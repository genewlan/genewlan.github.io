<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title></title>
    <url>/2023/12/31/CNN/</url>
    <content><![CDATA[<h3 id="第三章-卷积神经网络">第三章——卷积神经网络</h3>
<h4 id="卷积神经网络应用领域">卷积神经网络应用领域</h4>
<p>CV领域发展：</p>
<p><img src="/2023/12/31/CNN/1609377452885.png" alt="1609377452885"></p>
<blockquote>
<p>比赛中预测错误率的百分比，每年逐步下降。Human是人类肉眼的识别能力，2016年开始已经远高于人类肉眼死别能力，后面就取消了该方向的比赛了。</p>
</blockquote>
<p>检测任务：</p>
<p><img src="/2023/12/31/CNN/1609377623695.png" alt="1609377623695"></p>
<p>分类与检索：</p>
<p><img src="/2023/12/31/CNN/1609377675754.png" alt="1609377675754"></p>
<blockquote>
<p>分类：将图片分到对应类别。</p>
<p>检索：找到相似的图片。</p>
</blockquote>
<p>还有图片重构、无人驾驶、人脸识别</p>
<h4 id="卷积的作用">卷积的作用</h4>
<p>卷积网络与传统网络的区别：</p>
<p><img src="/2023/12/31/CNN/1609378885963.png" alt="1609378885963"></p>
<blockquote>
<p>输出的数据直接是三维的，还多了深度</p>
</blockquote>
<p>整体架构：</p>
<p>输入层、卷积层、池化层、全连接层</p>
<p><img src="/2023/12/31/CNN/1609378970489.png" alt="1609378970489"></p>
<blockquote>
<p>这里只有卷积层和池化层我们没有了解过</p>
</blockquote>
<p>卷积做了什么事：</p>
<p><img src="/2023/12/31/CNN/1609379061067.png" alt="1609379061067"></p>
<blockquote>
<p>比如一个猫的图，眼睛鼻子特征和周围环境特征的重要性明显不一样，需要区别对待。先把图像进行分割（最左边），分割成多个小区域，提取其中一个小区域（第二个5×5×3），蓝色图的右下角3×3矩阵，大字体的值是X的值，而小字体的值是w权重，会不断循环获取最优的w权重和对应的值，并输出右边绿色的14（特征值）。</p>
</blockquote>
<p>如果看了不理解，下面的具体计算方法一定能帮助你理解。</p>
<h4 id="卷积的计算方法">卷积的计算方法</h4>
<p><img src="/2023/12/31/CNN/202012310000.gif" alt="202012310000"></p>
<blockquote>
<p>input是输入，W0是第一层的权重，W1是第二层的权重，Output是输出</p>
</blockquote>
<p>我们以input三个块（RGB三颜色）左上角3×3矩阵值 和 第二层W1来计算，内积是乘法再相加。</p>
<ul>
<li>
<p>先来第一个（R颜色）左上角3×3：[0,0,0],[0,0,1],[0,0,1] 和 权重 [-1,-1,0],[-1,1,0],[-1,1,0]</p>
<p><code>(0*(-1) + 0*(-1) + 0*0)</code> + <code>(0*(-1) + 0*1 + 1*0)</code> + <code>(0*(-1) + 0*1 + 1*0)</code> = 0 得出R颜色的左上角矩阵的值为0；</p>
</li>
<li>
<p>第二个（G颜色） 左上角3×3矩阵值 和 第二层W1来计算</p>
<p><code>(0*1 + 0*(-1) + 0*0)</code> + <code>(0*(-1) + 1*0 + 1*(-1))</code> + <code>(0*(-1) + 0*0 + 2*0)</code> = -1</p>
</li>
<li>
<p>第三个（B颜色） 左上角3×3矩阵值 和 第二层W1来计算</p>
<p><code>((-1)*0 + 0*0 + 1)</code> + <code>(0*1 + 2*0 + 0*1)</code> + <code>(0*0 + 0*(-1) + 0*0)</code> = 0</p>
</li>
<li>
<p>最后再把三者结果相加并加上bias b1（偏值b）</p>
<p>0 + (-1) + 0 + 0 = -1</p>
<p>这级得到了output（0[:,:,1]）中左上角的结果 -1。</p>
</li>
</ul>
<h4 id="卷积层的参数">卷积层的参数</h4>
<p>卷积层涉及参数：滑动窗口步长、卷积核尺寸、边缘填充、卷积核个数</p>
<p><img src="/2023/12/31/CNN/1609382597717.png" alt="1609382597717"></p>
<ul>
<li>
<p>步长（移动多少个单元格）：</p>
<ul>
<li>
<p>步长为1的卷积：</p>
<p><img src="/2023/12/31/CNN/1609382708847.png" alt="1609382708847"></p>
<p>移动一个步长，得到红色绿色特征值，移动的步长越小，特征值越多</p>
</li>
<li>
<p>步长为2的卷积：</p>
<p><img src="/2023/12/31/CNN/1609382724744.png" alt="1609382724744"></p>
<p>移动两个步长，得到特征值越少</p>
</li>
<li>
<p>一般图像识别的用步长为1的，</p>
</li>
</ul>
</li>
<li>
<p>卷积核尺寸：选择区域的大小，如上面是3×3的矩阵，可以选择4×4、5×5的，核尺寸越小，越细粒度提取，特征越多。</p>
</li>
<li>
<p>边缘填充：</p>
<p><img src="/2023/12/31/CNN/1609385289111.png" alt="1609385289111"></p>
<p>+pad表示+1边缘，原本数据只有蓝色背景的部分（中间部分），而周围都是边缘增加的0，为什么这么做，滑动窗口时，边缘数据点明显滑动少，中间多，那能说明中间的就重要吗，为了使边缘的数据点也滑动多几次，就增加了这个边缘填充。文本分类中，有的文本有100个字，有的120字，不同长度无法训练，所以也会对其填充20个字，变成同样120的长度。</p>
</li>
<li>
<p>卷积核个数：最终计算的结果，要得到多少个特征图，个数多少，特征图多少。</p>
<p><img src="/2023/12/31/CNN/1609385564766.png" alt="1609385564766"></p>
</li>
<li>
<p>卷积参数共享：即input使用的W部分的参数是共享的，卷积网络比之前的全连接大大减少了参数，不再需要每个对应的W。</p>
</li>
</ul>
<h4 id="池化层的作用">池化层的作用</h4>
<p>将原始input的所有数据，进行压缩</p>
<p><img src="/2023/12/31/CNN/1609386518724.png" alt="1609386518724"></p>
<blockquote>
<p>减少长宽以减少数据量的体积。</p>
</blockquote>
<p>最大池化MAX POOLING：</p>
<p><img src="/2023/12/31/CNN/2021010109030000.gif" alt="2021010109030000"></p>
<ul>
<li>
<p>如上图，从可选中，选出最大的值。为什么选择最大的值，因为前面是有权重W相乘的，还记得前面的W0和W1吗，如果计算完成得到的结果最大，那说明该结果是最重要的，所以这里选最大的，即挑最重要的。</p>
</li>
<li>
<p>体积也从上图的2×2矩阵变成4×4的矩阵</p>
</li>
<li>
<p>除了最大池化还有平均池化，不过平均池化基本没人用，既然有最好的结果，就应该拿最好的。</p>
</li>
<li>
<p>池化层没有结果任何计算，只是选最大的</p>
</li>
</ul>
<h4 id="整体网络架构">整体网络架构</h4>
<p>只有带参数的才能算层，Relu和池化不算</p>
<p><img src="/2023/12/31/CNN/1609463898618.png" alt="1609463898618"></p>
<p>将一张图，通过不断卷积、池化、最后变成一条向量，接上全连接层，进行分类。</p>
<h4 id="残差网络resnet">残差网络ResNet</h4>
<p>深度网络遇到的问题：越大的层数理论上意味着越好，但实际是这样吗？下面是一组很早前测试的图</p>
<p><img src="/2023/12/31/CNN/1609464833488.png" alt="1609464833488"></p>
<blockquote>
<p>左边的训练集和右边的预测集都是20层的反而比56层的好，那么说明多出的36层起负作用。</p>
</blockquote>
<p>解决方案：</p>
<p><img src="/2023/12/31/CNN/1609464902930.png" alt="1609464902930"></p>
<blockquote>
<p>我们还是跟原来一样增加层数，但在此基础上增加残差，也就是如果多的一层网络效果并不比上一层好，那么依然使用上一层的结果，可以看到X直接跳过了两层，这样就能保证了效果一定是越来越好的。</p>
</blockquote>
<p>传统神经网络和Resnet的对比</p>
<p><img src="/2023/12/31/CNN/1609465049960.png" alt="1609465049960"></p>
<blockquote>
<p>ResNet是层数越多效果越好。</p>
</blockquote>
<p>下图是某个比赛中，冠军方案使用ResNet的层数是152层，第二名的22层有6.7的残差，而第一名的152层只有3.57的残差，相差近一倍的效果</p>
<p><img src="/2023/12/31/CNN/1609465201423.png" alt="1609465201423"></p>
<blockquote>
<p>当然层数越多，可能收益越少，但是保证残差一定是小于等于之前的低层数，也就是结果一定是向好的发展。</p>
</blockquote>
]]></content>
  </entry>
  <entry>
    <title>Unraveling the Intricacies of Biological Complexity--- Delving into the Synergy of Genomics, Metagenomics, and Comparative Genomics</title>
    <url>/2023/03/21/Exploring-the-Unknowns-of-Biological-Complexity/</url>
    <content><![CDATA[<p>Greetings esteemed colleagues and fellow enthusiasts in the realm of bioinformatics research. As a scientist with expertise in statistical modeling and a fervent interest in organismal evolution, my primary focus lies at the intersection of three intimately connected domains: Genomics, metagenomics, and comparative genomics.</p>
<p>Genomics concerns itself with the comprehensive study of an organism’s genome, while metagenomics delves into the collective genetic material of entire communities of organisms. Comparative genomics, on the other hand, scrutinizes the similarities and disparities in the genomes of distinct organisms. The intricate relationship binding these fields together is their collective capacity to furnish a holistic understanding of the genetic constitution of organisms, communities, and the evolutionary associations that permeate them.</p>
<p>My research pursuits encompass DNA molecular evolution and the genesis of encoding information. I am ardent about deciphering the enigmas of biological intricacy and eagerly anticipate the groundbreaking research that continues to surface in the field.</p>
<p>Recent advancements in sequencing technologies, coupled with state-of-the-art computational analysis methodologies, have facilitated the study of increasingly elaborate genetic systems. These encompass non-model organisms and even entire ecosystems. By amalgamating genomics, metagenomics, and comparative genomics, researchers can pinpoint and investigate the genetic foundations of multifaceted traits, such as susceptibility to diseases and adaptation to environmental conditions.</p>
<p>My academic provenance in bioinformatics and computer science has endowed me with the necessary skills to apply sophisticated statistical modeling techniques to biological research. Through this scholarly blog, I aspire to assimilate knowledge from other domains, refine my research objectives, and engage with like-minded individuals who share my zeal for probing the uncharted territories within the biological sphere.</p>
<p>The interdependence of genomics, metagenomics, and comparative genomics is of paramount significance in our endeavor to comprehend genetics and the elaborate biological systems in which they operate. The potential applications of these fields are immense, and their ongoing development and integration promise to yield novel insights and discoveries in genetics and beyond.</p>
<p>In essence, this blog serves as a conduit for me to disseminate my experiences, foster meaningful discourse with others, and perpetually learn and evolve. My ultimate aspiration is to collaborate with fellow researchers to uncover novel knowledge within the biological domain and contribute to its ongoing advancement.</p>
]]></content>
      <tags>
        <tag>Genomics</tag>
      </tags>
  </entry>
  <entry>
    <title>分子指纹与其应用</title>
    <url>/2023/03/24/GUN1D/</url>
    <content><![CDATA[<p>在化学领域，分子的描述和搜索是非常重要的问题，因为分子的物理性质和化学活性是由其化学结构和拓扑结构等特征决定的。因此，为了理解和预测分子的性质和行为，需要一种有效的方法来描述和比较分子的化学特征和结构。</p>
<p>然而，分子的化学结构和拓扑结构非常复杂，无法直接用数字或符号来表示。在计算机科学领域，常用的数据结构和算法往往也无法直接应用于分子描述和分子搜索等问题。因此，需要一种专门的方法来将分子转化为计算机可处理的形式，并提取其中的化学特征和结构信息。</p>
<p>在20世纪80年代初期，计算机技术已经逐渐成熟，开始被应用于化学研究领域。由于分子的化学结构和拓扑结构非常复杂，需要一种有效的方法来将分子转化为计算机可处理的形式。因此，化学家开始尝试使用计算机模拟和分子建模等技术来研究分子的性质和行为。然而，计算机模拟需要大量的计算资源和时间，因此需要一种简单且高效的方法来表示分子的化学特征和结构。</p>
<p>在这种背景下，分子指纹应运而生。分子指纹是一种基于简单规则或模式的编码方法，可以将分子表示为一个二进制或整数向量，其中每个元素表示分子的某种化学特征或结构信息。这种编码方法不仅可以减少计算复杂度，还可以提高分子描述的准确性和可重复性。</p>
<p>当时，化学家Trevor J. Howe等人提出了一种基于分子中子结构的编码方法，称为“SUBSTRUCTURE”指纹，该方法可以将分子表示为一个二进制向量，其中每个元素表示分子中的一个子结构特征。随后，另一位化学家Andrew R. Leach等人提出了一种基于分子拓扑结构的编码方法，称为“TOPOLOGICAL”指纹，该方法可以将分子表示为一个整数向量，其中每个元素表示分子中的一个拓扑结构特征。</p>
<p>在20世纪90年代，化学家Peter Willett等人提出了基于子结构的指纹方法，称为“FINGERPRINT”指纹，该方法可以将分子表示为一个二进制向量，其中每个元素表示分子中的一个化学子结构特征。此外，随着计算机技术和机器学习算法的不断发展，分子指纹的编码方法也在不断演化和创新。一些基于矩阵分解、图论和机器学习等方法的分子指纹方法相继出现。现代分子指纹方法不仅可以描述分子的化学特征和结构，还可以学习分子的高维表示，提高分子描述的精度和全面性，为分子设计和药物研发等领域提供了强有力的工具和方法。</p>
<p>因此，分子指纹的发展是多个化学家和研究人员共同努力的结果，涉及了分子结构、拓扑结构、子结构、矩阵分解、图论、机器学习等多个领域的知识和技术。他们的贡献使得分子指纹成为了一种简单、高效、准确和可重复的分子描述方法，在分子设计、药物研发等领域具有广泛的应用前景。</p>
<p>下面简单总结一下：</p>
<p>分子指纹是一种将分子结构转换为数字或二进制编码的方法。它将复杂的分子结构信息转换为固定长度的数值表示，以方便计算机处理和比较。分子指纹的生成方法有多种，包括基于结构的和基于性质的方法。</p>
<p>为什么需要分子指纹？因为分子结构非常复杂，无法直接进行计算机处理和比较。分子指纹的生成方法可以将分子结构信息转换为固定长度的二进制或数字向量，使得计算机可以对其进行处理和比较。分子指纹是化学信息学和计算机辅助药物设计等领域的重要工具。</p>
<p>如何生成分子指纹？分子指纹的生成方法包括特征提取和编码。特征提取是指从分子结构中提取有用的信息，例如原子类型、键类型、环结构、分子质量等等。编码是指将这些信息转换为数字或二进制表示，例如将每个特征映射为一个二进制位。分子指纹的生成方法有多种，其中基于结构的方法包括子结构指纹、拓扑指纹、MACCS指纹等，基于性质的方法则包括物化性质指纹、药效团指纹等。</p>
<p>分子指纹在药物研发中有着广泛的应用。药物的多样性是药物化学研究的关键问题之一，因为不同的化合物具有不同的生物活性和药物代谢。分子指纹可以用于筛选具有相似结构的化合物，以寻找可能具有相似生物活性的候选化合物。此外，分子指纹也可以用于药物分子的分类和聚类分析，以帮助药物研究人员更好地理解药物分子的结构与生物活性之间的关系。</p>
<p>在毒理学研究中，分子指纹也具有重要的应用价值。毒性是药物研究中的一个重要问题，因为药物在体内可能会产生毒性反应。分子指纹可以用于预测化合物的毒性和生物活性，以帮助药物研究人员更好地评估化合物的毒性风险。</p>
<p>下面以乙醇和乙酸为例来解释分子指纹是如何生成的</p>
<p>子结构指纹：对于乙醇分子，可以提取如下子结构：C-C, C-O, O-H。然后将这些子结构按照字典序排列，并按照出现次数进行编码，生成固定长度的二进制指纹。子结构指纹考虑了分子中不同的化学子结构，例如原子、化学键、环等，因此可以更好地描述分子的化学性质和结构特征。</p>
<p>拓扑指纹：对于乙醇分子，可以将分子中的每个原子编号，然后根据相邻原子间的连接信息生成一个固定长度的二进制向量。例如，将碳原子编码为001，氧原子编码为010，氢原子编码为100。拓扑指纹考虑了分子中不同原子之间的连接关系，因此可以更好地描述分子的拓扑结构和化学键特征。</p>
<p>MACCS指纹：对于乙醇分子，MACCS指纹可以包括如下特征：1. 包含一个碳原子和一个氧原子的环结构；2. 包含一个OH官能团；3. 包含一个乙基官能团等。然后根据这些特征进行编码，生成一个长度为166的二进制指纹。MACCS指纹是一种基于药效团的指纹编码方法，主要考虑了分子中的药效团信息，可以更好地描述分子的生物活性和作用机制。</p>
<p>物理特性指纹：物理特性指纹是基于分子物理特性的编码方法，例如电子结构、荷电性、立体构型等。对于乙醇分子，可以利用量子力学计算方法计算其分子的电子结构，然后将电子结构信息转化为二进制编码。例如，可以将每个原子的电荷、自旋、轨道等信息编码为二进制数，并将它们组合生成一个固定长度的二进制指纹。物理特性指纹是一种基于分子物理特性的编码方法，例如电子结构、荷电性、立体构型等，可以更好地描述分子的物理性质和化学结构特征。</p>
<p>二面角指纹：二面角指纹是基于分子二面角信息的编码方法。对于乙醇分子，可以利用分子建模软件计算其分子的二面角信息，然后将二面角信息编码为二进制向量。例如，可以将每个二面角转化为二进制数，并将它们组合生成一个固定长度的二进制指纹。二面角指纹考虑了分子中不同的二面角，可以更好地描述分子的构象和立体化学特征。</p>
<p>药效团指纹：药效团指纹是基于药效团信息的编码方法，可以用于描述分子的生物活性和作用机制。对于乙醇分子，可以提取如下药效团：OH官能团，乙基官能团，单一的碳氧化合物等。然后根据这些药效团信息进行编码，生成一个固定长度的二进制指纹。药效团指纹考虑了分子中不同的药效团信息，例如官能团、环等，可以更好地描述分子的生物活性和作用机制。</p>
<p>上述6种分子指纹的编码结果：</p>
<p>子结构指纹：001010100</p>
<p>拓扑指纹：001010010</p>
<p>MACCS指纹：000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000010</p>
<p>物理特性指纹：1011100011110000001010010001100001001000000000100001100000000010010010001010101110110000110000000010001001100000000001000001010000000010000000010000000000000000000000000</p>
<p>二面角指纹：11110110100100101111011110110000000010110101100111100101110110110010111101101100101110010111101101100101110010111101101100101110010111101101100101110010111101101100101110010111101101100101110010111101101100101110010111101101100101110010</p>
<p>药效团指纹：001000010</p>
<p>逐渐改进：</p>
<p>MACCS指纹（Molecular ACCess System）：它是一种基于哈希函数的分子指纹方法。MACCS指纹将分子中的化学键和它们周围的原子类型、环结构等信息编码为166位的二进制向量，其中每个位代表一个分子特征（例如特定的原子类型或结构），如果分子具有该特征，则该位为1，否则为0。使用MACCS指纹可以对分子进行相似性比较和分类，例如可以计算两个分子之间的Tanimoto相似系数，该系数在0到1之间，表示两个分子的相似度，值越大表示越相似。MACCS指纹方法在药物发现和化学信息学中得到了广泛的应用。</p>
<p>ECFP指纹（Extended-Connectivity Fingerprints）：ECFP指纹是一种基于分子拓扑结构的指纹方法，它将分子的拓扑结构信息编码为固定长度的二进制向量。具体来说，ECFP指纹方法从分子中选取一些原子或键作为起始点，然后沿着分子的连接边界遍历拓扑结构，形成一个子结构集合。然后，将这些子结构集合编码为二进制向量，其中每个位代表一个子结构，如果分子包含该子结构，则该位为1，否则为0。ECFP指纹方法可以在不同的层次上生成指纹，例如ECFP2、ECFP4等，表示选取的起始点数量不同，从而可以调整指纹的灵敏度和选择性。</p>
<p>RDKit指纹：RDKit是一种基于分子化学结构的指纹方法，它将分子的结构信息编码为固定长度的二进制向量。具体来说，RDKit指纹方法将分子分解为一些基元，例如原子、键、环等，然后根据这些基元组合生成指纹。RDKit指纹方法可以根据需要选择不同的基元和组合方式，例如根据原子类型、键类型、环结构等进行选择，从而可以调整指纹的灵敏度和选择性。</p>
<p>Morgan指纹：Morgan是一种基于分子子结构的指纹方法，它将分子的子结构信息编码为固定长度的二进制向量。具体来说，Morgan指纹方法从分子中选取一些原子或键作为起始点，然后沿着分子的连接边界遍历子结构，形成一个子结构集合。然后，将这些子结构集合编码为二进制向量，其中每个位代表一个子结构，如果分子包含该子结构，则该位为1，否则为0。Morgan指纹方法可以根据需要选择不同的起始点数量和子结构大小，从而可以调整指纹的灵敏度和选择性。</p>
<p>可以看出上述的方法要么表示结果太简单，和容易重复，尤其是很多分子指纹包含立体结构，这对于目前最具价值的应用科学——分子-蛋白对接来说，非常致命……</p>
<p>it takes many times……</p>
<p>一（步）直到（位）现在为止</p>
<p>图神经网络（Graph Neural Network, GNN）和变分自编码器（Variational Autoencoder, VAE）。这些方法可以学习分子的高维表示，包括原子特征、化学键、空间构型等信息，从而更全面地描述分子的化学和生物特性。</p>
<p>具体来说，图神经网络可以将分子表示为一个图结构，其中每个原子和化学键都作为图中的节点，节点之间的连接表示原子之间的化学键关系。然后利用神经网络对这个图结构进行学习，生成一个高维度的向量表示，该向量包含了分子的许多特征和结构信息。这种方法可以更好地描述分子的拓扑结构和化学键特征，适用于分子的分类、相似性计算等任务。</p>
<p>对于乙醇的一种可能的GNN编码结果：</p>
<p>[0.184, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0]</p>
<p>这个编码结果是一个长度为12的向量，每个元素表示一个原子或化学键的特征。具体来说，第一个元素表示乙醇分子中的氧原子，第八个元素表示乙醇分子中的羟基化学键（OH），其他元素表示分子中的其他原子和化学键。这个编码结果可以用于分子的分类、相似性计算等任务。需要注意的是，这个编码结果仅供参考，实际编码结果可能因为具体实现细节和参数设置等原因而有所不同。需要注意不同的指纹方法具有不同的特点和适用范围，需要根据具体的任务和数据选择合适的指纹方法。</p>
<p>下面就用一个比较简单的例子使用GUN网络，利用四种分子的分子指纹来预测新的分子的溶解度的实例</p>
<p>数据：</p>
<table>
<thead>
<tr>
<th>分子指纹</th>
<th>分子名称</th>
<th>溶解度</th>
</tr>
</thead>
<tbody>
<tr>
<td>CCC</td>
<td>丙烷</td>
<td>0.2</td>
</tr>
<tr>
<td>CCO</td>
<td>乙醇</td>
<td>0.5</td>
</tr>
<tr>
<td>CCN</td>
<td>乙胺</td>
<td>0.8</td>
</tr>
<tr>
<td>CC1=CC=CC=C1</td>
<td>苯</td>
<td>0.1</td>
</tr>
</tbody>
</table>
<p>目标分子：辛烷CC©CCCC©C</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">from</span> rdkit <span class="keyword">import</span> Chem</span><br><span class="line"><span class="keyword">from</span> rdkit.Chem <span class="keyword">import</span> AllChem</span><br><span class="line"><span class="keyword">from</span> rdkit.Chem.Descriptors <span class="keyword">import</span> MolLogP, MolWt, NumHAcceptors, NumHDonors</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GUN</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, input_size, hidden_size, output_size</span>):</span><br><span class="line">        <span class="built_in">super</span>(GUN, self).__init__()</span><br><span class="line">        self.fc1 = nn.Linear(input_size, hidden_size)</span><br><span class="line">        self.fc2 = nn.Linear(hidden_size, hidden_size)</span><br><span class="line">        self.fc3 = nn.Linear(hidden_size, output_size)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = F.relu(self.fc1(x))</span><br><span class="line">        x = F.relu(self.fc2(x))</span><br><span class="line">        x = self.fc3(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载分子数据集和标签，生成训练数据</span></span><br><span class="line">smiles_list = [<span class="string">&quot;CCC&quot;</span>, <span class="string">&quot;CCO&quot;</span>, <span class="string">&quot;CCN&quot;</span>, <span class="string">&quot;CC1=CC=CC=C1&quot;</span>]</span><br><span class="line">labels = [<span class="number">0.2</span>, <span class="number">0.5</span>, <span class="number">0.8</span>, <span class="number">0.1</span>]</span><br><span class="line">fingerprints = []</span><br><span class="line"><span class="keyword">for</span> smiles <span class="keyword">in</span> smiles_list:</span><br><span class="line">    mol = Chem.MolFromSmiles(smiles)</span><br><span class="line">    fp = AllChem.GetMorganFingerprintAsBitVect(mol, <span class="number">2</span>, nBits=<span class="number">2048</span>)</span><br><span class="line">    fp_array = torch.Tensor(fp)</span><br><span class="line">    fingerprints.append(fp_array)</span><br><span class="line">data = torch.stack(fingerprints)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成 GUN 网络实例并进行训练</span></span><br><span class="line">input_size = <span class="number">2048</span></span><br><span class="line">hidden_size = <span class="number">512</span></span><br><span class="line">output_size = <span class="number">1</span></span><br><span class="line">gun = GUN(input_size, hidden_size, output_size)</span><br><span class="line">optimizer = torch.optim.Adam(gun.parameters(), lr=<span class="number">0.001</span>)</span><br><span class="line">criterion = nn.MSELoss()</span><br><span class="line"></span><br><span class="line">num_epochs = <span class="number">100</span></span><br><span class="line">batch_size = <span class="number">2</span></span><br><span class="line">num_batches = <span class="built_in">len</span>(smiles_list) // batch_size</span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">    <span class="keyword">for</span> batch_idx <span class="keyword">in</span> <span class="built_in">range</span>(num_batches):</span><br><span class="line">        start_idx = batch_idx * batch_size</span><br><span class="line">        end_idx = (batch_idx + <span class="number">1</span>) * batch_size</span><br><span class="line">        inputs = data[start_idx:end_idx]</span><br><span class="line">        targets = torch.Tensor(labels[start_idx:end_idx]).reshape(-<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        optimizer.zero_grad()</span><br><span class="line">        outputs = gun(inputs)</span><br><span class="line">        loss = criterion(outputs, targets)</span><br><span class="line">        loss.backward()</span><br><span class="line">        optimizer.step()</span><br><span class="line"></span><br><span class="line">    epoch_loss = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">for</span> batch_idx <span class="keyword">in</span> <span class="built_in">range</span>(num_batches):</span><br><span class="line">        start_idx = batch_idx * batch_size</span><br><span class="line">        end_idx = (batch_idx + <span class="number">1</span>) * batch_size</span><br><span class="line">        inputs = data[start_idx:end_idx]</span><br><span class="line">        targets = torch.Tensor(labels[start_idx:end_idx]).reshape(-<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        outputs = gun(inputs)</span><br><span class="line">        batch_loss = criterion(outputs, targets)</span><br><span class="line">        epoch_loss += batch_loss.item()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Epoch <span class="subst">&#123;epoch+<span class="number">1</span>&#125;</span>, Loss: <span class="subst">&#123;epoch_loss/num_batches:<span class="number">.4</span>f&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 预测新的分子的溶解度</span></span><br><span class="line">new_smiles = <span class="string">&quot;CC(C)CCCC(C)C&quot;</span></span><br><span class="line">new_mol = Chem.MolFromSmiles(new_smiles)</span><br><span class="line">new_fp = AllChem.GetMorganFingerprintAsBitVect(new_mol, <span class="number">2</span>, nBits=<span class="number">2048</span>)</span><br><span class="line">new_fp_array = torch.Tensor(new_fp)</span><br><span class="line">new_data = new_fp_array.unsqueeze(<span class="number">0</span>)</span><br><span class="line">new_pred = gun(new_data)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;预测的溶解度为 <span class="subst">&#123;new_pred.item():<span class="number">.4</span>f&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>需要注意的是，这只是一个简单的示例，实际应用中需要根据具体的数据集和任务进行相应的调整。</p>
<p>结果：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">......</span><br><span class="line">Epoch 96, Loss: 0.0000</span><br><span class="line">Epoch 97, Loss: 0.0000</span><br><span class="line">Epoch 98, Loss: 0.0000</span><br><span class="line">Epoch 99, Loss: 0.0000</span><br><span class="line">Epoch 100, Loss: 0.0000</span><br><span class="line">预测的溶解度为 0.3516</span><br></pre></td></tr></table></figure>
<p>预告：如何依据gan网络生成生成新化合物，以对接靶蛋白</p>
]]></content>
      <tags>
        <tag>GUN</tag>
      </tags>
  </entry>
  <entry>
    <title>GANs网络在二维平面的实现</title>
    <url>/2023/04/14/GAN2D/</url>
    <content><![CDATA[<p>[TOC]</p>
<h1>GUNs的发迹史——刨根问底儿</h1>
<p>上一篇中，我们使用量GNN网络进行了辛烷溶解度的预测。那么问题来了，假如我们只有这些化合物是远远不能支撑人们日益增长的美好生活需要所需要的物质基础的。而现实生活中往往也是如此，化学家们经过几百年的努力分离出来许多化合物，但其中大部分不是“歪瓜”就是“裂枣”（可不敢胡说，或许是宝儿），不是产量少就是用不了，只有少量成功的化合物也被西方某大国成功的垄断。更重要的是，现实世界我们接触到的东西都是以平面或更高维的形式展现，一维是远远满足不了那里的人们追求欲望（~不，愿望），实现地强大且持久得野心的（~不，决心的）。</p>
<p>那么，有没有一种可以让我们快速生成大量非歪瓜劣枣的化合物呢？嗯，maybe生成网络就是答案之一。下面是博士卖驴的过程：</p>
<p>我们知道，机器学习在历史上也经历了三起三落，不断被打入冷宫，又被提拔为皇后。上世纪80年代，机器学习再度兴起，神经网络开始流行了。当时，人们主要的训练方式是监督学习，就是通过输入数据和对应的标签，让神经网络不断地调整自身的参数，以最小化预测值与真实标签之间的差距，从而实现模型的训练和优化，这就是我们熟知的反向传播算法。</p>
<p>这种算法的优点和缺点都很明显。优势是，它是可以处理大规模的数据集和复杂的非线性关系，而且算法效率较高，容易实现。但是，它经常如容易陷入局部最优解、对初始权重和偏置比较敏感、需要大量的标注数据等。尤其是在解决多层神经网络的过程中，劣势更加明显，训练过程更加困难。为了解决这个问题，研究人员开始尝试使用无监督学习的方法来训练神经网络。</p>
<p>值得一提的是当时最具影响的网络是自组织特征映射（Self-Organizing Feature Map，SOFM），也称为Kohonen网络。它旨在实现大规模数据的降维和可视化。主要思想是通过在输入空间中构建一个拓扑结构，将高维数据映射到低维空间中，并保持数据之间的拓扑关系，因此在图像压缩和信号处理等线性问题上面很有市场。Kohonen网络主要通过线性变换和欧氏距离量度来完成对目标的高效压缩，因此无法有效处理非线性数据和复杂分布的数据。于是需求造就市场，玻尔兹曼机（Boltzmann Machine）诞生了。</p>
<p>玻尔兹曼机是一种基于能量模型的概率生成模型，可以用于实现图像、音乐等多种生成任务。玻尔兹曼机最早是由物理学家Hinton等人提出的，它的原理是基于物理学中的玻尔兹曼分布理论，将神经元之间的相互作用看作是带有能量的粒子之间的相互作用，从而建立了一个能量模型。以下是玻尔兹曼机的工作过程：</p>
<ol>
<li>数据表示：将输入数据转换为向量形式，并将其作为可见层的状态。</li>
<li>随机初始化：将网络的权重和偏置随机初始化，以便在训练过程中进行优化。</li>
<li>Gibbs采样：通过交替执行正向传播和反向传播来更新网络的状态。在正向传播中，将可见层的状态传递到隐藏层，然后通过隐含层的状态重新计算可见层的状态。在反向传播中，将可见层的状态作为输出，然后通过反向传播误差来更新网络的权重和偏置。</li>
<li>训练：通过多次执行Gibbs采样来训练网络，直到网络收敛。在训练过程中，网络会不断地调整权重和偏置，以最小化能量函数。</li>
<li>生成：通过从网络中的随机状态开始，执行多次Gibbs采样来生成新的数据。在生成过程中，网络会根据其学习到的数据分布生成具有相似特征的新数据。</li>
</ol>
<p>重点来了：第五步。生成。主要目的是生成新的样本，以测试和验证模型的性能和效果。在波尔兹曼机中，生成是指从随机初始化的状态开始，通过不断迭代计算，生成新的样本。生成的过程类似于模拟退火，通过概率分布来探索样本空间，并从中采样生成新的样本。生成的样本可以用于评估模型的还原能力、泛化能力以及样本生成能力，从而判断模型的性能和效果。</p>
<p>然而，玻尔兹曼机的训练过程非常困难，因为需要对所有可能的状态进行计算，这个计算复杂度爆炸式增长，介于当时的电脑拥有强悍的11公斤身躯，超大的256k缓存，720k极致超大内存，以及超低的2280$的售价。玻尔兹曼机毫无疑问的流产了。就像妃子失宠之后很难再被想起一样，很长一段时间内没有得到广泛的应用。</p>
<p>后来~~~</p>
<p>后来，原始玻尔兹曼机的无向图改成了有向图，受限玻尔兹曼机（Restricted Boltzmann Machine ，RBM)诞生了；贪心算法接入，RBM变成了深度信念网络（Deep Belief Networks, DBN）。后来，专家系统被重新捡起来，人们想加入一些已知的确定的进入网络，将输入压缩成低维编码，并对解码器的误差进行重构，于是玻尔兹曼机又发展成了自编码器（Autoencoder, AE）。但是这货眼镜只能看到手里有的东西，对未知的东西则看缘分，这造成过了局部拟合，生成的东西乱七八遭，人们对AE的潜在数据空间进行约束，发展到了VAE。VAE在生成数据方面表现出色，但在生成高分辨率和多样化的数据方面仍然存在一些限制。于是一个生成器网络和一个判别器网络加入，判别器网络可以更好地区分真实数据和生成数据的生成器诞生了—gans，这是一款大规模流行生成对抗网络。</p>
<p>其数学基本思想发展如下：</p>
<img src="/2023/04/14/GAN2D/Snipaste_2023-04-12_14-31-48.png" style="zoom:80%;">
<p>当然后来还发展出了AGANs、BGANs、CGANs、、、WGANs，基本26个字母都用完了。无奈的人只有加单词如：StyleGANs，Progressive GANs、Self-Attention GANs、BigGANs、StarGANs等等，非常热闹。如下图：</p>
<img src="/2023/04/14/GAN2D/Evolution-of-GAN-model-year-wise.png">
<p>总之，这货还在疯狂的繁衍后代。</p>
<hr>
<h1>GUNs有啥用</h1>
<p>下面简单介绍一下，GAN（Generative Adversarial Networks）是一种深度学习模型，旨在生成与训练数据相似的新数据，由两个神经网络组成：生成器和判别器。GAN是通过对抗性训练的方式，让生成器不断生成与训练数据相似的新数据，同时让判别器不断判断生成的数据是否真实。这个过程类似于博弈论中的零和游戏，两个网络相互对抗，从而提高生成器的生成能力。</p>
<p>GAN的应用，包括图像生成、视频生成、语音合成等。我会讲解GAN在这些领域中的应用原理和方法，并展示一些实际应用的例子，让研究生了解GAN在实际应用中的价值和意义。</p>
<p>GAN算法的实现：包括生成器网络、判别器网络、损失函数、梯度下降算法等。一句话总结：生成器网络接收随机向量作为输入，并通过一系列的转换和变换生成与训练数据相似的新数据；判别器网络接收训练数据和生成器生成的数据作为输入，并输出一个概率值，表示输入的数据是真实数据的概率；损失函数，使得生成器和判别器能够相互对抗，同时被不断优化；梯度下降算法计算网络的参数梯度，并进行参数更新，略长~~。</p>
<p>总之：GANs是由两个神经网络组成的模型，一个是生成器网络，另一个是判别器网络，它们通过博弈的方式一起训练，使得生成器可以生成逼真的数据样本。GANs的工作流程如下：</p>
<ol>
<li>
<p>定义生成器和判别器网络。生成器网络将潜在的随机噪声输入转化为逼真的数据样本。判别器网络则判断输入的数据是真实的样本还是由生成器生成的假样本。</p>
</li>
<li>
<p>训练判别器网络。给定一批真实的数据样本和由生成器生成的假样本，判别器网络将对它们进行分类并计算损失函数。损失函数衡量了判别器网络对真实和假样本分类的准确性。</p>
</li>
<li>
<p>训练生成器网络。给定一批潜在的随机噪声输入，生成器网络将生成一批假样本。生成器的目标是欺骗判别器，使得它无法区分生成的假样本和真实的样本。因此，生成器的损失函数要最小化判别器将生成的假样本分类为假样本的概率。</p>
</li>
<li>
<p>交替训练生成器和判别器网络。在每一轮迭代中，生成器网络和判别器网络都要更新它们的参数，以最小化它们的损失函数。这个训练过程会一直进行，直到生成器能够生成逼真的数据样本，判别器无法准确地区分真实和假样本。</p>
</li>
<li>
<p>使用生成器生成新的数据样本。一旦生成器训练好了，就可以使用它生成新的逼真的数据样本，这些样本可以被用于各种应用，如图像修复、图像生成等。</p>
</li>
</ol>
<p>是不是很懵，没关系：</p>
<p>假设你有一个假币制造机，你希望这个机器可以制造跟真币一样逼真的假币，但是你不知道怎样制造才能达到这个目标。那么你可以使用GANs来解决这个问题。</p>
<p>首先，你需要有一些真币样本，这些真币样本将作为GANs的训练数据。你需要训练两个神经网络，一个是生成器网络，另一个是判别器网络。</p>
<p>生成器网络会生成假的币样本，判别器网络会判断这些样本是真币还是假币。在训练过程中，生成器网络不断生成更加逼真的假币样本，而判别器网络则不断提高对真币和假币的区分能力。</p>
<p>经过多次的迭代训练，你的生成器网络最终可以生成非常逼真的假币样本，而判别器网络也可以很难区分真币和假币。这样，你就成功地制造了逼真的假币，而GANs技术为你提供了一种有效的解决方案。</p>
<p>看图说话：</p>
<img src="/2023/04/14/GAN2D/Snipaste_2023-04-12_14-55-59.png" style="zoom:80%;">
<p>最终目的：让超级监视器认为真钱和假钱没差别，就像这样：</p>
<p>​           <img src="/2023/04/14/GAN2D/Snipaste_2023-04-12_15-05-31.png" style="zoom: 80%;"></p>
<p>于是：废纸变黄金</p>
<p><strong>好的有了这些知识，你就可以吊打南村群童了。但是，想踢馆初中生你还需要知道怎么操作</strong></p>
<p>下面实现一个对抗生成网络（GAN）的完整实例，包括数据处理、模型构建、训练和预测，使用 Tensorflow 和 Python 编程。我们将使用一个官方的手写数字数据集来训练一个 GAN，生成新的手写数字图像。这将next—-新化合物生成的基础。</p>
<h1>GUN的实现</h1>
<hr>
<h2 id="用keras搭一个神经网络的失败案例">用keras搭一个神经网络的失败案例</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers <span class="keyword">import</span> Input, Dense, Reshape, Flatten, Dropout, Conv2D, Conv2DTranspose</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers <span class="keyword">import</span> BatchNormalization, Activation, LeakyReLU</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.models <span class="keyword">import</span> Sequential, Model</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.optimizers <span class="keyword">import</span> Adam</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载数据集</span></span><br><span class="line">(X_train, _), (_, _) = mnist.load_data()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据处理</span></span><br><span class="line">X_train = X_train / <span class="number">127.5</span> - <span class="number">1.</span></span><br><span class="line">X_train = np.expand_dims(X_train, axis=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义模型参数</span></span><br><span class="line">img_rows = <span class="number">28</span></span><br><span class="line">img_cols = <span class="number">28</span></span><br><span class="line">channels = <span class="number">1</span></span><br><span class="line">img_shape = (img_rows, img_cols, channels)</span><br><span class="line">z_dim = <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义生成器模型</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_generator</span>(<span class="params">img_shape, z_dim</span>):</span><br><span class="line">    model = Sequential()</span><br><span class="line">    model.add(Dense(<span class="number">256</span>, input_dim=z_dim))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">    model.add(BatchNormalization(momentum=<span class="number">0.8</span>))</span><br><span class="line">    model.add(Dense(<span class="number">512</span>))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">    model.add(BatchNormalization(momentum=<span class="number">0.8</span>))</span><br><span class="line">    model.add(Dense(<span class="number">1024</span>))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">    model.add(BatchNormalization(momentum=<span class="number">0.8</span>))</span><br><span class="line">    model.add(Dense(np.prod(img_shape), activation=<span class="string">&#x27;tanh&#x27;</span>))</span><br><span class="line">    model.add(Reshape(img_shape))</span><br><span class="line"></span><br><span class="line">    z = Input(shape=(z_dim,))</span><br><span class="line">    img = model(z)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Model(z, img)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义判别器模型</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_discriminator</span>(<span class="params">img_shape</span>):</span><br><span class="line">    model = Sequential()</span><br><span class="line"></span><br><span class="line">    model.add(Flatten(input_shape=img_shape))</span><br><span class="line">    model.add(Dense(<span class="number">512</span>))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">    model.add(Dropout(<span class="number">0.4</span>)) </span><br><span class="line">    model.add(Dense(<span class="number">256</span>))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">    model.add(Dropout(<span class="number">0.4</span>)) </span><br><span class="line">    model.add(Dense(<span class="number">128</span>))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">    model.add(Dropout(<span class="number">0.4</span>))</span><br><span class="line">    model.add(Dense(<span class="number">1</span>, activation=<span class="string">&#x27;sigmoid&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    img = Input(shape=img_shape)</span><br><span class="line">    validity = model(img)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Model(img, validity)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建 GAN 模型</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_gan</span>(<span class="params">generator, discriminator</span>):</span><br><span class="line">    discriminator.trainable = <span class="literal">False</span></span><br><span class="line">    z = Input(shape=(z_dim,))</span><br><span class="line">    img = generator(z)</span><br><span class="line">    validity = discriminator(img)</span><br><span class="line">    <span class="keyword">return</span> Model(z, validity)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译模型</span></span><br><span class="line">generator = build_generator(img_shape, z_dim)</span><br><span class="line">discriminator = build_discriminator(img_shape)</span><br><span class="line">gan = build_gan(generator, discriminator)</span><br><span class="line">optimizer = Adam(<span class="number">0.0002</span>, <span class="number">0.5</span>)</span><br><span class="line">discriminator.<span class="built_in">compile</span>(loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>, optimizer=optimizer, metrics=[<span class="string">&#x27;accuracy&#x27;</span>])</span><br><span class="line">gan.<span class="built_in">compile</span>(loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>, optimizer=optimizer)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 训练模型</span></span><br><span class="line">epochs = <span class="number">10000</span></span><br><span class="line">batch_size = <span class="number">128</span></span><br><span class="line">sample_interval = <span class="number">200</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(epochs):</span><br><span class="line">    <span class="comment"># 训练判别器</span></span><br><span class="line">    idx = np.random.randint(<span class="number">0</span>, X_train.shape[<span class="number">0</span>], batch_size)</span><br><span class="line">    imgs = X_train[idx]</span><br><span class="line">    noise = np.random.normal(<span class="number">0</span>, <span class="number">1</span>, (batch_size, z_dim))</span><br><span class="line">    gen_imgs = generator.predict(noise)</span><br><span class="line">    d_loss_real = discriminator.train_on_batch(imgs, np.ones((batch_size, <span class="number">1</span>)))</span><br><span class="line">    d_loss_fake = discriminator.train_on_batch(gen_imgs, np.zeros((batch_size, <span class="number">1</span>)))</span><br><span class="line">    d_loss = <span class="number">0.5</span> * np.add(d_loss_real, d_loss_fake)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 训练生成器</span></span><br><span class="line">    noise = np.random.normal(<span class="number">0</span>, <span class="number">1</span>, (batch_size, z_dim))</span><br><span class="line">    g_loss = gan.train_on_batch(noise, np.ones((batch_size, <span class="number">1</span>)))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打印损失</span></span><br><span class="line">    <span class="keyword">if</span> epoch % sample_interval == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Epoch <span class="subst">&#123;epoch&#125;</span>, Discriminator Loss: <span class="subst">&#123;d_loss[<span class="number">0</span>]&#125;</span>, Generator Loss: <span class="subst">&#123;g_loss[<span class="number">0</span>]&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 随机生成新图像</span></span><br><span class="line">        r, c = <span class="number">5</span>, <span class="number">5</span></span><br><span class="line">        noise = np.random.normal(<span class="number">0</span>, <span class="number">1</span>, (r * c, z_dim))</span><br><span class="line">        gen_imgs = generator.predict(noise)</span><br><span class="line">        gen_imgs = <span class="number">0.5</span> * gen_imgs + <span class="number">0.5</span></span><br><span class="line">        fig, axs = plt.subplots(r, c)</span><br><span class="line">        cnt = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(r):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(c):</span><br><span class="line">                axs[i,j].imshow(gen_imgs[cnt, :,:,<span class="number">0</span>], cmap=<span class="string">&#x27;gray&#x27;</span>)</span><br><span class="line">                axs[i,j].axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">                cnt += <span class="number">1</span></span><br><span class="line">        plt.show()  </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>最后输出是这样婶儿的：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>/<span class="number">1</span> [==============================] - 0s 50ms/step</span><br><span class="line">Epoch <span class="number">0</span>, Discriminator Loss: <span class="number">0.0917658281326294</span>, Generator Loss: <span class="number">0.00045222198241</span></span><br><span class="line">&gt;&gt;&gt;&gt;&gt;&gt;</span><br><span class="line">Epoch <span class="number">1000</span>, Discriminator Loss: <span class="number">8.101632460951805</span>, Generator Loss: <span class="number">0.00000649235166</span></span><br></pre></td></tr></table></figure>
<img src="/2023/04/14/GAN2D/Snipaste_2023-04-12_16-56-38.png" title="style=&quot;zoom:150%;&quot;">
<p>打眼一看，这出问题了啊。</p>
<p>D_loss不断升高，幅度不大，G_loss不断下降，几何级下降，图像一片雪花。—&gt;鉴别器太弱了,把尿片当成宝了，什么垃圾都给你留下。</p>
<p><strong>堆叠层数</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 定义生成器模型</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_generator</span>(<span class="params">img_shape, z_dim</span>):</span><br><span class="line">    model = Sequential()</span><br><span class="line">    model.add(Dense(<span class="number">128</span>, input_dim=z_dim))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">    model.add(BatchNormalization(momentum=<span class="number">0.8</span>))</span><br><span class="line">    model.add(Dense(<span class="number">256</span>, input_dim=z_dim))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">    model.add(BatchNormalization(momentum=<span class="number">0.8</span>))</span><br><span class="line">    model.add(Dense(<span class="number">512</span>))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">    model.add(BatchNormalization(momentum=<span class="number">0.8</span>))</span><br><span class="line">    model.add(Dense(<span class="number">1024</span>))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">    model.add(BatchNormalization(momentum=<span class="number">0.8</span>))</span><br><span class="line">    model.add(Dense(np.prod(img_shape), activation=<span class="string">&#x27;tanh&#x27;</span>))</span><br><span class="line">    model.add(Reshape(img_shape))</span><br><span class="line">    z = Input(shape=(z_dim,))</span><br><span class="line">    img = model(z)</span><br><span class="line">    <span class="keyword">return</span> Model(z, img)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义判别器模型</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_discriminator</span>(<span class="params">img_shape</span>):</span><br><span class="line">    model = Sequential()</span><br><span class="line"></span><br><span class="line">    model.add(Flatten(input_shape=img_shape))</span><br><span class="line">    model.add(Dense(<span class="number">512</span>))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">    model.add(Dense(<span class="number">256</span>))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">    model.add(Dense(<span class="number">128</span>))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">    model.add(Dense(<span class="number">64</span>))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">    model.add(Dense(<span class="number">32</span>))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.2</span>))</span><br><span class="line">    model.add(Dense(<span class="number">1</span>, activation=<span class="string">&#x27;sigmoid&#x27;</span>))</span><br><span class="line">    img = Input(shape=img_shape)</span><br><span class="line">    validity = model(img)</span><br><span class="line">    <span class="keyword">return</span> Model(img, validity)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>看看效果（Epoch 5000），顺便调个参数吧：optimizer = Adam(0.0001, 0.9)</p>
<p><img src="/2023/04/14/GAN2D/Snipaste_2023-04-12_22-36-51.png" alt></p>
<p>这~，这是嘛呀！！！！还是不行，手搓航母吧！</p>
<p>有谁调试成立一定@我</p>
<hr>
<h2 id="换pytorch数据库">换pytorch数据库</h2>
<h3 id="非卷积对抗神经网络">非卷积对抗神经网络</h3>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torchvision</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">image_size = [<span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>]</span><br><span class="line">latent_dim = <span class="number">96</span></span><br><span class="line">batch_size = <span class="number">64</span></span><br><span class="line"><span class="comment">##生成器</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Generator</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Generator, self).__init__()</span><br><span class="line">        self.model = nn.Sequential(</span><br><span class="line">            nn.Linear(latent_dim, <span class="number">128</span>),</span><br><span class="line">            torch.nn.BatchNorm1d(<span class="number">128</span>),</span><br><span class="line">            torch.nn.ReLU(),</span><br><span class="line"></span><br><span class="line">            nn.Linear(<span class="number">128</span>, <span class="number">256</span>),</span><br><span class="line">            torch.nn.BatchNorm1d(<span class="number">256</span>),</span><br><span class="line">            torch.nn.ReLU(),</span><br><span class="line">            nn.Linear(<span class="number">256</span>, <span class="number">512</span>),</span><br><span class="line">            torch.nn.BatchNorm1d(<span class="number">512</span>),</span><br><span class="line">            torch.nn.ReLU(),</span><br><span class="line">            nn.Linear(<span class="number">512</span>, <span class="number">1024</span>),</span><br><span class="line">            torch.nn.BatchNorm1d(<span class="number">1024</span>),</span><br><span class="line">            torch.nn.ReLU(),</span><br><span class="line">            nn.Linear(<span class="number">1024</span>, np.prod(image_size, dtype=np.int32)),</span><br><span class="line">            nn.Sigmoid())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, z</span>):</span><br><span class="line">        output = self.model(z)</span><br><span class="line">        image = output.reshape(z.shape[<span class="number">0</span>], *image_size)</span><br><span class="line">        <span class="keyword">return</span> image</span><br><span class="line"><span class="comment">##监视器</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Discriminator</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Discriminator, self).__init__()</span><br><span class="line">        self.model = nn.Sequential(</span><br><span class="line">            nn.Linear(np.prod(image_size, dtype=np.int32), <span class="number">512</span>),</span><br><span class="line">            torch.nn.ReLU(),</span><br><span class="line">            nn.Linear(<span class="number">512</span>, <span class="number">256</span>),</span><br><span class="line">            torch.nn.GELU(),</span><br><span class="line">            nn.Linear(<span class="number">256</span>, <span class="number">128</span>),</span><br><span class="line">            torch.nn.ReLU(),</span><br><span class="line">            nn.Linear(<span class="number">128</span>, <span class="number">64</span>),</span><br><span class="line">            torch.nn.ReLU(),</span><br><span class="line">            nn.Linear(<span class="number">64</span>, <span class="number">32</span>),</span><br><span class="line">            torch.nn.ReLU(),</span><br><span class="line">            nn.Linear(<span class="number">32</span>, <span class="number">1</span>),</span><br><span class="line">            nn.Sigmoid())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, image</span>):</span><br><span class="line">        prob = self.model(image.reshape(image.shape[<span class="number">0</span>], -<span class="number">1</span>))</span><br><span class="line">        <span class="keyword">return</span> prob</span><br><span class="line"><span class="comment">##数据库</span></span><br><span class="line">dataset = torchvision.datasets.MNIST(<span class="string">&quot;mnist_data&quot;</span>, train=<span class="literal">True</span>, download=<span class="literal">True</span>,transform=torchvision.transforms.Compose([torchvision.transforms.Resize(<span class="number">28</span>),torchvision.transforms.ToTensor(),]))</span><br><span class="line"></span><br><span class="line">dataloader = torch.utils.data.DataLoader(dataset, batch_size=batch_size, shuffle=<span class="literal">True</span>, drop_last=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">##起个名，让他们准备干活</span></span><br><span class="line">generator = Generator()</span><br><span class="line">discriminator = Discriminator()</span><br><span class="line"><span class="comment">##更新损失函数</span></span><br><span class="line">g_optimizer = torch.optim.Adam(generator.parameters(), lr=<span class="number">0.0003</span>, betas=(<span class="number">0.4</span>, <span class="number">0.8</span>), weight_decay=<span class="number">0.0001</span>)</span><br><span class="line">d_optimizer = torch.optim.Adam(discriminator.parameters(), lr=<span class="number">0.0003</span>, betas=(<span class="number">0.4</span>, <span class="number">0.8</span>), weight_decay=<span class="number">0.0001</span>)</span><br><span class="line"></span><br><span class="line">loss_fn = nn.BCELoss()</span><br><span class="line"></span><br><span class="line">labels_one = torch.ones(batch_size, <span class="number">1</span>)</span><br><span class="line">labels_zero = torch.zeros(batch_size, <span class="number">1</span>)</span><br><span class="line"><span class="comment">#循环起来</span></span><br><span class="line">num_epoch = <span class="number">20</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epoch):</span><br><span class="line">    <span class="keyword">for</span> i, mini_batch <span class="keyword">in</span> <span class="built_in">enumerate</span>(dataloader):</span><br><span class="line">        gt_images, _ = mini_batch  </span><br><span class="line">        z = torch.randn(batch_size, latent_dim)</span><br><span class="line">        pred_images = generator(z)</span><br><span class="line"></span><br><span class="line">        g_optimizer.zero_grad()</span><br><span class="line">        recons_loss = torch.<span class="built_in">abs</span>(pred_images-gt_images).mean()</span><br><span class="line">        g_loss = recons_loss*<span class="number">0.05</span> + loss_fn(discriminator(pred_images), labels_one)</span><br><span class="line">        g_loss.backward()</span><br><span class="line"></span><br><span class="line">        g_optimizer.step()</span><br><span class="line">        d_optimizer.zero_grad()</span><br><span class="line"></span><br><span class="line">        real_loss = loss_fn(discriminator(gt_images), labels_one) </span><br><span class="line">        fake_loss = loss_fn(discriminator(pred_images.detach()), labels_zero) </span><br><span class="line">        d_loss = (real_loss + fake_loss)</span><br><span class="line"></span><br><span class="line">        d_loss.backward()</span><br><span class="line">        d_optimizer.step()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">50</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;step:<span class="subst">&#123;<span class="built_in">len</span>(dataloader)*epoch+i&#125;</span>, g_loss:<span class="subst">&#123;g_loss.item()&#125;</span>, d_loss:<span class="subst">&#123;d_loss.item()&#125;</span>&quot;</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">if</span> i % <span class="number">400</span> == <span class="number">0</span>:</span><br><span class="line">            image = pred_images[:<span class="number">16</span>].data</span><br><span class="line">            image = <span class="number">0.5</span> * (image + <span class="number">1</span>)</span><br><span class="line">            image = image.cpu().numpy()</span><br><span class="line">            plt.figure(figsize=(<span class="number">6</span>, <span class="number">6</span>))</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">                plt.subplot(<span class="number">4</span>, <span class="number">4</span>, j+<span class="number">1</span>)</span><br><span class="line">                plt.imshow(image[j, <span class="number">0</span>], cmap=<span class="string">&#x27;gray&#x27;</span>)</span><br><span class="line">                plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">            plt.show()</span><br><span class="line">     </span><br></pre></td></tr></table></figure>
<p>立杆见影：</p>
<table><tr>
    <td><img src="/2023/04/14/GAN2D/image_0.png"></td>
    <td><img src="/2023/04/14/GAN2D/image_937.png" alt="image_937"></td>
    <td><img src="/2023/04/14/GAN2D/image_2811.png" alt="image_2811"></td>
    <td><img src="/2023/04/14/GAN2D/image_4148.png" alt="image_4148"></td>
    <td><img src="/2023/04/14/GAN2D/image_5085.png" alt="image_5085"></td>
    <td><img src="/2023/04/14/GAN2D/image_6022.png" alt="image_6022"></td>
</tr></table>
<table><tr>
    <td><img src="/2023/04/14/GAN2D/image_7359.png"></td>
    <td><img src="/2023/04/14/GAN2D/image_8296.png" alt="image_8296"></td>
    <td><img src="/2023/04/14/GAN2D/image_9233.png"></td>
    <td><img src="/2023/04/14/GAN2D/image_10307.png" alt="image_10307"></td>
    <td><img src="/2023/04/14/GAN2D/image_15392.png" alt="image_15392"></td>
    <td><img src="/2023/04/14/GAN2D/image_16866.png"></td>
</tr></table>
<p>上述分别为是Epoch= 0，1000，3000，4000，5000，6000，7000，8000，9000，10000，15000，16000时的图像。非常nice。</p>
<h3 id="卷积对抗神经网络">卷积对抗神经网络</h3>
<h4 id="卷积对抗神经网络1">卷积对抗神经网络1</h4>
<p>有GPU的可以尝试一下，内存小的话，很快就会爆掉，这是代码，死慢死慢的！！</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torchvision.datasets <span class="keyword">as</span> datasets</span><br><span class="line"><span class="keyword">import</span> torchvision.transforms <span class="keyword">as</span> transforms</span><br><span class="line"><span class="keyword">import</span> torch.optim <span class="keyword">as</span> optim</span><br><span class="line"><span class="keyword">from</span> torch.utils.data <span class="keyword">import</span> DataLoader</span><br><span class="line"><span class="keyword">import</span> torchvision.utils</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义超参数</span></span><br><span class="line">batch_size = <span class="number">128</span></span><br><span class="line">num_epochs = <span class="number">100</span></span><br><span class="line">z_dim = <span class="number">100</span>  </span><br><span class="line">lr = <span class="number">0.0003</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment">#张量转换</span></span><br><span class="line">img_transform = transforms.Compose([transforms.ToTensor(),transforms.Normalize((<span class="number">0.5</span>,), (<span class="number">0.5</span>,))])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载 MNIST </span></span><br><span class="line">mnist = datasets.MNIST(root=<span class="string">&#x27;./data&#x27;</span>, train=<span class="literal">True</span>, transform=img_transform, download=<span class="literal">True</span>)</span><br><span class="line">data_loader = DataLoader(mnist, batch_size=batch_size, shuffle=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 判别器</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Discriminator</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Discriminator, self).__init__()</span><br><span class="line">        self.conv = nn.Sequential(</span><br><span class="line">            nn.Conv2d(<span class="number">1</span>, <span class="number">32</span>, <span class="number">5</span>, stride=<span class="number">1</span>, padding=<span class="number">2</span>),</span><br><span class="line">            nn.ReLU(inplace=<span class="literal">True</span>),</span><br><span class="line">            nn.AvgPool2d(<span class="number">2</span>, stride=<span class="number">2</span>),</span><br><span class="line">            nn.Conv2d(<span class="number">32</span>, <span class="number">64</span>, <span class="number">5</span>, stride=<span class="number">1</span>, padding=<span class="number">2</span>),</span><br><span class="line">            nn.ReLU(inplace=<span class="literal">True</span>),</span><br><span class="line">            nn.AvgPool2d(<span class="number">2</span>, stride=<span class="number">2</span>))</span><br><span class="line">        self.fc = nn.Sequential(</span><br><span class="line">            nn.Linear(<span class="number">7</span> * <span class="number">7</span> * <span class="number">64</span>, <span class="number">1024</span>),</span><br><span class="line">            nn.ReLU(inplace=<span class="literal">True</span>),</span><br><span class="line">            nn.Linear(<span class="number">1024</span>, <span class="number">1</span>),</span><br><span class="line">            nn.Sigmoid())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = self.conv(x)</span><br><span class="line">        x = x.view(x.size(<span class="number">0</span>), -<span class="number">1</span>)</span><br><span class="line">        x = self.fc(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成器</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Generator</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">super</span>(Generator, self).__init__()</span><br><span class="line">        self.fc = nn.Sequential(</span><br><span class="line">            nn.Linear(z_dim, <span class="number">256</span>),</span><br><span class="line">            nn.LeakyReLU(<span class="number">0.2</span>, inplace=<span class="literal">True</span>),</span><br><span class="line">            nn.BatchNorm1d(<span class="number">256</span>),</span><br><span class="line">            nn.Linear(<span class="number">256</span>, <span class="number">512</span>),</span><br><span class="line">            nn.LeakyReLU(<span class="number">0.2</span>, inplace=<span class="literal">True</span>),</span><br><span class="line">            nn.BatchNorm1d(<span class="number">512</span>),</span><br><span class="line">            nn.Linear(<span class="number">512</span>, <span class="number">1024</span>),</span><br><span class="line">            nn.LeakyReLU(<span class="number">0.2</span>, inplace=<span class="literal">True</span>),</span><br><span class="line">            nn.BatchNorm1d(<span class="number">1024</span>),</span><br><span class="line">            nn.Linear(<span class="number">1024</span>, <span class="number">7</span> * <span class="number">7</span> * <span class="number">64</span>),</span><br><span class="line">            nn.LeakyReLU(<span class="number">0.2</span>, inplace=<span class="literal">True</span>),</span><br><span class="line">            nn.BatchNorm1d(<span class="number">7</span> * <span class="number">7</span> * <span class="number">64</span>))</span><br><span class="line">        self.conv = nn.Sequential(</span><br><span class="line">            nn.ConvTranspose2d(<span class="number">64</span>, <span class="number">32</span>, <span class="number">4</span>, stride=<span class="number">2</span>, padding=<span class="number">1</span>),</span><br><span class="line">            nn.LeakyReLU(<span class="number">0.2</span>, inplace=<span class="literal">True</span>),</span><br><span class="line">            nn.BatchNorm2d(<span class="number">32</span>),</span><br><span class="line">            nn.ConvTranspose2d(<span class="number">32</span>, <span class="number">1</span>, <span class="number">4</span>, stride=<span class="number">2</span>, padding=<span class="number">1</span>),</span><br><span class="line">            nn.Tanh())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = self.fc(x)</span><br><span class="line">        x = x.view(-<span class="number">1</span>, <span class="number">64</span>, <span class="number">7</span>, <span class="number">7</span>)</span><br><span class="line">        x = self.conv(x)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义判别器和生成器</span></span><br><span class="line">D = Discriminator()</span><br><span class="line">G = Generator()</span><br><span class="line"></span><br><span class="line">device = torch.device(<span class="string">&quot;cuda:0&quot;</span> <span class="keyword">if</span> torch.cuda.is_available() <span class="keyword">else</span> <span class="string">&quot;cpu&quot;</span>)</span><br><span class="line">D.to(device)</span><br><span class="line">G.to(device)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义损失函数和优化器</span></span><br><span class="line">criterion = nn.BCELoss()</span><br><span class="line">d_optimizer = optim.Adam(D.parameters(), lr=lr)</span><br><span class="line">g_optimizer = optim.Adam(G.parameters(), lr=lr)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义真和假标签</span></span><br><span class="line">real_label = <span class="number">1</span></span><br><span class="line">fake_label = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对于每个epoch</span></span><br><span class="line"><span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(num_epochs):</span><br><span class="line">    <span class="comment"># 对于每个batch</span></span><br><span class="line">    <span class="keyword">for</span> i, (images, _) <span class="keyword">in</span> <span class="built_in">enumerate</span>(data_loader):</span><br><span class="line">        batch_size = images.size(<span class="number">0</span>)</span><br><span class="line">        images = images.view(batch_size, <span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 训练判别器</span></span><br><span class="line">        d_optimizer.zero_grad()</span><br><span class="line">        <span class="comment"># 真实数据</span></span><br><span class="line">        real_outputs = D(images)</span><br><span class="line">        real_loss = criterion(real_outputs, torch.ones(batch_size, <span class="number">1</span>))</span><br><span class="line">        <span class="comment"># 生成数据</span></span><br><span class="line">        z = torch.randn(batch_size, z_dim).to(device)</span><br><span class="line">        fake_images = G(z)</span><br><span class="line">        fake_outputs = D(fake_images.detach())</span><br><span class="line">        fake_loss = criterion(fake_outputs, torch.zeros(batch_size, <span class="number">1</span>))</span><br><span class="line">        <span class="comment"># 计算总损失</span></span><br><span class="line">        d_loss = real_loss + fake_loss</span><br><span class="line">        <span class="comment"># 反向传播和优化</span></span><br><span class="line">        d_loss.backward()</span><br><span class="line">        d_optimizer.step()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 训练生成器</span></span><br><span class="line">        g_optimizer.zero_grad()</span><br><span class="line">        z = torch.randn(batch_size, z_dim).to(device)</span><br><span class="line">        fake_images = G(z)</span><br><span class="line">        fake_outputs = D(fake_images)</span><br><span class="line">        g_loss = criterion(fake_outputs, torch.ones(batch_size, <span class="number">1</span>))</span><br><span class="line">        <span class="comment"># 反向传播和优化</span></span><br><span class="line">        g_loss.backward()</span><br><span class="line">        g_optimizer.step()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 打印损失</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Epoch [&#123;&#125;/&#123;&#125;], Step [&#123;&#125;/&#123;&#125;], d_loss: &#123;:.4f&#125;, g_loss: &#123;:.4f&#125;,&#x27;</span></span><br><span class="line">      <span class="string">&#x27;D(x): &#123;:.2f&#125;, D(G(z)): &#123;:.2f&#125;&#x27;</span>.<span class="built_in">format</span>(epoch, num_epochs, i+<span class="number">1</span>, <span class="built_in">len</span>(data_loader),d_loss.item(), g_loss.item(),real_score.mean().item(), fake_score.mean().item()))</span><br><span class="line">    <span class="comment"># 生成并打印图像</span></span><br><span class="line"><span class="keyword">with</span> torch.no_grad():</span><br><span class="line">    z = torch.randn(<span class="number">25</span>, latent_size, device=device)</span><br><span class="line">    fake_images = G(z).reshape(-<span class="number">1</span>, <span class="number">1</span>, <span class="number">28</span>, <span class="number">28</span>)</span><br><span class="line">    img_grid = torchvision.utils.make_grid(fake_images, nrow=<span class="number">5</span>, normalize=<span class="literal">True</span>)</span><br><span class="line">    img_array = img_grid.permute(<span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>).cpu().numpy()</span><br><span class="line">    plt.imshow(img_array)</span><br><span class="line">    plt.axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>
<p>我电脑有点垃，运行不到1个epoch，它就把我的电脑干掉了~~~不过，不到一个回合运行成这样，还是相当不错的。</p>
<p>卷积代码请参考<a href="https://blog.csdn.net/weixin_41278720/article/details/80861284">1</a>，根据需求自行修改。</p>
<table><tr>
    	<td><img src="/2023/04/14/GAN2D/Snipaste_2023-04-14_03-41-59.png" style="zoom:70%;"></td>
    	<td><img src="/2023/04/14/GAN2D/Snipaste_2023-04-14_04-14-09.png" style="zoom:70%;"></td>
</tr><tr><table>
<p>右边是改的一个简化版本，两个都是第100个epoch，1000epoch的时候大概率快了2min，不过这个模型怎么改都非常慢。已经进化到甲骨文时代了。不过，1000次epoch要花大概8min，还是算了，pass，xxx</p>
<h4 id="卷积对抗神经网络2">卷积对抗神经网络2</h4>
<p>这个就快多了，也不用gpu，关键是你可以看到他长大，很解压！！</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.datasets <span class="keyword">import</span> mnist</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers <span class="keyword">import</span> Input, Dense, Reshape, Flatten, Conv2D, Conv2DTranspose</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.layers <span class="keyword">import</span> BatchNormalization, LeakyReLU</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.models <span class="keyword">import</span> Sequential, Model</span><br><span class="line"><span class="keyword">from</span> tensorflow.keras.optimizers <span class="keyword">import</span> Adam</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义生成器模型</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_generator</span>():</span><br><span class="line">    model = Sequential()</span><br><span class="line">    model.add(Dense(<span class="number">7</span>*<span class="number">7</span>*<span class="number">256</span>, input_shape=(<span class="number">100</span>,)))</span><br><span class="line">    model.add(Reshape((<span class="number">7</span>, <span class="number">7</span>, <span class="number">256</span>)))</span><br><span class="line">    model.add(Conv2DTranspose(<span class="number">128</span>, kernel_size=<span class="number">3</span>, strides=<span class="number">2</span>, padding=<span class="string">&#x27;same&#x27;</span>))</span><br><span class="line">    model.add(BatchNormalization())</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.01</span>))</span><br><span class="line">    model.add(Conv2DTranspose(<span class="number">64</span>, kernel_size=<span class="number">3</span>, strides=<span class="number">1</span>, padding=<span class="string">&#x27;same&#x27;</span>))</span><br><span class="line">    model.add(BatchNormalization())</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.01</span>))</span><br><span class="line">    model.add(Conv2DTranspose(<span class="number">1</span>, kernel_size=<span class="number">3</span>, strides=<span class="number">2</span>, padding=<span class="string">&#x27;same&#x27;</span>, activation=<span class="string">&#x27;tanh&#x27;</span>))</span><br><span class="line">    model.<span class="built_in">compile</span>(loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>, optimizer=Adam(lr=<span class="number">0.0002</span>, beta_1=<span class="number">0.5</span>))</span><br><span class="line">    <span class="keyword">return</span> model</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义判别器模型</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_discriminator</span>():</span><br><span class="line">    model = Sequential()</span><br><span class="line">    model.add(Conv2D(<span class="number">64</span>, kernel_size=<span class="number">3</span>, strides=<span class="number">2</span>, input_shape=(<span class="number">28</span>, <span class="number">28</span>, <span class="number">1</span>), padding=<span class="string">&#x27;same&#x27;</span>))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.01</span>))</span><br><span class="line">    model.add(Conv2D(<span class="number">128</span>, kernel_size=<span class="number">3</span>, strides=<span class="number">2</span>, padding=<span class="string">&#x27;same&#x27;</span>))</span><br><span class="line">    model.add(LeakyReLU(alpha=<span class="number">0.01</span>))</span><br><span class="line">    model.add(Flatten())</span><br><span class="line">    model.add(Dense(<span class="number">1</span>, activation=<span class="string">&#x27;sigmoid&#x27;</span>))</span><br><span class="line">    model.<span class="built_in">compile</span>(loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>, optimizer=Adam(lr=<span class="number">0.0002</span>, beta_1=<span class="number">0.5</span>))</span><br><span class="line">    <span class="keyword">return</span> model</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义GAN网络</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">build_gan</span>(<span class="params">generator, discriminator</span>):</span><br><span class="line">    discriminator.trainable = <span class="literal">False</span></span><br><span class="line">    gan_input = Input(shape=(<span class="number">100</span>,))</span><br><span class="line">    x = generator(gan_input)</span><br><span class="line">    gan_output = discriminator(x)</span><br><span class="line">    gan = Model(inputs=gan_input, outputs=gan_output)</span><br><span class="line">    gan.<span class="built_in">compile</span>(loss=<span class="string">&#x27;binary_crossentropy&#x27;</span>, optimizer=Adam(lr=<span class="number">0.0002</span>, beta_1=<span class="number">0.5</span>))</span><br><span class="line">    <span class="keyword">return</span> gan</span><br><span class="line"></span><br><span class="line"><span class="comment"># 训练GAN网络</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">train_gan</span>(<span class="params">generator, discriminator, gan, epochs=<span class="number">100</span>, batch_size=<span class="number">128</span></span>):</span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(epochs):</span><br><span class="line">        <span class="comment"># 训练判别器</span></span><br><span class="line">        noise = np.random.normal(<span class="number">0</span>, <span class="number">1</span>, (batch_size, <span class="number">100</span>))</span><br><span class="line">        fake_images = generator.predict(noise)</span><br><span class="line">        real_images = train_images[np.random.randint(<span class="number">0</span>, train_images.shape[<span class="number">0</span>], batch_size)]</span><br><span class="line">        x = np.concatenate((real_images, fake_images))</span><br><span class="line">        y = np.zeros(<span class="number">2</span> * batch_size)</span><br><span class="line">        y[:batch_size] = <span class="number">0.9</span></span><br><span class="line">        discriminator_loss = discriminator.train_on_batch(x, y)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 训练生成器</span></span><br><span class="line">        noise = np.random.normal(<span class="number">0</span>, <span class="number">1</span>, (batch_size, <span class="number">100</span>))</span><br><span class="line">        y = np.ones(batch_size)</span><br><span class="line">        generator_loss = gan.train_on_batch(noise, y)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 每10个epoch保存一次生成器的输出</span></span><br><span class="line">        <span class="keyword">if</span> epoch % <span class="number">10</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Epoch:&#x27;</span>, epoch, <span class="string">&#x27;Discriminator Loss:&#x27;</span>, discriminator_loss, <span class="string">&#x27;Generator Loss:&#x27;</span>, generator_loss)</span><br><span class="line">            save_images(generator, epoch)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存生成器的输出</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_images</span>(<span class="params">generator, epoch</span>):</span><br><span class="line">    noise = np.random.normal(<span class="number">0</span>, <span class="number">1</span>, (<span class="number">25</span>, <span class="number">100</span>))</span><br><span class="line">    fake_images = generator.predict(noise)</span><br><span class="line">    fake_images = <span class="number">0.5</span> * fake_images + <span class="number">0.5</span></span><br><span class="line">    fig, axs = plt.subplots(<span class="number">5</span>, <span class="number">5</span>)</span><br><span class="line">    cnt = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">            axs[i,j].imshow(fake_images[cnt, :, :, <span class="number">0</span>], cmap=<span class="string">&#x27;gray&#x27;</span>)</span><br><span class="line">            axs[i,j].axis(<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">            cnt += <span class="number">1</span></span><br><span class="line">    plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载MNIST数据集</span></span><br><span class="line">(train_images, _), (_, _) = mnist.load_data()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将图像归一化到-1到1之间</span></span><br><span class="line">train_images = (train_images.astype(<span class="string">&#x27;float32&#x27;</span>) - <span class="number">127.5</span>) / <span class="number">127.5</span></span><br><span class="line">train_images = np.expand_dims(train_images, axis=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建GAN网络并训练</span></span><br><span class="line">generator = build_generator()</span><br><span class="line">discriminator = build_discriminator()</span><br><span class="line">gan = build_gan(generator, discriminator)</span><br><span class="line"></span><br><span class="line">train_gan(generator, discriminator, gan, epochs=<span class="number">10000</span>, batch_size=<span class="number">128</span>)</span><br></pre></td></tr></table></figure>
<p>下面的美图和表格按位置分别对应，数字代表epoch</p>
<table>
<thead>
<tr>
<th style="text-align:center">0</th>
<th style="text-align:center">50</th>
<th style="text-align:center">100</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">200</td>
<td style="text-align:center">400</td>
<td style="text-align:center">600</td>
</tr>
<tr>
<td style="text-align:center">700</td>
<td style="text-align:center">900</td>
<td style="text-align:center">1000</td>
</tr>
</tbody>
</table>
<table><tr>
    <td><img src="/2023/04/14/GAN2D/Snipaste_2023-04-14_04-47-40.png" style="zoom:38%;"></td>
    <td><img src="/2023/04/14/GAN2D/Snipaste_2023-04-14_04-48-00.png" alt="Snipaste_2023-04-14_04-48-00" style="zoom:38%;"></td>
    <td><img src="/2023/04/14/GAN2D/Snipaste_2023-04-14_04-48-15.png" alt="Snipaste_2023-04-14_04-48-15" style="zoom:38%;"></td>
</tr><tr><table>
<table><tr>
    <td><img src="/2023/04/14/GAN2D/Snipaste_2023-04-14_04-48-34.png" alt="Snipaste_2023-04-14_04-48-34" style="zoom:38%;"></td>
	<td><img src="/2023/04/14/GAN2D/Snipaste_2023-04-14_04-48-58.png" alt="Snipaste_2023-04-14_04-48-58" style="zoom:38%;"></td>
	<td><img src="/2023/04/14/GAN2D/Snipaste_2023-04-14_04-49-19.png" alt="Snipaste_2023-04-14_04-49-19" style="zoom:38%;"></td>
</tr><tr><table>
<table><tr> 
    <td><img src="/2023/04/14/GAN2D/Snipaste_2023-04-14_04-49-48.png" alt="Snipaste_2023-04-14_04-49-48" style="zoom:38%;"></td>
    <td><img src="/2023/04/14/GAN2D/Snipaste_2023-04-14_04-50-50.png" alt="Snipaste_2023-04-14_04-50-50" style="zoom:38%;"></td>
    <td><img src="/2023/04/14/GAN2D/Snipaste_2023-04-14_04-57-08.png" alt="Snipaste_2023-04-14_04-57-08" style="zoom:38%;"></td>
</tr><tr><table>
<p>在Gan网络的加持下，1000次学习之后，这些字体基本可以认为是人写的了。当然，图片也是一样得原理，彩色图片采用。</p>
<hr>
<p>嗯嗯，差不多了，下次接着写</p>
<p>预告——使用gan网络生成3d模型，然后进入<strong>球棍模型</strong>预测</p>
</table></tr></table></table></tr></table></table></tr></table></table></tr></table>]]></content>
      <tags>
        <tag>GANS</tag>
      </tags>
  </entry>
  <entry>
    <title>Clustering</title>
    <url>/2023/11/30/Clustering/</url>
    <content><![CDATA[<h1>Clustering  聚类</h1>
<p>[TOC]</p>
<p><a href="https://en.wikipedia.org/wiki/Cluster_analysis">Clustering</a> of unlabeled data can be performed with the module <a href="https://scikit-learn.org/stable/modules/classes.html#module-sklearn.cluster"><code>sklearn.cluster</code></a>.<br>
可以使用模块 <code>sklearn.cluster</code> 对未标记的数据进行聚类。</p>
<p>Each clustering algorithm comes in two variants: a class, that implements the <code>fit</code> method to learn the clusters on train data, and a function, that, given train data, returns an array of integer labels corresponding to the different clusters. For the class, the labels over the training data can be found in the <code>labels_</code> attribute.<br>
每种聚类算法都有两种变体：一个类，用于实现在训练数据上学习聚类 <code>fit</code> 的方法，以及一个函数，在给定训练数据的情况下，返回对应于不同聚类的整数标签数组。对于类，可以在 <code>labels_</code> 属性中找到训练数据上的标签。</p>
<h2 id="overview-of-clustering-methods-1-1-聚类方法概述">Overview of clustering methods<a href="https://scikit-learn.org/stable/modules/clustering.html#overview-of-clustering-methods">¶</a> 1.1. 聚类方法概述 ¶</h2>
<p><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_cluster_comparison.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_cluster_comparison_001.png" alt="img"></a></p>
<p>A comparison of the clustering algorithms in scikit-learn<a href="https://scikit-learn.org/stable/modules/clustering.html#id42">¶</a><br>
scikit-learn 中聚类算法的比较 ¶</p>
<table>
<thead>
<tr>
<th>Method name 方法名称</th>
<th>Parameters 参数</th>
<th>Scalability 可扩展性</th>
<th>Usecase 使用案例</th>
<th>Geometry (metric used) 几何图形（使用的指标）</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://scikit-learn.org/stable/modules/clustering.html#k-means">K-Means K-均值</a></td>
<td>number of clusters 簇数</td>
<td>Very large <code>n_samples</code>, medium <code>n_clusters</code> with <a href="https://scikit-learn.org/stable/modules/clustering.html#mini-batch-kmeans">MiniBatch code</a> 非常大 <code>n_samples</code> ，中型 <code>n_clusters</code> ，带 MiniBatch 代码</td>
<td>General-purpose, even cluster size, flat geometry, not too many clusters, inductive 通用型，均匀的簇大小，扁平的几何形状，没有太多的簇，感应式</td>
<td>Distances between points 点与点之间的距离</td>
</tr>
<tr>
<td><a href="https://scikit-learn.org/stable/modules/clustering.html#affinity-propagation">Affinity propagation 亲和力传播</a></td>
<td>damping, sample preference 阻尼、样品偏好</td>
<td>Not scalable with n_samples 无法通过 n_samples 进行扩展</td>
<td>Many clusters, uneven cluster size, non-flat geometry, inductive 簇多，簇大小不均匀，几何形状不平整，感应</td>
<td>Graph distance (e.g. nearest-neighbor graph) 图形距离（例如最近邻图形）</td>
</tr>
<tr>
<td><a href="https://scikit-learn.org/stable/modules/clustering.html#mean-shift">Mean-shift 均值偏移</a></td>
<td>bandwidth 带宽</td>
<td>Not scalable with <code>n_samples</code> 无法使用 <code>n_samples</code></td>
<td>Many clusters, uneven cluster size, non-flat geometry, inductive 簇多，簇大小不均匀，几何形状不平整，感应</td>
<td>Distances between points 点与点之间的距离</td>
</tr>
<tr>
<td><a href="https://scikit-learn.org/stable/modules/clustering.html#spectral-clustering">Spectral clustering 光谱聚类</a></td>
<td>number of clusters 簇数</td>
<td>Medium <code>n_samples</code>, small <code>n_clusters</code> 中型 <code>n_samples</code> 、小型 <code>n_clusters</code></td>
<td>Few clusters, even cluster size, non-flat geometry, transductive 团簇少，簇大小均匀，几何形状非平面，可转导</td>
<td>Graph distance (e.g. nearest-neighbor graph) 图形距离（例如最近邻图形）</td>
</tr>
<tr>
<td><a href="https://scikit-learn.org/stable/modules/clustering.html#hierarchical-clustering">Ward hierarchical clustering 病房分层聚类</a></td>
<td>number of clusters or distance threshold 聚类数或距离阈值</td>
<td>Large <code>n_samples</code> and <code>n_clusters</code> 大 <code>n_samples</code> 和 <code>n_clusters</code></td>
<td>Many clusters, possibly connectivity constraints, transductive 许多集群，可能是连通性约束，转导</td>
<td>Distances between points 点与点之间的距离</td>
</tr>
<tr>
<td><a href="https://scikit-learn.org/stable/modules/clustering.html#hierarchical-clustering">Agglomerative clustering 团聚聚类</a></td>
<td>number of clusters or distance threshold, linkage type, distance 簇数或距离阈值、链接类型、距离</td>
<td>Large <code>n_samples</code> and <code>n_clusters</code> 大 <code>n_samples</code> 和 <code>n_clusters</code></td>
<td>Many clusters, possibly connectivity constraints, non Euclidean distances, transductive 许多集群，可能是连通性约束，非欧几里得距离，转导</td>
<td>Any pairwise distance 任何成对距离</td>
</tr>
<tr>
<td><a href="https://scikit-learn.org/stable/modules/clustering.html#dbscan">DBSCAN DBSCAN扫描</a></td>
<td>neighborhood size 社区规模</td>
<td>Very large <code>n_samples</code>, medium <code>n_clusters</code> 非常大 <code>n_samples</code> ，中 <code>n_clusters</code></td>
<td>Non-flat geometry, uneven cluster sizes, outlier removal, transductive 非平面几何形状、不均匀的簇大小、异常值去除、转导</td>
<td>Distances between nearest points 最近点之间的距离</td>
</tr>
<tr>
<td><a href="https://scikit-learn.org/stable/modules/clustering.html#hdbscan">HDBSCAN HDBSCAN的</a></td>
<td>minimum cluster membership, minimum point neighbors 最小集群成员资格、最小点邻居</td>
<td>large <code>n_samples</code>, medium <code>n_clusters</code> 大 <code>n_samples</code> ， 中 <code>n_clusters</code></td>
<td>Non-flat geometry, uneven cluster sizes, outlier removal, transductive, hierarchical, variable cluster density 非平面几何形状、不均匀的簇大小、异常值去除、转导、分层、可变簇密度</td>
<td>Distances between nearest points 最近点之间的距离</td>
</tr>
<tr>
<td><a href="https://scikit-learn.org/stable/modules/clustering.html#optics">OPTICS 光学</a></td>
<td>minimum cluster membership 最低群集成员身份</td>
<td>Very large <code>n_samples</code>, large <code>n_clusters</code> 非常大，大 <code>n_samples</code> <code>n_clusters</code></td>
<td>Non-flat geometry, uneven cluster sizes, variable cluster density, outlier removal, transductive 非平面几何形状、不均匀的团簇大小、可变的团簇密度、异常值去除、转导</td>
<td>Distances between points 点与点之间的距离</td>
</tr>
<tr>
<td><a href="https://scikit-learn.org/stable/modules/mixture.html#mixture">Gaussian mixtures 高斯混合物</a></td>
<td>many 多</td>
<td>Not scalable 不可扩展</td>
<td>Flat geometry, good for density estimation, inductive 扁平的几何形状，适合密度估计，电感式</td>
<td>Mahalanobis distances to centers 马哈拉诺比斯到中心的距离</td>
</tr>
<tr>
<td><a href="https://scikit-learn.org/stable/modules/clustering.html#birch">BIRCH 桦树</a></td>
<td>branching factor, threshold, optional global clusterer. 分支因子、阈值、可选的全局聚类器。</td>
<td>Large <code>n_clusters</code> and <code>n_samples</code> 大 <code>n_clusters</code> 和 <code>n_samples</code></td>
<td>Large dataset, outlier removal, data reduction, inductive 大数据集、异常值去除、数据缩减、归纳</td>
<td>Euclidean distance between points 两点之间的欧几里得距离</td>
</tr>
<tr>
<td><a href="https://scikit-learn.org/stable/modules/clustering.html#bisect-k-means">Bisecting K-Means 平分 K 均值</a></td>
<td>number of clusters 簇数</td>
<td>Very large <code>n_samples</code>, medium <code>n_clusters</code> 非常大 <code>n_samples</code> ，中 <code>n_clusters</code></td>
<td>General-purpose, even cluster size, flat geometry, no empty clusters, inductive, hierarchical 通用，均匀的簇大小，扁平的几何形状，无空簇，感应式，分层</td>
<td>Distances between points 点与点之间的距离</td>
</tr>
</tbody>
</table>
<p>Non-flat geometry clustering is useful when the clusters have a specific shape, i.e. a non-flat manifold, and the standard euclidean distance is not the right metric. This case arises in the two top rows of the figure above.<br>
当聚类具有特定形状（即非平面流形）并且标准欧几里得距离不是正确的度量时，非平面几何聚类非常有用。这种情况出现在上图的顶部两行。</p>
<p>Gaussian mixture models, useful for clustering, are described in <a href="https://scikit-learn.org/stable/modules/mixture.html#mixture">another chapter of the documentation</a> dedicated to mixture models. KMeans can be seen as a special case of Gaussian mixture model with equal covariance per component.<br>
高斯混合模型对聚类很有用，在专门介绍混合模型的文档的另一章中进行了介绍。KMeans 可以看作是每个分量协方差相等的高斯混合模型的特例。</p>
<p><a href="https://scikit-learn.org/stable/glossary.html#term-transductive">Transductive</a> clustering methods (in contrast to <a href="https://scikit-learn.org/stable/glossary.html#term-inductive">inductive</a> clustering methods) are not designed to be applied to new, unseen data.<br>
转导聚类方法（与归纳聚类方法相反）并非旨在应用于新的、看不见的数据。</p>
<h2 id="k-means">K-means<a href="https://scikit-learn.org/stable/modules/clustering.html#k-means">¶</a></h2>
<p>The [<code>KMeans</code>]algorithm clusters data by trying to separate samples in n groups of equal variance, minimizing a criterion known as the <em>inertia</em> or within-cluster sum-of-squares (see below). This algorithm requires the number of clusters to be specified. It scales well to large numbers of samples and has been used across a large range of application areas in many different fields.<br>
该 <code>KMeans</code> 算法通过尝试将样本分成 n 组相等方差来对数据进行聚类，从而最小化称为惯性或簇内平方和的标准（见下文）。此算法需要指定簇数。它可以很好地扩展到大量样品，并已用于许多不同领域的各种应用领域。</p>
<p>The k-means algorithm divides a set of (N) samples (X) into (K) disjoint clusters (C), each described by the mean (\mu_j) of the samples in the cluster. The means are commonly called the cluster “centroids”; note that they are not, in general, points from (X), although they live in the same space.<br>
k-means 算法将一组 \（N\） 个样本 \（X\） 划分为 \（K\） 个不相交的聚类 \（C\），每个聚类由聚类中样本的平均值 \（\mu_j\） 描述。这些均值通常称为簇“质心”;请注意，尽管它们位于同一空间中，但它们通常不是来自 \（X\） 的点。</p>
<p>The K-means algorithm aims to choose centroids that minimise the <strong>inertia</strong>, or <strong>within-cluster sum-of-squares criterion</strong>:<br>
K-means 算法旨在选择最小化惯性或簇内平方和准则的质心：</p>
<p>[\sum_{i=0}^{n}\min_{\mu_j \in C}(||x_i - \mu_j||^2)]<br>
[\sum_{i=0}^{n}\min_{\mu_j \in C}（||x_i - \mu_j||^2）]</p>
<p>Inertia can be recognized as a measure of how internally coherent clusters are. It suffers from various drawbacks:<br>
惯性可以被认为是衡量集群内部连贯性程度的指标。它有各种缺点：</p>
<ul>
<li>Inertia makes the assumption that clusters are convex and isotropic, which is not always the case. It responds poorly to elongated clusters, or manifolds with irregular shapes.<br>
惯性假设团簇是凸的和各向同性的，但情况并非总是如此。它对细长的簇或形状不规则的流形反应不佳。</li>
<li>Inertia is not a normalized metric: we just know that lower values are better and zero is optimal. But in very high-dimensional spaces, Euclidean distances tend to become inflated (this is an instance of the so-called “curse of dimensionality”). Running a dimensionality reduction algorithm such as <a href="https://scikit-learn.org/stable/modules/decomposition.html#pca">Principal component analysis (PCA)</a> prior to k-means clustering can alleviate this problem and speed up the computations.<br>
惯性不是一个归一化的指标：我们只知道值越低越好，零值是最优的。但是在非常高维的空间中，欧几里得距离往往会膨胀（这是所谓的“维度诅咒”的一个例子）。在 k 均值聚类之前运行降维算法（如主成分分析 （PCA））可以缓解此问题并加快计算速度。</li>
</ul>
<p><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_kmeans_assumptions.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_kmeans_assumptions_002.png" alt="img"></a></p>
<p>K-means is often referred to as Lloyd’s algorithm. In basic terms, the algorithm has three steps. The first step chooses the initial centroids, with the most basic method being to choose (k) samples from the dataset (X). After initialization, K-means consists of looping between the two other steps. The first step assigns each sample to its nearest centroid. The second step creates new centroids by taking the mean value of all of the samples assigned to each previous centroid. The difference between the old and the new centroids are computed and the algorithm repeats these last two steps until this value is less than a threshold. In other words, it repeats until the centroids do not move significantly.<br>
K-means 通常被称为劳埃德算法。基本上，该算法有三个步骤。第一步选择初始质心，最基本的方法是从数据集\（X\）中选择\（k\）个样本。初始化后，K-means 由其他两个步骤之间的循环组成。第一步将每个样品分配到离其最近的质心。第二步通过获取分配给每个前一个质心的所有样本的平均值来创建新的质心。计算旧质心和新质心之间的差值，算法重复最后两个步骤，直到该值小于阈值。换句话说，它重复直到质心没有显着移动。</p>
<p><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_kmeans_digits.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_kmeans_digits_001.png" alt="img"></a></p>
<p>K-means is equivalent to the expectation-maximization algorithm with a small, all-equal, diagonal covariance matrix.<br>
K-means 等效于具有小的、完全相等的对角线协方差矩阵的期望最大化算法。</p>
<p>The algorithm can also be understood through the concept of <a href="https://en.wikipedia.org/wiki/Voronoi_diagram">Voronoi diagrams</a>. First the Voronoi diagram of the points is calculated using the current centroids. Each segment in the Voronoi diagram becomes a separate cluster. Secondly, the centroids are updated to the mean of each segment. The algorithm then repeats this until a stopping criterion is fulfilled. Usually, the algorithm stops when the relative decrease in the objective function between iterations is less than the given tolerance value. This is not the case in this implementation: iteration stops when centroids move less than the tolerance.<br>
该算法也可以通过 Voronoi 图的概念来理解。首先，使用当前质心计算点的 Voronoi 图。Voronoi 图中的每个线段都成为一个单独的聚类。其次，将质心更新为每段的均值。然后，该算法重复此操作，直到满足停止条件。通常，当迭代之间目标函数的相对减少小于给定的容差值时，算法会停止。在此实现中并非如此：当质心移动小于容差时，迭代将停止。</p>
<p>Given enough time, K-means will always converge, however this may be to a local minimum. This is highly dependent on the initialization of the centroids. As a result, the computation is often done several times, with different initializations of the centroids. One method to help address this issue is the k-means++ initialization scheme, which has been implemented in scikit-learn (use the <code>init='k-means++'</code> parameter). This initializes the centroids to be (generally) distant from each other, leading to probably better results than random initialization, as shown in the reference.<br>
如果有足够的时间，K-means将始终收敛，但这可能是局部最小值。这高度依赖于质心的初始化。因此，计算通常要进行多次，对质心进行不同的初始化。帮助解决此问题的一种方法是 k-means++ 初始化方案，该方案已在 scikit-learn 中实现（使用参数 <code>init='k-means++'</code> ）。这会将质心初始化为（通常）彼此相距较远，从而产生可能比随机初始化更好的结果，如参考中所示。</p>
<p>K-means++ can also be called independently to select seeds for other clustering algorithms, see <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.kmeans_plusplus.html#sklearn.cluster.kmeans_plusplus"><code>sklearn.cluster.kmeans_plusplus</code></a> for details and example usage.<br>
K-means++ 也可以独立调用，为其他聚类算法选择种子，有关详细信息和示例用法，请参阅 <code>sklearn.cluster.kmeans_plusplus</code> 。</p>
<p>The algorithm supports sample weights, which can be given by a parameter <code>sample_weight</code>. This allows to assign more weight to some samples when computing cluster centers and values of inertia. For example, assigning a weight of 2 to a sample is equivalent to adding a duplicate of that sample to the dataset (X).<br>
该算法支持样本权重，该权重可以由参数 <code>sample_weight</code> 给出。这允许在计算聚类中心和惯性值时为某些样本分配更多权重。例如，为样本分配权重 2 等同于将该样本的副本添加到数据集 \（X\）。</p>
<p>K-means can be used for vector quantization. This is achieved using the transform method of a trained model of <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html#sklearn.cluster.KMeans"><code>KMeans</code></a>.<br>
K-means 可用于矢量量化。这是使用 的训练模型的变换方法实现的 <code>KMeans</code> 。</p>
<h3 id="low-level-parallelism-低级并行性">Low-level parallelism<a href="https://scikit-learn.org/stable/modules/clustering.html#low-level-parallelism">¶</a>  低级并行性 ¶</h3>
<p>[<code>KMeans</code>]benefits from OpenMP based parallelism through Cython. Small chunks of data (256 samples) are processed in parallel, which in addition yields a low memory footprint. For more details on how to control the number of threads, please refer to our <a href="https://scikit-learn.org/stable/computing/parallelism.html#parallelism">Parallelism</a> notes.<br>
<code>KMeans</code> 通过Cython受益于基于OpenMP的并行性。小块数据（256 个样本）是并行处理的，此外，内存占用量也很小。有关如何控制线程数的更多详细信息，请参阅我们的并行性说明。</p>
<h3 id="mini-batch-k-means-批量-k-means">Mini Batch K-Means<a href="https://scikit-learn.org/stable/modules/clustering.html#mini-batch-k-means">¶</a> 批量 K-Means ¶</h3>
<p>The <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.MiniBatchKMeans.html#sklearn.cluster.MiniBatchKMeans"><code>MiniBatchKMeans</code></a> is a variant of the [<code>KMeans</code>]algorithm which uses mini-batches to reduce the computation time, while still attempting to optimise the same objective function. Mini-batches are subsets of the input data, randomly sampled in each training iteration. These mini-batches drastically reduce the amount of computation required to converge to a local solution. In contrast to other algorithms that reduce the convergence time of k-means, mini-batch k-means produces results that are generally only slightly worse than the standard algorithm.<br>
该 <code>MiniBatchKMeans</code> 算法是该 <code>KMeans</code> 算法的一种变体，它使用小批量来减少计算时间，同时仍然尝试优化相同的目标函数。小批量是输入数据的子集，在每次训练迭代中随机采样。这些小批量大大减少了收敛到本地解决方案所需的计算量。与其他减少 k 均值收敛时间的算法相比，小批量 k-means 产生的结果通常仅比标准算法稍差。</p>
<p>The algorithm iterates between two major steps, similar to vanilla k-means. In the first step, (b) samples are drawn randomly from the dataset, to form a mini-batch. These are then assigned to the nearest centroid. In the second step, the centroids are updated. In contrast to k-means, this is done on a per-sample basis. For each sample in the mini-batch, the assigned centroid is updated by taking the streaming average of the sample and all previous samples assigned to that centroid. This has the effect of decreasing the rate of change for a centroid over time. These steps are performed until convergence or a predetermined number of iterations is reached.<br>
该算法在两个主要步骤之间迭代，类似于 vanilla k-means。第一步，从数据集中随机抽取\（b\）个样本，形成一个小批量。然后将它们分配给最近的质心。在第二步中，更新质心。与 k 均值相比，这是基于每个样本完成的。对于小批量中的每个样品，通过获取样品的流平均值和分配给该质心的所有先前样品来更新分配的质心。这具有降低质心随时间变化率的效果。这些步骤将一直执行，直到收敛或达到预定的迭代次数。</p>
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.MiniBatchKMeans.html#sklearn.cluster.MiniBatchKMeans"><code>MiniBatchKMeans</code></a> converges faster than <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html#sklearn.cluster.KMeans"><code>KMeans</code></a>, but the quality of the results is reduced. In practice this difference in quality can be quite small, as shown in the example and cited reference.<br>
<code>MiniBatchKMeans</code> 收敛速度比 <code>KMeans</code> 快，但结果的质量会降低。在实践中，这种质量差异可能非常小，如示例和引用的参考文献所示。</p>
<p><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_mini_batch_kmeans.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_mini_batch_kmeans_001.png" alt="img"></a></p>
<h2 id="affinity-propagation-亲和传播">Affinity Propagation<a href="https://scikit-learn.org/stable/modules/clustering.html#affinity-propagation">¶</a> 亲和传播 ¶</h2>
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.AffinityPropagation.html#sklearn.cluster.AffinityPropagation"><code>AffinityPropagation</code></a> creates clusters by sending messages between pairs of samples until convergence. A dataset is then described using a small number of exemplars, which are identified as those most representative of other samples. The messages sent between pairs represent the suitability for one sample to be the exemplar of the other, which is updated in response to the values from other pairs. This updating happens iteratively until convergence, at which point the final exemplars are chosen, and hence the final clustering is given.<br>
<code>AffinityPropagation</code> 通过在样本对之间发送消息直到收敛来创建聚类。然后使用少量示例来描述数据集，这些示例被标识为其他样本中最具代表性的示例。对之间发送的消息表示一个样本是否适合作为另一个样本的示例，该样本会根据其他对的值进行更新。这种更新以迭代方式进行，直到收敛，此时选择最终的示例，从而给出最终的聚类。</p>
<p><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_affinity_propagation.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_affinity_propagation_001.png" alt="img"></a></p>
<p>Affinity Propagation can be interesting as it chooses the number of clusters based on the data provided. For this purpose, the two important parameters are the <em>preference</em>, which controls how many exemplars are used, and the <em>damping factor</em> which damps the responsibility and availability messages to avoid numerical oscillations when updating these messages.<br>
Affinity Propagation 可能很有趣，因为它会根据提供的数据选择集群的数量。为此，两个重要参数是首选项（控制使用的示例数量）和阻尼因子（抑制责任和可用性消息，以避免在更新这些消息时出现数字振荡）。</p>
<p>The main drawback of Affinity Propagation is its complexity. The algorithm has a time complexity of the order (O(N^2 T)), where (N) is the number of samples and (T) is the number of iterations until convergence. Further, the memory complexity is of the order (O(N^2)) if a dense similarity matrix is used, but reducible if a sparse similarity matrix is used. This makes Affinity Propagation most appropriate for small to medium sized datasets.<br>
Affinity Propagation 的主要缺点是它的复杂性。该算法的时间复杂度为\（O（N^2 T）\），其中\（N\）是样本数，\（T\）是收敛前的迭代次数。此外，如果使用密集相似性矩阵，则内存复杂度为\（O（N^2）\）量级，但如果使用稀疏相似性矩阵，则内存复杂度可约。这使得 Affinity Propagation 最适合中小型数据集。</p>
<p><strong>Algorithm description:</strong> The messages sent between points belong to one of two categories. The first is the responsibility (r(i, k)), which is the accumulated evidence that sample (k) should be the exemplar for sample (i). The second is the availability (a(i, k)) which is the accumulated evidence that sample (i) should choose sample (k) to be its exemplar, and considers the values for all other samples that (k) should be an exemplar. In this way, exemplars are chosen by samples if they are (1) similar enough to many samples and (2) chosen by many samples to be representative of themselves.<br>
算法说明：点间发送的消息属于两类之一。首先是责任\（r（i， k）\），这是样本\（k\）应该是样本\（i\）的典范的累积证据。第二个是可用性\（a（i， k）\），它是样本\（i\）应选择样本\（k\）作为其样本的累积证据，并考虑\（k\）应作为样本的所有其他样本的值。这样，如果样本 （1） 与许多样本足够相似，并且 （2） 由许多样本选择以代表它们自己，则样本将由样本选择。</p>
<p>More formally, the responsibility of a sample (k) to be the exemplar of sample (i) is given by:<br>
更正式地说，样本\（k\）作为样本\（i\）的示例的责任由下式给出：</p>
<p>[r(i, k) \leftarrow s(i, k) - max [ a(i, k’) + s(i, k’) \forall k’ \neq k ]]<br>
[r（i， k） \leftarrow s（i， k） - 最大 [ a（i， k’） + s（i， k’） \forall k’ \neq k ]]</p>
<p>Where (s(i, k)) is the similarity between samples (i) and (k). The availability of sample (k) to be the exemplar of sample (i) is given by:<br>
其中 \（s（i， k）\） 是样本 \（i\） 和 \（k\） 之间的相似度。样本 \（k\） 作为样本 \（i\） 示例的可用性由下式给出：</p>
<p>[a(i, k) \leftarrow min [0, r(k, k) + \sum_{i’~s.t.~i’ \notin {i, k}}{r(i’, k)}]]<br>
[a（i， k） \leftarrow min [0， r（k， k） + \sum_{i’~s.t.~i’ \notin {i， k}}{r（i’， k）}]]</p>
<p>To begin with, all values for (r) and (a) are set to zero, and the calculation of each iterates until convergence. As discussed above, in order to avoid numerical oscillations when updating the messages, the damping factor (\lambda) is introduced to iteration process:<br>
首先，\（r\） 和 \（a\） 的所有值都设置为零，并且每次迭代的计算直到收敛。如上所述，为了避免更新消息时出现数值振荡，在迭代过程中引入了阻尼因子 \（\lambda\）：</p>
<p>[r_{t+1}(i, k) = \lambda\cdot r_{t}(i, k) + (1-\lambda)\cdot r_{t+1}(i, k)]<br>
[r_{t+1}（i， k） = \lambda\cdot r_{t}（i， k） + （1-\lambda）\cdot r_{t+1}（i， k）]</p>
<p>[a_{t+1}(i, k) = \lambda\cdot a_{t}(i, k) + (1-\lambda)\cdot a_{t+1}(i, k)]<br>
[a_{t+1}（i， k） = \lambda\cdot a_{t}（i， k） + （1-\lambda）\cdot a_{t+1}（i， k）]</p>
<p>where (t) indicates the iteration times.<br>
其中\（t\）表示迭代次数。</p>
<h2 id="mean-shift-均值偏移">Mean Shift<a href="https://scikit-learn.org/stable/modules/clustering.html#mean-shift">¶</a>  均值偏移 ¶</h2>
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.MeanShift.html#sklearn.cluster.MeanShift"><code>MeanShift</code></a> clustering aims to discover <em>blobs</em> in a smooth density of samples. It is a centroid based algorithm, which works by updating candidates for centroids to be the mean of the points within a given region. These candidates are then filtered in a post-processing stage to eliminate near-duplicates to form the final set of centroids.<br>
<code>MeanShift</code> 聚类旨在发现样本密度平滑的斑点。它是一种基于质心的算法，其工作原理是将质心的候选者更新为给定区域内点的平均值。然后，在后处理阶段对这些候选物进行过滤，以消除近乎重复的质心，形成最终的质心集。</p>
<p>The position of centroid candidates is iteratively adjusted using a technique called hill climbing, which finds local maxima of the estimated probability density. Given a candidate centroid (x) for iteration (t), the candidate is updated according to the following equation:<br>
质心候选者的位置使用一种称为爬山的技术进行迭代调整，该技术可找到估计概率密度的局部最大值。给定迭代 \（t\） 的候选质心 \（x\），候选质心根据以下等式更新：</p>
<p>[x^{t+1} = x^t + m(x^t)]<br>
[x^{t+1} = x^t + m（x^t）]</p>
<p>Where (m) is the <em>mean shift</em> vector that is computed for each centroid that points towards a region of the maximum increase in the density of points. To compute (m) we define (N(x)) as the neighborhood of samples within a given distance around (x). Then (m) is computed using the following equation, effectively updating a centroid to be the mean of the samples within its neighborhood:<br>
其中 \（m\） 是针对指向点密度最大增加区域的每个质心计算的平均位移向量。为了计算\（m\），我们将\（N（x）\）定义为围绕\（x\）的给定距离内的样本邻域。然后使用以下等式计算\（m\），有效地将质心更新为其邻域内样本的平均值：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">\[m(x) = \frac&#123;1&#125;&#123;|N(x)|&#125; \sum_&#123;x_j \in N(x)&#125;x_j - x\]</span><br><span class="line">\[m（x） = \frac&#123;1&#125;&#123;|N（x）|&#125;\sum_&#123;x_j \in N（x）&#125;x_j - x\]</span><br></pre></td></tr></table></figure>
<p>In general, the equation for (m) depends on a kernel used for density estimation. The generic formula is:<br>
通常，\（m\） 的方程取决于用于密度估计的核。通用公式为：</p>
<p>[m(x) = \frac{\sum_{x_j \in N(x)}K(x_j - x)x_j}{\sum_{x_j \in N(x)}K(x_j - x)} - x]<br>
[m（x） = \frac{\sum_{x_j \in N（x）}K（x_j - x）x_j}{\sum_{x_j \in N（x）}K（x_j - x）} - x]</p>
<p>In our implementation, (K(x)) is equal to 1 if (x) is small enough and is equal to 0 otherwise. Effectively (K(y - x)) indicates whether (y) is in the neighborhood of (x).<br>
在我们的实现中，如果 \（x\） 足够小，\（K（x）\） 等于 1，否则等于 0。实际上，\（K（y - x）\） 表示 \（y\） 是否在 \（x\） 的邻域。</p>
<p>The algorithm automatically sets the number of clusters, instead of relying on a parameter <code>bandwidth</code>, which dictates the size of the region to search through. This parameter can be set manually, but can be estimated using the provided <code>estimate_bandwidth</code> function, which is called if the bandwidth is not set.<br>
该算法会自动设置聚类的数量，而不是依赖于参数，该参数 <code>bandwidth</code> 决定了要搜索的区域的大小。此参数可以手动设置，但可以使用提供的 <code>estimate_bandwidth</code> 函数进行估计，如果未设置带宽，则调用该函数。</p>
<p>The algorithm is not highly scalable, as it requires multiple nearest neighbor searches during the execution of the algorithm. The algorithm is guaranteed to converge, however the algorithm will stop iterating when the change in centroids is small.<br>
该算法的可扩展性不高，因为它在算法执行期间需要多个最近邻搜索。该算法保证收敛，但是当质心的变化很小时，算法将停止迭代。</p>
<p>Labelling a new sample is performed by finding the nearest centroid for a given sample.<br>
标记新样品是通过为给定样品找到最接近的质心来执行的。</p>
<p><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_mean_shift.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_mean_shift_001.png" alt="img"></a></p>
<h2 id="spectral-clustering-光谱聚类">Spectral clustering<a href="https://scikit-learn.org/stable/modules/clustering.html#spectral-clustering">¶</a>  光谱聚类 ¶</h2>
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.SpectralClustering.html#sklearn.cluster.SpectralClustering"><code>SpectralClustering</code></a> performs a low-dimension embedding of the affinity matrix between samples, followed by clustering, e.g., by KMeans, of the components of the eigenvectors in the low dimensional space. It is especially computationally efficient if the affinity matrix is sparse and the <code>amg</code> solver is used for the eigenvalue problem (Note, the <code>amg</code> solver requires that the <a href="https://github.com/pyamg/pyamg">pyamg</a> module is installed.)<br>
<code>SpectralClustering</code> 对样本之间的亲和矩阵进行低维嵌入，然后对低维空间中特征向量的分量进行聚类，例如，通过KMeans。如果亲和矩阵是稀疏的，并且求解器用于特征值问题，则计算效率特别高（请注意， <code>amg</code> <code>amg</code> 求解器要求安装 pyamg 模块。</p>
<p>The present version of SpectralClustering requires the number of clusters to be specified in advance. It works well for a small number of clusters, but is not advised for many clusters.<br>
当前版本的 SpectralClustering 需要提前指定聚类数量。它适用于少数集群，但不建议用于许多集群。</p>
<p>For two clusters, SpectralClustering solves a convex relaxation of the <a href="https://people.eecs.berkeley.edu/~malik/papers/SM-ncut.pdf">normalized cuts</a> problem on the similarity graph: cutting the graph in two so that the weight of the edges cut is small compared to the weights of the edges inside each cluster. This criteria is especially interesting when working on images, where graph vertices are pixels, and weights of the edges of the similarity graph are computed using a function of a gradient of the image.<br>
对于两个聚类，SpectralClustering 求解相似性图上归一化切割问题的凸松弛：将图形一分为二，以便与每个聚类内边缘的权重相比，切割边的权重较小。在处理图像时，此标准特别有趣，其中图形顶点是像素，并且相似度图的边缘权重是使用图像梯度函数计算的。</p>
<p><strong><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_segmentation_toy.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_segmentation_toy_001.png" alt="img"></a></strong></p>
<p><strong><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_segmentation_toy.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_segmentation_toy_002.png" alt="img"></a></strong></p>
<p>Warning 警告</p>
<p>Transforming distance to well-behaved similarities<br>
将距离转化为表现良好的相似性</p>
<p>Note that if the values of your similarity matrix are not well distributed, e.g. with negative values or with a distance matrix rather than a similarity, the spectral problem will be singular and the problem not solvable. In which case it is advised to apply a transformation to the entries of the matrix. For instance, in the case of a signed distance matrix, is common to apply a heat kernel:<br>
请注意，如果相似性矩阵的值分布不均匀，例如使用负值或使用距离矩阵而不是相似性，则谱问题将是奇异的，并且问题无法解决。在这种情况下，建议对矩阵的条目应用转换。例如，在有符号距离矩阵的情况下，应用热核是很常见的：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">similarity = np.exp(-beta * distance / distance.std())</span><br></pre></td></tr></table></figure>
<p>See the examples for such an application.<br>
请参阅此类应用程序的示例。</p>
<h3 id="different-label-assignment-strategies-不同的标签分配策略">Different label assignment strategies<a href="https://scikit-learn.org/stable/modules/clustering.html#different-label-assignment-strategies">¶</a> 不同的标签分配策略 ¶</h3>
<p>Different label assignment strategies can be used, corresponding to the <code>assign_labels</code> parameter of <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.SpectralClustering.html#sklearn.cluster.SpectralClustering"><code>SpectralClustering</code></a>. <code>&quot;kmeans&quot;</code> strategy can match finer details, but can be unstable. In particular, unless you control the <code>random_state</code>, it may not be reproducible from run-to-run, as it depends on random initialization. The alternative <code>&quot;discretize&quot;</code> strategy is 100% reproducible, but tends to create parcels of fairly even and geometrical shape. The recently added <code>&quot;cluster_qr&quot;</code> option is a deterministic alternative that tends to create the visually best partitioning on the example application below.<br>
可以使用不同的标签分配策略，对应于 <code>SpectralClustering</code> 的 <code>assign_labels</code> 参数。 <code>&quot;kmeans&quot;</code> 策略可以匹配更精细的细节，但可能不稳定。特别是，除非您控制 ，否则它可能无法从运行到运行重现 <code>random_state</code> ，因为它依赖于随机初始化。替代 <code>&quot;discretize&quot;</code> 策略是 100% 可重复的，但往往会创建相当均匀和几何形状的地块。最近添加 <code>&quot;cluster_qr&quot;</code> 的选项是一种确定性的替代方法，它倾向于在下面的示例应用程序上创建视觉上最佳的分区。</p>
<table>
<thead>
<tr>
<th><code>assign_labels=&quot;kmeans&quot;</code></th>
<th><code>assign_labels=&quot;discretize&quot;</code></th>
<th><code>assign_labels=&quot;cluster_qr&quot;</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_coin_segmentation.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_coin_segmentation_001.png" alt="img"></a></td>
<td><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_coin_segmentation.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_coin_segmentation_002.png" alt="img"></a></td>
<td><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_coin_segmentation.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_coin_segmentation_003.png" alt="img"></a></td>
</tr>
</tbody>
</table>
<h3 id="spectral-clustering-graphs-谱聚类图">Spectral Clustering Graphs<a href="https://scikit-learn.org/stable/modules/clustering.html#spectral-clustering-graphs">¶</a> 谱聚类图 ¶</h3>
<p>Spectral Clustering can also be used to partition graphs via their spectral embeddings. In this case, the affinity matrix is the adjacency matrix of the graph, and SpectralClustering is initialized with <code>affinity='precomputed'</code>:<br>
光谱聚类还可用于通过其光谱嵌入对图形进行分区。在本例中，亲和矩阵是图的邻接矩阵，SpectralClustering 初始化为 <code>affinity='precomputed'</code> ：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; from sklearn.cluster import SpectralClustering</span><br><span class="line">&gt;&gt;&gt; sc = SpectralClustering(3, affinity=&#x27;precomputed&#x27;, n_init=100,</span><br><span class="line">                            assign_labels=&#x27;discretize&#x27;)</span><br><span class="line">&gt;&gt;&gt; sc.fit_predict(adjacency_matrix)</span><br></pre></td></tr></table></figure>
<h2 id="hierarchical-clustering-分层聚类">Hierarchical clustering<a href="https://scikit-learn.org/stable/modules/clustering.html#hierarchical-clustering">¶</a>  分层聚类 ¶</h2>
<p>Hierarchical clustering is a general family of clustering algorithms that build nested clusters by merging or splitting them successively. This hierarchy of clusters is represented as a tree (or dendrogram). The root of the tree is the unique cluster that gathers all the samples, the leaves being the clusters with only one sample. See the <a href="https://en.wikipedia.org/wiki/Hierarchical_clustering">Wikipedia page</a> for more details.<br>
分层聚类分析是聚类分析算法的通用系列，它通过连续合并或拆分嵌套聚类来构建嵌套聚类。这种聚类层次结构表示为树（或树状图）。树的根是收集所有样本的唯一簇，叶子是只有一个样本的簇。有关更多详细信息，请参阅维基百科页面。</p>
<p>The <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.AgglomerativeClustering.html#sklearn.cluster.AgglomerativeClustering"><code>AgglomerativeClustering</code></a> object performs a hierarchical clustering using a bottom up approach: each observation starts in its own cluster, and clusters are successively merged together. The linkage criteria determines the metric used for the merge strategy:<br>
对象 <code>AgglomerativeClustering</code> 使用自下而上的方法执行分层聚类：每个观测值从自己的聚类开始，然后聚类依次合并在一起。关联条件确定用于合并策略的指标：</p>
<ul>
<li><strong>Ward</strong> minimizes the sum of squared differences within all clusters. It is a variance-minimizing approach and in this sense is similar to the k-means objective function but tackled with an agglomerative hierarchical approach.<br>
Ward 最小化所有聚类内的平方差和。这是一种方差最小化方法，从这个意义上说，它类似于 k 均值目标函数，但采用集聚分层方法处理。</li>
<li><strong>Maximum</strong> or <strong>complete linkage</strong> minimizes the maximum distance between observations of pairs of clusters.<br>
最大或完全链接使成对的集群观测值之间的最大距离最小化。</li>
<li><strong>Average linkage</strong> minimizes the average of the distances between all observations of pairs of clusters.<br>
平均链接最小化了集群对的所有观测值之间的距离平均值。</li>
<li><strong>Single linkage</strong> minimizes the distance between the closest observations of pairs of clusters.<br>
单连杆使成对的集群的最近观测值之间的距离最小化。</li>
</ul>
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.AgglomerativeClustering.html#sklearn.cluster.AgglomerativeClustering"><code>AgglomerativeClustering</code></a> can also scale to large number of samples when it is used jointly with a connectivity matrix, but is computationally expensive when no connectivity constraints are added between samples: it considers at each step all the possible merges.<br>
<code>AgglomerativeClustering</code> 当它与连通性矩阵一起使用时，也可以扩展到大量样本，但当样本之间没有添加连通性约束时，计算成本很高：它会在每个步骤中考虑所有可能的合并。</p>
<h3 id="different-linkage-type-ward-complete-average-and-single-linkage">Different linkage type: Ward, complete, average, and single linkage<a href="https://scikit-learn.org/stable/modules/clustering.html#different-linkage-type-ward-complete-average-and-single-linkage">¶</a></h3>
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.AgglomerativeClustering.html#sklearn.cluster.AgglomerativeClustering"><code>AgglomerativeClustering</code></a> supports Ward, single, average, and complete linkage strategies.<br>
<code>AgglomerativeClustering</code> 支持沃德、单联动、平均联动、完全联动策略。</p>
<p><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_linkage_comparison.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_linkage_comparison_001.png" alt="img"></a></p>
<p>Agglomerative cluster has a “rich get richer” behavior that leads to uneven cluster sizes. In this regard, single linkage is the worst strategy, and Ward gives the most regular sizes. However, the affinity (or distance used in clustering) cannot be varied with Ward, thus for non Euclidean metrics, average linkage is a good alternative. Single linkage, while not robust to noisy data, can be computed very efficiently and can therefore be useful to provide hierarchical clustering of larger datasets. Single linkage can also perform well on non-globular data.<br>
集聚集群具有“富人致富”的行为，导致集群大小不均匀。在这方面，单连杆是最差的策略，沃德给出的尺寸最规则。然而，亲和力（或聚类中使用的距离）不能随 Ward 而变化，因此对于非欧几里得度量，平均链接是一个很好的选择。单一链接虽然对嘈杂的数据不可靠，但可以非常有效地计算，因此可用于提供较大数据集的分层聚类。单链接在非球状数据上也可以表现良好。</p>
<h3 id="visualization-of-cluster-hierarchy-集群层次结构的可视化">Visualization of cluster hierarchy<a href="https://scikit-learn.org/stable/modules/clustering.html#visualization-of-cluster-hierarchy">¶</a>  集群层次结构的可视化 ¶</h3>
<p>It’s possible to visualize the tree representing the hierarchical merging of clusters as a dendrogram. Visual inspection can often be useful for understanding the structure of the data, though more so in the case of small sample sizes.<br>
可以将表示聚类分层合并的树可视化为树状图。目视检查通常有助于理解数据的结构，但在样本量较小的情况下更是如此。</p>
<p><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_agglomerative_dendrogram.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_agglomerative_dendrogram_001.png" alt="img"></a></p>
<h3 id="1-6-3-adding-connectivity-constraints-1-6-3-添加连接约束">1.6.3. Adding connectivity constraints<a href="https://scikit-learn.org/stable/modules/clustering.html#adding-connectivity-constraints">¶</a> 1.6.3. 添加连接约束 ¶</h3>
<p>An interesting aspect of <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.AgglomerativeClustering.html#sklearn.cluster.AgglomerativeClustering"><code>AgglomerativeClustering</code></a> is that connectivity constraints can be added to this algorithm (only adjacent clusters can be merged together), through a connectivity matrix that defines for each sample the neighboring samples following a given structure of the data. For instance, in the swiss-roll example below, the connectivity constraints forbid the merging of points that are not adjacent on the swiss roll, and thus avoid forming clusters that extend across overlapping folds of the roll.<br>
一个有趣的方面 <code>AgglomerativeClustering</code> 是，可以通过连通性矩阵将连通性约束添加到该算法中（只有相邻的聚类可以合并在一起），该连通性矩阵为每个样本定义遵循给定数据结构的相邻样本。例如，在下面的 swiss-roll 示例中，连通性约束禁止合并 swiss roll 上不相邻的点，从而避免形成跨越 roll 重叠褶皱的聚类。</p>
<p><strong><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_ward_structured_vs_unstructured.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_ward_structured_vs_unstructured_001.png" alt="img"></a></strong></p>
<p><strong><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_ward_structured_vs_unstructured.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_ward_structured_vs_unstructured_002.png" alt="img"></a></strong></p>
<p>These constraint are useful to impose a certain local structure, but they also make the algorithm faster, especially when the number of the samples is high.<br>
这些约束对于施加某种局部结构很有用，但它们也使算法更快，尤其是在样本数量较多时。</p>
<p>The connectivity constraints are imposed via an connectivity matrix: a scipy sparse matrix that has elements only at the intersection of a row and a column with indices of the dataset that should be connected. This matrix can be constructed from a-priori information: for instance, you may wish to cluster web pages by only merging pages with a link pointing from one to another. It can also be learned from the data, for instance using <a href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.kneighbors_graph.html#sklearn.neighbors.kneighbors_graph"><code>sklearn.neighbors.kneighbors_graph</code></a> to restrict merging to nearest neighbors as in <a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_agglomerative_clustering.html#sphx-glr-auto-examples-cluster-plot-agglomerative-clustering-py">this example</a>, or using <a href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.image.grid_to_graph.html#sklearn.feature_extraction.image.grid_to_graph"><code>sklearn.feature_extraction.image.grid_to_graph</code></a> to enable only merging of neighboring pixels on an image, as in the <a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_coin_ward_segmentation.html#sphx-glr-auto-examples-cluster-plot-coin-ward-segmentation-py">coin</a> example.<br>
连通性约束是通过连通性矩阵施加的：一个 scipy 稀疏矩阵，该矩阵仅在行和列的交点处具有元素，该列具有应连接的数据集的索引。这个矩阵可以从先验信息中构造：例如，您可能希望通过仅合并具有从一个页面指向另一个链接的页面来对网页进行聚类。它也可以从数据中学习，例如，用于限制合并到最近邻，如本例所示，或用于 <code>sklearn.neighbors.kneighbors_graph</code> <code>sklearn.feature_extraction.image.grid_to_graph</code> 仅启用图像上相邻像素的合并，如硬币示例所示。</p>
<p>Warning 警告</p>
<p><strong>Connectivity constraints with single, average and complete linkage<br>
具有单个、平均和完整链接的连接限制</strong></p>
<p>Connectivity constraints and single, complete or average linkage can enhance the ‘rich getting richer’ aspect of agglomerative clustering, particularly so if they are built with <a href="https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.kneighbors_graph.html#sklearn.neighbors.kneighbors_graph"><code>sklearn.neighbors.kneighbors_graph</code></a>. In the limit of a small number of clusters, they tend to give a few macroscopically occupied clusters and almost empty ones. (see the discussion in <a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_agglomerative_clustering.html#sphx-glr-auto-examples-cluster-plot-agglomerative-clustering-py">Agglomerative clustering with and without structure</a>). Single linkage is the most brittle linkage option with regard to this issue.<br>
连通性约束和单一、完全或平均链接可以增强集聚聚类的“富人越来越富”的方面，特别是如果它们是用 <code>sklearn.neighbors.kneighbors_graph</code> .在少量簇的限制下，它们往往会给出一些宏观上占据的簇和几乎空的簇。（参见有结构和无结构的团聚聚类中的讨论）。就此问题而言，单连杆是最脆弱的连杆选择。</p>
<p><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_agglomerative_clustering.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_agglomerative_clustering_001.png" alt="img"></a><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_agglomerative_clustering.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_agglomerative_clustering_002.png" alt="img"></a><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_agglomerative_clustering.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_agglomerative_clustering_003.png" alt="img"></a><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_agglomerative_clustering.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_agglomerative_clustering_004.png" alt="img"></a></p>
<h3 id="1-6-4-varying-the-metric-1-6-4-改变指标">1.6.4. Varying the metric<a href="https://scikit-learn.org/stable/modules/clustering.html#varying-the-metric">¶</a> 1.6.4. 改变指标 ¶</h3>
<p>Single, average and complete linkage can be used with a variety of distances (or affinities), in particular Euclidean distance (<em>l2</em>), Manhattan distance (or Cityblock, or <em>l1</em>), cosine distance, or any precomputed affinity matrix.<br>
单个、平均和完全链接可用于各种距离（或亲和力），特别是欧几里得距离 （l2）、曼哈顿距离（或 Cityblock 或 l1）、余弦距离或任何预先计算的亲和矩阵。</p>
<ul>
<li><em>l1</em> distance is often good for sparse features, or sparse noise: i.e. many of the features are zero, as in text mining using occurrences of rare words.<br>
L1 距离通常适用于稀疏特征或稀疏噪声：即许多特征为零，例如使用生僻词的出现进行文本挖掘。</li>
<li><em>cosine</em> distance is interesting because it is invariant to global scalings of the signal.<br>
余弦距离很有趣，因为它对信号的全局缩放是不变的。</li>
</ul>
<p>The guidelines for choosing a metric is to use one that maximizes the distance between samples in different classes, and minimizes that within each class.<br>
选择指标的准则是使用一个最大化不同类别中样本之间的距离，并最小化每个类别中的距离的指标。</p>
<p><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_agglomerative_clustering_metrics.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_agglomerative_clustering_metrics_005.png" alt="img"></a><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_agglomerative_clustering_metrics.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_agglomerative_clustering_metrics_006.png" alt="img"></a><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_agglomerative_clustering_metrics.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_agglomerative_clustering_metrics_007.png" alt="img"></a></p>
<h3 id="bisecting-k-means-平分-k-means">Bisecting K-Means<a href="https://scikit-learn.org/stable/modules/clustering.html#bisecting-k-means">¶</a> 平分 K-Means ¶</h3>
<p>The [<code>BisectingKMeans</code>] is an iterative variant of [<code>KMeans</code>], using divisive hierarchical clustering. Instead of creating all centroids at once, centroids are picked progressively based on a previous clustering: a cluster is split into two new clusters repeatedly until the target number of clusters is reached.<br>
是 <code>BisectingKMeans</code> 的迭代变体 <code>KMeans</code> ，使用分裂分层聚类。质心不是一次创建所有质心，而是根据先前的聚类逐步选取：一个聚类重复拆分为两个新聚类，直到达到目标聚类数。</p>
<p>[<code>BisectingKMeans</code>] is more efficient than [<code>KMeans</code>]when the number of clusters is large since it only works on a subset of the data at each bisection while [<code>KMeans</code>]always works on the entire dataset.<br>
<code>BisectingKMeans</code> 比聚类数量较多 <code>KMeans</code> 时更有效，因为它只适用于每个平分法的数据子集，而 <code>KMeans</code> 始终适用于整个数据集。</p>
<p>Although [<code>BisectingKMeans</code>] can’t benefit from the advantages of the <code>&quot;k-means++&quot;</code> initialization by design, it will still produce comparable results than <code>KMeans(init=&quot;k-means++&quot;)</code> in terms of inertia at cheaper computational costs, and will likely produce better results than <code>KMeans</code> with a random initialization.<br>
虽然 <code>BisectingKMeans</code> 不能从设计初始化的优势中受益，但它仍然会产生与 <code>KMeans(init=&quot;k-means++&quot;)</code> 惯性相当的结果，并且计算成本更低，并且可能产生比 <code>KMeans</code> 随机 <code>&quot;k-means++&quot;</code> 初始化更好的结果。</p>
<p>This variant is more efficient to agglomerative clustering if the number of clusters is small compared to the number of data points.<br>
如果聚类数量与数据点数量相比较小，则此变体对聚集聚类更有效。</p>
<p>This variant also does not produce empty clusters.<br>
此变体也不会生成空集群。</p>
<ul>
<li>
<p>There exist two strategies for selecting the cluster to split: 有两种策略可用于选择要拆分的集群：</p>
<p><code>bisecting_strategy=&quot;largest_cluster&quot;</code> selects the cluster having the most points <code>bisecting_strategy=&quot;largest_cluster&quot;</code> 选择点数最多的集群<code>bisecting_strategy=&quot;biggest_inertia&quot;</code> selects the cluster with biggest inertia (cluster with biggest Sum of Squared Errors within) <code>bisecting_strategy=&quot;biggest_inertia&quot;</code> 选择惯性最大的簇（误差平方和最大的簇）</p>
</li>
</ul>
<p>Picking by largest amount of data points in most cases produces result as accurate as picking by inertia and is faster (especially for larger amount of data points, where calculating error may be costly).<br>
在大多数情况下，按最大数量的数据点进行拣选会产生与惯性拣选一样准确的结果，并且速度更快（特别是对于大量数据点，其中计算误差可能代价高昂）。</p>
<p>Picking by largest amount of data points will also likely produce clusters of similar sizes while <code>KMeans</code> is known to produce clusters of different sizes.<br>
按最大数量的数据点进行选择也可能会产生类似大小的聚类，而 <code>KMeans</code> 已知会产生不同大小的聚类。</p>
<p>Difference between Bisecting K-Means and regular K-Means can be seen on example <a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_bisect_kmeans.html#sphx-glr-auto-examples-cluster-plot-bisect-kmeans-py">Bisecting K-Means and Regular K-Means Performance Comparison</a>. While the regular K-Means algorithm tends to create non-related clusters, clusters from Bisecting K-Means are well ordered and create quite a visible hierarchy.<br>
平分 K-Means 和常规 K-Means 之间的区别可以在 Bisecting K-Means 和 Regular K-Means Performance Comparison 示例中看到。虽然常规的 K-Means 算法倾向于创建不相关的聚类，但 Bisecting K-Means 的聚类是有序的，并创建相当可见的层次结构。</p>
<h2 id="dbscan">DBSCAN<a href="https://scikit-learn.org/stable/modules/clustering.html#dbscan">¶</a></h2>
<p>The <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html#sklearn.cluster.DBSCAN"><code>DBSCAN</code></a> algorithm views clusters as areas of high density separated by areas of low density. Due to this rather generic view, clusters found by DBSCAN can be any shape, as opposed to k-means which assumes that clusters are convex shaped. The central component to the DBSCAN is the concept of <em>core samples</em>, which are samples that are in areas of high density. A cluster is therefore a set of core samples, each close to each other (measured by some distance measure) and a set of non-core samples that are close to a core sample (but are not themselves core samples). There are two parameters to the algorithm, <code>min_samples</code> and <code>eps</code>, which define formally what we mean when we say <em>dense</em>. Higher <code>min_samples</code> or lower <code>eps</code> indicate higher density necessary to form a cluster.<br>
该 <code>DBSCAN</code> 算法将聚类视为由低密度区域分隔的高密度区域。由于这种相当通用的视图，DBSCAN 找到的聚类可以是任何形状，而不是假设聚类是凸形的 k 均值。DBSCAN的核心组成部分是岩心样本的概念，岩心样本是位于高密度区域的样本。因此，聚类是一组核心样本，每个样本彼此靠近（通过某种距离测量来测量）和一组接近核心样本（但本身不是核心样本）的非核心样本。该算法有两个参数，和 <code>eps</code> ， <code>min_samples</code> 它们正式定义了我们所说的密集时的含义。越高或越低表示形成集群所需的密度越 <code>eps</code> 高 <code>min_samples</code> 。</p>
<p>More formally, we define a core sample as being a sample in the dataset such that there exist <code>min_samples</code> other samples within a distance of <code>eps</code>, which are defined as <em>neighbors</em> of the core sample. This tells us that the core sample is in a dense area of the vector space. A cluster is a set of core samples that can be built by recursively taking a core sample, finding all of its neighbors that are core samples, finding all of <em>their</em> neighbors that are core samples, and so on. A cluster also has a set of non-core samples, which are samples that are neighbors of a core sample in the cluster but are not themselves core samples. Intuitively, these samples are on the fringes of a cluster.<br>
更正式地说，我们将核心样本定义为数据集中的样本，这样在 的距离内存在 <code>min_samples</code> 其他样本 <code>eps</code> ，这些样本被定义为核心样本的邻居。这告诉我们，核心样本位于向量空间的密集区域。集群是一组核心样本，可以通过递归获取核心样本、查找其所有作为核心样本的邻居、查找它们的所有核心样本邻居等来构建。集群还具有一组非核心样本，这些样本是集群中核心样本的邻居，但本身不是核心样本。直观地说，这些样本位于集群的边缘。</p>
<p>Any core sample is part of a cluster, by definition. Any sample that is not a core sample, and is at least <code>eps</code> in distance from any core sample, is considered an outlier by the algorithm.<br>
根据定义，任何核心样本都是集群的一部分。任何不是岩心样本的样本，并且至少 <code>eps</code> 与任何岩心样本保持一定距离，都会被算法视为异常值。</p>
<p>While the parameter <code>min_samples</code> primarily controls how tolerant the algorithm is towards noise (on noisy and large data sets it may be desirable to increase this parameter), the parameter <code>eps</code> is <em>crucial to choose appropriately</em> for the data set and distance function and usually cannot be left at the default value. It controls the local neighborhood of the points. When chosen too small, most data will not be clustered at all (and labeled as <code>-1</code> for “noise”). When chosen too large, it causes close clusters to be merged into one cluster, and eventually the entire data set to be returned as a single cluster. Some heuristics for choosing this parameter have been discussed in the literature, for example based on a knee in the nearest neighbor distances plot (as discussed in the references below).<br>
虽然该参数 <code>min_samples</code> 主要控制算法对噪声的容忍度（在嘈杂和大型数据集上，可能需要增加此参数），但对于为数据集和距离函数适当选择该参数 <code>eps</code> 至关重要，并且通常不能保留为默认值。它控制点的局部邻域。如果选择得太小，大多数数据根本不会聚类（并标记为 <code>-1</code> “噪声”）。如果选择得太大，则会导致紧密的聚类合并为一个聚类，并最终将整个数据集作为单个聚类返回。文献中已经讨论了选择此参数的一些启发式方法，例如基于最近邻距离图中的拐点（如下面的参考文献中所述）。</p>
<p>In the figure below, the color indicates cluster membership, with large circles indicating core samples found by the algorithm. Smaller circles are non-core samples that are still part of a cluster. Moreover, the outliers are indicated by black points below.<br>
在下图中，颜色表示集群成员资格，大圆圈表示算法找到的核心样本。较小的圆圈是非核心样本，它们仍然是集群的一部分。此外，异常值由下面的黑点表示。</p>
<p><strong><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_dbscan.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_dbscan_002.png" alt="img"></a></strong></p>
<h2 id="hdbscan">HDBSCAN<a href="https://scikit-learn.org/stable/modules/clustering.html#hdbscan">¶</a></h2>
<p>The <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.HDBSCAN.html#sklearn.cluster.HDBSCAN"><code>HDBSCAN</code></a> algorithm can be seen as an extension of <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html#sklearn.cluster.DBSCAN"><code>DBSCAN</code></a> and <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.OPTICS.html#sklearn.cluster.OPTICS"><code>OPTICS</code></a>. Specifically, <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html#sklearn.cluster.DBSCAN"><code>DBSCAN</code></a> assumes that the clustering criterion (i.e. density requirement) is <em>globally homogeneous</em>. In other words, <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html#sklearn.cluster.DBSCAN"><code>DBSCAN</code></a> may struggle to successfully capture clusters with different densities. <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.HDBSCAN.html#sklearn.cluster.HDBSCAN"><code>HDBSCAN</code></a> alleviates this assumption and explores all possible density scales by building an alternative representation of the clustering problem.<br>
该 <code>HDBSCAN</code> 算法可以看作是 <code>DBSCAN</code> 和 <code>OPTICS</code> 的扩展。具体来说， <code>DBSCAN</code> 假设聚类标准（即密度要求）是全局同质的。换句话说， <code>DBSCAN</code> 可能很难成功捕获具有不同密度的集群。 <code>HDBSCAN</code> 缓解了这一假设，并通过构建聚类问题的替代表示来探索所有可能的密度尺度。</p>
<h3 id="mutual-reachability-graph-相互可达性图">Mutual Reachability Graph<a href="https://scikit-learn.org/stable/modules/clustering.html#mutual-reachability-graph">¶</a>  相互可达性图 ¶</h3>
<p>HDBSCAN first defines (d_c(x_p)), the <em>core distance</em> of a sample (x_p), as the distance to its <code>min_samples</code> th-nearest neighbor, counting itself. For example, if <code>min_samples=5</code> and (x_<em>) is the 5th-nearest neighbor of (x_p) then the core distance is:<br>
HDBSCAN首先将样本\（x_p\）的核心距离\（d_c（x_p）\）定义为到其 <code>min_samples</code> 最近邻的距离，计算自身。例如，如果 <code>min_samples=5</code> 和 \（x_</em>\） 是 \（x_p\） 的第 5 个最近邻，则核心距离为：</p>
<p>[d_c(x_p)=d(x_p, x_<em>).]<br>
[d_c（x_p）=d（x_p， x_</em>）.]</p>
<p>Next it defines (d_m(x_p, x_q)), the <em>mutual reachability distance</em> of two points (x_p, x_q), as:<br>
接下来，它将 \（d_m（x_p， x_q）\），两点 \（x_p， x_q\） 的相互可达距离定义为：</p>
<p>[d_m(x_p, x_q) = \max{d_c(x_p), d_c(x_q), d(x_p, x_q)}]<br>
[d_m（x_p， x_q） = \max{d_c（x_p）， d_c（x_q）， d（x_p， x_q）}]</p>
<p>These two notions allow us to construct the <em>mutual reachability graph</em> (G_{ms}) defined for a fixed choice of <code>min_samples</code> by associating each sample (x_p) with a vertex of the graph, and thus edges between points (x_p, x_q) are the mutual reachability distance (d_m(x_p, x_q)) between them. We may build subsets of this graph, denoted as (G_{ms,\varepsilon}), by removing any edges with value greater than (\varepsilon): from the original graph. Any points whose core distance is less than (\varepsilon): are at this staged marked as noise. The remaining points are then clustered by finding the connected components of this trimmed graph.<br>
这两个概念允许我们通过将每个样本 \（x_p\） 与图的顶点相关联来构建为固定选择定义的 <code>min_samples</code> 相互可达性图 \G_（}\），因此点 \（x_p， x_q\） 之间的边是它们之间的相互可达性距离 \（d_m（x_p， x_q）\）。我们可以通过从原始图中删除任何值大于 \（\varepsilon\） 的边来构建此图的子集，表示为 \（G_{ms，\varepsilon}\）。任何核心距离小于\（\varepsilon\）：的点在此阶段被标记为噪声。然后，通过查找此修剪图的连接分量来对其余点进行聚类。</p>
<p>Note 注意</p>
<p>Taking the connected components of a trimmed graph (G_{ms,\varepsilon}) is equivalent to running DBSCAN* with <code>min_samples</code> and (\varepsilon). DBSCAN* is a slightly modified version of DBSCAN mentioned in [<a href="https://scikit-learn.org/stable/modules/clustering.html#cm2013">CM2013]</a>.<br>
取修剪图\（G_{ms，\varepsilon}\）的连接分量等同于使用 <code>min_samples</code> 和\（\varepsilon\）运行DBSCAN*。DBSCAN* 是 [CM2013] 中提到的 DBSCAN 的略微修改版本。</p>
<h3 id="hierarchical-clustering-分层聚类">Hierarchical Clustering<a href="https://scikit-learn.org/stable/modules/clustering.html#id11">¶</a> 分层聚类 ¶</h3>
<p>HDBSCAN can be seen as an algorithm which performs DBSCAN* clustering across all values of (\varepsilon). As mentioned prior, this is equivalent to finding the connected components of the mutual reachability graphs for all values of (\varepsilon). To do this efficiently, HDBSCAN first extracts a minimum spanning tree (MST) from the fully -connected mutual reachability graph, then greedily cuts the edges with highest weight. An outline of the HDBSCAN algorithm is as follows:<br>
HDBSCAN 可以看作是一种算法，它对 \（\varepsilon\） 的所有值执行 DBSCAN* 聚类。如前所述，这等效于查找 \（\varepsilon\） 的所有值的相互可达性图的连接分量。为了有效地做到这一点，HDBSCAN 首先从全连接的相互可达性图中提取最小生成树 （MST），然后贪婪地切割权重最高的边缘。HDBSCAN算法的概述如下：</p>
<ol>
<li>Extract the MST of (G_{ms})<br>
提取\（G_{ms}\） 的 MST</li>
<li>Extend the MST by adding a “self edge” for each vertex, with weight equal to the core distance of the underlying sample.<br>
通过为每个顶点添加一个“自边”来扩展 MST，其权重等于基础样本的核心距离。</li>
<li>Initialize a single cluster and label for the MST.<br>
初始化 MST 的单个群集和标签。</li>
<li>Remove the edge with the greatest weight from the MST (ties are removed simultaneously).<br>
从 MST 上取下重量最大的边缘（同时取下扎带）。</li>
<li>Assign cluster labels to the connected components which contain the end points of the now-removed edge. If the component does not have at least one edge it is instead assigned a “null” label marking it as noise.<br>
将聚类标签分配给包含现已移除的边的端点的连接元件。如果组件没有至少一条边，则会为其分配一个“空”标签，将其标记为噪声。</li>
<li>Repeat 4-5 until there are no more connected components.<br>
重复 4-5，直到没有更多连接的组件。</li>
</ol>
<p>HDBSCAN is therefore able to obtain all possible partitions achievable by DBSCAN* for a fixed choice of <code>min_samples</code> in a hierarchical fashion. Indeed, this allows HDBSCAN to perform clustering across multiple densities and as such it no longer needs (\varepsilon) to be given as a hyperparameter. Instead it relies solely on the choice of <code>min_samples</code>, which tends to be a more robust hyperparameter.<br>
因此，HDBSCAN 能够获得 DBSCAN* 可实现的所有可能分区，以便 <code>min_samples</code> 以分层方式进行固定选择。事实上，这使得 HDBSCAN 能够跨多个密度执行聚类，因此它不再需要将 \（\varepsilon\） 作为超参数给出。相反，它完全依赖于 <code>min_samples</code> 的选择，这往往是一个更健壮的超参数。</p>
<p><strong><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_hdbscan.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_hdbscan_005.png" alt="img"></a></strong></p>
<p><strong><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_hdbscan.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_hdbscan_007.png" alt="img"></a></strong></p>
<p>HDBSCAN can be smoothed with an additional hyperparameter <code>min_cluster_size</code> which specifies that during the hierarchical clustering, components with fewer than <code>minimum_cluster_size</code> many samples are considered noise. In practice, one can set <code>minimum_cluster_size = min_samples</code> to couple the parameters and simplify the hyperparameter space.<br>
HDBSCAN 可以使用额外的超参数进行平滑处理，该超参数 <code>min_cluster_size</code> 指定在分层聚类期间，样本少于 <code>minimum_cluster_size</code> 许多的组件被视为噪声。在实践中，可以设置 <code>minimum_cluster_size = min_samples</code> 耦合参数并简化超参数空间。</p>
<h2 id="optics">OPTICS<a href="https://scikit-learn.org/stable/modules/clustering.html#optics">¶</a></h2>
<p>The <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.OPTICS.html#sklearn.cluster.OPTICS"><code>OPTICS</code></a> algorithm shares many similarities with the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.DBSCAN.html#sklearn.cluster.DBSCAN"><code>DBSCAN</code></a> algorithm, and can be considered a generalization of DBSCAN that relaxes the <code>eps</code> requirement from a single value to a value range. The key difference between DBSCAN and OPTICS is that the OPTICS algorithm builds a <em>reachability</em> graph, which assigns each sample both a <code>reachability_</code> distance, and a spot within the cluster <code>ordering_</code> attribute; these two attributes are assigned when the model is fitted, and are used to determine cluster membership. If OPTICS is run with the default value of <em>inf</em> set for <code>max_eps</code>, then DBSCAN style cluster extraction can be performed repeatedly in linear time for any given <code>eps</code> value using the <code>cluster_optics_dbscan</code> method. Setting <code>max_eps</code> to a lower value will result in shorter run times, and can be thought of as the maximum neighborhood radius from each point to find other potential reachable points.<br>
该 <code>OPTICS</code> 算法与该 <code>DBSCAN</code> 算法有许多相似之处，可以认为是 DBSCAN 的泛化，它将 <code>eps</code> 要求从单个值放宽到一个值范围。DBSCAN 和 OPTICS 之间的主要区别在于，OPTICS 算法构建了一个可达性图，该图为每个样本分配距离 <code>reachability_</code> 和聚类 <code>ordering_</code> 属性中的点;这两个属性在拟合模型时分配，用于确定聚类成员资格。如果 OPTICS 在 的默认值 inf 设置为 的情况下 <code>max_eps</code> 运行，则可以使用该 <code>cluster_optics_dbscan</code> 方法在线性时间内对任何给定 <code>eps</code> 值重复执行 DBSCAN 样式聚类提取。设置为 <code>max_eps</code> 较低的值将导致更短的运行时间，并且可以将其视为从每个点开始的最大邻域半径，以查找其他潜在的可到达点。</p>
<p><strong><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_optics.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_optics_001.png" alt="img"></a></strong></p>
<p>The <em>reachability</em> distances generated by OPTICS allow for variable density extraction of clusters within a single data set. As shown in the above plot, combining <em>reachability</em> distances and data set <code>ordering_</code> produces a <em>reachability plot</em>, where point density is represented on the Y-axis, and points are ordered such that nearby points are adjacent. ‘Cutting’ the reachability plot at a single value produces DBSCAN like results; all points above the ‘cut’ are classified as noise, and each time that there is a break when reading from left to right signifies a new cluster. The default cluster extraction with OPTICS looks at the steep slopes within the graph to find clusters, and the user can define what counts as a steep slope using the parameter <code>xi</code>. There are also other possibilities for analysis on the graph itself, such as generating hierarchical representations of the data through reachability-plot dendrograms, and the hierarchy of clusters detected by the algorithm can be accessed through the <code>cluster_hierarchy_</code> parameter. The plot above has been color-coded so that cluster colors in planar space match the linear segment clusters of the reachability plot. Note that the blue and red clusters are adjacent in the reachability plot, and can be hierarchically represented as children of a larger parent cluster.<br>
OPTICS生成的可达距离允许在单个数据集中对聚类进行可变密度提取。如上图所示，将可达距离和数据集 <code>ordering_</code> 组合在一起会产生可达性图，其中点密度在 Y 轴上表示，并且对点进行排序，使附近的点相邻。将可达性图“切割”为单个值会产生类似DBSCAN的结果;“切口”上方的所有点都被归类为噪声，从左到右读取时，每次中断都表示一个新的集群。使用 OPTICS 的默认聚类提取会查看图形中的陡坡以查找聚类，用户可以使用参数 <code>xi</code> 定义什么是陡坡。在图形本身上还有其他分析的可能性，例如通过可达性图树状图生成数据的分层表示，并且可以通过 <code>cluster_hierarchy_</code> 参数访问算法检测到的聚类层次结构。上面的图已经过颜色编码，以便平面空间中的聚类颜色与可达性图的线性线段聚类相匹配。请注意，蓝色和红色聚类在可达性图中相邻，可以分层表示为较大父聚类的子聚类。</p>
<h2 id="birch">BIRCH<a href="https://scikit-learn.org/stable/modules/clustering.html#birch">¶</a></h2>
<p>The <a href="https://scikit-learn.org/stable/modules/generated/sklearn.cluster.Birch.html#sklearn.cluster.Birch"><code>Birch</code></a> builds a tree called the Clustering Feature Tree (CFT) for the given data. The data is essentially lossy compressed to a set of Clustering Feature nodes (CF Nodes). The CF Nodes have a number of subclusters called Clustering Feature subclusters (CF Subclusters) and these CF Subclusters located in the non-terminal CF Nodes can have CF Nodes as children.<br>
为 <code>Birch</code> 给定数据构建一个称为聚类特征树 （CFT） 的树。数据基本上是有损压缩到一组聚类功能节点（CF 节点）的。CF 节点具有许多称为聚类功能子集群（CF 子集群）的子集群，这些位于非终端 CF 节点中的 CF 子集群可以将 CF 节点作为子节点。</p>
<p>The CF Subclusters hold the necessary information for clustering which prevents the need to hold the entire input data in memory. This information includes:<br>
CF 子集群保存了聚类所需的信息，从而避免了将整个输入数据保存在内存中的需要。这些信息包括：</p>
<ul>
<li>Number of samples in a subcluster.<br>
子集群中的样本数。</li>
<li>Linear Sum - An n-dimensional vector holding the sum of all samples<br>
线性求和 - 保存所有样本之和的 n 维向量</li>
<li>Squared Sum - Sum of the squared L2 norm of all samples.<br>
平方和 - 所有样本的 L2 范数的平方和。</li>
<li>Centroids - To avoid recalculation linear sum / n_samples.<br>
质心 - 避免重新计算线性总和/n_samples。</li>
<li>Squared norm of the centroids.<br>
质心的平方范数。</li>
</ul>
<p>The BIRCH algorithm has two parameters, the threshold and the branching factor. The branching factor limits the number of subclusters in a node and the threshold limits the distance between the entering sample and the existing subclusters.<br>
BIRCH 算法有两个参数，即阈值和分支因子。分支因子限制节点中的子聚类数量，阈值限制输入样本与现有子聚类之间的距离。</p>
<p>This algorithm can be viewed as an instance or data reduction method, since it reduces the input data to a set of subclusters which are obtained directly from the leaves of the CFT. This reduced data can be further processed by feeding it into a global clusterer. This global clusterer can be set by <code>n_clusters</code>. If <code>n_clusters</code> is set to None, the subclusters from the leaves are directly read off, otherwise a global clustering step labels these subclusters into global clusters (labels) and the samples are mapped to the global label of the nearest subcluster.<br>
该算法可以被视为一种实例或数据缩减方法，因为它将输入数据简化为一组子簇，这些子簇直接从 CFT 的叶子中获得。这种减少的数据可以通过将其输入全局聚类器来进一步处理。此全局聚类器可以通过 设置 <code>n_clusters</code> 。如果 <code>n_clusters</code> 设置为“无”，则直接读出叶子中的子聚类，否则全局聚类步骤会将这些子聚类标记为全局聚类（标签），并将样本映射到最近子聚类的全局标签。</p>
<p><strong>Algorithm description: 算法说明：</strong></p>
<ul>
<li>A new sample is inserted into the root of the CF Tree which is a CF Node. It is then merged with the subcluster of the root, that has the smallest radius after merging, constrained by the threshold and branching factor conditions. If the subcluster has any child node, then this is done repeatedly till it reaches a leaf. After finding the nearest subcluster in the leaf, the properties of this subcluster and the parent subclusters are recursively updated.<br>
将一个新样本插入到 CF 树的根中，该树是一个 CF 节点。然后，它与根的子簇合并，该子簇在合并后具有最小的半径，受阈值和分支因子条件的约束。如果子集群有任何子节点，则重复执行此操作，直到它到达叶。在叶中找到最近的子集群后，将以递归方式更新此子集群和父子集群的属性。</li>
<li>If the radius of the subcluster obtained by merging the new sample and the nearest subcluster is greater than the square of the threshold and if the number of subclusters is greater than the branching factor, then a space is temporarily allocated to this new sample. The two farthest subclusters are taken and the subclusters are divided into two groups on the basis of the distance between these subclusters.<br>
如果通过合并新样本和最近的子聚类获得的子聚类的半径大于阈值的平方，并且子聚类的数量大于分支因子，则临时为该新样本分配一个空间。取两个最远的子簇，并根据这些子簇之间的距离将子簇分为两组。</li>
<li>If this split node has a parent subcluster and there is room for a new subcluster, then the parent is split into two. If there is no room, then this node is again split into two and the process is continued recursively, till it reaches the root.<br>
如果此拆分节点具有父子集群，并且有空间容纳新的子集群，则父节点将拆分为两个。如果没有空间，则此节点再次一分为二，并且该过程以递归方式继续，直到到达根。</li>
</ul>
<p><strong>BIRCH or MiniBatchKMeans?<br>
BIRCH 还是 MiniBatchKMeans？</strong></p>
<ul>
<li>BIRCH does not scale very well to high dimensional data. As a rule of thumb if <code>n_features</code> is greater than twenty, it is generally better to use MiniBatchKMeans.<br>
BIRCH 不能很好地扩展到高维数据。根据经验，如果 <code>n_features</code> 大于 20，则通常最好使用 MiniBatchKMeans。</li>
<li>If the number of instances of data needs to be reduced, or if one wants a large number of subclusters either as a preprocessing step or otherwise, BIRCH is more useful than MiniBatchKMeans.<br>
如果需要减少数据实例的数量，或者想要将大量子集群作为预处理步骤或其他方式，则 BIRCH 比 MiniBatchKMeans 更有用。</li>
</ul>
<p><strong>How to use partial_fit? 如何使用partial_fit？</strong></p>
<p>To avoid the computation of global clustering, for every call of <code>partial_fit</code> the user is advised<br>
为了避免全局聚类的计算，建议对用户的每次调用 <code>partial_fit</code> 进行</p>
<ol>
<li>To set <code>n_clusters=None</code> initially<br>
初始设置 <code>n_clusters=None</code></li>
<li>Train all data by multiple calls to partial_fit.<br>
通过多次调用 partial_fit 来训练所有数据。</li>
<li>Set <code>n_clusters</code> to a required value using <code>brc.set_params(n_clusters=n_clusters)</code>.<br>
<code>n_clusters</code> 使用 <code>brc.set_params(n_clusters=n_clusters)</code> 设置为所需的值。</li>
<li>Call <code>partial_fit</code> finally with no arguments, i.e. <code>brc.partial_fit()</code> which performs the global clustering.<br>
不带参数的 finally 调用 <code>partial_fit</code> ，即 <code>brc.partial_fit()</code> 执行全局聚类。</li>
</ol>
<p><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_birch_vs_minibatchkmeans.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_birch_vs_minibatchkmeans_001.png" alt="img"></a></p>
<h2 id="clustering-performance-evaluation-聚类性能评估">Clustering performance evaluation<a href="https://scikit-learn.org/stable/modules/clustering.html#clustering-performance-evaluation">¶</a> 聚类性能评估 ¶</h2>
<p>Evaluating the performance of a clustering algorithm is not as trivial as counting the number of errors or the precision and recall of a supervised classification algorithm. In particular any evaluation metric should not take the absolute values of the cluster labels into account but rather if this clustering define separations of the data similar to some ground truth set of classes or satisfying some assumption such that members belong to the same class are more similar than members of different classes according to some similarity metric.<br>
评估聚类算法的性能并不像计算错误数或监督分类算法的精度和召回率那样微不足道。特别是，任何评估指标都不应考虑聚类标签的绝对值，而应考虑此聚类定义的数据分离，类似于某些基本实况类集或满足某些假设，以便根据某些相似性指标，属于同一类的成员比不同类的成员更相似。</p>
<h3 id="rand-index-兰德索引">Rand index<a href="https://scikit-learn.org/stable/modules/clustering.html#rand-index">¶</a> 兰德索引 ¶</h3>
<p>Given the knowledge of the ground truth class assignments <code>labels_true</code> and our clustering algorithm assignments of the same samples <code>labels_pred</code>, the <strong>(adjusted or unadjusted) Rand index</strong> is a function that measures the <strong>similarity</strong> of the two assignments, ignoring permutations:<br>
给定对相同样本 <code>labels_pred</code> 的真值类赋值 <code>labels_true</code> 和聚类算法赋值的了解，（调整或未调整的）兰德指数是一个函数，用于衡量两个赋值的相似性，忽略排列：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; from sklearn import metrics</span><br><span class="line">&gt;&gt;&gt; labels_true = [0, 0, 0, 1, 1, 1]</span><br><span class="line">&gt;&gt;&gt; labels_pred = [0, 0, 1, 1, 2, 2]</span><br><span class="line">&gt;&gt;&gt; metrics.rand_score(labels_true, labels_pred)</span><br><span class="line">0.66...</span><br></pre></td></tr></table></figure>
<p>The Rand index does not ensure to obtain a value close to 0.0 for a random labelling. The adjusted Rand index <strong>corrects for chance</strong> and will give such a baseline.<br>
Rand 指数不确保随机标记获得接近 0.0 的值。调整后的兰德指数对机会进行校正，并将给出这样的基线。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; metrics.adjusted_rand_score(labels_true, labels_pred)</span><br><span class="line">0.24...</span><br></pre></td></tr></table></figure>
<p>As with all clustering metrics, one can permute 0 and 1 in the predicted labels, rename 2 to 3, and get the same score:<br>
与所有聚类指标一样，可以在预测标签中置换 0 和 1，将 2 重命名为 3，并获得相同的分数：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; labels_pred = [1, 1, 0, 0, 3, 3]</span><br><span class="line">&gt;&gt;&gt; metrics.rand_score(labels_true, labels_pred)</span><br><span class="line">0.66...</span><br><span class="line">&gt;&gt;&gt; metrics.adjusted_rand_score(labels_true, labels_pred)</span><br><span class="line">0.24...</span><br></pre></td></tr></table></figure>
<p>Furthermore, both <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.rand_score.html#sklearn.metrics.rand_score"><code>rand_score</code></a> <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.adjusted_rand_score.html#sklearn.metrics.adjusted_rand_score"><code>adjusted_rand_score</code></a> are <strong>symmetric</strong>: swapping the argument does not change the scores. They can thus be used as <strong>consensus measures</strong>:<br>
此外，两者都 <code>rand_score</code> <code>adjusted_rand_score</code> 是对称的：交换参数不会改变分数。因此，它们可以用作共识措施：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; metrics.rand_score(labels_pred, labels_true)</span><br><span class="line">0.66...</span><br><span class="line">&gt;&gt;&gt; metrics.adjusted_rand_score(labels_pred, labels_true)</span><br><span class="line">0.24...</span><br></pre></td></tr></table></figure>
<p>Perfect labeling is scored 1.0:<br>
完美标签得分为 1.0：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; labels_pred = labels_true[:]</span><br><span class="line">&gt;&gt;&gt; metrics.rand_score(labels_true, labels_pred)</span><br><span class="line">1.0</span><br><span class="line">&gt;&gt;&gt; metrics.adjusted_rand_score(labels_true, labels_pred)</span><br><span class="line">1.0</span><br></pre></td></tr></table></figure>
<p>Poorly agreeing labels (e.g. independent labelings) have lower scores, and for the adjusted Rand index the score will be negative or close to zero. However, for the unadjusted Rand index the score, while lower, will not necessarily be close to zero.:<br>
不一致的标签（例如独立标签）的分数较低，对于调整后的兰德指数，分数将为负或接近零。然而，对于未经调整的兰德指数，分数虽然较低，但不一定接近于零。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; labels_true = [0, 0, 0, 0, 0, 0, 1, 1]</span><br><span class="line">&gt;&gt;&gt; labels_pred = [0, 1, 2, 3, 4, 5, 5, 6]</span><br><span class="line">&gt;&gt;&gt; metrics.rand_score(labels_true, labels_pred)</span><br><span class="line">0.39...</span><br><span class="line">&gt;&gt;&gt; metrics.adjusted_rand_score(labels_true, labels_pred)</span><br><span class="line">-0.07...</span><br></pre></td></tr></table></figure>
<h4 id="advantages-优点">Advantages<a href="https://scikit-learn.org/stable/modules/clustering.html#advantages">¶</a>  优点 ¶</h4>
<ul>
<li><strong>Interpretability</strong>: The unadjusted Rand index is proportional to the number of sample pairs whose labels are the same in both <code>labels_pred</code> and <code>labels_true</code>, or are different in both.<br>
可解释性：未调整的 Rand 指数与两个 <code>labels_pred</code> <code>labels_true</code> 和 的标签相同或不同的样本对的数量成正比。</li>
<li><strong>Random (uniform) label assignments have an adjusted Rand index score close to 0.0</strong> for any value of <code>n_clusters</code> and <code>n_samples</code> (which is not the case for the unadjusted Rand index or the V-measure for instance).<br>
对于任何 <code>n_clusters</code> and <code>n_samples</code> 值，随机（统一）标签分配的调整后 Rand 指数得分接近 0.0（例如，未调整的 Rand 指数或 V 度量值并非如此）。</li>
<li><strong>Bounded range</strong>: Lower values indicate different labelings, similar clusterings have a high (adjusted or unadjusted) Rand index, 1.0 is the perfect match score. The score range is [0, 1] for the unadjusted Rand index and [-1, 1] for the adjusted Rand index.<br>
有界范围：较低的值表示不同的标签，相似的聚类具有较高（调整或未调整）的 Rand 指数，1.0 是完美匹配分数。未调整的 Rand 指数的分数范围为 [0， 1]，调整后的 Rand 指数的分数范围为 [-1， 1]。</li>
<li><strong>No assumption is made on the cluster structure</strong>: The (adjusted or unadjusted) Rand index can be used to compare all kinds of clustering algorithms, and can be used to compare clustering algorithms such as k-means which assumes isotropic blob shapes with results of spectral clustering algorithms which can find cluster with “folded” shapes.<br>
不对聚类结构进行任何假设：（调整或未调整）Rand 指数可用于比较各种聚类算法，并可用于比较聚类算法，例如假设各向同性斑点形状的 k 均值与光谱聚类算法的结果，后者可以找到具有“折叠”形状的聚类。</li>
</ul>
<h4 id="drawbacks-缺点">Drawbacks<a href="https://scikit-learn.org/stable/modules/clustering.html#drawbacks">¶</a> 缺点 ¶</h4>
<ul>
<li>
<p>Contrary to inertia, the <strong>(adjusted or unadjusted) Rand index requires knowledge of the ground truth classes</strong> which is almost never available in practice or requires manual assignment by human annotators (as in the supervised learning setting).<br>
与惯性相反，（调整或未调整）兰德指数需要了解基本实况类，这在实践中几乎从未获得过，或者需要人工注释者手动分配（如在监督学习环境中）。</p>
<p>However (adjusted or unadjusted) Rand index can also be useful in a purely unsupervised setting as a building block for a Consensus Index that can be used for clustering model selection (TODO).<br>
但是，（调整或未调整）Rand 指数在纯无监督环境中也可用于作为共识指数的构建块，该指数可用于聚类模型选择 （TODO）。</p>
</li>
<li>
<p>The <strong>unadjusted Rand index is often close to 1.0</strong> even if the clusterings themselves differ significantly. This can be understood when interpreting the Rand index as the accuracy of element pair labeling resulting from the clusterings: In practice there often is a majority of element pairs that are assigned the <code>different</code> pair label under both the predicted and the ground truth clustering resulting in a high proportion of pair labels that agree, which leads subsequently to a high score.<br>
未经调整的兰德指数通常接近 1.0，即使聚类本身差异很大。当将 Rand 指数解释为聚类产生的元素对标记的准确性时，可以理解这一点：在实践中，通常大多数元素对在预测和真值聚类下都被分配了 <code>different</code> 对标签，导致高比例的对标签一致，从而导致高分。</p>
</li>
</ul>
<h4 id="mathematical-formulation-数学公式">Mathematical formulation<a href="https://scikit-learn.org/stable/modules/clustering.html#mathematical-formulation">¶</a> 数学公式 ¶</h4>
<p>If C is a ground truth class assignment and K the clustering, let us define (a) and (b) as:<br>
如果 C 是真值类赋值，K 是聚类，那么我们将 \（a\） 和 \（b\） 定义为：</p>
<ul>
<li>(a), the number of pairs of elements that are in the same set in C and in the same set in K<br>
\（a\），在 C 中在同一集合中和在 K 中在同一集合中的元素对数</li>
<li>(b), the number of pairs of elements that are in different sets in C and in different sets in K<br>
\（b\），在 C 中处于不同集合中的元素对数，在 K 中处于不同集合中的元素对数</li>
</ul>
<p>The unadjusted Rand index is then given by:<br>
未经调整的兰特指数由下式给出：</p>
<p>[\text{RI} = \frac{a + b}{C_2^{n_{samples}}}]<br>
[\text{RI} = \frac{a + b}{C_2^{n_{样本}}}]</p>
<p>where (C_2^{n_{samples}}) is the total number of possible pairs in the dataset. It does not matter if the calculation is performed on ordered pairs or unordered pairs as long as the calculation is performed consistently.<br>
其中 \（C_2^{n_{samples}}\） 是数据集中可能的对总数。计算是在有序对还是无序对上执行并不重要，只要一致地执行计算即可。</p>
<p>However, the Rand index does not guarantee that random label assignments will get a value close to zero (esp. if the number of clusters is in the same order of magnitude as the number of samples).<br>
但是，Rand 指数并不能保证随机标签分配将获得接近于零的值（特别是如果聚类数与样本数处于同一数量级）。</p>
<p>To counter this effect we can discount the expected RI (E[\text{RI}]) of random labelings by defining the adjusted Rand index as follows:</p>
<p>[\text{ARI} = \frac{\text{RI} - E[\text{RI}]}{\max(\text{RI}) - E[\text{RI}]}]</p>
<h3 id="mutual-information-based-scores">Mutual Information based scores<a href="https://scikit-learn.org/stable/modules/clustering.html#mutual-information-based-scores">¶</a></h3>
<p>Given the knowledge of the ground truth class assignments <code>labels_true</code> and our clustering algorithm assignments of the same samples <code>labels_pred</code>, the <strong>Mutual Information</strong> is a function that measures the <strong>agreement</strong> of the two assignments, ignoring permutations. Two different normalized versions of this measure are available, <strong>Normalized Mutual Information (NMI)</strong> and <strong>Adjusted Mutual Information (AMI)</strong>. NMI is often used in the literature, while AMI was proposed more recently and is <strong>normalized against chance</strong>:<br>
给定对相同样本 <code>labels_pred</code> 的真值类赋值 <code>labels_true</code> 和聚类算法赋值的了解，互信息是一个测量两个赋值一致性的函数，忽略排列。此度量值有两个不同的规范化版本，即规范化互信息 （NMI） 和调整互信息 （AMI）。NMI 经常在文献中使用，而 AMI 是最近提出的，并且偶然被归一化：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; from sklearn import metrics</span><br><span class="line">&gt;&gt;&gt; labels_true = [0, 0, 0, 1, 1, 1]</span><br><span class="line">&gt;&gt;&gt; labels_pred = [0, 0, 1, 1, 2, 2]</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; metrics.adjusted_mutual_info_score(labels_true, labels_pred)  </span><br><span class="line">0.22504...</span><br></pre></td></tr></table></figure>
<p>One can permute 0 and 1 in the predicted labels, rename 2 to 3 and get the same score:<br>
可以在预测标签中置换 0 和 1，重命名 2 到 3 并获得相同的分数：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; labels_pred = [1, 1, 0, 0, 3, 3]</span><br><span class="line">&gt;&gt;&gt; metrics.adjusted_mutual_info_score(labels_true, labels_pred)  </span><br><span class="line">0.22504...</span><br></pre></td></tr></table></figure>
<p>All, <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.mutual_info_score.html#sklearn.metrics.mutual_info_score"><code>mutual_info_score</code></a>, <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.adjusted_mutual_info_score.html#sklearn.metrics.adjusted_mutual_info_score"><code>adjusted_mutual_info_score</code></a> and <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.normalized_mutual_info_score.html#sklearn.metrics.normalized_mutual_info_score"><code>normalized_mutual_info_score</code></a> are symmetric: swapping the argument does not change the score. Thus they can be used as a <strong>consensus measure</strong>:<br>
所有、 <code>mutual_info_score</code> 和 <code>adjusted_mutual_info_score</code> <code>normalized_mutual_info_score</code> 都是对称的：交换参数不会改变分数。因此，它们可以用作共识度量：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; metrics.adjusted_mutual_info_score(labels_pred, labels_true)  </span><br><span class="line">0.22504...</span><br></pre></td></tr></table></figure>
<p>Perfect labeling is scored 1.0:<br>
完美标签得分为 1.0：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; labels_pred = labels_true[:]</span><br><span class="line">&gt;&gt;&gt; metrics.adjusted_mutual_info_score(labels_true, labels_pred)  </span><br><span class="line">1.0</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; metrics.normalized_mutual_info_score(labels_true, labels_pred)  </span><br><span class="line">1.0</span><br></pre></td></tr></table></figure>
<p>This is not true for <code>mutual_info_score</code>, which is therefore harder to judge:<br>
但事实并非如此 <code>mutual_info_score</code> ，因此更难判断：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; metrics.mutual_info_score(labels_true, labels_pred)  </span><br><span class="line">0.69...</span><br></pre></td></tr></table></figure>
<p>Bad (e.g. independent labelings) have non-positive scores:<br>
不良（例如独立标签）具有非正分数：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; labels_true = [0, 1, 2, 0, 3, 4, 5, 1]</span><br><span class="line">&gt;&gt;&gt; labels_pred = [1, 1, 0, 0, 2, 2, 2, 2]</span><br><span class="line">&gt;&gt;&gt; metrics.adjusted_mutual_info_score(labels_true, labels_pred)  </span><br><span class="line">-0.10526...</span><br></pre></td></tr></table></figure>
<h4 id="advantages-优点">Advantages<a href="https://scikit-learn.org/stable/modules/clustering.html#id14">¶</a> 优点 ¶</h4>
<ul>
<li><strong>Random (uniform) label assignments have a AMI score close to 0.0</strong> for any value of <code>n_clusters</code> and <code>n_samples</code> (which is not the case for raw Mutual Information or the V-measure for instance).<br>
对于任何值 <code>n_clusters</code> and <code>n_samples</code> 的随机（统一）标签分配，AMI 分数都接近 0.0（例如，原始互信息或 V 度量并非如此）。</li>
<li><strong>Upper bound of 1</strong>: Values close to zero indicate two label assignments that are largely independent, while values close to one indicate significant agreement. Further, an AMI of exactly 1 indicates that the two label assignments are equal (with or without permutation).<br>
上限 1：接近零的值表示两个标签分配在很大程度上是独立的，而接近 1 的值表示非常一致。此外，AMI 正好为 1 表示两个标签分配相等（有或没有排列）。</li>
</ul>
<h4 id="drawbacks-缺点">Drawbacks<a href="https://scikit-learn.org/stable/modules/clustering.html#id15">¶</a> 缺点 ¶</h4>
<ul>
<li>
<p>Contrary to inertia, <strong>MI-based measures require the knowledge of the ground truth classes</strong> while almost never available in practice or requires manual assignment by human annotators (as in the supervised learning setting).<br>
与惯性相反，基于 MI 的测量需要了解基本实况类，而在实践中几乎不可用，或者需要人工注释者手动分配（如在监督学习设置中）。</p>
<p>However MI-based measures can also be useful in purely unsupervised setting as a building block for a Consensus Index that can be used for clustering model selection.<br>
然而，基于 MI 的测量在纯粹的无监督设置中也很有用，作为可用于聚类模型选择的共识指数的构建块。</p>
</li>
<li>
<p>NMI and MI are not adjusted against chance.<br>
NMI 和 MI 不会因偶然性而进行调整。</p>
</li>
</ul>
<h4 id="mathematical-formulation-数学公式">Mathematical formulation<a href="https://scikit-learn.org/stable/modules/clustering.html#id16">¶</a> 数学公式 ¶</h4>
<p>Assume two label assignments (of the same N objects), (U) and (V). Their entropy is the amount of uncertainty for a partition set, defined by:<br>
假设有两个标签赋值（相同的 N 个对象），\（U\） 和 \（V\）。它们的熵是分区集的不确定性量，定义如下：</p>
<p>[H(U) = - \sum_{i=1}^{|U|}P(i)\log(P(i))]<br>
[H（U） = - \sum_{i=1}^{|U|}P（i）\log（P（i））]</p>
<p>where (P(i) = |U_i| / N) is the probability that an object picked at random from (U) falls into class (U_i). Likewise for (V):<br>
其中 \（P（i） = |U_i|/ N\） 是从 \（U\） 中随机选择的对象落入类 \（U_i\） 的概率。\（V\） 也是如此：</p>
<p>[H(V) = - \sum_{j=1}^{|V|}P’(j)\log(P’(j))]<br>
[H（V） = - \sum_{j=1}^{|V|}P’（j）\log（P’（j））]</p>
<p>With (P’(j) = |V_j| / N). The mutual information (MI) between (U) and (V) is calculated by:<br>
其中\（P’（j） = |V_j|/ N\）。\（U\） 和 \（V\） 之间的互信息 （MI） 由下式计算：</p>
<p>[\text{MI}(U, V) = \sum_{i=1}^{|U|}\sum_{j=1}^{|V|}P(i, j)\log\left(\frac{P(i,j)}{P(i)P’(j)}\right)]<br>
[\text{MI}（U， V） = \sum_{i=1}^{|U|}\sum_{j=1}^{|V|}P（i， j）\log\left（\frac{P（i，j）}{P（i）P’（j）}\right）]</p>
<p>where (P(i, j) = |U_i \cap V_j| / N) is the probability that an object picked at random falls into both classes (U_i) and (V_j).<br>
其中 \（P（i， j） = |U_i \cap V_j|/ N\） 是随机拾取的对象同时属于类 \（U_i\） 和类 \（V_j\） 的概率。</p>
<p>It also can be expressed in set cardinality formulation:<br>
它也可以用集合基数公式表示：</p>
<p>[\text{MI}(U, V) = \sum_{i=1}^{|U|} \sum_{j=1}^{|V|} \frac{|U_i \cap V_j|}{N}\log\left(\frac{N|U_i \cap V_j|}{|U_i||V_j|}\right)]<br>
[\text{MI}（U， V） = \sum_{i=1}^{|U|}\sum_{j=1}^{|V|}\frac{|U_i \cap V_j|}{N}\log\left（\frac{N|U_i \cap V_j|}{|U_i||V_j|}\right）]</p>
<p>The normalized mutual information is defined as<br>
规范化的互信息定义为</p>
<p>[\text{NMI}(U, V) = \frac{\text{MI}(U, V)}{\text{mean}(H(U), H(V))}]<br>
[\text{NMI}（U， V） = \frac{\text{MI}（U， V）}{\text{mean}（H（U）， H（V））}]</p>
<p>This value of the mutual information and also the normalized variant is not adjusted for chance and will tend to increase as the number of different labels (clusters) increases, regardless of the actual amount of “mutual information” between the label assignments.<br>
互信息和归一化变体的这个值不会因偶然性而调整，并且随着不同标签（聚类）数量的增加而趋于增加，而不管标签分配之间的“互信息”的实际数量如何。</p>
<p>The expected value for the mutual information can be calculated using the following equation [<a href="https://scikit-learn.org/stable/modules/clustering.html#veb2009">VEB2009]</a>. In this equation, (a_i = |U_i|) (the number of elements in (U_i)) and (b_j = |V_j|) (the number of elements in (V_j)).<br>
互信息的期望值可以使用以下公式[VEB2009]计算。在这个等式中，\（a_i = |U_i|\）（\（U_i\）中的元素数）和\（b_j = |V_j|\）（\（V_j\）中的元素数）。</p>
<p>[E[\text{MI}(U,V)]=\sum_{i=1}^{|U|} \sum_{j=1}^{|V|} \sum_{n_{ij}=(a_i+b_j-N)^+ }^{\min(a_i, b_j)} \frac{n_{ij}}{N}\log \left( \frac{ N.n_{ij}}{a_i b_j}\right) \frac{a_i!b_j!(N-a_i)!(N-b_j)!}{N!n_{ij}!(a_i-n_{ij})!(b_j-n_{ij})! (N-a_i-b_j+n_{ij})!}]<br>
[E[\text{MI}（U，V）]=\sum_{i=1}^{|U|} \sum_{j=1}^{|V|} \sum_{n_{ij}=（a_i+b_j-N）^+ }^{\min（a_i， b_j）} \frac{n_{ij}}{N}\log \left（ \frac{ N.n_{ij}}{a_i b_j}\right） \frac{a_i！b_j！（ N-a_i）！ （N-b_j）！} {N！n_{ij}！ （a_i-n_{ij}）！ （b_j-n_{ij}）！ （N-a_i-b_j+n_{ij}）！} ]</p>
<p>Using the expected value, the adjusted mutual information can then be calculated using a similar form to that of the adjusted Rand index:<br>
使用期望值，可以使用与调整后的兰德指数类似的形式计算调整后的互信息：</p>
<p>[\text{AMI} = \frac{\text{MI} - E[\text{MI}]}{\text{mean}(H(U), H(V)) - E[\text{MI}]}]<br>
[\text{AMI} = \frac{\text{MI} - E[\text{MI}]}{\text{mean}（H（U）， H（V）） - E[\text{MI}]}]</p>
<p>For normalized mutual information and adjusted mutual information, the normalizing value is typically some <em>generalized</em> mean of the entropies of each clustering. Various generalized means exist, and no firm rules exist for preferring one over the others. The decision is largely a field-by-field basis; for instance, in community detection, the arithmetic mean is most common. Each normalizing method provides “qualitatively similar behaviours” [<a href="https://scikit-learn.org/stable/modules/clustering.html#yat2016">YAT2016]</a>. In our implementation, this is controlled by the <code>average_method</code> parameter.<br>
对于归一化互信息和调整互信息，归一化值通常是每个聚类的熵的广义平均值。存在各种通用方法，并且没有确定的规则来偏爱其中一种。该决定在很大程度上是逐个领域作出的;例如，在社区检测中，算术平均值是最常见的。每种归一化方法都提供了“定性相似的行为”[YAT2016]。在我们的实现中，这是由参数控制的 <code>average_method</code> 。</p>
<p>Vinh et al. (2010) named variants of NMI and AMI by their averaging method [<a href="https://scikit-learn.org/stable/modules/clustering.html#veb2010">VEB2010]</a>. Their ‘sqrt’ and ‘sum’ averages are the geometric and arithmetic means; we use these more broadly common names.<br>
Vinh等人（2010）通过平均法命名了NMI和AMI的变体[VEB2010]。它们的“平方”和“总和”平均值是几何和算术平均值;我们使用这些更广泛通用的名称。</p>
<h3 id="homogeneity-completeness-and-v-measure-同质性-完整性和-v-measure">Homogeneity, completeness and V-measure<a href="https://scikit-learn.org/stable/modules/clustering.html#homogeneity-completeness-and-v-measure">¶</a> 同质性、完整性和 V-measure ¶</h3>
<p>Given the knowledge of the ground truth class assignments of the samples, it is possible to define some intuitive metric using conditional entropy analysis.<br>
鉴于对样本的真值类分配的了解，可以使用条件熵分析定义一些直观的指标。</p>
<p>In particular Rosenberg and Hirschberg (2007) define the following two desirable objectives for any cluster assignment:<br>
特别是，Rosenberg和Hirschberg（2007）为任何集群分配定义了以下两个理想目标：</p>
<ul>
<li><strong>homogeneity</strong>: each cluster contains only members of a single class.<br>
同质性：每个集群仅包含单个类的成员。</li>
<li><strong>completeness</strong>: all members of a given class are assigned to the same cluster.<br>
完整性：给定类的所有成员都分配到同一集群。</li>
</ul>
<p>We can turn those concept as scores <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.homogeneity_score.html#sklearn.metrics.homogeneity_score"><code>homogeneity_score</code></a> and <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.completeness_score.html#sklearn.metrics.completeness_score"><code>completeness_score</code></a>. Both are bounded below by 0.0 and above by 1.0 (higher is better):<br>
我们可以将这些概念转换为分数 <code>homogeneity_score</code> 和 <code>completeness_score</code> .两者都以 0.0 为界，高于 1.0（越高越好）：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; from sklearn import metrics</span><br><span class="line">&gt;&gt;&gt; labels_true = [0, 0, 0, 1, 1, 1]</span><br><span class="line">&gt;&gt;&gt; labels_pred = [0, 0, 1, 1, 2, 2]</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; metrics.homogeneity_score(labels_true, labels_pred)</span><br><span class="line">0.66...</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; metrics.completeness_score(labels_true, labels_pred)</span><br><span class="line">0.42...</span><br></pre></td></tr></table></figure>
<p>Their harmonic mean called <strong>V-measure</strong> is computed by <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.v_measure_score.html#sklearn.metrics.v_measure_score"><code>v_measure_score</code></a>:<br>
它们的谐波平均值称为 V-measure，计算公式为 <code>v_measure_score</code> ：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; metrics.v_measure_score(labels_true, labels_pred)</span><br><span class="line">0.51...</span><br></pre></td></tr></table></figure>
<p>This function’s formula is as follows:<br>
该函数的公式如下：</p>
<p>[v = \frac{(1 + \beta) \times \text{homogeneity} \times \text{completeness}}{(\beta \times \text{homogeneity} + \text{completeness})}]<br>
[v = \frac{（1 + \beta） \times \text{同质性} \times \text{完整性}}{（\beta \times \text{homogeneity} + \text{完整性}）}]</p>
<p><code>beta</code> defaults to a value of 1.0, but for using a value less than 1 for beta:<br>
<code>beta</code> 默认值为 1.0，但对于 beta 使用小于 1 的值：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; metrics.v_measure_score(labels_true, labels_pred, beta=0.6)</span><br><span class="line">0.54...</span><br></pre></td></tr></table></figure>
<p>more weight will be attributed to homogeneity, and using a value greater than 1:<br>
更多的权重将归因于同质性，并使用大于 1 的值：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; metrics.v_measure_score(labels_true, labels_pred, beta=1.8)</span><br><span class="line">0.48...</span><br></pre></td></tr></table></figure>
<p>more weight will be attributed to completeness.<br>
更多的权重将归因于完整性。</p>
<p>The V-measure is actually equivalent to the mutual information (NMI) discussed above, with the aggregation function being the arithmetic mean [<a href="https://scikit-learn.org/stable/modules/clustering.html#b2011">B2011]</a>.<br>
V-measure实际上等价于上面讨论的互信息（NMI），聚合函数是算术平均值[B2011]。</p>
<p>Homogeneity, completeness and V-measure can be computed at once using <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.homogeneity_completeness_v_measure.html#sklearn.metrics.homogeneity_completeness_v_measure"><code>homogeneity_completeness_v_measure</code></a> as follows:<br>
同质性、完整性和 V 度量可以使用 <code>homogeneity_completeness_v_measure</code> 以下方法同时计算：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; metrics.homogeneity_completeness_v_measure(labels_true, labels_pred)</span><br><span class="line">(0.66..., 0.42..., 0.51...)</span><br></pre></td></tr></table></figure>
<p>The following clustering assignment is slightly better, since it is homogeneous but not complete:<br>
以下聚类分配稍微好一些，因为它是同质的，但不完整：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; labels_pred = [0, 0, 0, 1, 2, 2]</span><br><span class="line">&gt;&gt;&gt; metrics.homogeneity_completeness_v_measure(labels_true, labels_pred)</span><br><span class="line">(1.0, 0.68..., 0.81...)</span><br></pre></td></tr></table></figure>
<p>Note 注意</p>
<p><a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.v_measure_score.html#sklearn.metrics.v_measure_score"><code>v_measure_score</code></a> is <strong>symmetric</strong>: it can be used to evaluate the <strong>agreement</strong> of two independent assignments on the same dataset.<br>
<code>v_measure_score</code> 是对称的：它可用于评估同一数据集上两个独立赋值的一致性。</p>
<p>This is not the case for <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.completeness_score.html#sklearn.metrics.completeness_score"><code>completeness_score</code></a> and <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.homogeneity_score.html#sklearn.metrics.homogeneity_score"><code>homogeneity_score</code></a>: both are bound by the relationship:<br>
<code>completeness_score</code> 但 和 <code>homogeneity_score</code> 的情况并非如此：两者都受关系的约束：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">homogeneity_score(a, b) == completeness_score(b, a)</span><br></pre></td></tr></table></figure>
<h4 id="advantages-优点">Advantages<a href="https://scikit-learn.org/stable/modules/clustering.html#id21">¶</a>  优点 ¶</h4>
<ul>
<li><strong>Bounded scores</strong>: 0.0 is as bad as it can be, 1.0 is a perfect score.<br>
有界分数：0.0 是尽可能糟糕的，1.0 是满分。</li>
<li>Intuitive interpretation: clustering with bad V-measure can be <strong>qualitatively analyzed in terms of homogeneity and completeness</strong> to better feel what ‘kind’ of mistakes is done by the assignment.<br>
直观的解释：可以根据同质性和完整性对具有不良 V 度量的聚类进行定性分析，以更好地感受作业造成的“类型”错误。</li>
<li><strong>No assumption is made on the cluster structure</strong>: can be used to compare clustering algorithms such as k-means which assumes isotropic blob shapes with results of spectral clustering algorithms which can find cluster with “folded” shapes.<br>
不对聚类结构进行任何假设：可用于比较聚类算法，例如假设各向同性斑点形状的 k-means，以及可以找到具有“折叠”形状的聚类的光谱聚类算法的结果。</li>
</ul>
<h4 id="drawbacks-缺点">Drawbacks<a href="https://scikit-learn.org/stable/modules/clustering.html#id22">¶</a>  缺点 ¶</h4>
<ul>
<li>
<p>The previously introduced metrics are <strong>not normalized with regards to random labeling</strong>: this means that depending on the number of samples, clusters and ground truth classes, a completely random labeling will not always yield the same values for homogeneity, completeness and hence v-measure. In particular <strong>random labeling won’t yield zero scores especially when the number of clusters is large</strong>.<br>
对于随机标记，前面介绍的指标没有标准化：这意味着根据样本、聚类和真值类的数量，完全随机的标记并不总是产生相同的同质性、完整性和 v 度值。特别是，随机标记不会产生零分，尤其是当聚类数量很大时。</p>
<p>This problem can safely be ignored when the number of samples is more than a thousand and the number of clusters is less than 10. <strong>For smaller sample sizes or larger number of clusters it is safer to use an adjusted index such as the Adjusted Rand Index (ARI)</strong>.<br>
当样本数超过一千个且聚类数小于 10 个时，可以安全地忽略此问题。对于较小的样本量或较多的聚类，使用调整后的指数（如调整后的兰德指数 （ARI）））更安全。</p>
</li>
</ul>
<p><a href="https://scikit-learn.org/stable/auto_examples/cluster/plot_adjusted_for_chance_measures.html"><img src="https://scikit-learn.org/stable/_images/sphx_glr_plot_adjusted_for_chance_measures_001.png" alt="img"></a></p>
<ul>
<li>These metrics <strong>require the knowledge of the ground truth classes</strong> while almost never available in practice or requires manual assignment by human annotators (as in the supervised learning setting).<br>
这些指标需要了解基本实况类，而在实践中几乎不可用，或者需要人工注释者手动分配（如在监督学习设置中）。</li>
</ul>
<h4 id="mathematical-formulation-数学公式">Mathematical formulation<a href="https://scikit-learn.org/stable/modules/clustering.html#id23">¶</a> 数学公式 ¶</h4>
<p>Homogeneity and completeness scores are formally given by:<br>
同质性和完整性分数的正式公式为：</p>
<p>[h = 1 - \frac{H(C|K)}{H©}]<br>
[h = 1 - \frac{H（C|K）}{H（C）}]</p>
<p>[c = 1 - \frac{H(K|C)}{H(K)}]<br>
[c = 1 - \frac{H（K|C）}{H（K）}]</p>
<p>where (H(C|K)) is the <strong>conditional entropy of the classes given the cluster assignments</strong> and is given by:<br>
其中 \（H（C|K）\） 是给定聚类赋值的类的条件熵，由下式给出：</p>
<p>[H(C|K) = - \sum_{c=1}^{|C|} \sum_{k=1}^{|K|} \frac{n_{c,k}}{n} \cdot \log\left(\frac{n_{c,k}}{n_k}\right)]<br>
[H（C|K） = - \sum_{c=1}^{|C|}\sum_{k=1}^{|K|}\frac{n_{c，k}}{n} \cdot \log\left（\frac{n_{c，k}}{n_k}\right）]</p>
<p>and (H©) is the <strong>entropy of the classes</strong> and is given by:<br>
\（H（C）\） 是类的熵，由下式给出：</p>
<p>[H© = - \sum_{c=1}^{|C|} \frac{n_c}{n} \cdot \log\left(\frac{n_c}{n}\right)]<br>
[H（C） = - \sum_{c=1}^{|C|}\frac{n_c}{n} \cdot \log\left（\frac{n_c}{n}\right）]</p>
<p>with (n) the total number of samples, (n_c) and (n_k) the number of samples respectively belonging to class (c) and cluster (k), and finally (n_{c,k}) the number of samples from class (c) assigned to cluster (k).<br>
其中\（n\）是样本总数，\（n_c\）和\（n_k\）分别属于类\（c\）和聚类\（k\）的样本数，最后\（n_{c，k}\）类\（c\）分配给聚类\（k\）的样本数。</p>
<p>The <strong>conditional entropy of clusters given class</strong> (H(K|C)) and the <strong>entropy of clusters</strong> (H(K)) are defined in a symmetric manner.<br>
给定类 \（H（K|C）\） 和簇 \（H（K）\） 的熵以对称方式定义。</p>
<p>Rosenberg and Hirschberg further define <strong>V-measure</strong> as the <strong>harmonic mean of homogeneity and completeness</strong>:<br>
Rosenberg 和 Hirschberg 进一步将 V-measure 定义为均匀性和完备性的谐波平均值：</p>
<p>[v = 2 \cdot \frac{h \cdot c}{h + c}]</p>
<h3 id="fowlkes-mallows-scores-fowlkes-mallows得分">Fowlkes-Mallows scores<a href="https://scikit-learn.org/stable/modules/clustering.html#fowlkes-mallows-scores">¶</a>  Fowlkes-Mallows得分 ¶</h3>
<p>The Fowlkes-Mallows index (<a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.fowlkes_mallows_score.html#sklearn.metrics.fowlkes_mallows_score"><code>sklearn.metrics.fowlkes_mallows_score</code></a>) can be used when the ground truth class assignments of the samples is known. The Fowlkes-Mallows score FMI is defined as the geometric mean of the pairwise precision and recall:<br>
Fowlkes-Mallows指数（ <code>sklearn.metrics.fowlkes_mallows_score</code> ）可用于样本的真值类分配已知的情况。Fowlkes-Mallows 评分 FMI 定义为成对精度和召回率的几何平均值：</p>
<p>[\text{FMI} = \frac{\text{TP}}{\sqrt{(\text{TP} + \text{FP}) (\text{TP} + \text{FN})}}]<br>
[\text{FMI} = \frac{\text{TP}}{\sqrt{（\text{TP} + \text{FP}） （\text{TP} + \text{FN}）}}]</p>
<p>Where <code>TP</code> is the number of <strong>True Positive</strong> (i.e. the number of pair of points that belong to the same clusters in both the true labels and the predicted labels), <code>FP</code> is the number of <strong>False Positive</strong> (i.e. the number of pair of points that belong to the same clusters in the true labels and not in the predicted labels) and <code>FN</code> is the number of <strong>False Negative</strong> (i.e the number of pair of points that belongs in the same clusters in the predicted labels and not in the true labels).<br>
其中 <code>TP</code> ，是真阳性数（即在真实标签和预测标签中属于同一聚类的对点数）， <code>FP</code> 是假阳性数（即在真实标签中属于同一聚类而不是在预测标签中的对点数）和 <code>FN</code> 假阴性数（即属于预测标签中的相同聚类，而不是真实标签中的相同聚类）。</p>
<p>The score ranges from 0 to 1. A high value indicates a good similarity between two clusters.<br>
分数范围从 0 到 1。较高的值表示两个聚类之间的相似性良好。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; from sklearn import metrics</span><br><span class="line">&gt;&gt;&gt; labels_true = [0, 0, 0, 1, 1, 1]</span><br><span class="line">&gt;&gt;&gt; labels_pred = [0, 0, 1, 1, 2, 2]</span><br><span class="line">&gt;&gt;&gt; metrics.fowlkes_mallows_score(labels_true, labels_pred)</span><br><span class="line">0.47140...</span><br></pre></td></tr></table></figure>
<p>One can permute 0 and 1 in the predicted labels, rename 2 to 3 and get the same score:<br>
可以在预测标签中置换 0 和 1，重命名 2 到 3 并获得相同的分数：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; labels_pred = [1, 1, 0, 0, 3, 3]</span><br><span class="line"></span><br><span class="line">&gt;&gt;&gt; metrics.fowlkes_mallows_score(labels_true, labels_pred)</span><br><span class="line">0.47140...</span><br></pre></td></tr></table></figure>
<p>Perfect labeling is scored 1.0:<br>
完美标签得分为 1.0：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; labels_pred = labels_true[:]</span><br><span class="line">&gt;&gt;&gt; metrics.fowlkes_mallows_score(labels_true, labels_pred)</span><br><span class="line">1.0</span><br></pre></td></tr></table></figure>
<p>Bad (e.g. independent labelings) have zero scores:<br>
不良（例如独立标签）的得分为零：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; labels_true = [0, 1, 2, 0, 3, 4, 5, 1]</span><br><span class="line">&gt;&gt;&gt; labels_pred = [1, 1, 0, 0, 2, 2, 2, 2]</span><br><span class="line">&gt;&gt;&gt; metrics.fowlkes_mallows_score(labels_true, labels_pred)</span><br><span class="line">0.0</span><br></pre></td></tr></table></figure>
<h4 id="advantages-优点">Advantages<a href="https://scikit-learn.org/stable/modules/clustering.html#id25">¶</a> 优点 ¶</h4>
<ul>
<li><strong>Random (uniform) label assignments have a FMI score close to 0.0</strong> for any value of <code>n_clusters</code> and <code>n_samples</code> (which is not the case for raw Mutual Information or the V-measure for instance).<br>
对于任何值 <code>n_clusters</code> and <code>n_samples</code> 的随机（统一）标签分配，FMI 分数接近 0.0（例如，原始互信息或 V 度量并非如此）。</li>
<li><strong>Upper-bounded at 1</strong>: Values close to zero indicate two label assignments that are largely independent, while values close to one indicate significant agreement. Further, values of exactly 0 indicate <strong>purely</strong> independent label assignments and a FMI of exactly 1 indicates that the two label assignments are equal (with or without permutation).<br>
1 处的上限：接近 0 的值表示两个标签分配在很大程度上是独立的，而接近 1 的值表示非常一致。此外，值正好为 0 表示完全独立的标签分配，而 FMI 正好为 1 表示两个标签分配相等（有或没有排列）。</li>
<li><strong>No assumption is made on the cluster structure</strong>: can be used to compare clustering algorithms such as k-means which assumes isotropic blob shapes with results of spectral clustering algorithms which can find cluster with “folded” shapes.<br>
不对聚类结构进行任何假设：可用于比较聚类算法，例如假设各向同性斑点形状的 k-means，以及可以找到具有“折叠”形状的聚类的光谱聚类算法的结果。</li>
</ul>
<h4 id="1-11-4-2-drawbacks-1-11-4-2-缺点">1.11.4.2. Drawbacks<a href="https://scikit-learn.org/stable/modules/clustering.html#id26">¶</a> 1.11.4.2. 缺点 ¶</h4>
<ul>
<li>Contrary to inertia, <strong>FMI-based measures require the knowledge of the ground truth classes</strong> while almost never available in practice or requires manual assignment by human annotators (as in the supervised learning setting).<br>
与惯性相反，基于 FMI 的测量需要了解基本实况类，而在实践中几乎不可用，或者需要人工注释者手动分配（如在监督学习设置中）。</li>
</ul>
<h3 id="silhouette-coefficient-轮廓系数">Silhouette Coefficient<a href="https://scikit-learn.org/stable/modules/clustering.html#silhouette-coefficient">¶</a> 轮廓系数 ¶</h3>
<p>If the ground truth labels are not known, evaluation must be performed using the model itself. The Silhouette Coefficient (<a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.silhouette_score.html#sklearn.metrics.silhouette_score"><code>sklearn.metrics.silhouette_score</code></a>) is an example of such an evaluation, where a higher Silhouette Coefficient score relates to a model with better defined clusters. The Silhouette Coefficient is defined for each sample and is composed of two scores:<br>
如果地面实况标签未知，则必须使用模型本身执行评估。轮廓系数 （ <code>sklearn.metrics.silhouette_score</code> ） 是此类评估的一个示例，其中较高的轮廓系数分数与具有更好定义聚类的模型相关。轮廓系数是为每个样本定义的，由两个分数组成：</p>
<ul>
<li><strong>a</strong>: The mean distance between a sample and all other points in the same class.<br>
a：样本与同一类别中所有其他点之间的平均距离。</li>
<li><strong>b</strong>: The mean distance between a sample and all other points in the <em>next nearest cluster</em>.<br>
b：样本与下一个最近聚类中所有其他点之间的平均距离。</li>
</ul>
<p>The Silhouette Coefficient <em>s</em> for a single sample is then given as:<br>
然后，单个样本的轮廓系数 s 为：</p>
<p>[s = \frac{b - a}{max(a, b)}]<br>
[s = \frac{b - a}{max（a， b）}]</p>
<p>The Silhouette Coefficient for a set of samples is given as the mean of the Silhouette Coefficient for each sample.<br>
一组样本的轮廓系数是每个样本的轮廓系数的平均值。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; from sklearn import metrics</span><br><span class="line">&gt;&gt;&gt; from sklearn.metrics import pairwise_distances</span><br><span class="line">&gt;&gt;&gt; from sklearn import datasets</span><br><span class="line">&gt;&gt;&gt; X, y = datasets.load_iris(return_X_y=True)</span><br></pre></td></tr></table></figure>
<p>In normal usage, the Silhouette Coefficient is applied to the results of a cluster analysis.<br>
在正常使用中，轮廓系数应用于聚类分析的结果。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; import numpy as np</span><br><span class="line">&gt;&gt;&gt; from sklearn.cluster import KMeans</span><br><span class="line">&gt;&gt;&gt; kmeans_model = KMeans(n_clusters=3, random_state=1).fit(X)</span><br><span class="line">&gt;&gt;&gt; labels = kmeans_model.labels_</span><br><span class="line">&gt;&gt;&gt; metrics.silhouette_score(X, labels, metric=&#x27;euclidean&#x27;)</span><br><span class="line">0.55...</span><br></pre></td></tr></table></figure>
<h4 id="advantages-优点">Advantages<a href="https://scikit-learn.org/stable/modules/clustering.html#id28">¶</a> 优点 ¶</h4>
<ul>
<li>The score is bounded between -1 for incorrect clustering and +1 for highly dense clustering. Scores around zero indicate overlapping clusters.<br>
分数介于 -1（对于不正确的聚类）和 +1（对于高密度聚类）之间。分数接近零表示聚类重叠。</li>
<li>The score is higher when clusters are dense and well separated, which relates to a standard concept of a cluster.<br>
当聚类密集且分离良好时，分数会更高，这与聚类的标准概念有关。</li>
</ul>
<h4 id="drawbacks-缺点">Drawbacks<a href="https://scikit-learn.org/stable/modules/clustering.html#id29">¶</a>  缺点 ¶</h4>
<ul>
<li>The Silhouette Coefficient is generally higher for convex clusters than other concepts of clusters, such as density based clusters like those obtained through DBSCAN.<br>
凸簇的轮廓系数通常高于其他簇的概念，例如通过 DBSCAN 获得的基于密度的簇。</li>
</ul>
<h3 id="calinski-harabasz-index-calinski-harabasz-索引">Calinski-Harabasz Index<a href="https://scikit-learn.org/stable/modules/clustering.html#calinski-harabasz-index">¶</a>  Calinski-Harabasz 索引 ¶</h3>
<p>If the ground truth labels are not known, the Calinski-Harabasz index (<a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.calinski_harabasz_score.html#sklearn.metrics.calinski_harabasz_score"><code>sklearn.metrics.calinski_harabasz_score</code></a>) - also known as the Variance Ratio Criterion - can be used to evaluate the model, where a higher Calinski-Harabasz score relates to a model with better defined clusters.<br>
如果真值标签未知，则可以使用 Calinski-Harabasz 指数 （ <code>sklearn.metrics.calinski_harabasz_score</code> ） - 也称为方差比准则 - 用于评估模型，其中较高的 Calinski-Harabasz 分数与具有更好定义的聚类的模型相关。</p>
<p>The index is the ratio of the sum of between-clusters dispersion and of within-cluster dispersion for all clusters (where dispersion is defined as the sum of distances squared):<br>
该指数是所有聚类的簇间离散度和簇内色散之和的比率（其中色散定义为距离的平方和）：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; from sklearn import metrics</span><br><span class="line">&gt;&gt;&gt; from sklearn.metrics import pairwise_distances</span><br><span class="line">&gt;&gt;&gt; from sklearn import datasets</span><br><span class="line">&gt;&gt;&gt; X, y = datasets.load_iris(return_X_y=True)</span><br></pre></td></tr></table></figure>
<p>In normal usage, the Calinski-Harabasz index is applied to the results of a cluster analysis:<br>
在正常用法中，Calinski-Harabasz 指数应用于聚类分析的结果：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; import numpy as np</span><br><span class="line">&gt;&gt;&gt; from sklearn.cluster import KMeans</span><br><span class="line">&gt;&gt;&gt; kmeans_model = KMeans(n_clusters=3, random_state=1).fit(X)</span><br><span class="line">&gt;&gt;&gt; labels = kmeans_model.labels_</span><br><span class="line">&gt;&gt;&gt; metrics.calinski_harabasz_score(X, labels)</span><br><span class="line">561.62...</span><br></pre></td></tr></table></figure>
<h4 id="advantages-优点">Advantages<a href="https://scikit-learn.org/stable/modules/clustering.html#id31">¶</a> 优点 ¶</h4>
<ul>
<li>The score is higher when clusters are dense and well separated, which relates to a standard concept of a cluster.<br>
当聚类密集且分离良好时，分数会更高，这与聚类的标准概念有关。</li>
<li>The score is fast to compute.<br>
分数计算速度很快。</li>
</ul>
<h4 id="drawbacks-缺点">Drawbacks<a href="https://scikit-learn.org/stable/modules/clustering.html#id32">¶</a> 缺点 ¶</h4>
<ul>
<li>The Calinski-Harabasz index is generally higher for convex clusters than other concepts of clusters, such as density based clusters like those obtained through DBSCAN.<br>
凸簇的 Calinski-Harabasz 指数通常高于其他簇概念，例如通过 DBSCAN 获得的基于密度的簇。</li>
</ul>
<h4 id="mathematical-formulation-数学公式">Mathematical formulation<a href="https://scikit-learn.org/stable/modules/clustering.html#id33">¶</a>  数学公式 ¶</h4>
<p>For a set of data (E) of size (n_E) which has been clustered into (k) clusters, the Calinski-Harabasz score (s) is defined as the ratio of the between-clusters dispersion mean and the within-cluster dispersion:<br>
对于已聚类成 \（k\） 个聚类的一组大小为 \（n_E\） 的数据 \（E\），Calinski-Harabasz 分数 \（s\） 定义为聚类间离散均值与聚类内离散度的比值：</p>
<p>[s = \frac{\mathrm{tr}(B_k)}{\mathrm{tr}(W_k)} \times \frac{n_E - k}{k - 1}]<br>
[s = \frac{\mathrm{tr}（B_k）}{\mathrm{tr}（W_k）} \times \frac{n_E - k}{k - 1}]</p>
<p>where (\mathrm{tr}(B_k)) is trace of the between group dispersion matrix and (\mathrm{tr}(W_k)) is the trace of the within-cluster dispersion matrix defined by:<br>
其中 \（\mathrm{tr}（B_k）\） 是群间色散矩阵的迹线，\（\mathrm{tr}（W_k）\） 是簇内色散矩阵的迹线，定义如下：</p>
<p>[W_k = \sum_{q=1}^k \sum_{x \in C_q} (x - c_q) (x - c_q)^T]<br>
[W_k = \sum_{q=1}^k \sum_{x \in C_q} （x - c_q） （x - c_q）^T]</p>
<p>[B_k = \sum_{q=1}^k n_q (c_q - c_E) (c_q - c_E)^T]<br>
[B_k = \sum_{q=1}^k n_q （c_q - c_E） （c_q - c_E）^T]</p>
<p>with (C_q) the set of points in cluster (q), (c_q) the center of cluster (q), (c_E) the center of (E), and (n_q) the number of points in cluster (q).<br>
其中\（C_q\）是聚类\（q\）中的点集，\（c_q\）是聚类\（q\）的中心，\（c_E\）是\（E\）的中心，\（n_q\）是聚类\（q\）中的点数。</p>
<h3 id="davies-bouldin-index-davies-bouldin指数">Davies-Bouldin Index<a href="https://scikit-learn.org/stable/modules/clustering.html#davies-bouldin-index">¶</a> Davies-Bouldin指数 ¶</h3>
<p>If the ground truth labels are not known, the Davies-Bouldin index (<a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.davies_bouldin_score.html#sklearn.metrics.davies_bouldin_score"><code>sklearn.metrics.davies_bouldin_score</code></a>) can be used to evaluate the model, where a lower Davies-Bouldin index relates to a model with better separation between the clusters.<br>
如果真值标签未知，则 Davies-Bouldin 指数 （ <code>sklearn.metrics.davies_bouldin_score</code> ） 可用于评估模型，其中较低的 Davies-Bouldin 指数与聚类之间分离较好的模型相关。</p>
<p>This index signifies the average ‘similarity’ between clusters, where the similarity is a measure that compares the distance between clusters with the size of the clusters themselves.<br>
该指数表示聚类之间的平均“相似性”，其中相似性是将聚类之间的距离与聚类本身的大小进行比较的度量。</p>
<p>Zero is the lowest possible score. Values closer to zero indicate a better partition.<br>
零是可能的最低分数。值越接近于零，表示分区越好。</p>
<p>In normal usage, the Davies-Bouldin index is applied to the results of a cluster analysis as follows:<br>
在正常用法中，Davies-Bouldin 指数应用于聚类分析的结果，如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; from sklearn import datasets</span><br><span class="line">&gt;&gt;&gt; iris = datasets.load_iris()</span><br><span class="line">&gt;&gt;&gt; X = iris.data</span><br><span class="line">&gt;&gt;&gt; from sklearn.cluster import KMeans</span><br><span class="line">&gt;&gt;&gt; from sklearn.metrics import davies_bouldin_score</span><br><span class="line">&gt;&gt;&gt; kmeans = KMeans(n_clusters=3, random_state=1).fit(X)</span><br><span class="line">&gt;&gt;&gt; labels = kmeans.labels_</span><br><span class="line">&gt;&gt;&gt; davies_bouldin_score(X, labels)</span><br><span class="line">0.6619...</span><br></pre></td></tr></table></figure>
<h4 id="advantages-优点">Advantages<a href="https://scikit-learn.org/stable/modules/clustering.html#id35">¶</a>  优点 ¶</h4>
<ul>
<li>The computation of Davies-Bouldin is simpler than that of Silhouette scores.<br>
Davies-Bouldin 的计算比 Silhouette 分数的计算更简单。</li>
<li>The index is solely based on quantities and features inherent to the dataset as its computation only uses point-wise distances.<br>
该指数仅基于数据集固有的数量和特征，因为其计算仅使用逐点距离。</li>
</ul>
<h4 id="drawbacks-缺点">Drawbacks<a href="https://scikit-learn.org/stable/modules/clustering.html#id36">¶</a> 缺点 ¶</h4>
<ul>
<li>The Davies-Boulding index is generally higher for convex clusters than other concepts of clusters, such as density based clusters like those obtained from DBSCAN.<br>
凸聚类的 Davies-Boulding 指数通常高于其他聚类概念，例如基于 密度的聚类，例如从 DBSCAN 获得的聚类。</li>
<li>The usage of centroid distance limits the distance metric to Euclidean space.<br>
质心距离的使用将距离度量限制为欧几里得空间。</li>
</ul>
<h4 id="mathematical-formulation-数学公式">Mathematical formulation<a href="https://scikit-learn.org/stable/modules/clustering.html#id37">¶</a> 数学公式 ¶</h4>
<p>The index is defined as the average similarity between each cluster (C_i) for (i=1, …, k) and its most similar one (C_j). In the context of this index, similarity is defined as a measure (R_{ij}) that trades off:<br>
该指数定义为 \（i=1， …， k\） 的每个聚类 \（C_i\） 与其最相似的聚类 \（C_j\） 之间的平均相似度。在此索引的上下文中，相似性被定义为权衡以下因素的度量 \（R_{ij}\）：</p>
<ul>
<li>(s_i), the average distance between each point of cluster (i) and the centroid of that cluster – also know as cluster diameter.<br>
\（s_i\），簇 \（i\） 的每个点与该簇的质心之间的平均距离——也称为簇直径。</li>
<li>(d_{ij}), the distance between cluster centroids (i) and (j).<br>
\（d_{ij}\），簇质心\（i\）和\（j\）之间的距离。</li>
</ul>
<p>A simple choice to construct (R_{ij}) so that it is nonnegative and symmetric is:<br>
构造\（R_{ij}\）以使其为非负和对称的简单选择是：</p>
<p>[R_{ij} = \frac{s_i + s_j}{d_{ij}}]</p>
<p>Then the Davies-Bouldin index is defined as:<br>
那么 Davies-Bouldin 指数定义为：</p>
<p>[DB = \frac{1}{k} \sum_{i=1}^k \max_{i \neq j} R_{ij}]</p>
<h3 id="contingency-matrix-列联矩阵">Contingency Matrix<a href="https://scikit-learn.org/stable/modules/clustering.html#contingency-matrix">¶</a>  列联矩阵 ¶</h3>
<p>Contingency matrix (<a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.cluster.contingency_matrix.html#sklearn.metrics.cluster.contingency_matrix"><code>sklearn.metrics.cluster.contingency_matrix</code></a>) reports the intersection cardinality for every true/predicted cluster pair. The contingency matrix provides sufficient statistics for all clustering metrics where the samples are independent and identically distributed and one doesn’t need to account for some instances not being clustered.<br>
列联矩阵 （ <code>sklearn.metrics.cluster.contingency_matrix</code> ） 报告每个真实/预测聚类对的交集基数。列联矩阵为所有聚类指标提供了足够的统计数据，其中样本是独立且分布相同的，并且不需要考虑某些未聚类的实例。</p>
<p>Here is an example:<br>
下面是一个示例：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; from sklearn.metrics.cluster import contingency_matrix</span><br><span class="line">&gt;&gt;&gt; x = [&quot;a&quot;, &quot;a&quot;, &quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;]</span><br><span class="line">&gt;&gt;&gt; y = [0, 0, 1, 1, 2, 2]</span><br><span class="line">&gt;&gt;&gt; contingency_matrix(x, y)</span><br><span class="line">array([[2, 1, 0],</span><br><span class="line">       [0, 1, 2]])</span><br></pre></td></tr></table></figure>
<p>The first row of output array indicates that there are three samples whose true cluster is “a”. Of them, two are in predicted cluster 0, one is in 1, and none is in 2. And the second row indicates that there are three samples whose true cluster is “b”. Of them, none is in predicted cluster 0, one is in 1 and two are in 2.<br>
输出数组的第一行表示有三个样本，其真实聚类为“a”。其中，两个在预测的聚类 0 中，一个在聚类 1 中，没有一个在聚类 2 中。第二行表示有三个样本，其真实聚类为“b”。其中，没有一个在预测的聚类 0 中，一个在 1 中，两个在 2 中。</p>
<p>A <a href="https://scikit-learn.org/stable/modules/model_evaluation.html#confusion-matrix">confusion matrix</a> for classification is a square contingency matrix where the order of rows and columns correspond to a list of classes.<br>
用于分类的混淆矩阵是一个方形列联矩阵，其中行和列的顺序对应于类列表。</p>
<h4 id="advantages-优点">Advantages<a href="https://scikit-learn.org/stable/modules/clustering.html#id39">¶</a>  优点 ¶</h4>
<ul>
<li>Allows to examine the spread of each true cluster across predicted clusters and vice versa.<br>
允许检查每个真实聚类在预测聚类中的分布，反之亦然。</li>
<li>The contingency table calculated is typically utilized in the calculation of a similarity statistic (like the others listed in this document) between the two clusterings.<br>
计算的列联表通常用于计算两个聚类之间的相似性统计量（如本文档中列出的其他统计量）。</li>
</ul>
<h4 id="drawbacks-缺点">Drawbacks<a href="https://scikit-learn.org/stable/modules/clustering.html#id40">¶</a> 缺点 ¶</h4>
<ul>
<li>Contingency matrix is easy to interpret for a small number of clusters, but becomes very hard to interpret for a large number of clusters.<br>
列联矩阵对于少量聚类很容易解释，但对于大量聚类则变得非常困难。</li>
<li>It doesn’t give a single metric to use as an objective for clustering optimisation.<br>
它没有提供一个指标作为聚类优化的目标。</li>
</ul>
<h3 id="pair-confusion-matrix-对混淆矩阵">Pair Confusion Matrix<a href="https://scikit-learn.org/stable/modules/clustering.html#pair-confusion-matrix">¶</a>  对混淆矩阵 ¶</h3>
<p>The pair confusion matrix (<a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.cluster.pair_confusion_matrix.html#sklearn.metrics.cluster.pair_confusion_matrix"><code>sklearn.metrics.cluster.pair_confusion_matrix</code></a>) is a 2x2 similarity matrix<br>
对混淆矩阵 （ <code>sklearn.metrics.cluster.pair_confusion_matrix</code> ） 是一个 2x2 的相似性矩阵</p>
<p>[\begin{split}C = \left[\begin{matrix} C_{00} &amp; C_{01} \ C_{10} &amp; C_{11} \end{matrix}\right]\end{split}]</p>
<p>between two clusterings computed by considering all pairs of samples and counting pairs that are assigned into the same or into different clusters under the true and predicted clusterings.<br>
通过考虑所有样本对并计数在真实聚类和预测聚类下分配到相同或不同聚类中的对来计算的两个聚类之间。</p>
<p>It has the following entries:<br>
它包含以下条目：</p>
<p>(C_{00}) : number of pairs with both clusterings having the samples not clustered together<br>
\（C_{00}\） ： 两个聚类的样本未聚类在一起的对数</p>
<p>(C_{10}) : number of pairs with the true label clustering having the samples clustered together but the other clustering not having the samples clustered together<br>
\（C_{10}\） ： 具有真实标签聚类的对数，这些聚类的样本聚类在一起，但另一个聚类没有将样本聚类在一起</p>
<p>(C_{01}) : number of pairs with the true label clustering not having the samples clustered together but the other clustering having the samples clustered together<br>
\（C_{01}\） ： 具有真实标签聚类的对数，没有将样本聚类在一起，但另一个聚类将样本聚类在一起</p>
<p>(C_{11}) : number of pairs with both clusterings having the samples clustered together<br>
\（C_{11}\） ： 两个聚类的对数，样本聚类在一起</p>
<p>Considering a pair of samples that is clustered together a positive pair, then as in binary classification the count of true negatives is (C_{00}), false negatives is (C_{10}), true positives is (C_{11}) and false positives is (C_{01}).<br>
考虑一对样本聚集在一起的正对，那么在二元分类中，真阴性的计数是\（C_{00}\），假阴性是\（C_{10}\），真阳性是\（C_{11}\），假阳性是\（C_{01}\）。</p>
<p>Perfectly matching labelings have all non-zero entries on the diagonal regardless of actual label values:<br>
完全匹配的标签在对角线上具有所有非零条目，而不管实际标签值如何：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; from sklearn.metrics.cluster import pair_confusion_matrix</span><br><span class="line">&gt;&gt;&gt; pair_confusion_matrix([0, 0, 1, 1], [0, 0, 1, 1])</span><br><span class="line">array([[8, 0],</span><br><span class="line">       [0, 4]])</span><br><span class="line">&gt;&gt;&gt; pair_confusion_matrix([0, 0, 1, 1], [1, 1, 0, 0])</span><br><span class="line">array([[8, 0],</span><br><span class="line">       [0, 4]])</span><br></pre></td></tr></table></figure>
<p>Labelings that assign all classes members to the same clusters are complete but may not always be pure, hence penalized, and have some off-diagonal non-zero entries:<br>
将所有类成员分配给同一聚类的标签是完整的，但可能并不总是纯的，因此会受到惩罚，并且有一些非对角线的非零条目：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; pair_confusion_matrix([0, 0, 1, 2], [0, 0, 1, 1])</span><br><span class="line">array([[8, 2],</span><br><span class="line">       [0, 2]])</span><br></pre></td></tr></table></figure>
<p>The matrix is not symmetric:<br>
矩阵不对称：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; pair_confusion_matrix([0, 0, 1, 1], [0, 0, 1, 2])</span><br><span class="line">array([[8, 0],</span><br><span class="line">       [2, 2]])</span><br></pre></td></tr></table></figure>
<p>If classes members are completely split across different clusters, the assignment is totally incomplete, hence the matrix has all zero diagonal entries:<br>
如果类成员完全拆分到不同的聚类中，则赋值是完全不完整的，因此矩阵的对角线条目全部为零：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt;&gt;&gt; pair_confusion_matrix([0, 0, 0, 0], [0, 1, 2, 3])</span><br><span class="line">array([[ 0,  0],</span><br><span class="line">       [12,  0]])</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>clustering</tag>
      </tags>
  </entry>
  <entry>
    <title>Linear_programming</title>
    <url>/2023/05/31/Linear-programming/</url>
    <content><![CDATA[<p>[TOC]</p>
<p><strong>说在前面——线性规划的解本质上就是找到单纯形的顶点，并且定位顶点在哪里，那么其解的组成部分就包括两部分，前半部分代表顶点坐标，后半部分代表定位该坐标的数值信息，其实就是顶点坐标到超平面的截距。</strong></p>
<h1>线性规划</h1>
<p>1939年，苏联学者Kantorovich为前苏联政府解决生产、优化等问题时提出了极值问题，并且提出了解乘数法的新方法，可惜他的工作在当时并未引起足够的重视。事实上，他所提出的问题正是线性规划的雏形。</p>
<p>与此同时，美国的线性规划研究获得了飞快的发展。1941年，Hitchcock提出运输问题；1945年，Stigler提出了营养问题；1947年，Koopmans提出了经济问题。而奠定线性规划整套理论方法的，还要说是G.B.Dantzig，他被誉为“线性规划之父”。他在1947年担任美国空军审计官的数学顾问，为找到解决问题的机制化工具，提出了“在一组线性方程或不等式约束下，求某一线性形式极小值问题的数学模型”，这便是“线性规划”（linear programming）这一经典优化模型。同年夏天，Dantzig提出了该问题的通用解法——<strong>单纯形算法</strong>(Simplex method)。这个算法在后来被评为20世纪最伟大的算法之一。而“线性规划”这一名字的由来是在之后1948年，Koopmans和Dantzig在海滩散步时共同想出的。</p>
<p>尽管单纯形法作为解决线性规划的有效方法在学术界具有统治地位，但是1971年，Klee和Minty两位学者构造出一个例子，该例子下单纯形法的运作需要访问指数数量级别的顶点，也就是说，<strong>在最坏情况下，单纯形法是一个指数时间算法(exponential-time algorithm)</strong>。Dantzig在得知这个消息后感叹到他的噩梦到来了，单纯形法并不是在任何情况下都是高效可行的。那么，是否有更加高效的算法，比如多项式时间算法(polynomial-time algorithm)，来解决线性规划问题呢？8年后，即1979年，L.G.Khachiyan发明了椭球算法(ellipsoid method)，这是第一个解决线性规划问题的多项式时间算法。但是，这个算法虽然理论上是多项式时间运行，但是算法被证明是不切实际的，这个算法的杰出贡献是在理论层面告诉世人，线性规划是可以用多项式时间算法来解决的，同时也启发了学者在更加深入的优化领域进行算法开发。1984年，N.Karmarkar发明了内点算法(interior point method)，这是线性规划第一个实际可用的多项式时间算法。</p>
<p>以上摘自：李崇楠CSDN博客，【运筹OR帷幄】社区</p>
<h2 id="线性规划标准形式">线性规划标准形式</h2>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><munder><mo><mi>min</mi><mo>⁡</mo></mo><mi>x</mi></munder><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msup><mi>c</mi><mi>T</mi></msup><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>s.t.</mtext><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>A</mi><mi>x</mi><mo>≤</mo><mi>b</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>x</mi><mo>≥</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\min_{x} \quad &amp; c^Tx \\
\text{s.t.} \quad &amp; Ax \leq b \\
&amp; x \geq 0\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.891330999999999em;vertical-align:-2.1956654999999996em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6956655em;"><span style="top:-4.8043345em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.66786em;"><span style="top:-2.4em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-2.9643345em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">s.t.</span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-1.4643345000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1956654999999996em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.6956655em;"><span style="top:-4.8043345em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span></span></span><span style="top:-2.9643345em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault">A</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">b</span></span></span><span style="top:-1.4643345000000005em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.1956654999999996em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> 是一个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 维列向量，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span> 是一个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m \times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 的矩阵，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span> 是一个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> 维列向量，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">c</span></span></span></span> 是一个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 维列向量。这个问题的含义是，在满足 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span> 个<strong>线性不等式</strong>约束条件 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mi>x</mi><mo>≤</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Ax \leq b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8193em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">A</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span> 的前提下，最小化 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>c</mi><mi>T</mi></msup><mi>x</mi></mrow><annotation encoding="application/x-tex">c^Tx</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8413309999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault">x</span></span></span></span> 的值。另外，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x \geq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> 表示问题的解必须满足非负性条件。线性函数可以理解为每一项未知数(变量)的最高次数为1，即不会出现<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>次幂数超过1的情况。</p>
<p>实际问题中，线性规划常有着不同的形式。如最大化/最小化，绝对值约束等，这不利于算法的表示及推导**。为解决这一问题，引入线性规划的标准形，数学形式可以表示为：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>max</mi><mo>⁡</mo><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>z</mi><mo>=</mo><msub><mi>c</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>c</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>c</mi><mi>n</mi></msub><msub><mi>x</mi><mi>n</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mspace width="1em"><mrow><mi>s</mi><mi mathvariant="normal">.</mi><mi>t</mi><mi mathvariant="normal">.</mi></mrow><mspace width="1em"></mspace></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>a</mi><mn>11</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>12</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>a</mi><mrow><mn>1</mn><mi>n</mi></mrow></msub><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><msub><mi>b</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>a</mi><mn>21</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mn>22</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>a</mi><mrow><mn>2</mn><mi>n</mi></mrow></msub><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><msub><mi>b</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mspace width="1em"><mi><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>a</mi><mrow><mi>m</mi><mn>1</mn></mrow></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>a</mi><mrow><mi>m</mi><mn>2</mn></mrow></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><msub><mi>a</mi><mrow><mi>m</mi><mi>n</mi></mrow></msub><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><msub><mi>b</mi><mi>m</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>x</mi><mn>1</mn></msub><mo>≥</mo><mn>0</mn><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>≥</mo><mn>0</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><msub><mi>x</mi><mi>n</mi></msub><mo>≥</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\max\quad &amp; z = c_1x_1+c_2x_2+\cdots+c_nx_n\\
\quad{s.t.}\quad
&amp;a_{11}x_1+a_{12}x_2+\cdots+a_{1n}x_n=b_1\\
&amp;a_{21}x_1+a_{22}x_2+\cdots+a_{2n}x_n=b_2\\
&amp; \quad \vdots \\
&amp;a_{m1}x_1+a_{m2}x_2+\cdots+a_{mn}x_n=b_m\\
&amp; x_1 \geq 0, x_2 \geq 0, \cdots, x_n \geq 0  
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:9.66em;vertical-align:-4.580000000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.08em;"><span style="top:-7.74em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="mop">max</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-6.239999999999999em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord">.</span><span class="mord mathdefault">t</span><span class="mord">.</span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-4.739999999999998em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"></span></span><span style="top:-2.5799999999999983em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"></span></span><span style="top:-1.0799999999999983em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"></span></span><span style="top:0.4200000000000008em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.580000000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:5.08em;"><span style="top:-7.9275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-6.427499999999999em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.927499999999998em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999983em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span><span style="top:-1.2674999999999983em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:0.23250000000000082em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:4.580000000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="线性规划适用范围">线性规划适用范围</h2>
<ol>
<li>目标函数的系数是固定的常数</li>
<li>要求决策变量非负数</li>
<li>线性约束中的常数与决策变量的系数，都是已知且保持不变的常数。如果参数会变化的，且变化范围已知，就要进行鲁棒优化(robust optimization)、随机优化(stochastic optimization)等</li>
</ol>
<h2 id="线性模型等效转化">线性模型等效转化</h2>
<p>如果有一个非标准形的线性规划，那么如何等效地转化为标准形，下面是非标转化的例子：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>min</mi><mo>⁡</mo><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>3</mn><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><mn>4</mn><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mn>3</mn></msub><mi mathvariant="normal">∣</mi><mspace width="1em"></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mspace width="1em"><mrow><mi>s</mi><mi mathvariant="normal">.</mi><mi>t</mi><mi mathvariant="normal">.</mi></mrow><mspace width="1em"></mspace></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mn>2</mn></msub><mi mathvariant="normal">∣</mi><mo>≤</mo><mo>−</mo><mn>5</mn><mspace width="1em"></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>3</mn><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msub><mi>x</mi><mn>3</mn></msub><mo>≥</mo><mn>6</mn><mspace width="1em"></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><mn>12</mn><mspace width="1em"></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>≥</mo><mn>0</mn><mspace width="1em"></mspace></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\min\quad &amp; 3x_1-2x_2-4|x_3|  \quad \\
\quad{s.t.}\quad
&amp;-x_1+2|x_2|\leq -5 \quad  \\
&amp; 3x_2-x_3 \geq 6 \quad  \\
&amp; 2x_1+x_3=12 \quad  \\
&amp; x_1,x_2 \geq 0  \quad
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.500000000000002em;vertical-align:-3.5000000000000018em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4em;"><span style="top:-6.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">min</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-4.659999999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord">.</span><span class="mord mathdefault">t</span><span class="mord">.</span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-3.1599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.6599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.15999999999999837em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5000000000000018em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4em;"><span style="top:-6.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">4</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-4.659999999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">5</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-3.1599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">6</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-1.6599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-0.15999999999999837em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:1em;"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5000000000000018em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="目标函数最大化">目标函数最大化</h3>
<p>针对目标函数是最小化的模型我可以将原问题的<strong>目标函数乘以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">−</span><span class="mord">1</span></span></span></span></strong>，并最大化这个新的目标函数。在本例中，目标函数可以转化为</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>max</mi><mo>⁡</mo><mspace width="1em"><mo>−</mo><mn>3</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mn>4</mn><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mn>3</mn></msub><mi mathvariant="normal">∣</mi></mspace></mrow><annotation encoding="application/x-tex">\max\quad -3x_1+2x_2+4|x_3|
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mop">max</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mord">−</span><span class="mord">3</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">4</span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span></span></p>
<h3 id="消除约束">消除约束</h3>
<p>引入松弛变量（slack variable）松弛变量均满足非负约束。对“小于等于约束”，我们加上一个松弛变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">s_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>；对“大于等于约束”，我们减去松弛变量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">s_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。不等式约束都转换成了等式约束：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msub><mi>x</mi><mn>3</mn></msub><mo>−</mo><msub><mi>s</mi><mn>2</mn></msub><mo>=</mo><mn>6</mn></mrow><annotation encoding="application/x-tex">3x_2-x_3-s_2=6
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span></span></span></span></span></p>
<h3 id="消除自由变量">消除自由变量</h3>
<p>在转换的时候，需要对绝对值符号内的项进行正负号判断，将原本含有绝对值符号的式子拆分成两个不含绝对值符号的式子。考虑到绝对值符号可能出现在目标函数中，也可能出现在约束条件中，接下来我们给出两种示例。</p>
<h4 id="情况1：目标函数有绝对值">情况1：目标函数有绝对值</h4>
<p>本例中目标函数值的第三项含有绝对值符号<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mn>3</mn></msub><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|x_3|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span></span></span></span>,其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">x_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为自由变量。我们引入两个变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mn>3</mn><mo>+</mo></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mn>3</mn><mo>−</mo></msubsup></mrow><annotation encoding="application/x-tex">x_3^+,x_3^-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0777700000000001em;vertical-align:-0.266308em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.266308em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.266308em;"><span></span></span></span></span></span></span></span></span></span> ,定义为:</p>
<p class="katex-block katex-error" title="ParseError: KaTeX parse error: Can&#039;t use function &#039;$&#039; in math mode at position 51: …}
x_3&amp;\quad{if $̲x_3\geq0$}\\\\
…">\begin{aligned}
x_3^+=
\begin{cases}
x_3&amp;\quad{if $x_3\geq0$}\\\\
0&amp;\quad{otherwise}
\end{cases}
\end{aligned}
</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><msubsup><mi>x</mi><mn>3</mn><mo>−</mo></msubsup><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><msub><mi>x</mi><mn>3</mn></msub></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"><mrow><mi>i</mi><mi>f</mi><msub><mi>x</mi><mn>3</mn></msub><mo>≤</mo><mn>0</mn></mrow></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"><mrow><mi>o</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>w</mi><mi>i</mi><mi>s</mi><mi>e</mi></mrow></mspace></mrow></mstyle></mtd></mtr></mtable></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
x_3^-=
\begin{cases}
-x_3&amp;\quad{if x_3\leq0}\\
0&amp;\quad{otherwise}
\end{cases}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.30003em;vertical-align:-1.400015em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.900015em;"><span style="top:-3.9000150000000002em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">i</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.400015em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>由变量定义可知，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>x</mi><mn>3</mn><mo>+</mo></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mn>3</mn><mo>−</mo></msubsup></mrow><annotation encoding="application/x-tex">x_3^+,x_3^-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0777700000000001em;vertical-align:-0.266308em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.266308em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.266308em;"><span></span></span></span></span></span></span></span></span></span>一定都是非负的，并且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>3</mn></msub><mo>=</mo><msubsup><mi>x</mi><mn>3</mn><mo>+</mo></msubsup><mo>−</mo><msubsup><mi>x</mi><mn>3</mn><mo>−</mo></msubsup><mo separator="true">,</mo><mi mathvariant="normal">∣</mi><msub><mi>x</mi><mn>3</mn></msub><mi mathvariant="normal">∣</mi><mo>=</mo><msubsup><mi>x</mi><mn>3</mn><mo>+</mo></msubsup><mo>+</mo><msubsup><mi>x</mi><mn>3</mn><mo>−</mo></msubsup></mrow><annotation encoding="application/x-tex">x_3=x_3^+-x_3^-,|x_3|=x_3^++x_3^-</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0777700000000001em;vertical-align:-0.266308em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.266308em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0777700000000001em;vertical-align:-0.266308em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.266308em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">∣</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0777700000000001em;vertical-align:-0.266308em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.266308em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0777700000000001em;vertical-align:-0.266308em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.811462em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.266308em;"><span></span></span></span></span></span></span></span></span></span>。 <strong>此外，要注意二次约束(quadratic constraint)的情况</strong></p>
<p>情况2：约束条件有绝对值</p>
<p>1、转化</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>≤</mo><mo>−</mo><mn>5</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"><mrow><mi>i</mi><mi>f</mi><mspace width="1em"><msub><mi>x</mi><mn>2</mn></msub><mo>≥</mo><mn>0</mn></mspace></mrow></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>≤</mo><mo>−</mo><mn>5</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mspace width="1em"><mrow><mi>i</mi><mi>f</mi><mspace width="1em"><msub><mi>x</mi><mn>2</mn></msub><mo>≤</mo><mn>0</mn></mspace></mrow></mspace></mrow></mstyle></mtd></mtr></mtable></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\begin{cases}
-x_1+2x_2\leq-5&amp;\quad{if\quad x_2 \geq 0}\\
-x_1-2x_2\leq-5&amp;\quad{if\quad x_2 \leq 0}
\end{cases}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.30003em;vertical-align:-1.400015em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.900015em;"><span style="top:-3.9000150000000002em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">5</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">5</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.400015em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>2、消除约束</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right" columnspacing><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>s</mi><mn>1</mn></msub><mo>=</mo><mo>−</mo><mn>5</mn><mspace width="1em"><mrow><mi>i</mi><mi>f</mi><mspace width="1em"><msub><mi>x</mi><mn>2</mn></msub><mo>≥</mo><mn>0</mn></mspace></mrow></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>s</mi><mn>1</mn></msub><mo>=</mo><mo>−</mo><mn>5</mn><mspace width="1em"><mrow><mi>i</mi><mi>f</mi><mspace width="1em"><msub><mi>x</mi><mn>2</mn></msub><mo>≤</mo><mn>0</mn></mspace></mrow></mspace></mrow></mstyle></mtd></mtr></mtable></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\begin{cases}
-x_1+2x_2+s_1=-5 \quad{if\quad x_2 \geq 0}\\
-x_1-2x_2+s_1=-5\quad{if\quad x_2 \leq 0}
\end{cases}
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.30003em;vertical-align:-1.400015em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.900015em;"><span style="top:-3.9000150000000002em;"><span class="pstrut" style="height:3.75em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">5</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">5</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.400015em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>总之可以转化为以下标准形式</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>max</mi><mo>⁡</mo><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>−</mo><mn>3</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mn>4</mn><msubsup><mi>x</mi><mn>3</mn><mo>+</mo></msubsup><mo>+</mo><mn>4</mn><msubsup><mi>x</mi><mn>3</mn><mo>−</mo></msubsup><mo>+</mo><mn>0</mn><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><mn>0</mn><msub><mi>s</mi><mn>2</mn></msub><mspace width="1em"></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mspace width="1em"><mrow><mi>s</mi><mi mathvariant="normal">.</mi><mi>t</mi><mi mathvariant="normal">.</mi></mrow><mspace width="1em"></mspace></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>s</mi><mn>1</mn></msub><mo>=</mo><mo>−</mo><mn>5</mn><mspace width="1em"></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>3</mn><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msubsup><mi>x</mi><mn>3</mn><mo>+</mo></msubsup><mo>+</mo><msubsup><mi>x</mi><mn>3</mn><mo>−</mo></msubsup><mo>−</mo><msub><mi>s</mi><mn>2</mn></msub><mo>=</mo><mn>6</mn><mspace width="1em"></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msubsup><mi>x</mi><mn>3</mn><mo>+</mo></msubsup><mo>−</mo><msubsup><mi>x</mi><mn>3</mn><mo>−</mo></msubsup><mo>=</mo><mn>12</mn><mspace width="1em"></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msubsup><mi>x</mi><mn>3</mn><mo>+</mo></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mn>3</mn><mo>−</mo></msubsup><mo separator="true">,</mo><msub><mi>s</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>2</mn></msub><mo>≥</mo><mn>0</mn><mspace width="1em"></mspace></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\max\quad &amp; -3x_1+2x_2+4x_3^++4x_3^-+0s_1+0s_2  \quad \\
\quad{s.t.}\quad
&amp;-x_1+2x_2+s_1 = -5 \quad  \\
&amp; 3x_2-x_3^++x_3^--s_2 = 6 \quad  \\
&amp; 2x_1+x_3^+-x_3^-=12 \quad  \\
&amp; x_1,x_2,x_3^+,x_3^-,s_1,s_2 \geq 0  \quad
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.500000000000002em;vertical-align:-3.5000000000000018em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4em;"><span style="top:-6.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">max</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-4.659999999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord">.</span><span class="mord mathdefault">t</span><span class="mord">.</span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-3.1599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.6599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.15999999999999837em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5000000000000018em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4em;"><span style="top:-6.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">4</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">4</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-4.659999999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">5</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-3.1599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">6</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-1.6599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-0.15999999999999837em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:1em;"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5000000000000018em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>或：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>max</mi><mo>⁡</mo><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>−</mo><mn>3</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mn>4</mn><msubsup><mi>x</mi><mn>3</mn><mo>+</mo></msubsup><mo>+</mo><mn>4</mn><msubsup><mi>x</mi><mn>3</mn><mo>−</mo></msubsup><mo>+</mo><mn>0</mn><msub><mi>s</mi><mn>1</mn></msub><mo>+</mo><mn>0</mn><msub><mi>s</mi><mn>2</mn></msub><mspace width="1em"></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mspace width="1em"><mrow><mi>s</mi><mi mathvariant="normal">.</mi><mi>t</mi><mi mathvariant="normal">.</mi></mrow><mspace width="1em"></mspace></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>s</mi><mn>1</mn></msub><mo>=</mo><mo>−</mo><mn>5</mn><mspace width="1em"></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>3</mn><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><msubsup><mi>x</mi><mn>3</mn><mo>+</mo></msubsup><mo>+</mo><msubsup><mi>x</mi><mn>3</mn><mo>−</mo></msubsup><mo>−</mo><msub><mi>s</mi><mn>2</mn></msub><mo>=</mo><mn>6</mn><mspace width="1em"></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msubsup><mi>x</mi><mn>3</mn><mo>+</mo></msubsup><mo>−</mo><msubsup><mi>x</mi><mn>3</mn><mo>−</mo></msubsup><mo>=</mo><mn>12</mn><mspace width="1em"></mspace></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msubsup><mi>x</mi><mn>3</mn><mo>+</mo></msubsup><mo separator="true">,</mo><msubsup><mi>x</mi><mn>3</mn><mo>−</mo></msubsup><mo separator="true">,</mo><msub><mi>s</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>2</mn></msub><mo>≥</mo><mn>0</mn><mspace width="1em"></mspace></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\max\quad &amp; -3x_1+2x_2+4x_3^++4x_3^-+0s_1+0s_2  \quad \\
\quad{s.t.}\quad
&amp;-x_1-2x_2+s_1 = -5 \quad  \\
&amp; 3x_2-x_3^++x_3^--s_2 = 6 \quad  \\
&amp; 2x_1+x_3^+-x_3^-=12 \quad  \\
&amp; x_1,x_2,x_3^+,x_3^-,s_1,s_2 \geq 0  \quad
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.500000000000002em;vertical-align:-3.5000000000000018em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4em;"><span style="top:-6.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">max</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-4.659999999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="mord">.</span><span class="mord mathdefault">t</span><span class="mord">.</span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-3.1599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.6599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.15999999999999837em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5000000000000018em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4em;"><span style="top:-6.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">4</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">4</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-4.659999999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">−</span><span class="mord">5</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-3.1599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">6</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-1.6599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-0.15999999999999837em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">+</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8213309999999999em;"><span style="top:-2.4435610000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">−</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.256439em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:1em;"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5000000000000018em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h2 id="线性规划求解">线性规划求解</h2>
<h3 id="图解法">图解法</h3>
<p>图解法（Graphical Method）是一种直观的线性规划求解方法，适用于二元或三元线性规划问题。</p>
<p>该方法的基本思想是将可行域绘制成图形，并在图形上寻找最优解。对于二元线性规划问题，可以将可行域绘制成平面直角坐标系中的一个多边形。然后，可以通过计算目标函数在可行域的各个顶点处的取值，来确定最优解所对应的顶点。对于三元线性规划问题，可以将可行域绘制成三维空间中的一个多面体。然后，通过计算目标函数在可行域的各个顶点处的取值，来确定最优解所对应的顶点。虽然图解法在二元或三元线性规划问题上比较直观，但对于高维或大规模问题，绘制可行域非常困难。</p>
<h3 id="图解法步骤"><strong>图解法步骤</strong></h3>
<p><strong>建立坐标系；找半平面，找可行域；画等线值；找最优解</strong></p>
<p>几个重要概念：</p>
<h4 id="可行域和最优解"><strong>可行域和最优解</strong></h4>
<p><img src="/2023/05/31/Linear-programming/lp2.jpg" alt></p>
<h4 id="基变量与基可行解">基变量与基可行解</h4>
<p>考虑<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>个变量、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>个线性方程所构建的方程组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mtext mathvariant="bold">x</mtext><mo>=</mo><mtext mathvariant="bold">b</mtext></mrow><annotation encoding="application/x-tex">A\textbf{x}=\textbf{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord text"><span class="mord textbf">x</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord textbf">b</span></span></span></span></span>，假设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>≥</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n\ge m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span>有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">m\times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>的满秩子矩阵（该子矩阵称为<strong>基</strong>），令<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n-m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>个变量等于0，然后根据克莱姆法则可知能够求出满足<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mtext mathvariant="bold">x</mtext><mo>=</mo><mtext mathvariant="bold">b</mtext></mrow><annotation encoding="application/x-tex">A\textbf{x}=\textbf{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord text"><span class="mord textbf">x</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord textbf">b</span></span></span></span></span>的其余<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>个变量的唯一值。此时这<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>−</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">n-m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>个变量就是<strong>非基变量</strong>，其余<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>个变量就是<strong>基变量</strong>。而由上述基变量和非基变量组成的变量叫做<strong>基解</strong>。</p>
<p>如果上述讨论的线性方程组<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mtext mathvariant="bold">x</mtext><mo>=</mo><mtext mathvariant="bold">b</mtext></mrow><annotation encoding="application/x-tex">A\textbf{x}=\textbf{b}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mord text"><span class="mord textbf">x</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord textbf">b</span></span></span></span></span>的基解满足线性规划模型中的符号约束，那么它就是<strong>基可行解</strong>。</p>
<img src="/2023/05/31/Linear-programming/20200826211341954.png" style="zoom:67%;">
<p><strong>其中，基可行解通过线性变换可以得到所有的可行解</strong>，即基可行解是可行解中，<strong>线性无关</strong>（仿射独立）且<strong>主元乘积</strong>最小的集合。</p>
<h4 id="二元问题：花最少的钱-获得最多的营养">二元问题：花最少的钱，获得最多的营养</h4>
<p>首先画出两个约束条件的直线，并找出它们的交点。交点即为可行域的顶点之一。然后将目标函数的等高线绘制在可行域内，找出与目标函数等高线相切的顶点，即为最优解。</p>
<table>
<thead>
<tr>
<th>维生素</th>
<th>奶(g)中含</th>
<th>蛋(g)中含</th>
<th>每日需求</th>
</tr>
</thead>
<tbody>
<tr>
<td>Vc (mg)</td>
<td>2 x</td>
<td>4 y</td>
<td>40</td>
</tr>
<tr>
<td>Vb (mg)</td>
<td>3 x</td>
<td>2 y</td>
<td>50</td>
</tr>
<tr>
<td>单价 (US$)</td>
<td>3 x</td>
<td>2.5 y</td>
<td></td>
</tr>
</tbody>
</table>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><munder><mo><mi>min</mi><mo>⁡</mo></mo><mi>x</mi></munder><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>3</mn><mi>x</mi><mo>+</mo><mn>2.5</mn><mi>y</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>s.t.</mtext><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>2</mn><mi>x</mi><mo>+</mo><mn>4</mn><mi>y</mi><mo>≥</mo><mn>40</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>3</mn><mi>x</mi><mo>+</mo><mn>2</mn><mi>y</mi><mo>≥</mo><mn>50</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>≥</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\min_{x} \quad &amp; 3x + 2.5y \\\text{s.t.} \quad &amp; 2x + 4y \geq 40 \\&amp; 3x + 2y \geq 50 \\&amp; x, y \geq 0\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.34em;vertical-align:-2.9200000000000004em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.42em;"><span style="top:-5.58em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.66786em;"><span style="top:-2.4em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">min</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-3.74em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">s.t.</span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-2.2399999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.7399999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.9200000000000004em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.42em;"><span style="top:-5.58em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">3</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord">.</span><span class="mord">5</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.74em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">2</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">4</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">4</span><span class="mord">0</span></span></span><span style="top:-2.2399999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">3</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">5</span><span class="mord">0</span></span></span><span style="top:-0.7399999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.9200000000000004em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>对偶问题：花最多的钱买最少的商品</strong></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><munder><mo><mi>max</mi><mo>⁡</mo></mo><mi>x</mi></munder><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>40</mn><mi>x</mi><mo>+</mo><mn>50</mn><mi>y</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>s.t.</mtext><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>2</mn><mi>x</mi><mo>+</mo><mn>4</mn><mi>y</mi><mo>≤</mo><mn>3</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>3</mn><mi>x</mi><mo>+</mo><mn>2</mn><mi>y</mi><mo>≤</mo><mn>2.5</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo>≥</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\max_{x} \quad &amp; 40x + 50y \\\text{s.t.} \quad &amp; 2x + 4y \leq 3 \\&amp; 3x + 2y \leq 2.5 \\&amp; x, y \geq 0\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6.34em;vertical-align:-2.9200000000000004em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.42em;"><span style="top:-5.58em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43056em;"><span style="top:-2.4em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-3.74em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">s.t.</span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-2.2399999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-0.7399999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.9200000000000004em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.42em;"><span style="top:-5.58em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">4</span><span class="mord">0</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">5</span><span class="mord">0</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3.74em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">2</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">4</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">3</span></span></span><span style="top:-2.2399999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">3</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mord">.</span><span class="mord">5</span></span></span><span style="top:-0.7399999999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.9200000000000004em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>二者的最优解一致</strong></p>
<h1>凸分析</h1>
<p><strong>先记住一句话：几乎所有的最优性条件和对偶关系都是通过某种凸集的分离或者支撑性质建立起来的</strong></p>
<h2 id="凸集定义">凸集定义</h2>
<p>如果一个集合<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>是凸集,那么我们可以说，对于集合内任意两点<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>θ</mi><mi>x</mi><mo>+</mo><mtext>（</mtext><mn>1</mn><mo>−</mo><mi>θ</mi><mo stretchy="false">)</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">z=\theta x+（1-\theta)y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord cjk_fallback">（</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> 也在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span></span></span></span>里面。注意到，当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>等于0的时候，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">z = y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>, 当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span>等于1的时候, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">z = x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>, 也就是说从几何角度来理解z是一条连接<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>的线段。如下：</p>
<p><img src="/2023/05/31/Linear-programming/Snipaste_2023-05-29_19-26-13.png" alt></p>
<p><strong>other定义：凸组合（convex combination）、凸壳（Convex Hull）、空间多面体(Polyhedron)</strong></p>
<h2 id="单纯形法-simplex-method"><strong>单纯形法（Simplex Method）</strong></h2>
<p>单纯形法通过在多面体的顶点（称为“单纯形”）上迭代地移动来寻找最优解。在每一步中，算法尝试在当前单纯形中寻找一个更好的顶点，直到找到最优解为止。该算法非常高效，并且可以解决许多实际问题，例如生产计划、资源分配、运输问题等。</p>
<p>Dantzig在1953年又提出了改进单纯形法，目的是降低迭代过程中的累积误差；美国数学家Carlton Edward Lemke于1954年提出对偶单纯形法，来解决原问题难以求解，但是对偶问题方便求解的问题。然而，单纯形法的一个缺点是它可能会遇到所谓的“退化”情况，导致算法效率急剧下降。为了克服这个问题，人们在单纯形法的基础上发展了一些改进算法，例如内点法、Karmarkar算法等。</p>
<p><strong>步骤</strong>：化标准型；求基可行解，列初始单纯型表；检验非基变量检验数，得最优解/高斯消去法迭代，检验非基变量检验数，循环，直到取得最优解。</p>
<p>总的来说：单纯形法的求解过程，就是不断地寻求变量出入基的循环迭代过程，每次迭代都达到降低目标函数值（或增大目标函数值）的目的，最终得到最优解。</p>
<h3 id="单纯形法的基本思想">单纯形法的基本思想</h3>
<p><strong>[1]Dimitris Bertsimas, John N. Tsitsiklis, Introduction to Linear Optimization. Athena Scientific, Belmont, Massachusetts. P120—123.</strong></p>
<p><strong>[2]<a href="https://github.com/Operations-Research-Science">https://github.com/Operations-Research-Science</a></strong></p>
<p><strong>[3]<a href="https://www.kennethwong.tech/zh/post/simplex/">https://www.kennethwong.tech/zh/post/simplex/</a></strong></p>
<p>大致思路是，使用动态规划的思维，将约束拆分，与目标函数合并成二维向量。类似这样：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>A</mi><mn>1</mn></msub><mtext> </mtext><msub><mi>c</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>A</mi><mn>2</mn></msub><mtext> </mtext><msub><mi>c</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mo>⋯</mo><mo>+</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>A</mi><mi>n</mi></msub><mtext> </mtext><msub><mi>c</mi><mi>n</mi></msub></mrow></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow><msub><mi>x</mi><mi>n</mi></msub><mo>=</mo><mrow><mo fence="true">(</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>b</mi><mtext> </mtext><mi>z</mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\begin{pmatrix} A_1 \ c_1 \end{pmatrix}x_1+\begin{pmatrix} A_2 \ c_2 \end{pmatrix}x_2+\dots+\begin{pmatrix} A_n \ c_n \end{pmatrix}x_n=\begin{pmatrix} b \ z \end{pmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace"> </span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">(</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="mspace"> </span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">)</span></span></span></span></span></span></span></p>
<p>将拆分后所得的点[<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>c</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>A</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>c</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>A</mi><mi>n</mi></msub><mo separator="true">,</mo><msub><mi>c</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">A_1,c_1,A_2,c_2..A_n,c_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>]进行抽象，把线性规划转化为凸组合优化问题。即：够构造出<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>b</mi><mo separator="true">,</mo><mi>z</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(b,z)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mclose">)</span></span></span></span>的使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span>值最小的关于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>A</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>c</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(A_i,c_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>的<strong>凸组合</strong>，所有的凸组合构成了一个<strong>凸包</strong>，目标函数（目标函数在凸组合中的映射为<strong>需求线</strong>）与凸包相交点即为可行解。进一步地，如果向量线性独立，由这些线性独立的向量组成的凸包称为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span><strong>维单纯形</strong>。</p>
<p>这里简单比喻一下。四面体的四条边可以看作四维空间的基（线性无关），这些基进行线性组合，组成了凸包，这些凸包的形状是凸四面体，这些凸四面体称为三维单纯形。</p>
<p>下然后就是在这些单纯形的顶点进行基变换寻找出最优解。需要指出的是：<strong>一组基对应一组可行解，单纯形的顶点对应一组基，基和单纯形的顶点式一一对应的</strong>。</p>
<p><strong>线性规划的解本质上就是找到单纯形的顶点，并且定位顶点在哪里，那么其解的组成部分就包括两部分，前半部分代表顶点坐标，后半部分代表定位该坐标的数值信息，其实就是顶点坐标到超平面的截距。</strong></p>
<p>接下来就是遍历顶点，直到最优。</p>
<p>事情要是这么简单就好了，遍历顶点其实不现实，因此需要找到一些聪明一点的方法，将一些垃圾排除在计算范围外。下面，我们从最基础的单纯形法开始。</p>
<h3 id="单纯形法求解过程">单纯形法求解过程</h3>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>max</mi><mo>⁡</mo><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>z</mi><mo>=</mo><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>3</mn><msub><mi>x</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>s.t.</mtext><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>≤</mo><mn>8</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mspace width="1em"></mspace></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>4</mn><msub><mi>x</mi><mn>1</mn></msub><mo>≤</mo><mn>16</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mspace width="1em"></mspace></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>4</mn><msub><mi>x</mi><mn>2</mn></msub><mo>≤</mo><mn>12</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mspace width="1em"></mspace></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo>≥</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\max\quad  &amp; z=2x_1+3x_2 \\\text{s.t.}\quad 
&amp; x_1+2x_2\le8 \\ \quad 
&amp; 4x_1\le16 \\ \quad 
&amp; 4x_2\le12 \\ \quad 
&amp; x_1,x_2\ge0 \\
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.500000000000002em;vertical-align:-3.5000000000000018em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4em;"><span style="top:-6.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">max</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-4.659999999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">s.t.</span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-3.1599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-1.6599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-0.15999999999999837em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5000000000000018em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4em;"><span style="top:-6.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.659999999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">8</span></span></span><span style="top:-3.1599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">4</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord">6</span></span></span><span style="top:-1.6599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">4</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord">2</span></span></span><span style="top:-0.15999999999999837em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5000000000000018em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>转换为标准型</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>max</mi><mo>⁡</mo><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>z</mi><mo>−</mo><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><mn>3</mn><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>s.t.</mtext><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>s</mi><mn>1</mn></msub><mo>=</mo><mn>8</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mspace width="1em"></mspace></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>4</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>s</mi><mn>2</mn></msub><mo>=</mo><mn>16</mn><mtext> </mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mspace width="1em"></mspace></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>4</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>s</mi><mn>3</mn></msub><mo>=</mo><mn>12</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mspace width="1em"></mspace></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>3</mn></msub><mo>≥</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\max\quad  
&amp; z-2x_1-3x_2=0 
\\\text{s.t.}\quad 
&amp; x_1+2x_2+s_1=8 \\ \quad 
&amp; 4x_1+s_2=16 \ \\\quad 
&amp; 4x_2+s_3=12 \\ \quad 
&amp; x_1,x_2,s_1,s_2,s_3\ge0 \\
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.500000000000002em;vertical-align:-3.5000000000000018em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4em;"><span style="top:-6.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">max</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-4.659999999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">s.t.</span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-3.1599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-1.6599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-0.15999999999999837em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5000000000000018em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4em;"><span style="top:-6.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span><span style="top:-4.659999999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">8</span></span></span><span style="top:-3.1599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">4</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace"> </span></span></span><span style="top:-1.6599999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">4</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord">2</span></span></span><span style="top:-0.15999999999999837em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.5000000000000018em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>1、绘制单纯形表</p>
<table>
<thead>
<tr>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">s_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">s_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">s_ 3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td></td>
</tr>
<tr>
<td>1</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>8</td>
</tr>
<tr>
<td>4</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>16</td>
</tr>
<tr>
<td>0</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>12</td>
</tr>
</tbody>
</table>
<p>2、每次迭代都需要找到<strong>极大无关组</strong>作为<strong>初始基变量</strong>，这是用来保证求取的解处在顶点上，即：可以保证该解为基可行解[<strong>见证明</strong>]。</p>
<table>
<thead>
<tr>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">C_b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">s_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">s_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">s_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>2</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td></td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>2</td>
<td><strong>1</strong></td>
<td><strong>0</strong></td>
<td><strong>0</strong></td>
<td>8</td>
</tr>
<tr>
<td>0</td>
<td>4</td>
<td>0</td>
<td><strong>0</strong></td>
<td><strong>1</strong></td>
<td><strong>0</strong></td>
<td>16</td>
</tr>
<tr>
<td>0</td>
<td>0</td>
<td>4</td>
<td><strong>0</strong></td>
<td><strong>0</strong></td>
<td><strong>1</strong></td>
<td>12</td>
</tr>
</tbody>
</table>
<p>此时，进入计算的是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">s_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">s_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>  <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">s_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，叫<strong>基变量</strong>，其余的称为<strong>非基变量</strong>，全部为0。</p>
<p>相当于这样：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mi>max</mi><mo>⁡</mo><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mi>z</mi><mo>−</mo><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><mn>3</mn><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>s.t.</mtext><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>s</mi><mn>1</mn></msub><mo>=</mo><mn>8</mn><mo>−</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mspace width="1em"></mspace></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>s</mi><mn>2</mn></msub><mo>=</mo><mn>16</mn><mo>−</mo><mn>4</mn><msub><mi>x</mi><mn>1</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mspace width="1em"></mspace></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>s</mi><mn>3</mn></msub><mo>=</mo><mn>12</mn><mo>−</mo><mn>4</mn><msub><mi>x</mi><mn>2</mn></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\max\quad  
&amp; z-2x_1-3x_2=0 \\
\text{s.t.}\quad 
&amp; s_1=8-x_1-2x_2 \\ \quad 
&amp; s_2=16-4x_1 \\ \quad 
&amp; s_3=12-4x_2 \\
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:6em;vertical-align:-2.7500000000000004em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">max</span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">s.t.</span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-2.4099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-0.9099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mspace" style="margin-right:1em;"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.25em;"><span style="top:-5.41em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span><span style="top:-3.91em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.4099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">4</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-0.9099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">4</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.7500000000000004em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>此时的解称为初始可行解，上面的解为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>8</mn><mo separator="true">,</mo><mn>16</mn><mo separator="true">,</mo><mn>12</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[0,0,8,16,12]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">8</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">6</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">2</span><span class="mclose">]</span></span></span></span></p>
<p>先验证一下：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mn>0</mn><mo>∗</mo><mn>2</mn><mo>+</mo><mn>0</mn><mo>∗</mo><mn>3</mn><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">z= 0*2+0*3+..+=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">+</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></p>
<p>所有解均为非负，满足条件，完。</p>
<p>想得美，这么简单的话还要计算机做什么~</p>
<p>下面来检验一下：</p>
<table>
<thead>
<tr>
<th></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>C</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">C_b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">x_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">s_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">s_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">s_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span></th>
<th><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>o</mi><mi>u</mi><mi>t</mi><mo>=</mo><mi>b</mi><mi mathvariant="normal">/</mi><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">out=b/x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord">/</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td>2</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td></td>
<td></td>
</tr>
<tr>
<td>s1</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>8</td>
<td>4</td>
</tr>
<tr>
<td>s2</td>
<td>0</td>
<td>4</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>16</td>
<td>-</td>
</tr>
<tr>
<td>s3</td>
<td>0</td>
<td>0</td>
<td><strong>4</strong></td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>12</td>
<td>3</td>
</tr>
<tr>
<td></td>
<td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mi>n</mi></mrow><annotation encoding="application/x-tex">in</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span></span></span></span></td>
<td>2</td>
<td>3</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>in是入基变量校验数，计算方法如下：</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>=</mo><mn>2</mn><mo>−</mo><mo stretchy="false">(</mo><mn>0</mn><mo>×</mo><mn>1</mn><mo>+</mo><mn>0</mn><mo>×</mo><mn>4</mn><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mo stretchy="false">)</mo><mo>=</mo><mn>2</mn><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x_1=2-(0×1+0×4+..+)=2&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">4</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">+</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub><mo>=</mo><mn>3</mn><mo>−</mo><mo stretchy="false">(</mo><mn>0</mn><mo>×</mo><mn>2</mn><mo>+</mo><mn>0</mn><mo>×</mo><mn>0</mn><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><mo stretchy="false">)</mo><mo>=</mo><mn>3</mn><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x_2=3-(0×2+0×0+..+)=3&gt;0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">+</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="mord">3</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></p>
<p>均大于0，说明是有贡献的，所以选<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">X_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>作为入基变量，同时，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>&gt;</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">2&gt;3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68354em;vertical-align:-0.0391em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span>,所以选择<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>作为入基变量。</p>
<p>为什么是这样呢？</p>
<p>可以记住这样一句话：它表示在可行解空间中，目标函数值移动时，每单位距离的变化量。</p>
<p>就是说：<strong>在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>s</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">x_1,x_2,s_1,s_2,s_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>与原点组成的向量空间中，非基变量（初始为远点）向目标函数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>3</mn><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">2x_1+3x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.79444em;vertical-align:-0.15em;"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>移动时，与x_1的法向量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[1,0,0,0,0]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">]</span></span></span></span>的夹角为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>r</mi><mi>c</mi><mi>t</mi><mi>a</mi><mi>n</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">arctan2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">a</span><span class="mord mathdefault">n</span><span class="mord">2</span></span></span></span>。</strong></p>
<p>了解这个之后，剩下的就很简单了，看反正切图像</p>
<p><img src="/2023/05/31/Linear-programming/Snipaste_2023-05-31_23-11-41.png" alt></p>
<p>如果小与0，则说明加角为负值，贡献减少，如果为正值，说明夹角为正，贡献增加。</p>
<p>因此，<strong>b表示，目标函数分别到非基向量的截距。</strong></p>
<p>接下来就很简单了，循环上面的步骤</p>
<p><img src="/2023/05/31/Linear-programming/Snipaste_2023-05-31_23-46-36.png" alt></p>
<p><img src="/2023/05/31/Linear-programming/Snipaste_2023-05-31_23-46-57.png" alt="Snipaste_2023-05-31_23-46-57"></p>
<p><img src="/2023/05/31/Linear-programming/Snipaste_2023-05-31_23-47-13.png" alt="Snipaste_2023-05-31_23-47-13"></p>
<p>最终求得最优解为14。</p>
<h4 id="线性规划求解">线性规划求解</h4>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><munder><mo><mi>max</mi><mo>⁡</mo></mo><mi>x</mi></munder><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>3</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mn>2.9</mn><msub><mi>x</mi><mn>3</mn></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mtext>s.t.</mtext><mspace width="1em"></mspace></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>8</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>2</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mn>10</mn><msub><mi>x</mi><mn>3</mn></msub><mo>≤</mo><mn>300</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>10</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>5</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mn>8</mn><msub><mi>x</mi><mn>3</mn></msub><mo>≤</mo><mn>400</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>13</mn><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mn>10</mn><msub><mi>x</mi><mn>3</mn></msub><mo>≤</mo><mn>420</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>3</mn></msub><mo>≥</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\max_{x} \quad &amp; 3x_1 + 2x_2 + 2.9x_3 \\ \text{s.t.} \quad &amp; 8x_1 + 2x_2 + 10x_3 \leq 300 \\ &amp; 10x_1 + 5x_2 + 8x_3 \leq 400 \\ &amp; 2x_1 + 13x_2 + 10x_3 \leq 420 \\ &amp; x_1, x_2, x_3 \geq 0\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:7.840000000000002em;vertical-align:-3.6700000000000017em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.17em;"><span style="top:-6.33em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43056em;"><span style="top:-2.4em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-4.489999999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord">s.t.</span></span><span class="mspace" style="margin-right:1em;"></span></span></span><span style="top:-2.9899999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:-1.4899999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span><span style="top:0.010000000000001563em;"><span class="pstrut" style="height:3em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.6700000000000017em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:4.17em;"><span style="top:-6.33em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">3</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord">.</span><span class="mord">9</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-4.489999999999999em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">8</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">3</span><span class="mord">0</span><span class="mord">0</span></span></span><span style="top:-2.9899999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">1</span><span class="mord">0</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">5</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">8</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">4</span><span class="mord">0</span><span class="mord">0</span></span></span><span style="top:-1.4899999999999984em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mord">3</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">4</span><span class="mord">2</span><span class="mord">0</span></span></span><span style="top:0.010000000000001563em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:3.6700000000000017em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>Rglpk<span class="punctuation">)</span></span><br><span class="line">x1<span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">8</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">x2<span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">13</span><span class="punctuation">)</span></span><br><span class="line">x3<span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="number">8</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">mat<span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>x1<span class="punctuation">,</span>x2<span class="punctuation">,</span>x3<span class="punctuation">)</span></span><br><span class="line">dir <span class="operator">&lt;-</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;&lt;=&quot;</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">rhs <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">300</span><span class="punctuation">,</span><span class="number">400</span><span class="punctuation">,</span><span class="number">420</span><span class="punctuation">)</span> </span><br><span class="line">obj <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">2.9</span><span class="punctuation">)</span> </span><br><span class="line"></span><br><span class="line">Rglpk_solve_LP<span class="punctuation">(</span>obj<span class="punctuation">,</span> mat<span class="punctuation">,</span> dir<span class="punctuation">,</span> rhs<span class="punctuation">,</span> <span class="built_in">max</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="built_in">$</span>optimum  <span class="params">#</span>求解器找到的最优目标函数值。</span><br><span class="line">[1] 135.2667</span><br><span class="line"><span class="built_in">$</span>solution <span class="params">#</span>决策变量的最优值。</span><br><span class="line">[1] 22.533333 23.200000  7.333333</span><br><span class="line"><span class="built_in">$</span>status  <span class="params">#</span>是否取得最优，0为取到最优</span><br><span class="line">[1] 0</span><br><span class="line"><span class="built_in">$</span>solution<span class="built_in">_</span>dual<span class="params">#</span>约束条件的最优对偶变量值（拉格朗日乘子）</span><br><span class="line">[1] 0 0 0</span><br><span class="line"><span class="built_in">$</span>auxiliary <span class="params">#</span>附加信息</span><br><span class="line"><span class="built_in">$</span>auxiliary<span class="built_in">$</span>primal  <span class="params">#</span>原始问题的解</span><br><span class="line">[1] 300 400 420</span><br><span class="line"><span class="built_in">$</span>auxiliary<span class="built_in">$</span>dual  <span class="params">##</span>对偶问题的解</span><br><span class="line">[1] 0.03000000 0.26666667 0.04666667</span><br><span class="line"><span class="built_in">$</span>sensitivity<span class="built_in">_</span>report  <span class="params">#</span>是否输出敏感性分析报告</span><br><span class="line">[1] NA</span><br></pre></td></tr></table></figure>
<p>1] 马国瑜. 线性规划的发展历史[J]. 北京化工大学学报(自然科学版), 1985(4):27-33.</p>
<h4 id="多元线性求解">多元线性求解</h4>
<p>上面的代码相当不人性，需要加载一个求解器gurobi（可以申请学术版）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> gurobipy <span class="keyword">import</span> *</span><br><span class="line">m = Model(<span class="string">&quot;LP model&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义变量</span></span><br><span class="line">x1 = m.addVar(lb=<span class="number">0</span>, ub=<span class="number">150</span>, vtype=GRB.INTEGER, name=<span class="string">&#x27;x1&#x27;</span>)</span><br><span class="line">x2 = m.addVar(lb=<span class="number">0</span>, ub=<span class="number">150</span>, vtype=GRB.INTEGER, name=<span class="string">&#x27;x2&#x27;</span>)</span><br><span class="line">x3 = m.addVar(lb=<span class="number">0</span>, ub=<span class="number">150</span>, vtype=GRB.INTEGER, name=<span class="string">&#x27;x3&#x27;</span>)</span><br><span class="line">x4 = m.addVar(lb=<span class="number">0</span>, ub=<span class="number">150</span>, vtype=GRB.INTEGER, name=<span class="string">&#x27;x4&#x27;</span>)</span><br><span class="line">x5 = m.addVar(lb=<span class="number">0</span>, ub=<span class="number">150</span>, vtype=GRB.INTEGER, name=<span class="string">&#x27;x5&#x27;</span>)</span><br><span class="line">x6 = m.addVar(lb=<span class="number">0</span>, ub=<span class="number">150</span>, vtype=GRB.INTEGER, name=<span class="string">&#x27;x6&#x27;</span>)</span><br><span class="line">x7 = m.addVar(lb=<span class="number">0</span>, ub=<span class="number">150</span>, vtype=GRB.INTEGER, name=<span class="string">&#x27;x7&#x27;</span>)</span><br><span class="line">x8 = m.addVar(lb=<span class="number">0</span>, ub=<span class="number">150</span>, vtype=GRB.INTEGER, name=<span class="string">&#x27;x8&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加约束</span></span><br><span class="line">m.addConstr(<span class="number">2</span>*x1 + x2 + x3 + x4 &gt;= <span class="number">100</span>)</span><br><span class="line">m.addConstr(<span class="number">2</span>*x2 + x3 + <span class="number">3</span>*x5 + <span class="number">2</span>*x6 + x7 &gt;=<span class="number">150</span>)</span><br><span class="line">m.addConstr(x1 + x3 + <span class="number">3</span>*x4 + <span class="number">2</span>*x6 + <span class="number">3</span>*x7 + <span class="number">5</span>*x8 &gt;=<span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加目标函数</span></span><br><span class="line">m.setObjective(<span class="number">5</span>*x1 + <span class="number">6</span>*x2 + <span class="number">23</span>*x3 + <span class="number">5</span>*x4 + <span class="number">24</span>*x5 + <span class="number">6</span>*x6 +<span class="number">23</span>*x7 + <span class="number">5</span>*x8, GRB.MINIMIZE)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 求解</span></span><br><span class="line">m.optimize()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;最优值：&#x27;</span>, m.objVal)</span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> m.getVars():</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;参数&#x27;</span>, v.varName, <span class="string">&#x27;=&#x27;</span>, v.x)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="证明-可以忽略">证明，可以忽略</h2>
<p>在凸优化中，可行域的每个顶点都可以表示为约束条件的一个极端解，也就是可行限制条件的某些等号处取等。因此，为了证明选取极大无关组作为初始基变量可以保证初始基变量所对应的顶点是可行域的一个顶点，需要证明初始基变量对应的顶点是可行限制条件的一个极端解。</p>
<p>设可行域为：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi><mo>=</mo><mo stretchy="false">{</mo><mi>x</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>n</mi></msup><mi mathvariant="normal">∣</mi><mi>A</mi><mi>x</mi><mo>≤</mo><mi>b</mi><mo separator="true">,</mo><mi>x</mi><mo>≥</mo><mn>0</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{P} = \{ x \in \mathbb{R}^n | Ax \leq b, x \geq 0 \} 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span><span class="mord">∣</span><span class="mord mathdefault">A</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0</span><span class="mclose">}</span></span></span></span></span></p>
<p>其中，A是一个m x n的矩阵，b是一个m维列向量。假设选取极大无关组作为初始基变量，对应的基向量为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>=</mo><mo stretchy="false">[</mo><msub><mi>A</mi><msub><mi>I</mi><mn>1</mn></msub></msub><mo separator="true">,</mo><msub><mi>A</mi><msub><mi>I</mi><mn>2</mn></msub></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><msub><mi>I</mi><mi>m</mi></msub></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">B = [A_{I_1}, A_{I_2}, ..., A_{I_m}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0001em;vertical-align:-0.2501em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.16454285714285719em;"><span style="top:-2.357em;margin-left:-0.07847em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>I</mi><mn>2</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>I</mi><mi>m</mi></msub></mrow><annotation encoding="application/x-tex">I_1, I_2, ..., I_m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是极大无关组的下标集合。</p>
<p>由于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>是一个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">m \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>的方阵，且它的行列式<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mi>e</mi><mi>t</mi><mo stretchy="false">(</mo><mi>B</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">det(B)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mclose">)</span></span></span></span>不等于0，因为极大无关组的元素是线性无关的。因此，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>是可逆的，即存在一个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">m \times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>的矩阵<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">B^{-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>，使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">BB^{-1}=I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span></span></span></span>是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">m\times m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>的单位矩阵。</p>
<p>假设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>B</mi></msub><mo>=</mo><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>b</mi></mrow><annotation encoding="application/x-tex">x_B=B^{-1}b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">b</span></span></span></span>，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">x_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是基变量的取值，且满足约束条件<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>B</mi></msub><msub><mi>x</mi><mi>B</mi></msub><mo>=</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">A_Bx_B=b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span>。因为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>对应的列是单位矩阵，所以有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>B</mi></msub><msub><mi>x</mi><mi>B</mi></msub><mo>=</mo><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>b</mi></mrow><annotation encoding="application/x-tex">A_Bx_B=B^{-1}b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">b</span></span></span></span>，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>B</mi></msub><mo>=</mo><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>b</mi></mrow><annotation encoding="application/x-tex">x_B=B^{-1}b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">b</span></span></span></span>。</p>
<p>又因为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>是极大无关组，所以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><msub><mi>x</mi><mi>B</mi></msub><mo>=</mo><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_ix_B=b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>∈</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">i \in I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span></span></span></span>，而对于不在极大无关组中的列<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo mathvariant="normal">∉</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">j \notin I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="llap"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right:0.05555555555555555em;"></span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.25em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span></span></span></span>，有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>j</mi></msub><msub><mi>x</mi><mi>B</mi></msub><mo>≤</mo><msub><mi>b</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">A_jx_B\leq b_j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>，因为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x\geq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7719400000000001em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≥</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>。</p>
<p>因此，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">x_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>满足所有的约束条件，也就是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>B</mi></msub><mo>∈</mo><mi mathvariant="script">P</mi></mrow><annotation encoding="application/x-tex">x_B \in \mathcal{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span></span></span></span>。又因为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>中的列是线性无关的，所以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">x_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是唯一满足上述约束条件的向量，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">x_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是基可行解。</p>
<p>接下来需要证明<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">x_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是可行限制条件的一个极端解。假设存在一个向量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">x&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>∈</mo><mi mathvariant="script">P</mi></mrow><annotation encoding="application/x-tex">x&#x27; \in \mathcal{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.790992em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span></span></span></span>，且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo mathvariant="normal">≠</mo><msub><mi>x</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">x&#x27; \neq x_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。由于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo mathvariant="normal">≠</mo><msub><mi>x</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">x&#x27; \neq x_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.946332em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，所以它们对应的基向量不同，即存在一个<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo mathvariant="normal">∉</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">k \notin I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mord"><span class="mrel">∈</span></span><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.75em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="llap"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="inner"><span class="mord"><span class="mord">/</span><span class="mspace" style="margin-right:0.05555555555555555em;"></span></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.25em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span></span></span></span>，使得<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>k</mi></msub><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><msub><mi>b</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">A_kx&#x27;=b_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.901892em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，且<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>≤</mo><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_ix&#x27; \leq b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.901892em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>∈</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">i \in I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span></span></span></span>。</p>
<p>然而，由于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi></mrow><annotation encoding="application/x-tex">B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span>是极大无关组，所以对于所有的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>∈</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">i \in I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span></span></span></span>，有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><msub><mi>x</mi><mi>B</mi></msub><mo>=</mo><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_ix_B=b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>≤</mo><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_ix&#x27; \leq b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.901892em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>。因此，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><msub><mi>x</mi><mi>B</mi></msub><mo>&lt;</mo><msub><mi>A</mi><mi>i</mi></msub><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">A_ix_B &lt; A_ix&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.901892em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>，进而有：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>B</mi></msub><msub><mi>x</mi><mi>B</mi></msub><mo>+</mo><msub><mi>A</mi><mi>k</mi></msub><msub><mi>x</mi><mi>B</mi></msub><mo>≤</mo><mi>b</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>B</mi></msub><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>+</mo><msub><mi>A</mi><mi>k</mi></msub><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>≤</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">A_Bx_B+A_kx_B \leq b, A_Bx&#x27;+A_kx&#x27; \leq b 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.996332em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.9518920000000001em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.801892em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span></span></p>
<p>将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>B</mi></msub><mo>=</mo><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>b</mi></mrow><annotation encoding="application/x-tex">x_B=B^{-1}b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">b</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>=</mo><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>b</mi><mo>+</mo><mi>t</mi><msub><mi>x</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">x&#x27;=B^{-1}b+tx_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.897438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.76508em;vertical-align:-0.15em;"></span><span class="mord mathdefault">t</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>代入上述不等式中，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">t \in [0,1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65418em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>，得到：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>b</mi><mo>+</mo><mi>t</mi><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>A</mi><mi>k</mi></msub><msub><mi>x</mi><mi>k</mi></msub><mo>≤</mo><mi>b</mi><mo separator="true">,</mo><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>b</mi><mo>+</mo><mi>t</mi><mo stretchy="false">(</mo><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>A</mi><mi>k</mi></msub><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mi>t</mi><mo stretchy="false">(</mo><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>A</mi><mi>I</mi></msub><msub><mi>x</mi><mi>I</mi></msub><mo stretchy="false">)</mo><mo>≤</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">B^{-1}b+tB^{-1}A_kx_k\leq b, B^{-1}b+ t(B^{-1}A_kx_k) + t(B^{-1}A_Ix_I) \leq b 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.947438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.014108em;vertical-align:-0.15em;"></span><span class="mord mathdefault">t</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.058548em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>I</mi></msub></mrow><annotation encoding="application/x-tex">x_I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">x_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>中除<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">x_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>以外的元素构成的向量。由于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">x&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>满足约束条件，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>≤</mo><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_ix&#x27; \leq b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.901892em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，因此有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>A</mi><mi>I</mi></msub><msub><mi>x</mi><mi>I</mi></msub><mo>≤</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">B^{-1}A_Ix_I \leq 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.964108em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>。</p>
<p>因此，上述不等式可以进一步简化为：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>b</mi><mo>+</mo><mi>t</mi><mo stretchy="false">(</mo><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>A</mi><mi>k</mi></msub><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>≤</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">B^{-1}b+t(B^{-1}A_kx_k) \leq b 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.947438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span></span></p>
<p>由于<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>A</mi><mi>k</mi></msub><msub><mi>x</mi><mi>k</mi></msub><mo>=</mo><msub><mi>b</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">B^{-1}A_kx_k=b_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.964108em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，因此上述不等式可以写成：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>b</mi><mo>+</mo><mi>t</mi><mo stretchy="false">(</mo><msub><mi>b</mi><mi>k</mi></msub><mo stretchy="false">)</mo><mo>≤</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">B^{-1}b+t(b_k) \leq b 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.947438em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span></span></p>
<p>将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>代入上述不等式中得到：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mi>b</mi><mo>≤</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">B^{-1}b \leq b 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.000078em;vertical-align:-0.13597em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span></span></p>
<p>但是，这与<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>∈</mo><mi mathvariant="script">P</mi></mrow><annotation encoding="application/x-tex">x&#x27; \in \mathcal{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.790992em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span></span></span></span>相矛盾，因为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">x&#x27;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.751892em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span>是一个可行解，满足<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>≤</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">Ax&#x27; \leq b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.887862em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">A</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span>，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>B</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><msub><mi>A</mi><mi>i</mi></msub><msup><mi>x</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>≤</mo><msub><mi>b</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">B^{-1}A_ix&#x27; \leq b_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.964108em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.751892em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>∈</mo><mi>I</mi></mrow><annotation encoding="application/x-tex">i \in I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69862em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span></span></span></span>。因此，假设不成立，即<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">x_B</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>是可行限制条件的一个极端解。</p>
<p>综上所述，选取极大无关组作为初始基变量可以保证初始基变量所对应的顶点是可行域的一个顶点，并且对应的基向量是线性无关的，也就是一个基向量集合的一个极端向量，对应的基变量是一个基可行解。因此，可以保证这个基可行解对应的顶点是可行域的一个顶点，也就是可行解的一个极端解。</p>
]]></content>
      <tags>
        <tag>Mathmodeling</tag>
      </tags>
  </entry>
  <entry>
    <title>Nature of Matrix</title>
    <url>/2023/07/31/Matrix/</url>
    <content><![CDATA[<p>[TOC]</p>
<p><strong>写在前面</strong></p>
<p>这个月真实服了，爬了一趟山，毁了两块手机屏幕，一次直接碎了；另一次是我嫌安装的不完美，手贱拆坏了，于是扔了。买了个新手机，莫名的摄像头还不好使了，害我至今无法登微信。前几天，他喵的也不知道什么情况电脑充电器直接冒烟了。这难道是暗示我可以实施下一步计划了吗？</p>
<p>也不总是坏处，还好有以前打印了资料，可以静几天，摆脱手机带来的叮叮叮；</p>
<p>本月同时做了一些NLP相关的工作（建模中，下篇介绍），以期可以收获点灵感，用于基因组研究。为了研究基因组也是拼了，下面是看的资料汇总：</p>
<h1>线性代数有什么用？</h1>
<p>瑞典的 L.戈丁说过，没有掌握线代的人简直就是文盲。</p>
<p>学习一门学问，最重要的是把握主干内容，迅速建立对于这门学问的整体概念，不必一开始就考虑所有的细枝末节和特殊情况，自乱阵脚。</p>
<p><strong>初学者的疑惑</strong></p>
<p>矩阵究竟是什么东西？</p>
<p>矩阵的乘法规则究竟为什么这样规定？</p>
<p>行列式究竟是一个什么东西？</p>
<p>为什么说 P-1AP 得到的矩阵与 A 矩阵“相似”？这里的“相似”是什么意思？</p>
<p>特征值和特征向量的本质是什么？</p>
<h1>线性代数的内容及发展简史</h1>
<p>在研究关联着多个因素的量所引起的问题，则需要考察多元函数。如果所研究的关联性是线性的，那么称这个问题为线性问题。一次方程就是研究线性问题的方程，被称为线性方程，讨论线性方程及线性运算的代数就叫做线性代数。历史上线性代数的第一个问题是关于解线性方程组的问题，而线性方程组理论的发展又促成了作为工具的行列式理论和矩阵论的创立与发展</p>
<h1>空间与坐标系</h1>
<p>对线形空间和矩阵的几个核心概念的理解</p>
<h2 id="线性">线性</h2>
<p>在线性代数里面的主要的意思就是线性空间里的<strong>线性变换</strong>，强调了函数的变量之间的变换的意义。</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>k</mi><mi>x</mi><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">f(x)=kx+b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span>（k 和 b 是不变量），称为一元线性函数。为了线性函数的进一步推广，我们忍痛割“尾”，令 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">b=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span> ，这个函数在<strong>几何</strong>上就变成一条过原点的直线。（因为不过原点的直线不满足我们对线性函数的比例性的要求）。实际上，<strong>代数</strong>上最基本的意义只有两条：<strong>可加性和比例性</strong>。用数学的表达来说就是：<strong>对加法和数乘封闭</strong>。</p>
<h2 id="空间-space">空间(space)</h2>
<p>数学定义，大致都是“存在一个集合，在这个集合上定义某某概念，然后满足某些性质”，就被称为了空间。显然，对于大多数人来说，这个太抽象了。更别说运算其中的内容，根本没有感觉好不好。</p>
<p><strong>经验告诉我们，对于抽象的东西需要先从现实中去类比，然后去提取信息</strong>。我们一般人最熟悉的是物理上的三维空间；从数学上说，它则是一个三维的欧几里德空间。为了要了解空间，先看看我们熟悉的这样一个空间有些什么最基本的特点：</p>
<ol>
<li>由很多（实际上是无穷多个）位置点组成</li>
<li>这些点之间存在相对的关系</li>
<li>可以定义长度、角度</li>
<li>这个空间可以容纳运动</li>
</ol>
<p>凡是讨论数学问题，都得有一个集合。<strong>第 1、2 条是空间的基础</strong>，不算是空间特有的性质,只能算作集合，并不是说有了这些就算是空间。第 3 条其他的空间不需要具备，属于额外添加项，为了计算方便，人为添加。第 4 条是空间的本质，也就是说：<strong>容纳运动是空间的本质特征</strong>。</p>
<p>有了这些知识，我们就可以把我们关于三维空间的认识扩展到其他的空间。事实上，不管是什么空间，都必须容纳和支持在其中发生的符合规则的运动（变换）。同时你会发现，在某种空间中往往会存在一种相对应的变换：拓扑空间中有拓扑变换，线性空间中有线性变换，仿射空间中有仿射变换，其实这些变换本质就是对应空间中允许的运动形式。<strong>“空间”是容纳运动的一个对象集合，而变换则规定了对应空间的运动</strong></p>
<p>回到主题，<strong>简单的说，能装东西的就是空间；对于数学，装的东西是可运算的元素</strong>。从拓扑空间开始，一步步往上加定义，可以形成很多空间。线形空间其实还是比较初级的，如果在里面定义了范数，就成了赋范线性空间。赋范线性空间满足完备性，就成了巴那赫空间；赋范线性空间中定义角度，就有了内积空间，内积空间再满足完备性，就得到希尔伯特空间，如果空间里装载所有类型的函数，就叫泛函空间。总之，空间有很多种。</p>
<h2 id="线性空间">线性空间</h2>
<p>既然我们承认线性空间是个空间，那么有两个最基本的问题必须首先得到解决：</p>
<ol>
<li>线性空间中的元素有什么性质？</li>
<li>空间中容纳了怎样的运动，我们该如何描述？</li>
</ol>
<p>我们先来试着回答第一个问题，线性空间中的任何一个对象，通过选取基和坐标的办法，都可以表达为向量的形式。</p>
<p>在线性代数中，基也称为基底是描述、刻画向量空间的基本工具。换一个说法也就是建立坐标系。基的英文名字是 Basic。基可以是任意元素，比如{数学书、英语书、笔记本、碳素笔}就构成一组基；基也可以是有限维向量、无限维的函数、矩阵等 。</p>
<p>L1. 最高次项不大于 n 次的多项式的全体构成一个线性空间，也就是说，这个线性空间中的每一个对象是一个多项式。如果我们以 x0, x1, …, xn为基，那么任何一个这样的多项式都可以表达为一组 n+1 维向量，其中的每一个分量 ai 其实就是多项式中 x(i-1)项的系数。<strong>值得说明的是，基的选取有多种办法，只要所选取的那一组基线性无关就可以</strong>。<br>
L2. 闭区间[a, b]上的 n 阶连续可微函数的全体，构成一个线性空间。也就是说，这个线性空间的每一个对象是一个连续函数。对于其中任何一个连续函数，根据<strong>魏尔斯特拉斯定理，一定可以找到最高次项不大于 n 的多项式函数，使之与该连续函数的差为 0</strong>，也就是说，完全相等。这样就把问题归结为 L1 了。</p>
<p>**只要你找到合适的基，用向量可以表示线性空间里任何一个对象。换句话说，给你一个空间，你就能建立一个坐标系，来描述这个空间中的对象！**向量表面上只是一列数，但是其实由于它的有序性，所以除了这些数本身携带的信息之外，还可以在每个数的对应位置上携带信息。下面我们尝试建立一个坐标系：</p>
<p>基本想法就是创建一个空间，而空间的最基本特征是存在点，且不同的点有各自位置。根据经验就是利用数轴将点的位置标志出来，一维就用一条线，二维就用两条线，以此类推。</p>
<p>聪明的你肯定就可以想到：上面的想法就是创造<strong>坐标系</strong>的过程。我们分析一下，坐标系中最重要的是什么吗？没错就是数轴，<strong>不在同一平面的数轴</strong>，使用数学语言翻译他就叫<strong>线性无关的基</strong>。</p>
<p>举个例子，比如在平面内的任意向量，我们可以用两个不共线（线性无关）的向量描述。这就是我们在高中熟知的平面向量基本定理，这两个不共线的向量就构成描述这个空间的 2×2 矩阵。而对于高维空间的任意向量，自然要 n 个线性无关的向量构成，于是就构成一个 n×n 的矩阵，其中的n就是基的个数。（<strong>需要注意，基的单位是 1，长度不一定是 1</strong>），同时如果n个向量互不共线，我们就说他们组成的矩阵是**满秩（=非奇异）**的，反过来也成立。</p>
<p>空间之间的变化其实就是换了一组基而已。所以泰勒展开其实是换了一组基，所以傅里叶级数是换了一组基，拉普拉斯变换是换了一组基，小波变换是换了一组基。<strong>基的选取一定是为了你研究问题的方便。</strong></p>
<p><strong>结论：由一组线性无关的向量放在一起构成的矩阵描述了一个坐标系。</strong></p>
<h1>矩阵与变换</h1>
<p>世界是物质的，物质是运动的，接下来肯定要研究一下线性空间里面的运动是怎么实现的，也就是来回答第二个问题，这个问题的回答会涉及到线性代数的一个最根本的问题。</p>
<p><strong>线性空间中的运动，被称为线性变换</strong>。也就是说，你从线性空间中的一个点运动到任意的另外一个点，都可以通过一个线性变化来完成。那么，线性变换如何表示呢？</p>
<p>在线性空间中，当你选定一组基之后，不仅可以<strong>用一个向量来描述空间中的任何一个对象</strong>，而且可以<strong>用矩阵来描述该空间中的任何一个运动（变换）</strong>。<strong>也既：在线性空间中选定基之后，向量刻画对象，矩阵刻画对象的运动，用矩阵与向量的乘法施加运动</strong>。</p>
<p><strong>矩阵的本质是运动的描述</strong>，这里的“运动”的概念不是微积分中的连续性的运动，而是瞬间发生的变化。“运动”这个词用在这里，还是容易产生歧义的，说得更确切些，应该是“<strong>跃迁</strong>”。而在数学中，这个词语叫<strong>变换</strong>。描述一个三维对象只需要三维向量，但所有的计算机图形学变换矩阵都是 4 x 4 的。</p>
<p>比如，拓扑变换，就是在拓扑空间里从一个点到另一个点的跃迁。仿射变换，就是在仿射空间里从一个点到另一个点的跃迁。而仿射空间跟向量空间是亲兄弟。一个空间中的对象和运动竟然可以用相类同的方式表示。能说这是巧合吗？如果是巧合的话，那可真是幸运的巧合！</p>
<p>一旦我们理解了“变换”这个概念，矩阵的定义就变：“<strong>矩阵是线性空间里的变换的描述</strong>。”</p>
<p>它在教科书中常以这样形式出现：在一个线性空间 V 里的一个线性变换 T，当选定一组基之后，就可以表示为矩阵。在这里，我们要说清楚<strong>到底什么是线性变换</strong>，<strong>什么是基</strong>，<strong>什么叫选定一组基</strong></p>
<p>线性变换：设有一种变换 T，使得对于线性空间 V 中间任何两个不相同的对象 x 和 y，以及任意实数 a 和 b，有：</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo stretchy="false">(</mo><mi>a</mi><mi>x</mi><mo>+</mo><mi>b</mi><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>a</mi><mi>T</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mi>b</mi><mi>T</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T(ax + by) = aT(x) + bT(y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span>，那么就称 T 为线性变换，说的是从自己空间到自己空间的变换。</p>
<p>基，基看成是线性空间里的坐标系就可以了。注意是坐标系，不是坐标值。这样一来，“选定一组基”就是说在线性空间里选定一个坐标系。</p>
<p>最后我们把矩阵的定义完善如下：<strong>“矩阵是线性空间中的线性变换的一个描述。在一个线性空间中，只要我们选定一组基，那么对于任何一个线性变换，都能够用一个确定的矩阵来加以描述。</strong>”</p>
<h1>矩阵与方程组</h1>
<p>当解一个方程组的时候，我们知道，方程组的解只与系数有关，于是，将系数提取出来，放在一起，就构成了矩阵，而矩阵的行变换就相当于解方程时的加减消元过程（也叫高斯消元法）。下面我们从方程组解的几何意义来解释方程组 Ax=b 的意义，先把结论给出来</p>
<ol>
<li>方程组<strong>有解</strong>还可以理解成空间几何图形有公共交点或者交线（高维度时还可能出现“交面”等情况），<strong>无穷解</strong>代表有公共相交部分，但是最终形成的不是一个点，而是线或者面或者更高维的东西，而<strong>无解</strong>代表着没有公共相交的部分。</li>
<li>方程组<strong>有解</strong>就说明 b 这个向量能用 A 的列向量线性表示，也可以说 b 这个向量在 <strong>A的列向量所构成的空间中</strong>！<strong>无穷解</strong>表示矩阵 A 中的列向量线性相关，所以导致表示方式不唯一，而<strong>无解</strong>则表示矩阵 A 中的列向量和 b 不在同一个空间里。</li>
</ol>
<p>解释如下：</p>
<p><img src="/2023/07/31/Matrix/Snipaste_2023-06-07_17-34-04.png" alt></p>
<h1>矩阵与基和坐标</h1>
<p>从空间的角度更深入的理解一下矩阵</p>
<p>线性空间 V 的基不是唯一的，只要 n 个 n 维向量线性无关，就可以用来描述这个空间。那么线性空间中的两组基之间有什么联系呢？同一个向量在不同基下有不同的坐标，他们之间有什么联系呢？</p>
<p><img src="/2023/07/31/Matrix/Snipaste_2023-06-07_19-56-26.png" alt></p>
<p>这里 M 是可逆的。可逆的意思是可以变过来也可以变回去，不可逆就是只能朝着一个方向变换。从条件的角度来说：可逆是充要条件，不可逆是充分条件。我们可以看出来：**右乘一个方阵就是将一组基换到另一组基！**于是我们得出这样的认识“<strong>对象的变换等价于坐标系的变换</strong>”或者“<strong>固定坐标系下一个对象的变换等价于固定对象所处的坐标系变换。</strong>”</p>
<p><img src="/2023/07/31/Matrix/Snipaste_2023-06-07_20-00-17.png" alt></p>
<p>达成同一个变换的结果，比如把点(1, 1)变到点(2, 3)去，你可以有两种做法。第一，坐标系不动，点动，把(1, 1)点挪到(2, 3)去。第二，点不动，变坐标系，让 x 轴的度量（单位向量）变成原来的 1/2，让 y 轴的度量（单位向量）变成原先的 1/3，这样点还是那个点，可是点的坐标就变成(2, 3)了。</p>
<p>我们得出一个重要的结论：“<strong>对坐标系施加变换的方法，就是让表示那个坐标系的矩阵与表示那个变化的矩阵相乘</strong>。”</p>
<p>对于 X 和 Y 中的单个向量，有 By=Ax</p>
<p>我们很自然的对于这个等式的理解：有一个向量，它在坐标系 A 的度量下得到的度量结果向量为 x，那么它在坐标系 B（单位阵）的度量下，这个向量的度量结果是 y</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">;</mo><mn>0</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo><mo>=</mo><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">;</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">[</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[2,0;0,3][1,1]=[1,0;0,1][2,3]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mclose">]</span></span></span></span></span></p>
<p>如果把 A 放在一个向量 x 的前面，形成 Ax 的样式，我们可以认为这是对向量 x 的一个环境声明。同理对于 BY=AX 的理解就是向量组{x}和{y}。</p>
<p>我们将得到惊人的结论：<strong>这哪里是什么左乘法计算，根本就是身份识别</strong>。</p>
<p>到此，我们基本呢说清楚了矩阵最核心的概念，下面，我们针对一些比较特殊的现象，来更深入理解一下线性代数和矩阵！</p>
<h1>特殊的矩阵</h1>
<p>旋转矩阵乘幂的几何及物理解释：大家已经知道，一个矩阵乘以一个向量，一般将会对向量的几何图形进行旋转和伸缩变化。如果<strong>仅仅进行伸缩，就是特征值和特征向量的问题</strong>，如果<strong>仅仅是旋转，就是正交化的问题</strong>。</p>
<h2 id="旋转矩阵">旋转矩阵</h2>
<p><img src="/2023/07/31/Matrix/Snipaste_2023-06-08_10-19-16.png" alt></p>
<p>总结一下，这就是二阶旋转矩阵（逆时针）</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>cos</mi><mo>⁡</mo><mi>θ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mi>sin</mi><mo>⁡</mo><mi>θ</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>sin</mi><mo>⁡</mo><mi>θ</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>cos</mi><mo>⁡</mo><mi>θ</mi></mrow></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\begin{bmatrix}
\cos\theta &amp; -\sin\theta \\
\sin\theta &amp; \cos\theta \\
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">sin</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">−</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">sin</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">cos</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p>
<p><strong>一个矩阵是旋转矩阵，当且仅当它是正交矩阵并且它的行列式是1</strong>。正交矩阵的行列式是 ±1；<strong>如果行列式是 −1，则它包含了一个反射而不是真旋转矩阵</strong>。对于旋转矩阵乘幂，我们可以知道，就是一直旋转，乘了几次就是旋转了几次。当好多个旋转矩阵（可以不同）连乘时，我们就能理解了，这是把一个向量沿着多个方向旋转的叠加！</p>
<h2 id="对角矩阵">对角矩阵</h2>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>a</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>b</mi></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\begin{bmatrix}
a &amp; 0 \\
0 &amp; b \\
\end{bmatrix}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">a</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p>
<p>对于对角矩阵乘幂，就是一直放大（缩小），乘了几次就是放大（缩小）了几次。当好多个对角矩阵（可以不同）连乘时，我们就能理解了，这是把一个向量放大（缩小）叠加</p>
<p>对于一般矩阵乘幂的几何及物理。乘积的效果就是多个伸缩和旋转的叠加！如在S=ABCDEF中，会把所有的矩阵线性变化的作用力传递并积累下去，最终得到一个和作用力S。工业上的例子就是机器人的手臂，机械臂上的每个关节就是一个矩阵,机械臂末端的位置或动作是所有关节运动的综合效果。</p>
<p><strong>旋转矩阵把一个矩阵乘向量的作用变成对向量的旋转，对角矩阵乘向量的作用变成对向量的伸缩</strong></p>
<h1>矩阵的等价与相似</h1>
<p>什么是<strong>矩阵等价</strong>呢？</p>
<p>从定义角度就是：存在可逆矩阵 P 和 Q 满足 PAQ= B 则我们说A 和 B 是等价的。我们知道，对于可逆变换的意义就是变换过去还可以变换回来，无论怎么变换，只要是可逆的，变换是<strong>不改变矩阵维度</strong>的。</p>
<p>这里说一下<strong>可逆矩阵</strong>，它可以表示为一系列初等矩阵的乘积。拉伸、对称、剪切分别对应三种初等变换。也就是说，有了这三种变换，其他任意的矩阵变换都可以用这三种变换表示</p>
<p>用人话总结就是：<strong>如果两个矩阵同维度，且可以通过变换使得两个矩阵相等，则他们是等价矩阵</strong>。就是说等价的要求直选哟维度相同</p>
<p>从空间的角度来说，就是他们是同一种类型的子空间！你可以这样理解：<strong>如果两个矩阵等价，一个矩阵能表示一个线，另一个矩阵也表示线；一个矩阵能表示一个面，另一个矩阵也表示面</strong></p>
<p>怎么理解 P 和 Q的作用呢？</p>
<p>P 和 Q 可以看成是可逆变换， 变换的作用就是为了把元素之间相互干扰的矩阵化成能一眼看出维数的简单矩阵。维数代表什么？在控制中，维数反映系统的可观测和可控性的量度（就是看看这个空间多大，这个空间里面着装的变量够不够）。</p>
<p>什么是矩阵相似呢？从定义角度就是：存在可逆矩阵 P  满足$ B=P^{-1}AP<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>则我们说</mtext><mi>A</mi><mtext>和</mtext><mi>B</mi><mtext>是相似的。在</mtext><mi>P</mi><mtext>坐标系下测量的</mtext><mi>x</mi><mtext>′，在直角坐标系测量为</mtext><mi>x</mi><mtext>，可以表示成</mtext></mrow><annotation encoding="application/x-tex">则我们说A 和 B 是相似的。 在P坐标系下测量的x′，在直角坐标系测量为x，可以表示成</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">则</span><span class="mord cjk_fallback">我</span><span class="mord cjk_fallback">们</span><span class="mord cjk_fallback">说</span><span class="mord mathdefault">A</span><span class="mord cjk_fallback">和</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">相</span><span class="mord cjk_fallback">似</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">。</span><span class="mord cjk_fallback">在</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord cjk_fallback">坐</span><span class="mord cjk_fallback">标</span><span class="mord cjk_fallback">系</span><span class="mord cjk_fallback">下</span><span class="mord cjk_fallback">测</span><span class="mord cjk_fallback">量</span><span class="mord cjk_fallback">的</span><span class="mord mathdefault">x</span><span class="mord">′</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">在</span><span class="mord cjk_fallback">直</span><span class="mord cjk_fallback">角</span><span class="mord cjk_fallback">坐</span><span class="mord cjk_fallback">标</span><span class="mord cjk_fallback">系</span><span class="mord cjk_fallback">测</span><span class="mord cjk_fallback">量</span><span class="mord cjk_fallback">为</span><span class="mord mathdefault">x</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">表</span><span class="mord cjk_fallback">示</span><span class="mord cjk_fallback">成</span></span></span></span>Px′=x<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>；同理有</mtext></mrow><annotation encoding="application/x-tex">；同理有</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">；</span><span class="mord cjk_fallback">同</span><span class="mord cjk_fallback">理</span><span class="mord cjk_fallback">有</span></span></span></span>Py′=y<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>。代入就得到：</mtext></mrow><annotation encoding="application/x-tex">。代入就得到：</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">。</span><span class="mord cjk_fallback">代</span><span class="mord cjk_fallback">入</span><span class="mord cjk_fallback">就</span><span class="mord cjk_fallback">得</span><span class="mord cjk_fallback">到</span><span class="mord cjk_fallback">：</span></span></span></span>Py′=APx′<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>，可以稍稍改成</mtext></mrow><annotation encoding="application/x-tex">，可以稍稍改成</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">稍</span><span class="mord cjk_fallback">稍</span><span class="mord cjk_fallback">改</span><span class="mord cjk_fallback">成</span></span></span></span>Py′=P(P^{−1}AP)x′<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>，换句话说，在</mtext><mi>P</mi><mtext>坐标系下，从</mtext><mi>x</mi><mtext>′到</mtext><mi>y</mi><mtext>′的运动用矩阵</mtext></mrow><annotation encoding="application/x-tex">，换句话说，在P坐标系下，从x′到y′的运动用矩阵</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">换</span><span class="mord cjk_fallback">句</span><span class="mord cjk_fallback">话</span><span class="mord cjk_fallback">说</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">在</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord cjk_fallback">坐</span><span class="mord cjk_fallback">标</span><span class="mord cjk_fallback">系</span><span class="mord cjk_fallback">下</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">从</span><span class="mord mathdefault">x</span><span class="mord">′</span><span class="mord cjk_fallback">到</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">′</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">运</span><span class="mord cjk_fallback">动</span><span class="mord cjk_fallback">用</span><span class="mord cjk_fallback">矩</span><span class="mord cjk_fallback">阵</span></span></span></span>B=P^{−1}AP$表示，B就是A的一个相似矩阵！所以说，相似矩阵只不过是在不同坐标系下的变换矩阵。</p>
<p>矩阵对应的行列式值的几何意义就是体积，因此相似矩阵的行列式值都相同，不管怎样变化，体积都相同。总而言之，相似变换是为了简化计算！</p>
<h1><em>矩阵的相似对角化</em></h1>
<p>特征值英文名 eigen value，我们可以想一个问题：有没有变换只改变长度，不改变方向呢？如果存在矩阵对某一个向量或某些向量只发生伸缩变换，不对这些向量产生旋转的效果，那么这些向量就称为这个矩阵的特征向量。</p>
<h2 id="特征值为什么特征">特征值为什么特征</h2>
<p>当蒙娜丽莎的图像左右翻转时，中间垂直的红色向量方向保持不变。而水平方向上黄色的向量的方向完全反转，因此它们都是左右翻转变换的特征向量。<strong>红色向量长度不变，其特征值为 1</strong>。<strong>黄色向量长度也不变但方向变了，其特征值为-1</strong>。<strong>橙色向量在翻转后和原来的向量不在同一条直线上，不是特征向量</strong>。</p>
<p><img src="/2023/07/31/Matrix/Snipaste_2023-06-08_21-04-25.png" alt></p>
<p>所以一个变换的特征向量是这样一种向量：它经过这种特定的变换后保持方向不变，只是进行长度上的伸缩而已。举个例子：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo separator="true">;</mo><mn>0</mn><mo separator="true">,</mo><mo>−</mo><mn>1</mn><mo stretchy="false">]</mo><mo>∗</mo><mo stretchy="false">[</mo><mi>a</mi><mo separator="true">;</mo><mi>b</mi><msup><mo stretchy="false">]</mo><mi>T</mi></msup><mo>=</mo><mo stretchy="false">[</mo><mi>a</mi><mo separator="true">,</mo><mtext>–</mtext><mi>b</mi><msup><mo stretchy="false">]</mo><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">[1,0;0,-1]*[a;b]^T=[a,–b]^T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">−</span><span class="mord">1</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">a</span><span class="mpunct">;</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">–</span><span class="mord mathdefault">b</span><span class="mclose"><span class="mclose">]</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></p>
<p>上述特征向量中，a不变，b变成负数，因此该矩阵中的列向量均为特征向量，特征值均为1。</p>
<p>上面的变换，我们在图像上很容易看出来，但是在计算上就很困难了，我们必须要经历矩阵的乘法，如果我们套用乘法公式去计算乘方，那可真是让人头疼。那有没有好算乘方的矩阵呢？有！那就是对角矩阵，它的乘方就是对角矩阵对角线上元素各自乘方即可。也就是说，<strong>如果一个矩阵可以转换为对角矩阵，那么一个大矩阵 A 对向量的作用就变成了一个数乘以特征向量了再求个和，复杂的矩阵运算就变成了数乘运算</strong>！</p>
<p>方程本质是一种约束，微分方程就是在世界上各种各样的函数中，约束出一类函数。对于一阶微分方程就是一个类似求解特征向量的问题，只不过“特征向量”变成函数！</p>
<h2 id="神奇的e">神奇的e</h2>
<p>一杯开水放在室内，它温度的下降是指数形式的；听说过放射性元素的原子核发生衰变么？随着放射的不断进行，放射强度将按指数曲线下降；化学反应的进程也可以用指数函数描述……</p>
<h2 id="如何选基">如何选基</h2>
<p>下面就是能不能找到这样的“好”向量组（矩阵）作为基的问题了？矩阵能不能对角化，为什么不能对角化，不能对角化说明了矩阵出了什么问题？</p>
<p>先抛出答案，如果矩阵作用了一个任意向量 x， Ax 和 x 之间总存在不是 0 或者π的夹角，那么就不能对角化。令 Ax=λx 相等，能算出 n 个线性无关的向量就说明可以找到，算不出来或者算出来数目不够，那么好，我们找不到这样的基。同时，**如果矩阵与一个对角阵相似，那么他们具有相同的特征多项式、特征值、秩、迹。**由于对角阵的这些量是容易求出来的，而这些值在工程中是非常重要而且有意义的。</p>
<p>特征向量们作为一组基，把空间中的变换 A简单化了。那么和它对应的特征值怎么理解呢？</p>
<p>特征值反映了特征向量在变换时的伸缩倍数。对一个变换而言。特征向量指明变换的方向，而特征值反映的是变换的剧烈程度！一个矩阵，只要我们找到合适的坐标，它的全部信息就可以用坐标系和特征值表示！也就是说 ：我们从不同角度看问题，其难易程度是不一样的！而矩阵对角化为我们提供了一个很好的看问题的角度。</p>
<p>为什么矩阵的特征值有时会被称为谱呢？其实这和特征值的物理意义有关，一阶线性微分方程组对应的矩阵的特征值就是系统的固有频率。凡是叫谱的东西，都是可以分解的，比如光谱。我们可以将一个具有良好性能的矩阵分解成多个作用的叠加。</p>
<p>在数学中有一个谱定律（Spectral theorem），也叫谱分解或者特征值分解。</p>
<p>一个矩阵 A 可表示为如下线性组合<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msub><mi>λ</mi><mn>1</mn></msub><msub><mi>P</mi><mn>1</mn></msub><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub><msub><mi>P</mi><mn>2</mn></msub><mo>+</mo><msub><mi>λ</mi><mn>3</mn></msub><msub><mi>P</mi><mn>3</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">A=\lambda_1 P_1 +\lambda_2 P_2+\lambda_3 P_3+......</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.10556em;vertical-align:0em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>1</mn></msub><mtext>、</mtext><msub><mi>P</mi><mn>2</mn></msub><mtext>、</mtext><msub><mi>P</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">P_1、P_2、P_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">、</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">、</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>  称为 A 的谱族，$ \lambda_1 、\lambda_2、\lambda_n$等表示特征值。</p>
<p>这里做了两个假设：</p>
<p>矩阵 A 是可以对角化的。</p>
<p>所有特征值都是不同的。</p>
<p><strong>特征值和谱族的乘积就代表了它对矩阵 A 的贡献率</strong>——说的通俗一点就是能量（power）或者权重(weight)。这样，能量多的、权重大的部分当然重要，问题的主要矛盾就凸显出来了！</p>
<p>矩阵不能对角化的原因是因为有剪切变换，所以才有Jordan 块的事。旋转变换可以由连续两次反射变换来实现。旋转变换对应矩阵出现复特征值。</p>
<h1><em>矩阵的复数域对角化</em></h1>
<p>特征值的问题我们已经说得差不多了，让我们来谈一谈复特征值。复数运算天生就带有旋转的结构。貌似旋转矩阵和复数有着某种天生的联系！如果将复特征值写成指数形式，它的幅值代表伸长或者缩小的程度，相角代表 Ax 和 x 之间的夹角。</p>
<p>旋转矩阵和复数运算在对向量的作用形式上具有相同的结构！</p>
<p>对角化的过程，实质上就是找特征向量的过程，选取特征向量作为基来表征矩阵 A。如果一个矩阵在复数域不能对角化，我们还有办法把它化成比较优美的形式——Jordan 标准型。高等代数理论已经证明：一个方阵在复数域一定可以化成 Jordan 标准型。</p>
<h1>内积与相关</h1>
<p>正交性</p>
<p>从数学的角度看到的是基，用它来描述函数空间中任何一个元具有唯一性和可逆性；可以联系映射的定义域和值域，从而研究解乃至求得解。从应用的角度看到的是一种基本工具或方法，可以使得例如函数变换、函数逼近、数据压缩、数学物理问题的求解等问题变得容易处理和易于理解</p>
<p>有一种去除冗余性的方法，就是施密特正交化方法。</p>
<p><img src="/2023/07/31/Matrix/Snipaste_2023-06-10_08-48-06.png" alt></p>
<p>斯密特正交化的思想其实非常简单：两个向量不正交就是说明二者有重叠，我们把重叠去除就正交了。比如图中红色的那个向量，我们将它去除就可以得到正交的向量了。怎么去除？首先要知道红色的向量的大小和方向：大小用内积算，用β1的方向向量定。有了大小和方向，做一次减法就行了。</p>
<p>独立是一个很重要的概念，科研中我们总是希望找到一个现象是受那几个独立变量影响，如果你找到了函数关系式，你就成功了</p>
<p>在线性代数中我们还提到内积的概念，对于内积的理解，有更广泛的含义。</p>
<p>形式上可以理解成对应的元素相乘再求和，对于函数就是对应微分时的两个函数乘积再求积分；对于平稳过程，<strong>内积可以衡量两个函数的线性相似程度</strong>（注意是线性！）。内积值越大表示两个函数线性相似程度越大,内积为零表示完全不线性相似；而矩阵的转置运算，其实就是为了算内积而出现的。两个函数内积为零则两个函数正交,在三维空间中它们的夹角为 90 度,在三维以上不是这样的。</p>
<p>内积和向量的夹角和相关有着密切的联系。我们知道，如果两个向量是共线的，那么他们的夹角就是 0或者 180。此时向量夹角余弦值的绝对值是 1。反过来，通过计算向量之间的夹角余弦值，我们就能判断他们之间线性关系的强弱。</p>
<p>内积还与相关系数有着密切联系。假设五个国家的国民生产总值分别是 1、2、3、5、8，又假设这五个国家的贫困比例分别是 11%、12%、13%、15%、18%。则我们现在有两个有序的包含 5 个元素的向量 x、y：x = (1, 2, 3, 5, 8) ，y = (0.11, 0.12, 0.13, 0.15, 0.18) 使用一般的方法来计算cosΘ= 0.9208  。<br>
而上面的数据实际上是故意选择了一个不完美的线性关系：y = 0.01 x +0.10 。</p>
<p>为了化简成形如y=ax+b的形式，我们可以这样做：将x值减去期望E(x);将y减去E(y),x = (−2.8, −1.8, −0.8, 1.2, 4.2)、 y = (−0.028, −0.018, −0.008, 0.012, 0.042),就可以得到y = 0.01 x。此时，cosΘ=1。也就是说：减去期望相当于将原点坐标平移到期望点。</p>
<p>内积还可以计算其中的相似度，例如皮尔逊相关系数。：用在概率论中，我们可以计算随机变量的相关系数，来判断两个随机变量是否相关。用在数字信号处理中，我们也可以计算两组采样值的相关系数来提取信号或者去除白噪声。在气象学中，可以判断两个不同气象要素或同一气象要素在不同时间和空间的相互关联。在经济学科中，可以用相关判断广告投入与月均销售额之间的关系。在医学中，可以用相关判断体内物理化学参数和疾病之间的关系。。在遗传学中，可以判断群体中不同性状的育种值之间的关系。大名鼎鼎的最小二乘法也要利用相关来判断能否很好地拟合。用在互联网的文本搜索和文章分类中，我们可以通过计算相关系数（其实只要计算内积就可以）来快速解决。</p>
<h1>内积与范数</h1>
<p>回想微积分，它的核心是极限。这其实是一种全新的世界观，告诉我们两个东西无限接近的时候就是同一个东西。但是，我们常常忽略一个比它更基础的东西——距离！微积分σ-ξ语言中引入一种叫“距离”要多小有多小，才定义的极限。可见，距离的概念才是“根本的概念”</p>
<p>同样的道理，我们也会定义向量之间的距离、矩阵之间的距离，也就是传说中的范数(norm)。只要满足三条：非负，齐次，三角不等式就都可以叫做 norm。</p>
<h2 id="欧氏距离-euclidean-distance">欧氏距离(Euclidean Distance)</h2>
<p>欧氏距离是最易于理解的一种距离计算方法，源自欧氏空间中两点间的距离公式，也就是向量的 2 范数。</p>
<h2 id="曼哈顿距离-manhattan-distance">曼哈顿距离(Manhattan Distance)</h2>
<p>想象你在曼哈顿要从一个十字路口开车到另外一个十字路口，驾驶距离是两点间的直线距离吗？显然不是，除非你能穿越大楼。实际驾驶距离就是这个“曼哈顿距离”。而这也是曼哈顿距离名称的来源， 曼哈顿距离也称为城市街区距离(City Block distance)。曼哈顿距离也就是向量的 1 范数。</p>
<h2 id="切比雪夫距离-chebyshev-distance">切比雪夫距离 ( Chebyshev Distance )</h2>
<p>国际象棋玩过么？国王走一步能够移动到相邻的 8 个方格中的任意一个。那<br>
么国王从格子(x1,y1)走到格子(x2,y2)最少需要多少步？你会发现<br>
最少步数总是$ max( |x_1-x_2|, |y_1-y_2|) $步。</p>
<h2 id="闵可夫斯基距离-minkowski-distance">闵可夫斯基距离(Minkowski Distance)</h2>
<p>闵氏距离不是一种距离，而是一组距离的定义。也称为向量的 p 范数,其中 p 是一个变参数。当 p=1 时，就是曼哈顿距离；当 p=2 时，就是欧氏距离；当 p→∞时，就是切比雪夫距离。根据变参数的不同，闵氏距离可以表示一类的距离。</p>
<p>之前介绍了向量之间距离的定义方法，也称为范数，接受了这些概念之后再<br>
理解矩阵范数就容易多了。下面我们就来介绍<strong>矩阵范数</strong>。</p>
<h2 id="矩阵范数">矩阵范数</h2>
<p>如果你认为矩阵里面装的是向量，或者说向量也应该是特殊的矩阵。那么，矩阵和向量应该满足相容性，并且通过<strong>向量范数的定义可以诱导出矩阵范数</strong>。此类范数称为<strong>诱导范数</strong>。如果认为<strong>矩阵里面装载的是纯的数</strong>，那么此时矩阵的“距离”就是 A 到 0 矩阵的“距离”，这类范数称为<br>
<strong>非诱导范数</strong>。</p>
<h3 id="诱导矩阵范数">诱导矩阵范数</h3>
<p>1范数，列和范数</p>
<p>∞范数，行和范数</p>
<p>2范数，谱范数</p>
<h3 id="非诱导矩阵范数">非诱导矩阵范数</h3>
<p>M1范数</p>
<p>M2范数</p>
<p>重点说一下矩阵的 M2 范数，也称为弗罗贝尼乌斯范数（Frobenius norm）、F 范数或希尔伯特-施密特范数（ Hilbert–Schmidt norm），</p>
<p>M∞范数</p>
<h2 id="广义距离">广义距离</h2>
<p>两个随机变量的在统计上是否相关或独立，或者它们的统计特性是否相似，为检验这些问题在统计学中引入了Kullback-Leibler 型距离和 Bhattacharyya 距离（或称为差离度，divergence）。这些距离不满足三角不等式，称为广义距离。<strong>在工程研究中你可以利用手头掌握的数学不等式，定义新的距离或广义距离，它或许有某种特别的性质。</strong></p>
<h3 id="标准化欧氏距离-standardized-euclidean-distance">标准化欧氏距离 (Standardized Euclidean distance )</h3>
<p>标准欧氏距离的思路：既然数据各维分量的分布不一样，好吧！那我先将各个分量都“标准化”到均值、方差相等吧。</p>
<p>标准化后的值 = ( 标准化前的值 － 分量的均值 ) /分量的标准差</p>
<h3 id="马氏距离-mahalanobis-distance">马氏距离(Mahalanobis Distance)</h3>
<h3 id="汉明距离-hamming-distance">汉明距离(Hamming distance)</h3>
<p>两个等长字符串 s1 与 s2 之间的汉明距离定义为将其中一个变为另外一个所<br>
需要作的最小替换次数。例如字符串“1111”与“1001”之间的汉明距离为 2</p>
<h3 id="杰卡德相似系数-jaccard-similarity-coefficient">杰卡德相似系数(Jaccard similarity coefficient)</h3>
<h1><em>优美的二次型</em></h1>
<p>矩阵是由元素和元素的位置这两方面组成的，主对角线元素代表自身和自身的关系，其他位置代表相互关系。在实际应用中，我们很多情形都是对称的相互关系，比如两个物体之间力的关系，作用力和反作用力相等。这样一个系统的力学关系矩阵就是对称的，比如振动矩阵，电路矩阵等。在数学上，这种关系用二次型来描述。</p>
<p>每个二次型都可以经过线性替换变成若干个平方和的形式，对于矩阵来说，就是每个对称矩阵都合同于一个对角矩阵，后者称为一个标准形。<strong>二次型的几何意义是二次曲面</strong>，比如三维中的椭球和双曲抛物面等。</p>
<p><strong>而进行正交变换的意义就是将其在不改变几何形状的基础上将坐标换到好位置，所谓的好位置就是让其几何中心在坐标原点，而且它还关于坐标轴对称</strong>，二次型矩阵具有对称性，所以二次型一定可以化成对角矩阵，可以利用二次型的线性变换化简二次曲面。</p>
<p>对于二次型的正定问题，它有惯性定理决定。它还有一个很好的应用，就是用在微积分的多元函数求极值问题。我们知道，对于一个多元函数，我们可以用泰勒公式在驻点展开到二次项，在很小的邻域内就能反映函数的极值性质。。对于极值，其一阶偏导为零，同时将常数项移到等式左边，只剩下二阶项。如果这个二次多项式是正定的，则函数有极大值，如果是负定的就有极小值。因此，才有微积分里面用二阶导数的关系式来判断一元函数和多元函数的极值判别式！</p>
<p>这里还涉及一个合同的概念，其实合同主要是为了二次型而存在的。对于二次型的矩阵表示来说，做一次非退化的线性替换相当于将二次型的矩阵变为一个与其合同的矩阵。</p>
<h1>行列式</h1>
<p>行列式的几何意义是什么呢？概括说来有两个解释：</p>
<p>一个解释是行列式就是行列式中的行或列向量所构成的“平行多面体”的<strong>有向面积或有向体积</strong>；另<br>
一个解释是矩阵 A 的行列式 detA 就是线性变换 A 下的<strong>图形面积或体积的伸缩因子</strong></p>
<p>我们不妨换一个角度：对于一个对角阵，它的行列式的几何意义比较好理解：对于二维平面就是长×宽；从三维空间就是长×宽×高；对于一般矩阵，将 其 对角化，将坐标之间的耦合关系解除。我们知道相似变换就是把线性空间里面的对象换了一组基来表示而已。这时复杂的几何体就变成一个规则的“空间几何体”，有点类似长方体。然后取行列式的几何意义就清楚了，它真的是表示空间“几何体”的体积！</p>
<p>另一个问题就是变换坐标的事情，我们知道，同一个空间体积可以用不同的基和坐标表示，我们可以分别算出这两组基表示下几何体的体积，其计算出来的值一般是不一样的。两个体积之间有什么关系呢？答案是两个体积之间相差的是一个坐标变换矩阵的行列式！无论是线性变换，还是非线性变换（比如微积分中的直角坐标和极坐标之间的变换），<strong>两个体积之比就是行列式值的关系</strong>（微积分中相差的是雅克比行列式）。</p>
<p><img src="/2023/07/31/Matrix/Snipaste_2023-06-09_16-14-51.png" alt></p>
<p>以上二维和三维行列式的例子中，行列式被解释为向量形成的图形的面积或体积。面积或体积的定义是恒正的，而行列式是有正有负的，因此需要引入有向面积和有向体积的概念。负的面积或体积在物理学中可能难以理解，但在数学中，它们和有向角的概念类似，都是对空间镜面对称特性的一种刻画。如果行列式表示的是线性变换对体积的影响，那么行列式的正负就表示了空间的定向</p>
<p><img src="/2023/07/31/Matrix/Snipaste_2023-06-09_16-16-43.png" alt></p>
<p>如上图中，左边的黄色骰子（可以看成有单位的有向体积的物体）在经过了线性变换后变成中间绿色的平行六边形，这时行列式为正，两者是同定向的，可以通过旋转和拉伸从一个变成另一个。而骰子和右边的红色平行六边形之间也是通过线性变换得到的，但是无论怎样旋转和拉伸，都无法使一个变成另一个，一定要通过镜面反射才行。这时两者之间的线性变换的行列式是负的。可以看出，线性变换可以分为两类，一类对应着正的行列式，保持空间的定向不变，另一类对应负的行列式，颠倒空间的定向。</p>
<h1>积分变换</h1>
<p>傅里叶分析不仅仅是一个数学工具，更是一种可以彻底颠覆一个人以前世界观的思维模式。原本看似简单的函数，为什么我们要复杂化将它展成傅里叶级数呢？这样分析问题真的有必要么？</p>
<p>首先从最直观的信号分解角度，看看用正弦信号逼近的效果；然后给出线性代数中最重要的特征向量的概念，引出本节的核心：为什么要用正弦信号而不用其他信号分解；在理解这二者的基础上介绍数学中空间的概念，这也是线性代数的一个重要思想；理解了数学中空间的概念就很容易理解物理中时域频域的概念；然后我们从投影的角度再来理解一下傅里叶变换，这在数学上就更加抽象了；最后在数学上对傅里叶变换进行一个推广，引入其他形式的变换。</p>
<h2 id="分解的角度">分解的角度</h2>
<p>什么是分解呢？分解的意思就像我们用不同的涂料来调色，一个色调可以分解成不同基色调的组合。一束白光可以分解成不同颜色的光的叠加。</p>
<p><img src="/2023/07/31/Matrix/Snipaste_2023-06-10_13-09-57.png" alt></p>
<h2 id="特征信号角度">特征信号角度</h2>
<p>如果你接受了分解的思想，你可能会有这样的疑问：为什么偏偏选择三角函数而不用其他函数进行分解？</p>
<p>大自然中很多现象可以抽象成一个线性时不变系统来研究，无论你用微分方程还是传递函数或者状态空间描述。</p>
<p><strong>线性时不变系统</strong>：输入输出信号满足线性关系，而且系统参数不随时间变换。对于大自然界的很多系统，一个正弦曲线信号输入后，输出的仍是正弦曲线，只有幅度和相位可能发生变化，但是频率和波的形状仍是一样的。也就是说正弦信号是系统的特征向量！</p>
<p>当然，指数信号也是系统的特征向量，表示能量的衰减或积聚。自然界的衰减或者扩散现象大多是指数形式的，或者既有波动又有指数衰减，因此具有特征的基函数就由三角函数变成复指数函数。</p>
<p><strong>正弦信号</strong>恰好是很多线性时不变系统的特征向量。于是就有了<strong>傅里叶变换</strong>。对于更一般的线性时不变系统，<strong>复指数信号</strong>(表示耗散或衰减)是系统的“特征向量”。于是就有了<strong>拉普拉斯变换</strong>。$z $变换也是同样的道理，这时 $ z^n$ 是离散系统的“特征向量”。</p>
<h3 id="时域频域的概念">时域频域的概念</h3>
<p>什么是时域？从我们出生，我们看到的世界都以时间贯穿，人的身高、汽车的轨迹都会随着时间发生改变。这种以时间作为参照来观察动态世界的方法我们称其为时域分析</p>
<p>频域(frequency domain)是描述信号在频率方面特性时用到的一种坐标系。用线性代数的语言就是装着正弦函数的空。频域最重要的性质是：它不是真实的，而是一个数学构造。正弦波是频域中唯一存在的波形，这是频域中最重要的规则，即正弦波是对频域的描述，因为时域中的任何波形都可用正弦波合成。</p>
<p>对于一个信号来说，信号强度随时间的变化规律就是时域特性，信号是由哪些单一频率的信号合成的就是频域特性。</p>
<h3 id="数学上的时域频域">数学上的时域频域</h3>
<p>从数学上理解，频域的概念就是由正弦信号构成的空间。或者说这个空间里装着正弦信号。</p>
<p><img src="/2023/07/31/Matrix/Snipaste_2023-06-10_16-43-39.png" alt></p>
<p>对于泰勒展开，我们选取了多项式作为基，于是由多项式构成的空间就叫多项式空间。对于傅里叶变换，我们只是选取了三角函数作为基，于是由三角函数构成的空间就叫频率空间或者叫频域。</p>
<p>时域分析与频域分析是对信号的两个观察面。时域分析是以时间轴为坐标表示动态信号的关系；频域分析是把信号变为以频率轴为坐标表示出来。一般来说，时域的表示较为形象与直观，频域分析则更为简练，剖析问题更为深刻和方便。</p>
<p>贯穿时域与频域的方法之一，就是传中说的傅里叶分析。傅里叶分析可分为傅里叶级数（Fourier Serie）和傅里叶变换(Fourier Transformation)。</p>
<p>“任意连续周期信号可以由一组适当的正弦曲线组合而成” 总而言之，不管是傅里叶级数，还是傅里叶变换、拉普拉斯变换、z 变换，本质上都是线性代数里面讲的求特征值和特征向量。</p>
]]></content>
      <tags>
        <tag>Math Matrix</tag>
      </tags>
  </entry>
  <entry>
    <title>Neural-Network-Frame</title>
    <url>/2023/09/30/Neural-Network-Frame/</url>
    <content><![CDATA[<p>[TOC]</p>
<h1>引言</h1>
<p>环顾我们的四周，原本被认为只有人类才能做到的事情，现在人工智能都能毫无差错地完成，甚至试图超越人类。在这个发展速度惊人的世界背后，深度学习技术发挥着重要作用，世界各地研究人员不吝褒奖之词，称其为革新性技术。<br>
入门深度学习，<strong>应该尽量不依靠任何内容不明的黑盒</strong>，即各种库、工具等，尽量从最基础的知识出发，只用NumPy和Matplotlib等基础库，<strong>一步一步实现各种神经网络</strong>。闻之不若见之，见之不若知之，知之不若行之。我们开搞！<br>
编程语言我们使用<strong>Python</strong>。除了简单、易读、易记、开源、免费、高性能等优点，它凭借着NumPy、SciPy等优秀的数值计算、统计分析库，在数据科学领域占有不可动摇的地位。很多深度学习的框架都提供了Python接口，比如Caffe、TensorFlow、Chainer、Theano等。所以Python是目前最适合入门机器学习和深度学习的编程语言。最好直接安装Anaconda，里面除了Python很多库都包了。 Python的入门可以去康康我的博客哦《<a href="https://blog.csdn.net/weixin_45116099/article/details/125661025">Python简介，无代码</a>》。</p>
<p>几乎必加的两行：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>
<h1>感知机</h1>
<p>感知机是具有输入和输出的算法。<strong>给定一个输入，将输出一个既定的值</strong>。它将权重w和偏置b设定为参数。**单层感知机只能表示线性空间，而多层感知机可以表示非线性空间。**使用感知机可以表示与门、或门、与非门等逻辑电路。异或门无法通过单层感知机来表示，但使用2层感知机就可以！所以理论上，多层感知机可以表示计算机！（与非门能构成任何逻辑电路，而计算机的本质就是一堆逻辑电路）</p>
<p><img src="https://img-blog.csdnimg.cn/bf65900614924f28ac166fb9ea1beefa.png" alt="在这里插入图片描述"><br>
多层感知机很简单但也很重要，之后的神经网络跟它长得很像很像。</p>
<p><img src="https://img-blog.csdnimg.cn/29111909139d4cb1a64800942774bcde.png#pic_center" alt="在这里插入图片描述"></p>
<h1>神经网络</h1>
<p>多层感知机能表示复杂的函数，但是对于合适的、能符合预期的输入与输出的权重的确定，现在还是由人工进行，在面临大量的权重和偏置参数时，人力是无法胜任的。<br>
神经网络的出现就是为了解决这个坏消息。具体地讲，神经网络的一个重要性质是它可以<strong>自动地从数据中学习到合适的权重参数</strong>。</p>
<p><img src="https://img-blog.csdnimg.cn/55ac4bc3608f48949cfa2c823837da9f.png#pic_center" alt="在这里插入图片描述"><br>
上面是一个经典的神经网络，由3层神经元构成，因为实际上只有2层神经元有权重，因此称其为“2层网络”。神经网络的形状感知机。实际上，就神经元的连接方式而言，与感知机并没有任何差异。</p>
<h2 id="激活函数">激活函数</h2>
<p>h(x)函数会<strong>将输入信号的总和转换为输出信号</strong>，这种函数一般称为<strong>激活函数</strong>（activation function）。如“激活”一词所示，激活函数的作用在于决定如何来激活输入信号的总和。激活函数是连接感知机和神经网络的桥梁。(一般而言，“朴素感知机”是指单层网络，指的是激活函数使用了阶跃函数的模型。“多层感知机”是指神经网络，即使用 sigmoid函数等平滑的激活函数的多层网络。)</p>
<p><img src="https://img-blog.csdnimg.cn/0436b3e8e19445b481ce8ef3ef096408.png#pic_center" alt="在这里插入图片描述"><br>
激活函数以阈值为界，一旦输入超过阈值，就切换输出。这样的函数称为“<strong>阶跃函数</strong>”。因此，可以说感知机中使用了阶跃函数作为激活函数。也就是说，<strong>在激活函数的众多候选函数中，感知机使用了阶跃函数</strong>。实际上，如果将激活函数从阶跃函数换成其他函数，就可以进入神经网络的世界了。</p>
<h3 id="sigmoid函数">Sigmoid函数</h3>
<p>下面我们就来介绍一下神经网络使用的激活函数。神经网络中经常使用的一个激活函数就是<strong>sigmoid函数</strong>，函数就是给定某个输入后，会返回某个输出的转换器。比如，向sigmoid函数输入1.0或2.0后，就会有某个值被输出，类似h(1.0) = 0.731 …、h(2.0) = 0.880 …<br>
<img src="https://img-blog.csdnimg.cn/3d0e53b1dc9e4985ba9ac0ec6063611f.png" alt="在这里插入图片描述"><br>
sigmoid函数是一条平滑的曲线，输出随着输入发生连续性的变化。而阶跃函数以0为界，输出发生急剧性的变化。<strong>sigmoid函数的平滑性对神经网络的学习具有重要意义。感知机中神经元之间流动的是0或1的二元信号，而神经网络中流动的是连续的实数值信号</strong>。</p>
<h3 id="relu函数">ReLU函数</h3>
<p>还有一个激活函数明星就是ReLU函数，后面会大量用到！<br>
<img src="https://img-blog.csdnimg.cn/570471407f424a7e94c25ab1fb1ddec8.png#pic_center" alt="在这里插入图片描述"><br>
如果从宏观视角看图，可以发现激活函数具有相似的形状。实际上，两者的结构均是“<strong>输入小时，输出接近0（为0）；随着输入增大，输出向1靠近（变成1）</strong>”。也就是说，<strong>当输入信号为重要信息时，阶跃函数和sigmoid函数都会输出较大的值；当输入信号为不重要的信息时，两者都输出较小的值</strong>。还有一个共同点是，<strong>不管输入信号有多小，或者有多大，输出信号的值都在0到1之间</strong>。</p>
<h3 id="小总结">小总结</h3>
<p><img src="https://img-blog.csdnimg.cn/26da27a334b84c459b43f252c1506c36.png" alt="在这里插入图片描述"></p>
<p><strong>神经网络的激活函数必须使用非线性函数</strong>！换句话说，激活函数不能使用线性函数。因为使用线性函数时，无法发挥多层网络带来的优势，不管如何加深层数，总是存在与之等效的“无隐藏层的神经网络”。<br>
<strong>神经网络中的激活函数大多使用平滑变化的sigmoid函数或ReLU函数。</strong></p>
<h2 id="输出层的设计">输出层的设计</h2>
<p>神经网络可以用在分类问题和回归问题上，不过<strong>需要根据情况改变输出层的激活函数</strong>。一般而言，<strong>回归问题用恒等函数，分类问题用softmax函数</strong>！</p>
<p><strong>恒等函数</strong>会将输入按原样输出，<strong>对于输入的信息，不加以任何改动地直接输出</strong>。</p>
<h3 id="softmax函数">softmax函数</h3>
<p><strong>softmax函数</strong>可以用下面的式表示：</p>
<p><img src="https://img-blog.csdnimg.cn/d74b16167f454018b9e1e65eeb9d2772.png" alt="在这里插入图片描述"><br>
softmax函数的输出是0*.<em>0到1</em>.*0之间的实数。并且，softmax函数的输出值的总和是1。输出总和为1是softmax函数的一个重要性质。正因为有了这个性质，<strong>我们才可以把softmax函数的输出解释为“概率”！通过使用softmax函数，我们可以用概率的（统计的）方法处理问题。</strong></p>
<h3 id="小总结">小总结</h3>
<p>一般而言，神经网络只把输出值最大的神经元所对应的类别作为识别结果。并且，即便使用softmax函数，输出值最大的神经元的位置也不会变。因此，<strong>神经网络在进行分类时，输出层的softmax函数可以省略</strong>。在实际的问题中，由于指数函数的运算需要一定的计算机运算量，因此输出层的softmax函数一般会被省略。但是，<strong>softmax函数对于神经网络的学习过程（反向传播）具有重大作用！</strong></p>
<p>通过巧妙地使用NumPy<strong>多维数组</strong>，可以高效地实现神经网络。<br>
分类问题中，<strong>输出层的神经元的数量设置为要分类的类别数。</strong><br>
输入数据的集合称为批（batch）。<strong>通过以批为单位进行推理处理，能够实现高速的运算。</strong></p>
<h1>神经网络的学习！</h1>
<p>终于到了重头戏！前面我们知道了整个网络的前向传播过程，其实就是很直观地不断用数据乘权重再加偏置再经激活函数，一直流动到最后，如果输出层的激活函数选softmax，则能很直观地看到当前数据经过网络后属于不同分类的概率。在这个过程，所有权重、偏置都是固定的，这些参数才是这个深度神经网络的灵魂，合适的参数才能带来正常工作的神经网络。所以，网络需要学习！</p>
<p>数据是机器学习的命根子，机器学习从数据中寻找答案、从数据中发现模式、根据数据讲故事。神经网络的特征就是可以<strong>从数据中学习</strong>。所谓“从数据中学习”，是指可以由数据自动决定权重参数的值。在实际的神经网络中，参数的数量成千上万，在层数更深的深度学习中，参数的数量甚至可以上亿，想要人工决定这些参数的值是不可能的。所以神经网络学习的本质，就是它<strong>自动调参（权重、偏置），让损失函数不断降低至满意。</strong></p>
<p>机器学习的方法中，由机器从收集到的数据中找出规律性。与从零开始想出算法相比，这种方法可以更高效地解决问题，也能减轻人的负担。但是需要注意的是，将图像转换为向量时使用的特征量仍是由人设计的。对于不同的问题，必须使用合适的特征量（必须设计专门的特征量），才能得到好的结果。比如，为了区分狗的脸部，人们需要考虑与用于识别5的特征量不同的其他特征量。也就是说，即使使用特征量和机器学习的方法，也需要针对不同的问题人工考虑合适的特征量。<strong>而在神经网络中，连图像中包含的重要特征量也都是由机器来学习的。</strong></p>
<p><img src="https://img-blog.csdnimg.cn/cdb26f8931434e71b2a56f61fac5f769.png" alt="在这里插入图片描述"></p>
<p>深度学习有时也称为<strong>端到端机器学习</strong>（end-to-end machine learning）。这里所说的端到端是指从一端到另一端的意思，也就是从原始数据（输入）中获得目标结果（输出）的意思。神经网络的优点是对所有的问题都可以用同样的流程来解决。比如，不管要求解的问题是识别5，还是识别狗，抑或是识别人脸，<strong>神经网络都是通过不断地学习所提供的数据，尝试发现待求解的问题的模式。也就是说，与待处理的问题无关，神经网络可以将数据直接作为原始数据，进行“端对端”的学习</strong>。</p>
<h2 id="损失函数">损失函数</h2>
<p>神经网络的学习<strong>通过某个指标表示现在的状态</strong>。然后，以这个指标为<strong>基准</strong>，寻找最优权重参数。神经网络的学习中所用的指标称为<strong>损失函数（loss function）</strong>。这个损失函数可以使用任意函数，但一般用<strong>均方误差</strong>和<strong>交叉熵误差</strong>等。</p>
<p>在进行神经网络的学习时，<strong>不能将识别精度作为指标</strong>。因为如果以识别精度为指标，则参数的导数在绝大多数地方都会变为0。此时识别精度为32%。如果以识别精度为指标，即使稍微改变权重参数的值，识别精度也仍将保持在32%，不会出现变化。也就是说，仅仅微调参数，是无法改善识别精度的。即便识别精度有所改善，它的值也不会像32.0123 …%这样连续变化，而是变为33%、34%这样的不连续的、离散的值。而如果把<strong>损失函数作为指标</strong>，则当前损失函数的值可以表示为0.92543 …这样的值。并且，如果稍微改变一下参数的值，对应的损失函数也会像0.93432…这样发生连续性的变化。</p>
<h3 id="均方误差">均方误差</h3>
<p><img src="https://img-blog.csdnimg.cn/5d7e44588f014c37b04390d7e7ea903d.png#pic_center" alt="在这里插入图片描述"><br>
就是所有数据前向传播的输出与对应标签值相减再平方再加起来，二分之一是为了让后面的求导省去系数。</p>
<h3 id="交叉熵误差">交叉熵误差</h3>
<p><img src="https://img-blog.csdnimg.cn/88bad17812694362a146298cce2fe907.png" alt="在这里插入图片描述"><br>
log表示以e为底数的自然对数（log e）。yk是神经网络的输出，tk是正确解标签。并且，tk中只有正确解标签的索引为1，其他均为0（one-hot表示）。因此，式子实际上只计算对应正确解标签的输出的自然对数。比如，假设正确解标签的索引是“2”，与之对应的神经网络的输出是0.6，则交叉熵误差是−log 0.6 = 0.51；若“2”对应的输出是0.1，则交叉熵误差为−log 0.1 = 2.30。也就是说，交叉熵误差的值是由正确解标签所对应的输出结果决定的。从图中可以知道，若输出（一般经过softmax层，表示分类的概率）越接近1，表示正确类别上的概率越大，则交叉熵误差就越接近0，误差就越小，很不错。</p>
<h2 id="mini-batch">mini-batch</h2>
<p>机器学习使用训练数据进行学习。使用训练数据进行学习，严格来说，就是针对训练数据计算损失函数的值，找出使该值尽可能小的参数。MNIST数据集的训练数据有60000个，如果以全部数据为对象求损失函数的和，则计算过程需要花费较长的时间。再者，如果遇到大数据，数据量会有几百万、几千万之多，这种情况下以全部数据为对象计算损失函数是不现实的。因此，我们从全部数据中选出一部分，作为全部数据的“近似”。神经网络的学习也是从训练数据中选出一批数据（称为mini-batch,小批量），然后对每个mini-batch进行学习。比如，从60000个训练数据中随机选择100笔，再用这100笔数据进行学习。这种学习方式称为mini-batch学习。</p>
<p><img src="https://img-blog.csdnimg.cn/7c8dfb27fcab4d9eabf5ae46236c007b.png#pic_center" alt="在这里插入图片描述"></p>
<h2 id="梯度法">梯度法</h2>
<p>机器学习的主要任务是在学习时寻找最优参数。同样地，神经网络也必须在学习时找到最优参数（权重和偏置）。这里所说的最优参数是指损失函数。取最小值时的参数。但是，一般而言，损失函数很复杂，参数空间庞大，我们不知道它在何处能取得最小值。而通过巧妙地使用梯度来寻找函数最小值（或者尽可能小的值）的方法就是梯度法。这里需要注意的是，**梯度表示的是各点处的函数值减小最多的方向。因此，无法保证梯度所指的方向就是函数的最小值或者真正应该前进的方向。**实际上，在复杂的函数中，梯度指示的方向基本上都不是函数值最小处。</p>
<p>虽然梯度的方向并不一定指向最小值，<strong>但沿着它的方向能够最大限度地减小函数的值</strong>。因此，<strong>在寻找函数的最小值（或者尽可能小的值）的位置的任务中，要以梯度的信息为线索，决定前进的方向。</strong> 在梯度法中，<strong>函数的取值从当前位置沿着梯度方向前进一定距离，然后在新的地方重新求梯度，再沿着新梯度方向前进，如此反复，不断地沿梯度方向前进。</strong> 像这样，<strong>通过不断地沿梯度方向前进，逐渐减小函数值的过程就是梯度法（gradient method）</strong>。梯度法是解决机器学习中最优化问题的常用方法，特别是在神经网络的学习中经常被使用。</p>
<p><img src="https://img-blog.csdnimg.cn/d06aca8268944464a6623ad435ed71ca.png" alt="在这里插入图片描述"><br>
<em>η</em> 表示更新量，在神经网络的学习中，称为<strong>学习率</strong>（learning rate）。学习率决定在一次学习中，应该学习多少，以及在多大程度上更新参数。实验结果表明，**学习率过大的话，会发散成一个很大的值；反过来，学习率过小的话，基本上没怎么更新就结束了。**也就是说，设定合适的学习率是一个很重要的问题。</p>
<p>上面式子表示更新一次的式子，这个步骤会反复执行。也就是说，每一步都按式子更新变量的值，通过反复执行此步骤，逐渐减小函数值。虽然这里只展示了有两个变量时的更新过程，但是即便增加变量的数量，也可以通过类似的式子（各个变量的偏导数）进行更新。</p>
<p>像学习率、权重初始值等的参数称为超参数。这是一种和神经网络的参数（权重和偏置）性质不同的参数。相对于神经网络的权重参数是通过训练数据和学习算法自动获得的，<strong>学习率这样的超参数则是人工设定的</strong>。一般来说，超参数需要尝试多个值，以便找到一种可以使学习顺利进行的设定，这篇博客最后两章会讲到超参数的优化问题。</p>
<p>在上图的gradient_descent()函数中，参数f是要进行最优化的函数，init_x是初始值，lr是学习率learning rate，step_num是梯度法的重复次数。numerical_gradient(f,x)会求函数的梯度，用该梯度乘以学习率得到的值进行更新操作，由step_num指定重复的次数。使用这个函数可以求函数的极小值，顺利的话，还可以求函数的最小值。</p>
<p>在右图的numerical_gradient()函数里使用了<strong>数值微分</strong>的方法算梯度，比较简单，但计算会相对繁琐，<strong>等下介绍的反向传播</strong>能极快地完成梯度的运算。<br>
更多梯度法的细节，这里不好展开，可以康康我的博客哦《<a href="https://blog.csdn.net/weixin_45116099/article/details/122509740">无废话的机器学习笔记（三）(梯度下降)</a>》</p>
<h2 id="神经网络学习全貌">神经网络学习全貌!</h2>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">前提</span><br></pre></td></tr></table></figure>
<p>神经网络存在合适的权重和偏置，调整权重和偏置以便拟合训练数据的</p>
<p>过程称为“学习”。神经网络的学习分成下面4个步骤。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">步骤1（mini-batch）</span><br></pre></td></tr></table></figure>
<p>从训练数据中随机选出一部分数据，这部分数据称为mini-batch。我们</p>
<p>的目标是减小mini-batch的损失函数的值。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">步骤2（计算梯度）</span><br></pre></td></tr></table></figure>
<p>为了减小mini-batch的损失函数的值，需要求出各个权重参数的梯度。</p>
<p>梯度表示损失函数的值减小最多的方向。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">步骤3（更新参数）</span><br></pre></td></tr></table></figure>
<p>将权重参数沿梯度方向进行微小更新。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">步骤4（算误差、精度）</span><br></pre></td></tr></table></figure>
<p>每次循环都算一下误差，若到一次epoch，算一下精度。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">步骤5（重复）</span><br></pre></td></tr></table></figure>
<p>重复步骤1、步骤2、步骤3、步骤4。</p>
<p><img src="https://img-blog.csdnimg.cn/5433501b38c24319953682cfa454fb69.png" alt="在这里插入图片描述"></p>
<p>epoch是一个单位。一个 epoch表示学习中所有训练数据均被使用过一次时的更新次数。比如，对于 10000笔训练数据，用大小为 100笔数据的mini-batch进行学习时，重复随机梯度下降法 100次，所有的训练数据就都被“看过”了A。此时，100次就是一个 epoch。</p>
<p>代码的实现可以看这篇！《<a href="https://blog.csdn.net/weixin_45116099/article/details/127704825?csdn_share_tail=%7B%22type%22:%22blog%22,%22rType%22:%22article%22,%22rId%22:%22127704825%22,%22source%22:%22weixin_45116099%22%7D">纯手撸一个神经网络</a>》</p>
<h2 id="小总结">小总结</h2>
<p><img src="https://img-blog.csdnimg.cn/45a45fc8ed974cde8676dd909b4fbd0d.png#pic_center#" alt="在这里插入图片描述"></p>
<h1>误差反向传播法</h1>
<p>上面，我们介绍了神经网络的学习，并通过数值微分计算了神经网络的权重参数的梯度（严格来说，是损失函数关于权重参数的梯度）。数值微分虽然简单，也容易实现，但缺点是计算上比较费时间。本章我们将学习一个能够<strong>高效计算权重参数的梯度的方法——误差反向传播法。</strong><br>
首先介绍<strong>计算图</strong>，计算图将计算过程用图形表示出来。这里说的图形是数据结构图，通过多个节点和边表示（连接节点的直线称为“边”）。<br>
<strong>问题1</strong>：太郎在超市买了2个100日元一个的苹果，消费税是10%，请计算支付金额。</p>
<p><img src="https://img-blog.csdnimg.cn/a9940653d42e42c384959b11a9697a4e.png#pic_center#" alt="在这里插入图片描述"></p>
<p>计算图将复杂的计算分割成简单的局部计算，和流水线作业一样，<strong>将局部计算的结果传递给下一个节点</strong>。在将复杂的计算分解成简单的计算这一点上与汽车的组装有相似之处。</p>
<p><strong>计算图的优点</strong>：</p>
<ol>
<li>能局部计算</li>
<li>能保存中间计算结果（方便反向传播）</li>
<li>可直观表现反向传播法求导数</li>
</ol>
<h2 id="链式法则-chain-rule">链式法则（chain rule）！</h2>
<p>介绍链式法则时，我们需要先从<strong>复合函数</strong>说起。复合函数是由多个函数构成的函数。比如，z = (x + y)2是由下式所示的两个式子构成的。</p>
<p><img src="https://img-blog.csdnimg.cn/a7d6e9f6f55741a2b49d8e9e49d43e61.png#pic_center#" alt="在这里插入图片描述"></p>
<p>如果某个函数由复合函数表示，则该复合函数的导数可以用构成复合函数的各个函数的导数的乘积表示。</p>
<p><img src="https://img-blog.csdnimg.cn/1c9ac383f17440b9b6ce85242d7166f4.png#pic_center#" alt="在这里插入图片描述"></p>
<p>反向传播的计算顺序是，<strong>先将节点的输入信号乘以节点的局部导数（偏导数），然后再传递给下一个节点</strong>。反向传播是基于链式法则的。</p>
<p><img src="https://img-blog.csdnimg.cn/ea6424b765824f9ca5d06b7bc4a36ed0.png" alt="在这里插入图片描述"></p>
<h2 id="反向传播">反向传播</h2>
<p>上面介绍了<strong>计算图的反向传播是基于链式法则成立的</strong>。这里将以“加法+”和“乘法×”等运算为例，介绍反向传播的结构。</p>
<h3 id="加法">加法</h3>
<p>首先来考虑加法节点的反向传播。这里以z = x + y为对象，观察它的反向传播。z = x + y的导数可由下式计算出来。</p>
<p><img src="https://img-blog.csdnimg.cn/8265783ed12f4d79b3c1a6fd4efa01c8.png#pic_center#" alt="在这里插入图片描述"></p>
<p><strong>反向传播将从上游传过来的导数乘以1，然后传向下游。也就是说，因为加法节点的反向传播只乘以1，所以输入的值会原封不动地流向下一个节点。</strong></p>
<p><img src="https://img-blog.csdnimg.cn/a4519255991b4cdebe20b78c7164be8a.png" alt="在这里插入图片描述"><br>
所以看见加法节点，<strong>无脑地将后面传来的值往下传就行</strong>！</p>
<p>用Python实现加法层：<br>
<img src="https://img-blog.csdnimg.cn/c35b82d299864f86919d350443c0da88.png#pic_center#" alt="在这里插入图片描述"></p>
<h3 id="乘法">乘法</h3>
<p>接下来，我们看一下乘法节点的反向传播。这里我们考虑z = xy。这个式子的导数用式表示:</p>
<p><img src="https://img-blog.csdnimg.cn/b910b02868004c6caf629235f32dcc56.png#pic_center#" alt="在这里插入图片描述"><br>
乘法的反向传播会<strong>将上游的值乘以正向传播时的输入信号的“翻转值”后传递给下游</strong>，如下图。</p>
<p><img src="https://img-blog.csdnimg.cn/12a4771eadbe4ba9943824368033914d.png" alt="在这里插入图片描述"></p>
<p>买苹果的例子也能轻松完成反向传播：</p>
<p><img src="https://img-blog.csdnimg.cn/90b434af3a724632a0ade7e839c000d8.png#pic_center#" alt="在这里插入图片描述"></p>
<p>用Python实现乘法层：<br>
<img src="https://img-blog.csdnimg.cn/eff9a392c4314d24a42a76a5b5f9bc9e.png#pic_center#" alt="在这里插入图片描述"><br>
MulLayer要初始化self.x和self.y是因为<strong>backward要用到这俩变量</strong>，所以需要在forward后保存下来（保存中间计算结果）。而AddLayer的backward直接无脑传就行，不用初始化什么变量。</p>
<p><strong>用Python从零搭建买苹果和橘子的计算图：</strong></p>
<p><img src="https://img-blog.csdnimg.cn/4d73fc5f77054e82a6da6a6d176a1145.png#pic_center#" alt="在这里插入图片描述"><br>
这个实现稍微有一点长，但是每一条命令都很简单。首先，生成必要的层，以合适的顺序调用正向传播的forward()方法。然后，用与正向传播相反的顺序调用反向传播的backward()方法，就可以求出想要的导数。</p>
<h2 id="激活函数层的实现">激活函数层的实现</h2>
<p>现在，我们将计算图的思路应用到神经网络中。这里，我们把构成神经网络的层实现为一个类。</p>
<h3 id="relu层的实现">ReLU层的实现</h3>
<p>如果正向传播时的输入x大于0，则反向传播会将上游的值原封不动地传给下游。反过来，如果正向传播时的x小于等于0，则反向传播中传给下游的信号将停在此处。</p>
<p><img src="https://img-blog.csdnimg.cn/5a6d7a967bba498d965ac780b7c233b0.png" alt="在这里插入图片描述"><br>
ReLU层的作用就像电路中的开关一样。正向传播时，有电流通过的话，就将开关设为 ON；没有电流通过的话，就将开关设为 OFF。反向传播时，开关为ON的话，电流会直接通过；开关为OFF的话，则不会有电流通过。</p>
<h3 id="sigmoid层的实现">Sigmoid层的实现</h3>
<p><img src="https://img-blog.csdnimg.cn/20bc0eb2a20e4168a27fbc3b31e4d6bb.png" alt="在这里插入图片描述"></p>
<h3 id="affine层的实现">Affine层的实现</h3>
<p><img src="https://img-blog.csdnimg.cn/9124185119ee4402b5b4717fcb851fff.png" alt="在这里插入图片描述"><br>
<img src="https://img-blog.csdnimg.cn/77cf32102f5747519c4550e98babf845.png#pic_center#" alt="在这里插入图片描述"></p>
<h3 id="softmax-with-loss层的实现">Softmax-with-Loss层的实现</h3>
<p>softmax函数会<strong>将输入值正规化之后再输出</strong>。</p>
<p><img src="https://img-blog.csdnimg.cn/734f33f0a46b467884c22b0290add88c.png" alt="在这里插入图片描述"></p>
<p>考虑到这里也包含作为损失函数的交叉熵误差（cross entropy error），所以称为“<strong>Softmax-with-Loss</strong>层”。</p>
<p><img src="https://img-blog.csdnimg.cn/66f1945dda964be88ef0f4c1fe9ba979.png#pic_center#" alt="在这里插入图片描述"><br>
图中要注意的是反向传播的结果。Softmax层的反向传播得到了（y1 − t1, y2 − t2, y3 − t3）这样“漂亮”的结果。由于（y1, y2, y3）是Softmax层的输出，（t1, t2, t3）是监督数据，所以（y1 − t1, y2 − t2, y3 − t3）是Softmax层的输出和标签的差分。<strong>神经网络的反向传播会把这个差分表示的误差传递给前面的层，这是神经网络学习中的重要性质。神经网络学习的目的就是通过调整权重参数，使神经网络的输出（Softmax的输出）接近标签。因此，必须将神经网络的输出与标签的误差高效地传递给前面的层</strong>。刚刚的（y1 − t1, y2 − t2, y3 − t3）正是Softmax层的输出与标签的差，直截了当地表示了当前神经网络的输出与标签的误差。</p>
<p>这里考虑一个具体的例子，比如思考标签是（0,1,0），Softmax层的输出是 (0.3,0.2,0.5) 的情形。因为正确解标签处的概率是0.2（20%），这个时候的神经网络未能进行正确的识别。此时，Softmax层的反向传播传递的是 (0.3, −0.8,0.5) 这样一个大的误差。因为这个大的误差会向前面的层传播，<strong>所以Softmax层前面的层会从这个大的误差中学习到“大”的内容。</strong></p>
<p>使用交叉熵误差作为 softmax函数的损失函数后，反向传播得到（y1 − t1, y2 − t2, y3 − t3）这样“漂亮”的结果。实际上，这样 <strong>“漂亮”的结果并不是偶然的</strong>，<strong>而是为了得到这样的结果，特意设计了交叉熵误差函数</strong>！回归问题中输出层使用“恒等函数”，损失函数使用“平方和误差”，也是出于同样的理由。也就是说，使用“平方和误差”作为“恒等函数”的损失函数，反向传播才能得到（y1 −t1, y2 − t2, y3 − t3）这样“漂亮”的结果。</p>
<p><img src="https://img-blog.csdnimg.cn/63675b9cd8c245628ab07d142452d87b.png#pic_center#" alt="在这里插入图片描述"></p>
<h2 id="小总结">小总结</h2>
<p>通过像<strong>组装乐高积木一样组装上面实现的层</strong>，可以构建神经网络。</p>
<p><img src="https://img-blog.csdnimg.cn/b4f3688de8fa4983a99e2ab6a49181c8.png#pic_center#" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/80644dee1b3e4b90b3b669441abd9ffd.png#pic_center#" alt="在这里插入图片描述"></p>
<h1>学习中的技巧</h1>
<h2 id="参数的更新-optimizer">参数的更新（optimizer）</h2>
<p>神经网络的学习的目的是找到使损失函数的值尽可能小的参数。这是寻找最优参数的问题，解决这个问题的过程称为最优化（optimization）。在深度学习中，优化器（optimizer）有很多种选择，如SGD、Momentum、AdaGrad、Adam等，下面一一介绍。</p>
<h3 id="sgd">SGD</h3>
<p>为了找到最优参数，我们将参数的梯度（导数）作为了线索。使用参数的梯度，沿梯度方向更新参数，并重复这个步骤多次，从而逐渐靠近最优参数，这个过程称为随机梯度下降法（stochastic gradient descent），简称SGD。随机是因为我们加入了mini-batch，即每次我们只随机选择一定数量的数据参与学习。SGD相比正常的GD是一个简单、高效的方法，比起胡乱地搜索参数空间，不失为一种“聪明”的方法。</p>
<p><img src="https://img-blog.csdnimg.cn/4de62303cf134579adc93c86777daa12.png" alt="在这里插入图片描述"><br>
SGD呈“之”字形移动。这是一个相当低效的路径。也就是说，SGD的缺点是，<strong>如果函数的形状非均向（anisotropic），比如呈延伸状，搜索的路径就会非常低效</strong>。因此，我们需要比单纯朝梯度方向前进的SGD更聪明的方法。<strong>SGD低效的根本原因是，梯度的方向并没有指向最小值的方向。</strong></p>
<h3 id="momentum">Momentum</h3>
<p>Momentum是“动量”的意思，和物理有关。因为SGD只关注了梯度，但很多时候梯度下降的方向并不是最小值，很有可能是一片平地或一个小坑，当梯度为0，参数就会立刻停止更新，小球会立刻停止滚动。为了改善这种问题，给小球加上速度这一概念，当往下滑动时，即使遇到了平地或小坑，也能由积累的速度助其越过障碍，这种方法就是Momentum！</p>
<p><img src="https://img-blog.csdnimg.cn/152be0eb12504f4383bc5b88a19686a3.png" alt="在这里插入图片描述"><br>
我们可以看到，即使梯度为0，因为之前积累的v不为0，所以w会继续更新！</p>
<p><img src="https://img-blog.csdnimg.cn/4b667a2f4d9e42f98a430a364a8d4f93.png#pic_center#" alt="在这里插入图片描述"></p>
<h3 id="adagrad">AdaGrad</h3>
<p>在神经网络的学习中，学习率（数学式中记为<em>η</em>）的值很重要。学习率过小，会导致学习花费过多时间；反过来，学习率过大，则会导致学习发散而不能正确进行。在关于学习率的有效技巧中，有一种被称为学习率衰减（learning ratedecay）的方法，即随着学习的进行，使学习率逐渐减小。实际上，一开始“多”学，然后逐渐“少”学的方法，在神经网络的学习中经常被使用。</p>
<p>AdaGrad会<strong>为参数的每个元素适当地调整学习率</strong>，与此同时进行学习。</p>
<p><img src="https://img-blog.csdnimg.cn/b5543ae31fca45719657966cb3ec2028.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/bdc5cc895950482caa833e37dd05c181.png#pic_center#" alt="在这里插入图片描述"></p>
<h3 id="adam">Adam</h3>
<p>Momentum参照小球在碗中滚动的物理规则进行移动，AdaGrad为参数的每个元素适当地调整更新步伐。<strong>合体！*<em>变成Adam！Adam是2015年提出的新方法。它的理论有些复杂，直观地讲，就是*<em>融合了Momentum和AdaGrad的方法</em></em>。通过组合前面两个方法的优点，有望实现参数空间的高效搜索。此外，进行</strong>超参数的“偏置校正”**也是Adam的特征。</p>
<p><img src="https://img-blog.csdnimg.cn/70ab48be523547238c09e09943708761.png#pic_center#" alt="在这里插入图片描述"><br>
Adam会设置 3个超参数。一个是学习率（论文中以α出现），另外两个是一次momentum系数β1和二次momentum系数β2。根据论文，标准的设定值是β1为 0.9，β2 为 0.999。设置了这些值后，大多数情况下都能顺利运行。</p>
<h3 id="小总结">小总结</h3>
<p>上面我们介绍了SGD、Momentum、AdaGrad、Adam这4种方法，那么用哪种方法好呢？非常遗憾，（目前）并不存在能在所有问题中都表现良好的方法。这4种方法各有各的特点，都有各自擅长解决的问题和不擅长解决的问题。很多研究中至今仍在使用SGD。Momentum和AdaGrad也是值得一试的方法。一般而言，与SGD相比，其他3种方法可以学习得更快，有时最终的识别精度也更高。最近，很多研究人员和技术人员都喜欢用Adam。</p>
<h2 id="权重的初始值">权重的初始值</h2>
<p>在神经网络的学习中，权重的初始值特别重要。实际上，设定什么样的权重初始值，经常关系到神经网络的学习能否成功。</p>
<p><strong>为什么不能将权重初始值设为0呢？严格地说，为什么不能将权重初始值设成一样的值呢？</strong> 这是因为在误差反向传播法中，所有的权重值都会进行相同的更新。比如，在2层神经网络中，假设第1层和第2层的权重为0。这样一来，正向传播时，因为输入层的权重为0，所以第2层的神经元全部会被传递相同的值。第2层的神经元中全部输入相同的值，这意味着反向传播时第2层的权重全部都会进行相同的更新。<strong>因此，权重被更新为相同的值，并拥有了对称的值（重复的值）。这使得神经网络拥有许多不同的权重的意义丧失了。为了防止“权重均一化”（严格地讲，是为了瓦解权重的对称结构），必须随机生成初始值。</strong></p>
<p>因为激活函数sigmoid函数是S型函数，随着输出不断地靠近0（或者靠近1），它的导数的值逐渐接近0。因此，偏向0和1的数据分布会造成反向传播中梯度的值不断变小，最后消失。这个问题称为<strong>梯度消失</strong>（gradient vanishing）。层次加深的深度学习中，梯度消失的问题可能会更加严重。</p>
<h3 id="xavier初始值">Xavier初始值</h3>
<p>为了使各层的激活值呈现出具有相同广度的分布，推荐使用Xavier初始值。<br>
<img src="https://img-blog.csdnimg.cn/20022954fbb14b3c863e1b8a496c5c9c.png#pic_center#" alt="在这里插入图片描述"><br>
使用Xavier初始值后，前一层的节点数越多，要设定为目标节点的初始值的权重尺度就越小。</p>
<h3 id="he初始值">He初始值</h3>
<p><strong>Xavier初始值是以激活函数是线性函数为前提而推导出来的</strong>。因为sigmoid函数和tanh函数左右对称，且中央附近可以视作线性函数，所以适合使用Xavier初始值。但当激活函数使用ReLU时，一般推荐使用<strong>ReLU专用的初始值</strong>，也就是Kaiming He等人推荐的初始值，也称为“<strong>He初始值</strong>”。</p>
<p><img src="https://img-blog.csdnimg.cn/144b6e5209344d808531371d833be766.png#pic_center#" alt="在这里插入图片描述"></p>
<h3 id="小总结">小总结</h3>
<p><strong>当激活函数使用ReLU时，权重初始值使用He初始值，当激活函数为sigmoid或tanh等S型曲线函数时，初始值使用Xavier初始值。这是目前的最佳实践。</strong></p>
<p><img src="https://img-blog.csdnimg.cn/067f2c726cb348049ea4fcf3fefa0729.png#pic_center#" alt="在这里插入图片描述"><br>
在神经网络的学习中，<strong>权重初始值非常重要</strong>。很多时候权重初始值的设定关系到神经网络的学习能否成功。权重初始值的重要性容易被忽视，而任何事情的开始（初始值）总是关键的。</p>
<h2 id="batch-normalization">Batch Normalization</h2>
<p>为了使各层拥有适当的广度，“强制性”地调整激活值的分布，Batch Normalization方法就是基于这个想法而产生的。简单来说，就是<strong>在ReLU前正规化一下数据。</strong></p>
<p><img src="https://img-blog.csdnimg.cn/ee96a6520a4044cdb76b242d4628f34a.png" alt="在这里插入图片描述"><br>
Batch Norm，顾名思义，以进行学习时的mini-batch为单位，按mini-batch进行正规化。具体而言，就是进行使数据分布的均值为0、方差为1的正规化。</p>
<p><img src="https://img-blog.csdnimg.cn/52e147c20be7455aa8fdce6fe10b9809.png#pic_center#" alt="在这里插入图片描述"></p>
<p><strong>几乎所有的情况下都是使用Batch Norm时学习进行得更快</strong>。实际上，在不使用Batch Norm的情况下，如果不赋予一个尺度好的初始值，学习将完全无法进行。通过使用Batch Norm，可以推动学习的进行。并且，对权重初始值变得健壮（“对初始值健壮”表示不那么依赖初始值）。Batch Norm具备了如此优良的性质，一定能应用在更多场合中。</p>
<h2 id="正规化">正规化</h2>
<p>机器学习的问题中，过拟合是一个很常见的问题。过拟合指的是只能拟合训练数据，但不能很好地拟合不包含在训练数据中的其他数据的状态。机器学习的目标是<strong>提高泛化能力</strong>，即便是没有包含在训练数据里的未观测数据，也希望模型可以进行正确的识别。</p>
<p>发生过拟合的原因：</p>
<ol>
<li>模型拥有大量参数、表现力强。</li>
<li>训练数据少。</li>
</ol>
<h3 id="权重衰减-l1-l2正则化">权重衰减（L1、L2正则化）</h3>
<p>权值衰减是一直以来经常被使用的一种抑制过拟合的方法。该方法通过在学习的过程中对大的权重进行惩罚，来抑制过拟合。很多过拟合原本就是因为权重参数取值过大才发生的。正则化就是在损失函数后面加上权重，抑制权重过大的情况。</p>
<p>欢迎去康康我的博客《<a href="https://blog.csdn.net/weixin_45116099/article/details/122524171">无废话的机器学习笔记（番外）(数据集，方差-偏差，过拟合，正则化，降维)</a>》哦。</p>
<h3 id="dropout">Dropout</h3>
<p>如果网络的模型变得很复杂，只用权值衰减就难以应对了。在这种情况下，我们经常会使用Dropout 方法。<br>
<strong>Dropout是一种在学习的过程中随机删除神经元的方法。</strong> 训练时，随机选出隐藏层的神经元，然后将其删除。被删除的神经元不再进行信号的传递，如图所示。训练时，每传递一次数据，就会随机选择要删除的神经元。然后，测试时，虽然会传递所有的神经元信号，但是对于各个神经元的输出，要乘上训练时的删除比例后再输出。</p>
<p><img src="https://img-blog.csdnimg.cn/ad73324a07a04ba8bda39758b27d153e.png" alt="在这里插入图片描述"></p>
<p>机器学习中经常使用<strong>集成学习</strong>。所谓集成学习，就是让多个模型单独进行学习，推理时再取多个模型的输出的平均值。用神经网络的语境来说，比如，准备 5个结构相同（或者类似）的网络，分别进行学习，测试时，以这 5个网络的输出的平均值作为答案。实验告诉我们，通过进行集成学习，神经网络的识别精度可以提高好几个百分点。这个集成学习与 Dropout有密切的关系。这是因为可以将 Dropout理解为，通过在学习过程中随机删除神经元，从而每一次都让不同的模型进行学习。并且，推理时，通过对神经元的输出乘以删除比例（比如，0.5等），可以取得模型的平均值。也就是说，可以理解成，Dropout将集成学习的效果（模拟地）通过一个网络实现了。</p>
<h3 id="超参数的验证">超参数的验证</h3>
<p>神经网络中，除了权重和偏置等参数，超参数（hyper-parameter）也经常出现。这里所说的超参数是指，比如各层的神经元数量、batch大小、参数更新时的学习率或权值衰减等。如果这些超参数没有设置合适的值，模型的性能就会很差。虽然超参数的取值非常重要，但是在决定超参数的过程中一般会伴随很多的试错。</p>
<p>调整超参数时，必须使用超参数专用的确认数据。用于调整超参数的数据，一般称为验证数据（validation data）。我们使用这个验证数据来评估超参数的好坏。所以数据集一般事先分成<strong>训练数据、验证数据、测试数据</strong>三部分（6:2:2）。</p>
<p><img src="https://img-blog.csdnimg.cn/93c37e2339734061ba1375d2262cc162.png#pic_center#" alt="在这里插入图片描述"></p>
<p>进行超参数的最优化时，逐渐缩小超参数的“好值”的存在范围非常重要。所谓逐渐缩小范围，是指一开始先大致设定一个范围，从这个范围中随机选出一个超参数（采样），用这个采样到的值进行识别精度的评估；然后，多次重复该操作，观察识别精度的结果，根据这个结果缩小超参数的“好值”的范围。通过重复这一操作，就可以逐渐确定超参数的合适范围。在进行神经网络的超参数的最优化时，与网格搜索等有规律的搜索相比，随机采样的搜索方式效果更好。这是因为在多个超参数中，各个超参数对最终的识别精度的影响程度不同。</p>
<p>在超参数的最优化中，要注意的是深度学习需要很长时间（比如，几天或几周）。因此，在超参数的搜索中，需要尽早放弃那些不符合逻辑的超参数。于是，在超参数的最优化中，减少学习的epoch，缩短一次评估所需的时间是一个不错的办法。</p>
<h2 id="小总结">小总结</h2>
<p><img src="https://img-blog.csdnimg.cn/3b1e7efb894d48918bff47000d99a821.png#pic_center#" alt="在这里插入图片描述"></p>
<h1>卷积神经网络 CNN</h1>
<p>CNN被用于图像识别、语音识别等各种场合，在图像识别的比赛中，基于深度学习的方法几乎都以CNN为基础。</p>
<p>CNN和之前介绍的神经网络一样，<strong>可以像乐高积木一样通过组装层来构建</strong>。不过，CNN中新出现了<strong>卷积层</strong>（Convolution层）和<strong>池化层</strong>（Pooling层）。之前介绍的神经网络中，<strong>相邻层的所有神经元之间都有连接，这称为全连接</strong>（fully-connected）。另外，我们用Affine层实现了全连接层。如果使用这个Affine层，一个5层的全连接的神经网络就可以通过图所示的网络结构来实现。</p>
<p><img src="https://img-blog.csdnimg.cn/8d479c50fef04dca9ae59b8b73d36b62.png" alt="在这里插入图片描述"></p>
<p>那么，CNN会是什么样的结构呢？下图是<strong>CNN的一个例子</strong>。</p>
<p><img src="https://img-blog.csdnimg.cn/162aba72b9af4ce8a39c2bda5b03ee3d.png" alt="在这里插入图片描述"></p>
<h2 id="卷积层">卷积层</h2>
<p>在全连接层中，相邻层的神经元全部连接在一起，输出的数量可以任意决定。<strong>全连接层存在什么问题呢？那就是数据的形状被“忽视”了。</strong> 比如，输入数据是图像时，图像通常是高、长、通道方向上的3维形状。但是，向全连接层输入时，需要将3维数据拉平为1维数据。实际上，前面提到的使用了MNIST数据集的例子中，输入图像就是1通道、高28像素、长28像素的（1, 28,28）形状，但却被排成1列，以784个数据的形式输入到最开始的Affine层。</p>
<p>图像是3维形状，这个形状中应该含有重要的空间信息。比如，空间上邻近的像素为相似的值、RBG的各个通道之间分别有密切的关联性、相距较远的像素之间没有什么关联等，3维形状中可能隐藏有值得提取的本质模式。但是，因为全连接层会忽视形状，将全部的输入数据作为相同的神经元（同一维度的神经元）处理，所以无法利用与形状相关的信息。</p>
<p>而<strong>卷积层可以保持形状不变</strong>。当输入数据是图像时，卷积层会以3维数据的形式接收输入数据，并同样以3维数据的形式输出至下一层。<strong>因此，在CNN中，可以（有可能）正确理解图像等具有形状的数据。</strong></p>
<h3 id="卷积运算">卷积运算</h3>
<p>卷积运算对输入数据应用滤波器。在下面例子中，输入数据是有高长方向的形状的数据，滤波器也一样，有高长方向上的维度。假设用（height, width）表示数据和滤波器的形状，则在本例中，输入大小是(4, 4)，滤波器大小是(3, 3)，输出大小是(2, 2)。另外，有的文献中也会用“核”这个词来表示这里所说的“滤波器”。卷积运算以一定间隔滑动滤波器的窗口并应用。这里所说的窗口是指图中灰色的3 × 3的部分。如图所示，将各个位置上滤波器的元素和输入的对应元素相乘，然后再求和（有时将这个计算称为乘积累加运算）。然后，将这个结果保存到输出的对应位置。将这个过程在所有位置都进行一遍，就可以得到卷积运算的输出。</p>
<p><img src="https://img-blog.csdnimg.cn/2aa209c5e3de47688ded5747c30d8556.png" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/186fd072612b4908b9b90a009de5a88b.png#pic_center#" alt="在这里插入图片描述"></p>
<h3 id="填充-padding">填充（padding）</h3>
<p>在进行卷积层的处理之前，有时要向输入数据的周围填入固定的数据（比如0等），这称为填充（padding），是卷积运算中经常会用到的处理。比如，在图中，对大小为(4, 4)的输入数据应用了幅度为1的填充。“幅度为1的填充”是指用幅度为1像素的0填充周围。</p>
<p><img src="https://img-blog.csdnimg.cn/378444c856584ea482ad39b83d88adfb.png#pic_center#" alt="在这里插入图片描述"><br>
通过填充，大小为(4, 4)的输入数据变成了(6, 6)的形状。然后，应用大小为(3, 3)的滤波器，生成了大小为(4, 4)的输出数据。这个例子中将填充设成了1，不过填充的值也可以设置成2、3等任意的整数。使用填充主要是为了调整输出的大小。如果每次进行卷积运算都会缩小空间，那么在某个时刻输出大小就有可能变为 1，导致无法再应用卷积运算。为了避免出现这样的情况，就要使用填充。</p>
<h3 id="步幅-stride">步幅（stride）</h3>
<p>应用滤波器的位置间隔称为步幅（stride）。之前的例子中步幅都是1，如果将步幅设为2，则如图所示，应用滤波器的窗口的间隔变为2个元素。</p>
<p><img src="https://img-blog.csdnimg.cn/d8d426e1c2784b3a8f6298b534824787.png#pic_center#" alt="在这里插入图片描述"></p>
<p>综上，<strong>增大步幅后，输出大小会变小。而增大填充后，输出大小会变大。</strong></p>
<p><img src="https://img-blog.csdnimg.cn/be103ea55bbe49a9a7cd49492238753a.png#pic_center#" alt="在这里插入图片描述"></p>
<h3 id="3维数据卷积运算">3维数据卷积运算</h3>
<p><img src="https://img-blog.csdnimg.cn/e6d1245bd0e14d3d81c71ebaad6c09c7.png#pic_center#" alt="在这里插入图片描述"><br>
需要注意的是，在3维数据的卷积运算中，输入数据和滤波器的通道数要设为相同的值。在这个例子中，输入数据和滤波器的通道数一致，均为3。滤波器大小可以设定为任意值（不过，每个通道的滤波器大小要全部相同）。这个例子中滤波器大小为(3, 3)，但也可以设定为(2, 2)、(1, 1)、(5, 5)等任意值。再强调一下，<strong>通道数只能设定为和输入数据的通道数相同的值</strong>。</p>
<h2 id="池化层">池化层</h2>
<p>池化是缩小高、长方向上的空间的运算。比如，如图7-14所示，进行将2 × 2的区域集约成1个元素的处理，缩小空间大小。</p>
<p><img src="https://img-blog.csdnimg.cn/009009119f634a0caeff22f760948eac.png#pic_center#" alt="在这里插入图片描述"></p>
<p>就是求最大值，非常简单，叫做<strong>Max池化</strong>。也有<strong>Average池化</strong>。Max池化是从目标区域中取出最大值，Average池化则是计算目标区域的平均值。</p>
<p><strong>池化层的特征</strong>：</p>
<ol>
<li>没有要学习的参数</li>
<li>通道数不发生变化</li>
<li>对微小的位置变化具有鲁棒性（健壮）</li>
</ol>
<h2 id="im2col">im2col</h2>
<p>如果老老实实地实现卷积运算，估计要重复好几层的for语句。这样的实现有点麻烦，而且，NumPy中存在使用for语句后处理变慢的缺点（NumPy中，访问元素时最好不要用for语句）。这里，我们不使用for语句，而是使用im2col这个便利的函数进行简单的实现。</p>
<p>**im2col是一个函数，将输入数据展开以适合滤波器（权重）。**如图所示，对3维的输入数据应用im2col后，数据转换为2维矩阵（正确地讲，是把包含批数量的4维数据转换成了2维数据）。im2col会把输入数据展开以适合滤波器（权重）。具体地说，如图所示，对于输入数据，将应用滤波器的区域（3维方块）横向展开为1列。im2col会在所有应用滤波器的地方进行这个展开处理。</p>
<p><img src="https://img-blog.csdnimg.cn/9eff8de9105e4b508dfeff91838acdbb.png#pic_center#" alt="在这里插入图片描述"><br>
使用im2col展开输入数据后，之后就只需将卷积层的滤波器（权重）纵向展开为1列，并计算2个矩阵的乘积即可（参照图7-19）。这和全连接层的Affine层进行的处理基本相同。</p>
<p>在滤波器的应用区域重叠的情况下，使用im2col展开后，展开后的元素个数会多于原方块的元素个数。因此，<strong>使用im2col的实现存在比普通的实现消耗更多内存的缺点</strong>。但是，汇总成一个大的矩阵进行计算，对计算机的计算颇有益处。比如，<strong>在矩阵计算的库（线性代数库）等中，矩阵计算的实现已被高度最优化，可以高速地进行大矩阵的乘法运算。因此，通过归结到矩阵计算上，可以有效地利用线性代数库。</strong></p>
<p><img src="https://img-blog.csdnimg.cn/ff61f251d5074326a6455d956530eade.png" alt="在这里插入图片描述"></p>
<p>卷积层的初始化方法将滤波器（权重）、偏置、步幅、填充作为参数接收。滤波器是 (FN, C, FH, FW)的 4 维形状。另外，FN、C、FH、FW分别是 FilterNumber（滤波器数量）、Channel、Filter Height、Filter Width的缩写。这里用粗体字表示Convolution层的实现中的重要部分。在这些粗体字部分，用im2col展开输入数据，并用reshape将滤波器展开为2维数组。然后，计算展开后的矩阵的乘积。通过在reshape时指定为-1，reshape函数会自动计算-1维度上的元素个数，以使多维数组的元素个数前后一致。(10, 3, 5, 5)形状的数组的元素个数共有750个，指定reshape(10,-1)后，就会转换成(10, 75)形状的数组。transpose会更改多维数组的轴的顺序。</p>
<p><strong>池化层也easy：</strong></p>
<p><img src="https://img-blog.csdnimg.cn/a25c2c8c6c2144e69205a4473409498f.png" alt="在这里插入图片描述"></p>
<h2 id="cnn的实现">CNN的实现</h2>
<p><img src="https://img-blog.csdnimg.cn/9695b283646d49f38df2ffdb984057b3.png" alt="在这里插入图片描述"><br>
搭积木！</p>
<p>如果堆叠了多层卷积层，则<strong>随着层次加深，提取的信息也愈加复杂、抽象</strong>，这是深度学习中很有意思的一个地方。最开始的层对简单的边缘有响应，接下来的层对纹理有响应，再后面的层对更加复杂的物体部件有响应。也就是说，随着层次加深，<strong>神经元从简单的形状向“高级”信息变化</strong>。换句话说，就像我们理解东西的“含义”一样，响应的对象在逐渐变化。</p>
<p>是不是想赶紧动起手来，看看这篇！《<a href="https://blog.csdn.net/weixin_45116099/article/details/127708920">最简单用TensorFlow实现CNN</a>》</p>
<h2 id="具有代表性的cnn">具有代表性的CNN</h2>
<h3 id="lenet">LeNet</h3>
<p>LeNet在1998年被提出，是进行手写数字识别的网络。如图所示，它有连续的卷积层和池化层（正确地讲，是只“抽选元素”的子采样层），最后经全连接层输出结果。</p>
<p><img src="https://img-blog.csdnimg.cn/d2ac9cc1972246709543a7c8a756d973.png" alt="在这里插入图片描述"><br>
和“现在的CNN”相比，LeNet有几个不同点。第一个不同点在于激活函数。LeNet中使用sigmoid函数，而现在的CNN中主要使用ReLU函数。此外，原始的LeNet中使用子采样（subsampling）缩小中间数据的大小，而现在的CNN中Max池化是主流。</p>
<h3 id="alexnet">AlexNet</h3>
<p>在LeNet问世20多年后，AlexNet被发布出来。AlexNet是引发深度学习热潮的导火线，不过它的网络结构和LeNet基本上没有什么不同。</p>
<p><img src="https://img-blog.csdnimg.cn/9fd0c480de72448782d04f8b35ea34df.png#pic_center#" alt="在这里插入图片描述"><br>
AlexNet叠有多个卷积层和池化层，最后经由全连接层输出结果。虽然结构上AlexNet和LeNet没有大的不同，但有以下几点差异：</p>
<p>1、激活函数使用ReLU</p>
<p>2、使用进行局部正规化的LRN（Local Response Normalization）层</p>
<p>3、使用Dropout</p>
<h3 id="vgg">VGG</h3>
<p>VGG是由卷积层和池化层构成的基础的CNN。不过，如图所示，它的特点在于将有权重的层（卷积层或者全连接层）叠加至16层（或者19层），具备了深度（根据层的深度，有时也称为“VGG16”或“VGG19”）。VGG中需要注意的地方是，基于3×3的小型滤波器的卷积层的运算是连续进行的。如图所示，重复进行“卷积层重叠2次到4次，再通过池化层将大小减半”的处理，最后经由全连接层输出结果。</p>
<p><img src="https://img-blog.csdnimg.cn/9271a68d881e46a2b553f0b4c746b576.png#pic_center#" alt="在这里插入图片描述"></p>
<h3 id="googlenet">GoogLeNet</h3>
<p>图中的矩形表示卷积层、池化层等。只看图的话，这似乎是一个看上去非常复杂的网络结构，但实际上它基本上和之前介绍的CNN结构相同。不过，GoogLeNet的特征是，网络不仅在纵向上有深度，在横向上也有宽度，这称为“Inception结构”。Inception结构使用了多个大小不同的滤波器（和池化），最后再合并它们的结果。GoogLeNet的特征就是将这个Inception结构用作一个构件（构成元素）。此外，在GoogLeNet中，很多地方都使用了大小为1 × 1的滤波器的卷积层。这个1 × 1的卷积运算通过在通道方向上减小大小，有助于减少参数和实现高速化处理。</p>
<p><img src="https://img-blog.csdnimg.cn/bf71cac4d0484082ab2a8af0b0a6299c.png" alt="在这里插入图片描述"></p>
<h3 id="resnet">ResNet</h3>
<p>ResNet是微软团队开发的网络。它的特征在于具有比以前的网络更深的结构。我们已经知道加深层对于提升性能很重要。但是，在深度学习中，过度加深层的话，很多情况下学习将不能顺利进行，导致最终性能不佳。ResNet中，为了解决这类问题，导入了“快捷结构”（也称为“捷径”或“小路”）。导入这个快捷结构后，就可以随着层的加深而不断提高性能了（当然，层的加深也是有限度的）。</p>
<p><img src="https://img-blog.csdnimg.cn/3e0188c5849843ae92e9a4ecec73f249.png" alt="在这里插入图片描述"></p>
<h3 id="小总结">小总结</h3>
<p>关于网络结构，其实上面的结构没有太大的不同。但是，围绕它们的环境和计算机技术有了很大的进步。具体地说，现在任何人都可以获得大量的数据。而且，擅长大规模并行计算的GPU得到普及，高速进行大量的运算已经成为可能。<strong>大数据和GPU</strong>已成为深度学习发展的巨大的原动力。大多数情况下，深度学习（加深了层次的网络）存在大量的参数。因此，学习需要大量的计算，并且需要使那些参数“满意”的大量数据。可以说是 GPU和大数据给这些课题带来了希望。</p>
<p><img src="https://img-blog.csdnimg.cn/706d1d52f34643e3b718d37a67527ef3.png#pic_center#" alt="在这里插入图片描述"></p>
<p><img src="https://img-blog.csdnimg.cn/bfdf68f9326b43a9a7fdfdd961338cd1.png#pic_center#" alt="在这里插入图片描述"></p>
<h1>深度学习</h1>
<h2 id="更深">更深</h2>
<p>关于加深层的重要性，现状是理论研究还不够透彻。尽管目前相关理论还比较贫乏，但是有几点可以从过往的研究和实验中得以解释。从很多比赛的结果显示，最近前几名的方法多是基于深度学习的，并且有逐渐加深网络的层的趋势。也就是说，可以看到层越深，识别性能也越高。<br>
加深层可以减少网络的参数数量。说得详细一点，就是与没有加深层的网络相比，加深了层的网络可以用更少的参数达到同等水平（或者更强）的表现力。这一点结合卷积运算中的滤波器大小来思考就好理解了。<br>
<img src="https://img-blog.csdnimg.cn/b816086172464e178d77209851eb1ba8.png" alt="在这里插入图片描述"><br>
一次5 × 5的卷积运算的区域可以由两次3 × 3的卷积运算抵充。并且，相对于前者的参数数量25（5 × 5），后者一共是18（2 × 3 × 3），通过叠加卷积层，参数数量减少了。而且，这个参数数量之差会随着层的加深而变大。</p>
<p>加深层可以使<strong>学习更加高效</strong>。与没有加深层的网络相比，通过加深层，可以<strong>减少学习数据</strong>，从而高效地进行学习。通过加深网络，就可以分层次地分解需要学习的问题。因此，各层需要学习的问题就变成了更简单的问题。比如，最开始的层只要专注于学习边缘就好，这样一来，只需用较少的学习数据就可以高效地进行学习。这是为什么呢？因为和印有“狗”的照片相比，包含边缘的图像数量众多，并且边缘的模式比“狗”的模式结构更简单。<strong>通过加深层，可以分层次地传递信息，这一点也很重要。比如，因为提取了边缘的层的下一层能够使用边缘的信息，所以应该能够高效地学习更加高级的模式。也就是说，通过加深层，可以将各层要学习的问题分解成容易解决的简单问题，从而可以进行高效的学习。</strong></p>
<h2 id="更快">更快</h2>
<p>在一般的CNN中，大多数时间都被耗费在卷积层上。实际上，卷积层的处理时间加起来占GPU整体的95%，占CPU整体的89%！因此，如何高速、高效地进行卷积层中的运算是深度学习的一大课题。卷积层中进行的运算可以追溯至乘积累加运算。因此，深度学习的高速化的主要课题就变成了如何高速、高效地进行大量的乘积累加运算。</p>
<h3 id="gpu计算">GPU计算</h3>
<p>虽然到目前为止，我们都是使用CPU进行计算的，但现实是只用CPU来应对深度学习无法令人放心。实际上，环视一下周围，大多数深度学习的框架都支持GPU（Graphics Processing Unit），可以高速地处理大量的运算。另外，最近的框架也开始支持多个GPU或多台机器上的分布式学习。</p>
<p><img src="https://img-blog.csdnimg.cn/2cdfed733bb844b587112864e259e4ec.png#pic_center#" alt="在这里插入图片描述"><br>
GPU原本是作为图像专用的显卡使用的，但最近不仅用于图像处理，也用于通用的数值计算。由于GPU可以高速地进行并行数值计算，因此<strong>GPU</strong>计算的目标就是将这种压倒性的计算能力用于各种用途。</p>
<p>深度学习中需要进行大量的乘积累加运算（或者大型矩阵的乘积运算）。这种大量的并行运算正是GPU所擅长的（反过来说，CPU比较擅长连续的、复杂的计算）。因此，与使用单个CPU相比，使用GPU进行深度学习的运算可以达到惊人的高速化。如果对于一个网络，使用CPU要花40天以上的时间，而使用GPU则可以将时间缩短至6天。</p>
<p>GPU主要由NVIDIA和AMD两家公司提供。虽然两家的GPU都可以用于通用的数值计算，<strong>但与深度学习比较“亲近”的是NVIDIA的GPU</strong>。实际上，大多数深度学习框架只受益于NVIDIA的GPU。这是因为深度学习的框架中使用了NVIDIA提供的<strong>CUDA</strong>这个面向GPU计算的综合开发环境。</p>
<h3 id="分布式学习">分布式学习</h3>
<p>虽然通过GPU可以实现深度学习运算的高速化，但即便如此，当网络较深时，学习还是需要几天到几周的时间。并且，前面也说过，深度学习伴随着很多试错。为了创建良好的网络，需要反复进行各种尝试，这样一来就必然会产生尽可能地缩短一次学习所需的时间的要求。于是，将深度学习的学习过程扩展开来的想法（也就是分布式学习）就变得重要起来。</p>
<p>现在的深度学习框架中，出现了好几个支持多GPU或者多机器的分布式学习的框架。其中，Google的TensorFlow、微软的CNTK（Computational Network Toolki）在开发过程中高度重视分布式学习。以大型数据中心的低延迟·高吞吐网络作为支撑，基于这些框架的分布式学习呈现出惊人的效果。</p>
<p>随着GPU个数的增加，学习速度也在提高。实际上，与使用1个GPU时相比，使用100个GPU（设置在多台机器上，共100个）似乎可以实现56倍的高速化！这意味着之前花费7天的学习只要3个小时就能完成，充分说明了分布式学习惊人的效果。</p>
<h3 id="运算精度的位数缩减">运算精度的位数缩减</h3>
<p>在深度学习的高速化中，除了计算量之外，内存容量、总线带宽等也有可能成为瓶颈。关于内存容量，需要考虑将大量的权重参数或中间数据放在内存中。关于总线带宽，当流经GPU（或者CPU）总线的数据超过某个限制时，就会成为瓶颈。考虑到这些情况，我们希望尽可能减少流经网络的数据的位数。</p>
<p>计算机中表示小数时，有32位的单精度浮点数和64位的双精度浮点数等格式。根据以往的实验结果，在深度学习中，即便是16位的半精度浮点数（half float），也可以顺利地进行学习。实际上，NVIDIA的下一代GPU框架Pascal也支持半精度浮点数的运算，由此可以认为今后半精度浮点数将被作为标准使用。</p>
<p>为了实现深度学习的高速化，位数缩减是今后必须关注的一个课题，特别是在面向嵌入式应用程序中使用深度学习时，位数缩减非常重要。</p>
<h3 id="小总结">小总结</h3>
<p><img src="https://img-blog.csdnimg.cn/57c00b8afaf64c92b1ff3206ad7d7e63.png#pic_center#" alt="在这里插入图片描述"></p>
<h1>结尾</h1>
<p>上面的全部图片和内容来自于《深度学习入门-基于Python的理论和实现》这本好书，它真正地从零开始一步一步教导着我如何用Python搭建神经网络，所以这篇博客相当于读书笔记，我将其中比较关键的核心知识简练地提取出来，图也适当进行了整合，希望能让朋友们最快速地入门或回顾深度学习基础知识。如果觉得有帮助可以给个赞哦蟹蟹</p>
]]></content>
      <tags>
        <tag>frame</tag>
        <tag>Neural-Network-Frame</tag>
      </tags>
  </entry>
  <entry>
    <title>bayes-net</title>
    <url>/2023/09/30/bayes-net/</url>
    <content><![CDATA[<p>[TOC]</p>
<h1>引言</h1>
<p>事实上，介绍贝叶斯定理、贝叶斯方法、贝叶斯推断的资料、书籍不少，比如《数理统计学简史》，以及《统计决策论及贝叶斯分析 James O.Berger著》等等，然介绍贝叶斯网络的中文资料则非常少，中文书籍总共也没几本，有的多是英文资料，但初学者一上来就扔给他一堆英文论文，因无基础和语言的障碍而读得异常吃力导致无法继续读下去则是非常可惜的（当然，有了一定的基础后，便可阅读更多的英文资料）。</p>
<p>故本文结合课程讲义及相关参考资料写就，从贝叶斯方法讲起，重点阐述贝叶斯网络，依然可以定义为一篇读书笔记或学习笔记，有任何问题，欢迎随时不吝指出，thanks！</p>
<h2 id="贝叶斯方法">贝叶斯方法</h2>
<p>长久以来，人们对一件事情发生或不发生的概率<img src="https://img-blog.csdn.net/20141110214603237" alt="img">，只有固定的0和1，即要么发生，要么不发生，从来不会去考虑某件事情发生的概率有多大，不发生的概率又是多大。而且概率<img src="https://img-blog.csdn.net/20141110214603237" alt="img">虽然未知，但最起码是一个确定的值。比如如果问那时的人们一个问题：“有一个袋子，里面装着若干个白球和黑球，请问从袋子中取得白球的概率<img src="https://img-blog.csdn.net/20141110214603237" alt="img">是多少？”他们会想都不用想，会立马告诉你，取出白球的概率<img src="https://img-blog.csdn.net/20141110214603237" alt="img">就是1/2，要么取到白球，要么取不到白球，即θ只能有一个值，而且不论你取了多少次，取得白球的概率θ始终都是1/2，即不随观察结果X 的变化而变化。</p>
<p>这种频率派的观点长期统治着人们的观念，直到后来一个名叫Thomas Bayes的人物出现。</p>
<h3 id="贝叶斯方法的提出">贝叶斯方法的提出</h3>
<p>托马斯·贝叶斯Thomas Bayes（1702-1763）在世时，并不为当时的人们所熟知，很少发表论文或出版著作，与当时学术界的人沟通交流也很少，用现在的话来说，贝叶斯就是活生生一民间学术“屌丝”，可这个“屌丝”最终发表了一篇名为“An essay towards solving a problem in the doctrine of chances”，翻译过来则是：机遇理论中一个问题的解。你可能觉得我要说：这篇论文的发表随机产生轰动效应，从而奠定贝叶斯在学术史上的地位。</p>
<blockquote>
<p>​      <img src="https://img-blog.csdn.net/20141110191248285" alt="img"></p>
</blockquote>
<p>事实上，上篇论文发表后，在当时并未产生多少影响，在20世纪后，这篇论文才逐渐被人们所重视。对此，与梵高何其类似，画的画生前一文不值，死后价值连城。</p>
<p>回到上面的例子：“有一个袋子，里面装着若干个白球和黑球，请问从袋子中取得白球的概率θ是多少？”贝叶斯认为取得白球的概率<img src="https://img-blog.csdn.net/20141110214603237" alt="img">是个不确定的值，因为其中含有机遇的成分。比如，一个朋友创业，你明明知道创业的结果就两种，即要么成功要么失败，但你依然会忍不住去估计他创业成功的几率有多大？你如果对他为人比较了解，而且有方法、思路清晰、有毅力、且能团结周围的人，你会不由自主的估计他创业成功的几率可能在80%以上。这种不同于最开始的“非黑即白、非0即1”的思考方式，便是贝叶斯式的思考方式。</p>
<p>继续深入讲解贝叶斯方法之前，先简单总结下频率派与贝叶斯派各自不同的思考方式：</p>
<ul>
<li>
<p>频率派把需要推断的参数θ看做是固定的未知常数，即概率<img src="https://img-blog.csdn.net/20141110214603237" alt="img">虽然是未知的，但最起码是确定的一个值，同时，样本X 是随机的，所以频率派重点研究样本空间，大部分的概率计算都是针对样本X 的分布；</p>
</li>
<li>
<p>而贝叶斯派的观点则截然相反，他们认为参数<img src="https://img-blog.csdn.net/20141110214603237" alt="img">是随机变量，而样本X 是固定的，由于样本是固定的，所以他们重点研究的是参数<img src="https://img-blog.csdn.net/20141110214603237" alt="img">的分布。</p>
<p>相对来说，频率派的观点容易理解，所以下文重点阐述贝叶斯派的观点。</p>
<p>贝叶斯派既然把<img src="https://img-blog.csdn.net/20141110214603237" alt="img">看做是一个随机变量，所以要计算<img src="https://img-blog.csdn.net/20141110214603237" alt="img">的分布，便得事先知道<img src="https://img-blog.csdn.net/20141110214603237" alt="img">的无条件分布，即在有样本之前（或观察到X之前），<img src="https://img-blog.csdn.net/20141110214603237" alt="img">有着怎样的分布呢？</p>
<p>比如往台球桌上扔一个球，这个球落会落在何处呢？如果是不偏不倚的把球抛出去，那么此球落在台球桌上的任一位置都有着相同的机会，即球落在台球桌上某一位置的概率<img src="https://img-blog.csdn.net/20141110214603237" alt="img">服从均匀分布。这种在实验之前定下的属于基本前提性质的分布称为先验分布，或<img src="https://img-blog.csdn.net/20141110214603237" alt="img">的无条件分布。</p>
<p>至此，贝叶斯及贝叶斯派提出了一个思考问题的固定模式：</p>
</li>
<li>
<p><strong>先验分布<img src="https://img-blog.csdn.net/20141110214925523" alt="img"> + 样本信息<img src="https://img-blog.csdn.net/20141110211153578" alt="img"><img src="https://img-blog.csdn.net/20141110190250086" alt="img"> 后验分布<img src="https://img-blog.csdn.net/20141110215058639" alt="img"></strong></p>
<p>上述思考模式意味着，新观察到的样本信息将修正人们以前对事物的认知。换言之，在得到新的样本信息之前，人们对<img src="https://img-blog.csdn.net/20141110210919359" alt="img">的认知是先验分布<img src="https://img-blog.csdn.net/20141110214925523" alt="img">，在得到新的样本信息<img src="https://img-blog.csdn.net/20141110211153578" alt="img">后，人们对<img src="https://img-blog.csdn.net/20141110210919359" alt="img">的认知为<img src="https://img-blog.csdn.net/20141110215058639" alt="img">。</p>
</li>
</ul>
<p>​    其中，先验信息一般来源于经验跟历史资料。比如林丹跟某选手对决，解说一般会根据林丹历次比赛的成绩对此次比赛的胜负做个大致的判断。再比如，某工厂每天都要对产品进行质检，以评估产品的不合格率θ，经过一段时间后便会积累大量的历史资料，这些历史资料便是先验知识，有了这些先验知识，便在决定对一个产品是否需要每天质检时便有了依据，如果以往的历史资料显示，某产品的不合格率只有0.01%，便可视为信得过产品或免检产品，只每月抽检一两次，从而省去大量的人力物力。</p>
<p>而后验分布<img src="https://img-blog.csdn.net/20141110215058639" alt="img">一般也认为是在给定样本<img src="https://img-blog.csdn.net/20141110211153578" alt="img">的情况下<img src="https://img-blog.csdn.net/20141110210919359" alt="img">的条件分布，而使<img src="https://img-blog.csdn.net/20141110215058639" alt="img">达到最大的值<img src="https://img-blog.csdn.net/20141110211547800" alt="img">称为最大后验估计，类似于经典统计学中的极大似然估计。</p>
<p>综合起来看，则好比是人类刚开始时对大自然只有少得可怜的先验知识，但随着不断观察、实验获得更多的样本、结果，使得人们对自然界的规律摸得越来越透彻。所以，贝叶斯方法既符合人们日常生活的思考方式，也符合人们认识自然的规律，经过不断的发展，最终占据统计学领域的半壁江山，与经典统计学分庭抗礼。</p>
<p>此外，贝叶斯除了提出上述思考模式之外，还特别提出了举世闻名的贝叶斯定理。</p>
<h3 id="贝叶斯定理">贝叶斯定理</h3>
<p>在引出贝叶斯定理之前，先学习几个定义：</p>
<ul>
<li><strong>条件概率</strong>（又称后验概率）就是事件A在另外一个事件B已经发生条件下的发生概率。条件概率表示为P(A|B)，读作“在B条件下A的概率”。</li>
</ul>
<p>比如，在同一个样本空间Ω中的事件或者子集A与B，如果随机从Ω中选出的一个元素属于B，那么这个随机选择的元素还属于A的概率就定义为在B的前提下A的条件概率，所以：P(A|B) = |A∩B|/|B|，接着分子、分母都除以|Ω|得到</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141114111032274" alt="img"></p>
</blockquote>
<ul>
<li>
<p><strong>联合概率</strong>表示两个事件共同发生的概率。A与B的联合概率表示为<img src="https://img-blog.csdnimg.cn/img_convert/ec2046ed2f18030656d81cb020239d88.png" alt="img">或者<img src="https://img-blog.csdnimg.cn/img_convert/b3c3955190962cedde6494c9ad959567.png" alt="img">。</p>
</li>
<li>
<p><strong>边缘概率</strong>（又称先验概率）是某个事件发生的概率。边缘概率是这样得到的：在联合概率中，把最终结果中那些不需要的事件通过合并成它们的全概率，而消去它们（对离散随机变量用求和得全概率，对连续随机变量用积分得全概率），这称为边缘化（marginalization），比如A的边缘概率表示为P(A)，B的边缘概率表示为P(B)。</p>
<p>接着，考虑一个问题：P(A|B)是在B发生的情况下A发生的可能性。</p>
</li>
</ul>
<ol>
<li>首先，事件B发生之前，我们对事件A的发生有一个基本的概率判断，称为A的先验概率，用P(A)表示；</li>
<li>其次，事件B发生之后，我们对事件A的发生概率重新评估，称为A的后验概率，用P(A|B)表示；</li>
<li>类似的，事件A发生之前，我们对事件B的发生有一个基本的概率判断，称为B的先验概率，用P(B)表示；</li>
<li>同样，事件A发生之后，我们对事件B的发生概率重新评估，称为B的后验概率，用P(B|A)表示。</li>
</ol>
<p>贝叶斯定理便是基于下述贝叶斯公式：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141110213025473" alt="img"></p>
</blockquote>
<p>上述公式的推导其实非常简单，就是从条件概率推出。</p>
<p>根据条件概率的定义，在事件B发生的条件下事件A发生的概率是</p>
<blockquote>
<p><img src="https://img-blog.csdnimg.cn/img_convert/86cb719fe395093cf2fa9ea3c243347d.png" alt="img"></p>
</blockquote>
<p>同样地，在事件A发生的条件下事件B发生的概率</p>
<blockquote>
<p><img src="https://img-blog.csdnimg.cn/img_convert/57730ecbc7bea763e0c9c90e95b0dbe6.png" alt="img"></p>
</blockquote>
<p>整理与合并上述两个方程式，便可以得到：</p>
<blockquote>
<p><img src="https://img-blog.csdnimg.cn/img_convert/1c38dff5ee6ee3003a67501744ec81f8.png" alt="img"></p>
</blockquote>
<p>接着，上式两边同除以P(B)，若P(B)是非零的，我们便可以得到<strong>贝叶斯定理</strong>的公式表达式：</p>
<blockquote>
<p><img src="https://img-blog.csdnimg.cn/img_convert/3240d4201d8a39969ea079bbf1e271bf.png" alt="img"></p>
</blockquote>
<p>所以，贝叶斯公式可以直接根据条件概率的定义直接推出。即因为P(A,B) = P(A)P(B|A) = P(B)P(A|B)，所以P(A|B) = P(A)P(B|A)  / P(B)。</p>
<h3 id="应用：拼写检查">应用：拼写检查</h3>
<p>经常在网上搜索东西的朋友知道，当你不小心输入一个不存在的单词时，搜索引擎会提示你是不是要输入某一个正确的单词，比如当你在Google中输入“<a href="http://www.gu1234.com/search?hl=zh-CN&amp;site=webhp&amp;source=hp&amp;q=Julw&amp;btnK=Google+%E6%90%9C%E7%B4%A2&amp;gws_rd=ssl">Julw</a>”时，系统会猜测你的意图：是不是要搜索“July”，如下图所示：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112225545796" alt="img"></p>
</blockquote>
<p>这叫做拼写检查。根据谷歌一员工写的<a href="http://norvig.com/spell-correct.html">文章</a>显示，Google的拼写检查基于贝叶斯方法。下面我们就来看看，怎么利用贝叶斯方法，实现&quot;拼写检查&quot;的功能。</p>
<p>用户输入一个单词时，可能拼写正确，也可能拼写错误。如果把拼写正确的情况记做c（代表correct），拼写错误的情况记做w（代表wrong），那么&quot;拼写检查&quot;要做的事情就是：在发生w的情况下，试图推断出c。换言之：已知w，然后在若干个备选方案中，找出可能性最大的那个c，也就是求<img src="https://img-blog.csdn.net/20141112230745208" alt="img">的最大值。<br>
而根据贝叶斯定理，有：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112230845578" alt="img"></p>
</blockquote>
<p>由于对于所有备选的c来说，对应的都是同一个w，所以它们的P(w)是相同的，因此我们只要最大化</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112231004421" alt="img"></p>
</blockquote>
<p>即可。其中：</p>
<ul>
<li>
<p>P©表示某个正确的词的出现&quot;概率&quot;，它可以用&quot;频率&quot;代替。如果我们有一个足够大的文本库，那么这个文本库中每个单词的出现频率，就相当于它的发生概率。某个词的出现频率越高，P©就越大。比如在你输入一个错误的词“Julw”时，系统更倾向于去猜测你可能想输入的词是“July”，而不是“Jult”，因为“July”更常见。</p>
</li>
<li>
<p>P(w|c)表示在试图拼写c的情况下，出现拼写错误w的概率。为了简化问题，假定两个单词在字形上越接近，就有越可能拼错，P(w|c)就越大。举例来说，相差一个字母的拼法，就比相差两个字母的拼法，发生概率更高。你想拼写单词July，那么错误拼成Julw（相差一个字母）的可能性，就比拼成Jullw高（相差两个字母）。值得一提的是，一般把这种问题称为“编辑距离”，参见博客中的<a href="http://blog.csdn.net/v_july_v/article/details/8701148#t4">这篇</a>文章。</p>
<p>所以，我们比较所有拼写相近的词在文本库中的出现频率，再从中挑出出现频率最高的一个，即是用户最想输入的那个词。具体的计算过程及此方法的缺陷请参见<a href="http://norvig.com/spell-correct.html">这里</a>。</p>
</li>
</ul>
<h2 id="贝叶斯网络">贝叶斯网络</h2>
<h3 id="贝叶斯网络的定义">贝叶斯网络的定义</h3>
<p>贝叶斯网络(Bayesian network)，又称信念网络(Belief Network)，或有向无环图模型(directed acyclic graphical model)，是一种概率图模型，于1985年由Judea Pearl首先提出。它是一种模拟人类推理过程中因果关系的不确定性处理模型，其网络拓朴结构是一个有向无环图(DAG)。</p>
<p>贝叶斯网络的有向无环图中的节点表示随机变量<img src="https://img-blog.csdn.net/20141110221023930" alt="img">，它们可以是可观察到的变量，或隐变量、未知参数等。认为有因果关系（或非条件独立）的变量或命题则用箭头来连接。若两个节点间以一个单箭头连接在一起，表示其中一个节点是“因(parents)”，另一个是“果(children)”，两节点就会产生一个条件概率值。</p>
<p>总而言之，<strong>连接两个节点的箭头代表此两个随机变量是具有因果关系，或非条件独立</strong>。</p>
<p>例如，假设节点E直接影响到节点H，即E→H，则用从E指向H的箭头建立结点E到结点H的有向弧(E,H)，权值(即连接强度)用条件概率P(H|E)来表示，如下图所示：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111180200463" alt="img"></p>
</blockquote>
<p>简言之，把某个研究系统中涉及的随机变量，根据是否条件独立绘制在一个有向图中，就形成了贝叶斯网络。其主要用来描述随机变量之间的条件依赖，用圈表示随机变量(random variables)，用箭头表示条件依赖(conditional dependencies)。</p>
<p>令G = (I,E)表示一个有向无环图(DAG)，其中I代表图形中所有的节点的集合，而E代表有向连接线段的集合，且令X = (Xi)i ∈ I为其有向无环图中的某一节点i所代表的随机变量，若节点X的联合概率可以表示成：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141110222518593" alt="img"></p>
</blockquote>
<p>则称X为相对于一有向无环图G 的贝叶斯网络，其中，<img src="https://img-blog.csdn.net/20141110222555954" alt="img">表示节点i之“因”，或称pa(i)是i的parents（父母）。</p>
<p>此外，对于任意的随机变量，其联合概率可由各自的局部条件概率分布相乘而得出：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141110224303808" alt="img"></p>
</blockquote>
<p>如下图所示，便是一个简单的贝叶斯网络：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141110221319352" alt="img"></p>
</blockquote>
<p>因为a导致b，a和b导致c，所以有</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141110222147578" alt="img"></p>
</blockquote>
<h3 id="贝叶斯网络的3种结构形式">贝叶斯网络的3种结构形式</h3>
<p>给定如下图所示的一个贝叶斯网络：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141110234449486" alt="img"></p>
</blockquote>
<p>从图上可以比较直观的看出：</p>
<ul>
<li>\1. x1,x2,…x7的联合分布为</li>
</ul>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141110233944921" alt="img"></p>
</blockquote>
<ul>
<li>
<p>\2. x1和x2独立（对应head-to-head）；</p>
</li>
<li>
<p>\3. x6和x7在x4给定的条件下独立（对应tail-to-tail）。</p>
<p>根据上图，第1点可能很容易理解，但第2、3点中所述的条件独立是啥意思呢？其实第2、3点是贝叶斯网络中3种结构形式中的其中二种。为了说清楚这个问题，需要引入D-Separation（D-分离）这个概念。</p>
<p>D-Separation是一种用来判断变量是否条件独立的图形化方法。换言之，对于一个DAG(有向无环图)E，D-Separation方法可以快速的判断出两个节点之间是否是条件独立的。</p>
</li>
</ul>
<p>2.2.1 形式1：head-to-head</p>
<p>贝叶斯网络的第一种结构形式如下图所示：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141110235330121" alt="img"></p>
</blockquote>
<p>所以有：P(a,b,c) = P(a)*P(b)*P(c|a,b)成立，化简后可得：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141110235818784" alt="img"></p>
</blockquote>
<p>即在<strong>c未知的条件下，a、b被阻断(blocked)，是独立的</strong>，称之为head-to-head条件独立，对应本节中最开始那张图中的“x1、x2独立”。</p>
<p>2.2.2 形式2：tail-to-tail</p>
<p>贝叶斯网络的第二种结构形式如下图所示</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111000434953" alt="img"></p>
</blockquote>
<p>考虑c未知，跟c已知这两种情况：</p>
<ol>
<li>在c未知的时候，有：P(a,b,c)=P©*P(a|c)*P(b|c)，此时，没法得出P(a,b) = P(a)P(b)，即c未知时，a、b不独立。</li>
<li>在c已知的时候，有：P(a,b|c)=P(a,b,c)/P©，然后将P(a,b,c)=P©*P(a|c)*P(b|c)带入式子中，得到：P(a,b|c)=P(a,b,c)/P© = P©*P(a|c)*P(b|c) / P© = P(a|c)*P(b|c)，即c已知时，a、b独立。</li>
</ol>
<p>所以，<strong>在c给定的条件下，a，b被阻断(blocked)，是独立的</strong>，称之为tail-to-tail条件独立，对应本节中最开始那张图中的“x6和x7在x4给定的条件下独立”。</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111000649872" alt="img"></p>
</blockquote>
<p>2.2.3 形式3：head-to-tail</p>
<p>贝叶斯网络的第三种结构形式如下图所示：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111001937768" alt="img"></p>
</blockquote>
<p>还是分c未知跟c已知这两种情况：</p>
<ol>
<li>c未知时，有：P(a,b,c)=P(a)*P(c|a)*P(b|c)，但无法推出P(a,b) = P(a)P(b)，即c未知时，a、b不独立。</li>
<li>c已知时，有：P(a,b|c)=P(a,b,c)/P©，且根据P(a,c) = P(a)*P(c|a) = P©*P(a|c)，可化简得到：</li>
</ol>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111001901123" alt="img"></p>
</blockquote>
<p>所以，<strong>在c给定的条件下，a，b被阻断(blocked)，是独立的</strong>，称之为head-to-tail条件独立。</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111002057687" alt="img"></p>
</blockquote>
<p><strong>插一句</strong>：这个head-to-tail其实就是一个链式网络，如下图所示：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111002737625" alt="img"></p>
</blockquote>
<p>根据之前对head-to-tail的讲解，我们已经知道，在xi给定的条件下，xi+1的分布和x1,x2…xi-1条件独立。意味着啥呢？意味着：xi+1的分布状态只和xi有关，和其他变量条件独立。通俗点说，当前状态只跟上一状态有关，跟上上或上上之前的状态无关。这种顺次演变的随机过程，就叫做马尔科夫链（Markov chain）。且有：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111003037680" alt="img"></p>
</blockquote>
<p>接着，将上述结点推广到结点集，则是：对于任意的结点集A，B，C，考察所有通过A中任意结点到B中任意结点的路径，若要求A，B条件独立，则需要所有的路径都被阻断(blocked)，即满足下列两个前提之一：</p>
<ol>
<li>A和B的“head-to-tail型”和“tail-to-tail型”路径都通过C；</li>
<li>A和B的“head-to-head型”路径不通过C以及C的子孙；</li>
</ol>
<p>最后，举例说明上述D-Separation的3种情况（即贝叶斯网络的3种结构形式），则是如下图所示：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111004832787" alt="img"></p>
</blockquote>
<p>上图中左边部分是head-to-tail，给定 T 时，A 和 X 独立；右边部分的右上角是tail-to-tail，给定S时，L和B独立；右边部分的右下角是head-to-head，未给定D时，L和B独立。</p>
<h3 id="贝叶斯网络的实例">贝叶斯网络的实例</h3>
<p>给定如下图所示的贝叶斯网络：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111213550845" alt="img"></p>
</blockquote>
<p>其中，各个单词、表达式表示的含义如下：</p>
<ul>
<li>
<p>smoking表示吸烟，其概率用P(S)表示，lung Cancer表示的肺癌，一个人在吸烟的情况下得肺癌的概率用P(C|S)表示，X-ray表示需要照医学上的X光，肺癌可能会导致需要照X光，吸烟也有可能会导致需要照X光（所以smoking也是X-ray的一个因），所以，因吸烟且得肺癌而需要照X光的概率用P(X|C,S)表示。</p>
</li>
<li>
<p>Bronchitis表示支气管炎，一个人在吸烟的情况下得支气管炎的概率用P(B|S)，dyspnoea表示呼吸困难，支气管炎可能会导致呼吸困难，肺癌也有可能会导致呼吸困难（所以lung Cancer也是dyspnoea的一个因），因吸烟且得了支气管炎导致呼吸困难的概率用P(D|C,B)表示。</p>
<p>lung Cancer简记为C，Bronchitis简记为B，dyspnoea简记为D，且C = 0表示lung Cancer不发生的概率，C = 1表示lung Cancer发生的概率，B等于0（B不发生）或1（B发生）也类似于C，同样的，D=1表示D发生的概率，D=0表示D不发生的概率，便可得到dyspnoea的一张概率表，如上图的最右下角所示。</p>
</li>
</ul>
<h3 id="因子图">因子图</h3>
<p>回到2.3节中那个实例上，如下图所示：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111005733875" alt="img"></p>
</blockquote>
<p>对于上图，在一个人已经呼吸困难（dyspnoea）的情况下，其抽烟（smoking）的概率是多少呢？即：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111005823359" alt="img"></p>
</blockquote>
<p>咱们来一步步计算推导下：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111010027078" alt="img"></p>
</blockquote>
<p>解释下上述式子推导过程：</p>
<ol>
<li>第二行：对联合概率关于b,x,c求和（在d=1的条件下），从而消去b,x,c，得到s和d=1的联合概率。</li>
<li>第三行：最开始，所有变量都在sigma(d=1,b,x,c)的后面（sigma表示对“求和”的称谓），但由于P(s)和“d=1,b,x,c”都没关系，所以，可以提到式子的最前面。而且P(b|s)和x、c没关系，所以，也可以把它提出来，放到sigma(b)的后面，从而式子的右边剩下sigma(x)和sigma©。</li>
</ol>
<p>此外，图中Variable elimination表示的是变量消除的意思。为了更好的解决此类问题，咱们得引入因子图的概念。</p>
<p>2.4.1 因子图的定义</p>
<p>wikipedia上是这样定义因子图的：将一个具有多变量的全局函数因子分解，得到几个局部函数的乘积，以此为基础得到的一个双向图叫做因子图（Factor Graph）。</p>
<p>比如，假定对于函数<img src="https://img-blog.csdn.net/20141111010913859" alt="img">，有下述式子成立：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111010838872" alt="img"></p>
</blockquote>
<p>其中<img src="https://img-blog.csdn.net/20141111010859137" alt="img">，其对应的因子图<img src="https://img-blog.csdn.net/20141111010916375" alt="img">包括：</p>
<ol>
<li>变量节点<img src="https://img-blog.csdn.net/20141111011033218" alt="img"></li>
<li>因子（函数）节点<img src="https://img-blog.csdn.net/20141111010947528" alt="img"></li>
<li>边<img src="https://img-blog.csdn.net/20141111011138781" alt="img">，边通过下列因式分解结果得到：在因子（函数）节点<img src="https://img-blog.csdn.net/20141111011059319" alt="img">和变量节点<img src="https://img-blog.csdn.net/20141111011106386" alt="img">之间存在边的充要条件是<img src="https://img-blog.csdn.net/20141111011114904" alt="img">存在。</li>
</ol>
<p>正式的定义果然晦涩！我相信你没看懂。通俗来讲，所谓因子图就是对函数进行因子分解得到的一种概率图。一般内含两种节点：变量节点和函数节点。我们知道，一个全局函数通过因式分解能够分解为多个局部函数的乘积，这些局部函数和对应的变量关系就体现在因子图上。</p>
<p>举个例子，现在有一个全局函数，其因式分解方程为：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112103919079" alt="img"></p>
</blockquote>
<p>其中fA,fB,fC,fD,fE为各函数，表示变量之间的关系，可以是条件概率也可以是其他关系（如马尔可夫随机场Markov Random Fields中的势函数）。</p>
<p>为了方便表示，可以写成：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112104009484" alt="img"></p>
</blockquote>
<p>其对应的因子图为：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112104542668" alt="img"></p>
</blockquote>
<p>且上述因子图等价于：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112104625484" alt="img"></p>
</blockquote>
<p>所以，在因子图中，所有的顶点不是变量节点就是函数节点，边线表示它们之间的函数关系。</p>
<p>但搞了半天，虽然知道了什么是因子图，但因子图到底是干嘛的呢？为何要引入因子图，其用途和意义何在？事实上，因子图跟贝叶斯网络和马尔科夫随机场（Markov Random Fields）一样，也是概率图的一种。</p>
<p>既然提到了马尔科夫随机场，那顺便说下有向图、无向图，以及条件随机场等相关概念。</p>
<ul>
<li>我们已经知道，有向图模型，又称作贝叶斯网络（Directed Graphical Models, DGM, Bayesian Network）。</li>
</ul>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141222112243656" alt="img"></p>
</blockquote>
<ul>
<li>但在有些情况下，强制对某些结点之间的边增加方向是不合适的。使用没有方向的无向边，形成了无向图模型（Undirected Graphical Model,UGM）, 又被称为马尔科夫随机场或者马尔科夫网络（Markov Random Field,  MRF or Markov network）。</li>
</ul>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141222112302034" alt="img"></p>
</blockquote>
<ul>
<li>设X=(X1,X2…Xn)和Y=(Y1,Y2…Ym)都是联合随机变量，若随机变量Y构成一个无向图 G=(V,E)表示的马尔科夫随机场（MRF），则条件概率分布P(Y|X)称为条件随机场（Conditional Random Field, 简称CRF，后续新的博客中可能会阐述CRF）。如下图所示，便是一个线性链条件随机场的无向图模型：</li>
</ul>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141222111852153" alt="img"></p>
</blockquote>
<p>回到本文的主旨上来。在概率图中，<strong>求某个变量的边缘分布</strong>是常见的问题。这问题有很多求解方法，其中之一就是把贝叶斯网络或马尔科夫随机场转换成因子图，然后用sum-product算法求解。换言之，基于因子图可以用sum-product 算法高效的求各个变量的边缘分布。</p>
<p>先通过一些例子分别说明如何把贝叶斯网络（和马尔科夫随机场），以及把马尔科夫链、隐马尔科夫模型转换成因子图后的情形，然后在2.4.2节，咱们再来看如何利用因子图的sum-product算法求边缘概率分布。</p>
<p>给定下图所示的贝叶斯网络或马尔科夫随机场：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111092211421" alt="img"><img src="https://img-blog.csdn.net/20141112101407483" alt="img"></p>
</blockquote>
<p>根据各个变量对应的关系，可得：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111092421343" alt="img"></p>
</blockquote>
<p>其对应的因子图为（以下两种因子图的表示方式皆可）：</p>
<blockquote>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111092601459" alt="img"></p>
</blockquote>
</blockquote>
<p>由上述例子总结出由贝叶斯网络构造因子图的方法：</p>
<ul>
<li>
<p>贝叶斯网络中的一个因子对应因子图中的一个结点</p>
</li>
<li>
<p>贝叶斯网络中的每一个变量在因子图上对应边或者半边</p>
</li>
<li>
<p>结点g和边x相连当且仅当变量x出现在因子g中。</p>
<p>再比如，对于下图所示的由马尔科夫链转换而成的因子图：</p>
</li>
</ul>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111234424734" alt="img"></p>
</blockquote>
<p>有：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111234428132" alt="img"></p>
</blockquote>
<p>而对于如下图所示的由隐马尔科夫模型转换而成的因子图：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111234503609" alt="img"></p>
</blockquote>
<p>有</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111234515031" alt="img"></p>
</blockquote>
<p>2.4.2 Sum-product算法</p>
<p>我们已经知道，对于下图所示的因子图：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111093045895" alt="img"></p>
</blockquote>
<p>有：</p>
<blockquote>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111093054537" alt="img"></p>
</blockquote>
</blockquote>
<p>下面，咱们来考虑一个问题：即如何由联合概率分布求边缘概率分布。</p>
<p>首先回顾下联合概率和边缘概率的定义，如下：</p>
<ul>
<li>
<p>联合概率表示两个事件共同发生的概率。A与B的联合概率表示为<img src="https://img-blog.csdnimg.cn/img_convert/ec2046ed2f18030656d81cb020239d88.png" alt="img">或者<img src="https://img-blog.csdnimg.cn/img_convert/b3c3955190962cedde6494c9ad959567.png" alt="img">。</p>
</li>
<li>
<p>边缘概率（又称先验概率）是某个事件发生的概率。边缘概率是这样得到的：在联合概率中，把最终结果中不需要的那些事件合并成其事件的全概率而消失（对离散随机变量用求和得全概率，对连续随机变量用积分得全概率）。这称为边缘化（marginalization）。A的边缘概率表示为P(A)，B的边缘概率表示为P(B)。</p>
<p>事实上，某个随机变量fk的边缘概率可由x1,x2,x3, …, xn的联合概率求到，具体公式为：</p>
</li>
</ul>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111235305570" alt="img"></p>
</blockquote>
<p>啊哈，啥原理呢？原理很简单，还是它：对xk外的其它变量的概率求和，最终剩下xk的概率！</p>
<p>此外，换言之，如果有</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111235735656" alt="img"></p>
</blockquote>
<p>那么</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141111235745640" alt="img"></p>
</blockquote>
<p>上述式子如何进一步化简计算呢？考虑到我们小学所学到的乘法分配率，可知a<em>b + a</em>c = a*(b + c)，前者2次乘法1次加法，后者1次乘法，1次加法。我们这里的计算是否能借鉴到分配率呢？别急，且听下文慢慢道来。</p>
<p>假定现在我们需要计算如下式子的结果：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112000434217" alt="img"></p>
</blockquote>
<p>同时，f 能被分解如下：</p>
<blockquote>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112000519707" alt="img"></p>
</blockquote>
</blockquote>
<p>借鉴分配率，我们可以提取公因子：</p>
<blockquote>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112000839984" alt="img"></p>
</blockquote>
</blockquote>
<p>因为变量的边缘概率等于所有与他相连的函数传递过来的消息的积，所以计算得到：</p>
<blockquote>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112000843006" alt="img"></p>
</blockquote>
</blockquote>
<p>仔细观察上述计算过程，可以发现，其中用到了类似“消息传递”的观点，且总共两个步骤。</p>
<p>第一步、对于f 的分解图，根据蓝色虚线框、红色虚线框围住的两个box外面的消息传递：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112001129256" alt="img"></p>
</blockquote>
<p>计算可得：</p>
<blockquote>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112001150643" alt="img"></p>
</blockquote>
</blockquote>
<p>第二步、根据蓝色虚线框、红色虚线框围住的两个box内部的消息传递：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112001808913" alt="img"></p>
</blockquote>
<p>根据<img src="https://img-blog.csdn.net/20141112001819443" alt="img">，我们有：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112001830316" alt="img"></p>
</blockquote>
<p>就这样，上述计算过程将一个概率分布写成两个因子的乘积，而这两个因子可以继续分解或者通过已知得到。这种利用消息传递的观念计算概率的方法便是sum-product算法。前面说过，基于因子图可以用sum-product算法可以高效的求各个变量的边缘分布。</p>
<p>到底什么是sum-product算法呢？sum-product算法，也叫belief propagation，有两种消息：</p>
<ul>
<li>一种是变量(Variable)到函数(Function)的消息：<img src="https://img-blog.csdn.net/20141112163109597" alt="img">，如下图所示</li>
</ul>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112164507756" alt="img"></p>
</blockquote>
<p>此时，变量到函数的消息为<img src="https://img-blog.csdn.net/20141112164737703" alt="img">。</p>
<ul>
<li>另外一种是函数(Function)到变量(Variable)的消息：<img src="https://img-blog.csdn.net/20141112163122468" alt="img">。如下图所示：</li>
</ul>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112164805362" alt="img"></p>
</blockquote>
<p>此时，函数到变量的消息为：<img src="https://img-blog.csdn.net/20141112164838031" alt="img">。</p>
<p>以下是sum-product算法的总体框架：</p>
<ul>
<li><em>1</em>、给定如下图所示的因子图：</li>
</ul>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112154537627" alt="img"></p>
</blockquote>
<ul>
<li><em>2</em>、sum-product 算法的消息计算规则为：</li>
</ul>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112154545692" alt="img"></p>
</blockquote>
<ul>
<li><em>3</em>、根据sum-product定理，如果因子图中的函数f 没有周期，则有：</li>
</ul>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112154606750" alt="img"></p>
</blockquote>
<p>值得一提的是：如果因子图是无环的，则一定可以准确的求出任意一个变量的边缘分布，如果是有环的，则无法用sum-product算法准确求出来边缘分布。</p>
<p>比如，下图所示的贝叶斯网络：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112183526203" alt="img"></p>
</blockquote>
<p>其转换成因子图后，为：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141112183557236" alt="img"></p>
</blockquote>
<p>可以发现，若贝叶斯网络中存在“环”（无向），则因此构造的因子图会得到环。而使用消息传递的思想，这个消息将无限传输下去，不利于概率计算。<br>
解决方法有3个：</p>
<ul>
<li>
<p>1、删除贝叶斯网络中的若干条边，使得它不含有无向环</p>
<p>比如给定下图中左边部分所示的原贝叶斯网络，可以通过去掉C和E之间的边，使得它重新变成有向无环图，从而成为图中右边部分的近似树结构：</p>
</li>
</ul>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141113002311057" alt="img"></p>
</blockquote>
<p>具体变换的过程为最大权生成树算法MSWT（详细建立过程请参阅此<a href="http://pan.baidu.com/s/1o69Lp1K">PPT</a> 第60页），通过此算法，这课树的近似联合概率P’(x)和原贝叶斯网络的联合概率P(x)的相对熵（如果忘了什么叫相对熵，请参阅：<a href="http://blog.csdn.net/v_july_v/article/details/40508465">最大熵模型中的数学推导</a>）最小。</p>
<ul>
<li>
<p>2、重新构造没有环的贝叶斯网络</p>
</li>
<li>
<p>3、选择loopy belief propagation算法（你可以简单理解为sum-product 算法的递归版本），此算法一般选择环中的某个消息，随机赋个初值，然后用sum-product算法，迭代下去，因为有环，一定会到达刚才赋初值的那个消息，然后更新那个消息，继续迭代，直到没有消息再改变为止。唯一的缺点是不确保收敛，当然，此算法在绝大多数情况下是收敛的。</p>
<p>此外，除了这个sum-product算法，还有一个max-product 算法。但只要弄懂了sum-product，也就弄懂了max-product 算法。因为max-product 算法就在上面sum-product 算法的基础上把求和符号换成求最大值max的符号即可！</p>
<p>最后，sum-product 和 max-product 算法也能应用到隐马尔科夫模型hidden Markov models上，后面有机会的话可以介绍。</p>
</li>
</ul>
]]></content>
      <tags>
        <tag>bayes net</tag>
      </tags>
  </entry>
  <entry>
    <title></title>
    <url>/2023/12/31/RNN/</url>
    <content><![CDATA[<h3 id="第四章-递归神经网络与词向量原理解读">第四章——递归神经网络与词向量原理解读</h3>
<h4 id="rnn网络架构解读">RNN网络架构解读</h4>
<p>常规神经网络并不能考虑时间序列的特征（比如前天+昨天+今天或者带有前后关联的特征），现在每个特征都是独立考虑的，那么如果有这样的特征，网络应该怎么学呢</p>
<p><img src="/2023/12/31/RNN/1609467376667.png" alt="1609467376667"></p>
<blockquote>
<p>而递归递归网络hidden这里的转回箭头，表示训练完第一个X后，再拿回来去训练第二个X，即前一次训练的结果对后一次的训练结果产生影响。</p>
</blockquote>
<p><img src="/2023/12/31/RNN/1609469515280.png" alt="1609469515280"></p>
<blockquote>
<p>类似现在有X0、X1、X2 … Xt，假设X0就是本月的1号，X1就是2号以此类推，Xt就是昨天，这样是不是就是一个时间序列。</p>
<p>X输入后有了h，h是中间的结果，每个h保证能联合前一个的h。</p>
</blockquote>
<h4 id="lstm网络">LSTM网络</h4>
<p>RNN的问题在于，每一次的h只考虑前一个，当h到最后的时候，它只考虑n-1的h，这样对吗？或者说越后面的时间的数据一定越重要吗？我们是不是应该考虑每个时间的数据</p>
<p><img src="/2023/12/31/RNN/1609470667941.png" alt="1609470667941"></p>
<ul>
<li>
<p>C：控制参数，决定什么样的信息会被保留什么样的会被遗忘。</p>
</li>
<li>
<p>门：一种让信息选择式通过的方法</p>
</li>
<li>
<p>每次计算的结果和前一轮的结果进行比较，选择要更新的信息</p>
<p><img src="/2023/12/31/RNN/1609470919296.png" alt="1609470919296"></p>
</li>
</ul>
<h4 id="词向量word2vec模型通俗解释">词向量Word2Vec模型通俗解释</h4>
<p>先考虑第一个问题：如何将文本向量化</p>
<p>比如描述一个人，只用身高或体重，还是综合各项指标？如下</p>
<p><img src="/2023/12/31/RNN/1609473546489.png" alt="1609473546489"></p>
<p>只要有了向量，就可以用不同的方法来计算相似度。如下</p>
<p><img src="/2023/12/31/RNN/1609473880971.png" alt="1609473880971"></p>
<p>通常，数据的维度越高，能提供的信息也就越多，从而计算结果的可靠性就更值得信赖了。如下</p>
<p><img src="/2023/12/31/RNN/1609473996445.png" alt="1609473996445"></p>
<p>如何描述语言的特征呢？通常都在词的层面上构建特征。Word2Vec就是把词转成向量：</p>
<p><img src="/2023/12/31/RNN/1609474064534.png" alt="1609474064534"></p>
<p>假设现在已经拿到一份训练好的词向量，其中每个词都表示50维的向量：</p>
<p><img src="/2023/12/31/RNN/1609474157691.png" alt="1609474157691"></p>
<p>如果在热度图中显示，结果如下：</p>
<p><img src="/2023/12/31/RNN/1609474174914.png" alt="1609474174914"></p>
<p>从结果中可以发现，相似的词在特征表达中比较相似，也就是说明词的特征是有实际意义的！</p>
<p><img src="/2023/12/31/RNN/1609474327116.png" alt="1609474327116"></p>
<blockquote>
<p>如上图的男人和男孩有相当部分的区域颜色是相似的，只是有的浅了点，有的深了点。同样的地方，对比水，它们之间相差的就非常远，颜色基本没有关联。</p>
</blockquote>
<h4 id="训练数据构建">训练数据构建</h4>
<p>输入数据从哪来？首先我们得理解的是，文字单词转换成数值，它并不是仅仅针对该次任务或者该数据的，Thou或者shalt在这里是有这些意思，转成对应的数值，在其它文本其它数据中也是同样的意思，所以只要是符合逻辑的文本，我们都可以拿来训练。目前有Google的预训练bert模型也是这个原理。一般我们会维护一下语料库大表。</p>
<p><img src="/2023/12/31/RNN/1609548160973.png" alt="1609548160973"></p>
<p>如何训练</p>
<p><img src="/2023/12/31/RNN/1609548501773.png" alt="1609548501773"></p>
<blockquote>
<p>我们选中三个单词，以thou shalt 来预测not，也可以不断的往后滑动，如以shalt not来预测make</p>
</blockquote>
<p><img src="/2023/12/31/RNN/1609548578713.png" alt="1609548578713"></p>
<blockquote>
<p>也就是可以是无监督学习，但文字的前后一定是有先后顺序的，不能没有说话逻辑。</p>
</blockquote>
<h4 id="cbow与skipgram模型">CBOW与Skipgram模型</h4>
<p>CBOW：根据上下文预测中间内容</p>
<p><img src="/2023/12/31/RNN/1609548813211.png" alt="1609548813211"></p>
<p>Skipgram：根据中间内容预测上下文</p>
<p><img src="/2023/12/31/RNN/1609548875711.png" alt="1609548875711"></p>
<p>两模型输入输出如下：</p>
<p><img src="/2023/12/31/RNN/1609548965958.png" alt="1609548965958"></p>
<blockquote>
<p>这两个模型都存在gensim里，后续调用该工具包即可。</p>
</blockquote>
<p>最终预测的词也会带有概率，而前面我们讲到如SoftMax用到会将最大的值提取出来，如果我们的语料库非常大，比如5万字，那么要给出5万字的概率，而SoftMax也得计算这5万，可以说是非常耗时的，怎么解决这个问题呢？</p>
<h4 id="负采样方案">负采样方案</h4>
<p><strong>初始方案：</strong></p>
<p>输入两个单词，看它们是不是前后对应的输入和输出，也就相当于一个二分类任务</p>
<p><img src="/2023/12/31/RNN/1609549331116.png" alt="1609549331116"></p>
<p>出发点是好的，但是此时训练集构建出来的标签全为1，无法进行较好的训练</p>
<p><img src="/2023/12/31/RNN/1609549488755.png" alt="1609549488755"></p>
<blockquote>
<p>如上图，这样相当于告诉模型，只要往1预测，那么一定能效果好，类似风控场景中，正负样本非常悬殊甚至达到1：1万的情况。我们是不能直接训练的，我们会“构造”一些正样本，而这里是1太多，需要构建一些负样本。</p>
</blockquote>
<p><strong>改进方案：</strong></p>
<p>加入一些负样本</p>
<p><img src="/2023/12/31/RNN/1609549655385.png" alt="1609549655385"></p>
<blockquote>
<p>1个1添加多少个0呢？gensim工具包给出的默认参数是1个1和5个0，即正负样本比1:5</p>
</blockquote>
<p>正常情况下的Skipgram训练集</p>
<p><img src="/2023/12/31/RNN/1609549825425.png" alt="1609549825425"></p>
<p><strong>大致流程如下：</strong></p>
<p><strong>1.初始化词向量矩阵</strong></p>
<p><img src="/2023/12/31/RNN/1609549880269.png" alt="1609549880269"></p>
<blockquote>
<p>最左边Embedding是语料库大表，所有的词都在里面。</p>
<p>Context是本次的预测的文本</p>
<p>dataset是负采样完成后的结果</p>
</blockquote>
<p><img src="/2023/12/31/RNN/1609550018745.png" alt="1609550018745"></p>
<p><strong>2.通过神经网络返回传播来计算更新，此时不光更新权重参数矩阵W，也会更新输入数据</strong></p>
<p><img src="/2023/12/31/RNN/1609550107070.png" alt="1609550107070"></p>
<blockquote>
<p>给出损失函数Error的结果，并更新到输入和输出数据中。更新输出数据是为了输出本次的预测结果，而更新输入数据，是为了维护我们将一直使用的语料库大表，使得我们的语料库的词向量等越来越准确。</p>
</blockquote>
]]></content>
  </entry>
  <entry>
    <title></title>
    <url>/2023/12/31/deeplearning/</url>
    <content><![CDATA[<h3 id="第一章-深度学习必备知识点">第一章——深度学习必备知识点</h3>
<h4 id="深度学习要解决的问题">深度学习要解决的问题</h4>
<p><img src="/2023/12/31/deeplearning/ai%E6%A6%82%E5%BF%B5.jpg" alt="ai概念"></p>
<blockquote>
<p>人工智能、机器学习、深度学习的区别于联系</p>
</blockquote>
<p>机器学习的流程：</p>
<ul>
<li>数据提取</li>
<li>特征工程</li>
<li>建立模型</li>
<li>评估与应用</li>
</ul>
<blockquote>
<p>特征工程可以说是建模过程中，最重要的部分。</p>
</blockquote>
<p>既然特征工程是最重要的，常规我们会做各种各样的特征，如聚合统计、交叉等，那有没有一种方法，它可以<strong>自动的</strong>去选择重要的特征。</p>
<p>而深度学习可以说是最接近人工智能这一概念的，因为它解决了机器学习中“人工的”问题，如人工的选择特征、选择算法等。</p>
<p>深度学习最大的亮点，就是解决特征工程的人工问题。</p>
<p>特征工程的作用：</p>
<ul>
<li>数据特征决定了模型的上限</li>
<li>预处理和特征提取是最核心的</li>
<li>算法与参数选择决定了如何逼近这个上限</li>
</ul>
<p>特征如何提取，数值类的相对容易，那么文本类、图像类的呢？</p>
<p>传统特征提取方法：</p>
<p><img src="/2023/12/31/deeplearning/1609231197783.png" alt="1609231197783"></p>
<blockquote>
<p>各种计算可以说是非常麻烦的。</p>
</blockquote>
<p>为什么需要深度学习：</p>
<p><img src="/2023/12/31/deeplearning/1609231229982.png" alt="1609231229982"></p>
<blockquote>
<p>如上图，将一个图像，分解成多个维度并变换成数值，变成机器可认识的。</p>
</blockquote>
<h4 id="深度学习应用领域">深度学习应用领域</h4>
<p>自动驾驶：</p>
<p><img src="/2023/12/31/deeplearning/1609231356957.png" alt="1609231356957"></p>
<p>人脸识别：</p>
<p><img src="/2023/12/31/deeplearning/1609231444053.png" alt="1609231444053"></p>
<p>医学检测：</p>
<p><img src="/2023/12/31/deeplearning/1609231564609.png" alt="1609231564609"></p>
<p>缺点：计算大量数据导致速度慢。</p>
<p>数据规模越大，越适合深度学习</p>
<p><img src="/2023/12/31/deeplearning/1609231974586.png" alt="1609231974586"></p>
<h4 id="计算机视觉任务">计算机视觉任务</h4>
<p>如图像分类任务，如何把一张猫的图片，分到猫的类别（有一些列的标签：人、笔、飞机、猫 等等）</p>
<p>图像表示：计算机眼中的图像，一张图片被表示成三维数组的形式，每个像素的值从0到255。</p>
<p><img src="/2023/12/31/deeplearning/1609232252675.png" alt="1609232252675"></p>
<blockquote>
<p>可能的维度是<code>300*100*3</code>，假设高度h是300，宽度w是100，3则是颜色通道RBG。图像中数值越大表示该点越亮，反之则越暗。</p>
</blockquote>
<p><strong>计算机视觉面临的挑战</strong>：</p>
<p>还是上面这张图，如照射角度：</p>
<p><img src="/2023/12/31/deeplearning/1609232506522.png" alt="1609232506522"></p>
<p>其形状可能改变成如下的样子：</p>
<p><img src="/2023/12/31/deeplearning/1609232535282.png" alt="1609232535282"></p>
<p>或者部分遮蔽：</p>
<p><img src="/2023/12/31/deeplearning/1609232607322.png" alt="1609232607322"></p>
<p>背景混入：</p>
<p><img src="/2023/12/31/deeplearning/1609232625184.png" alt="1609232625184"></p>
<p>这些都是可能遇到得问题，如何解决可以给一些遮蔽的样本，这些都是数据量可以解决的。</p>
<h4 id="得分函数">得分函数</h4>
<p>线性函数</p>
<ul>
<li>
<p>从输入——&gt;输出的映射</p>
<p><img src="/2023/12/31/deeplearning/1609292913300.png" alt="1609292913300"></p>
<p>每个像素点对结果产生影响，而每个像素点有对应的权重。</p>
</li>
<li>
<p>数学表示</p>
<p><img src="/2023/12/31/deeplearning/1609296031349.png" alt="1609296031349"></p>
<p><code>32*32*3</code>=3072个X（像素点），假设需要分类的类别一共有10个，那么这3072个X在这10个W（类别）中有着不同的权重得分，还有b偏值项，最终最高 得分 的就是预测的分类。</p>
</li>
<li>
<p>计算方法</p>
<p><img src="/2023/12/31/deeplearning/1609296720418.png" alt="1609296720418"></p>
<p>为了计算简单，假设这种猫只有4个像素点，分别是56、231、24、2，分成3个类别（猫、狗、船），其中W有3行对应3个类别，且Xi有4个值对应4个像素点，我们来计算第一行，<code>W*X+b = 0.2*56+(-0.5)*231+0.1*24+2.0*2+1.1 = -97.9+1.1 = -96.8</code>，这样就得到了结果。</p>
<p>当权重Wi比较大时，说明该像素点对结果的影响比较重要，正值代表促进作用，负值代表抑制作用。</p>
<ul>
<li>W矩阵怎么来的：一开始是假设了一个，然后根据结果不断优化，就像上面的预测是把猫预测成了狗437.9，那么神经网络会不断迭代W矩阵中的值。</li>
</ul>
<p>现在我们知道上面的结果不够好，那么我们应该怎样让它变好。</p>
</li>
</ul>
<h4 id="损失函数">损失函数</h4>
<ul>
<li>如何衡量分类的结果</li>
<li>怎么明确模型当前的效果是好是坏。</li>
</ul>
<h5 id="其中一种损失函数-回归任务-：1609297367586">其中一种损失函数（回归任务）：<img src="/2023/12/31/deeplearning/1609297367586.png" alt="1609297367586"></h5>
<p>实验：</p>
<p><img src="/2023/12/31/deeplearning/1609297561822.png" alt="1609297561822"></p>
<p>假设我们运行完模型，得到上面这么个结果，第一张图评定为猫3.2为车5.1明显不合理，如果利用上面的公式，就是5.1-3.2=1.9，值越大表明预测越离谱，小于0则表示没有误差。</p>
<p>而+1是为了防止一种情况是，如果预测的car不是5.1而是3.15，那么3.15-3.2也小于0，但是能明确的说预测没问题吗？或许不能吧，因为只有一点偏差可能是“刚刚好”预测对了，那么+1就可以防止这种情况，预测对的值一定要远大于预测错的值。</p>
<p>计算：</p>
<p>cat = max(0, 5.1 - 3.2 + 1) + max(0, -1.7 - 3.2 + 1)</p>
<p>​      = max(0, 2.9) + max(0, -3.9)</p>
<p>​      = 2.9 + 0 = 2.9</p>
<blockquote>
<p>max(0, x)的意思是x大于0取x，小于0则取0</p>
</blockquote>
<p>car = max(0, 1.3 - 4.9 + 1) + max(0, 2.0 - 4.9 + 1)</p>
<p>​      = max(0, -2.6) + max(0, -1.9)</p>
<p>​      = 0 + 0 = 0</p>
<p>frog = max(0, 2.2 - (-3.1) + 1) + max(0, 2.5 - (-3.1) + 1)</p>
<p>​      = max(0, 5.3) + max(0, 5.6)</p>
<p>​      = 5.3 + 5.6 = 10.9</p>
<p>其中car预测最好，frog的预测最差</p>
<p>损失函数的值相同，意味着两个模型一样吗？</p>
<ul>
<li>
<p>还是这个公式：<img src="/2023/12/31/deeplearning/1609308126418.png" alt="1609308126418"></p>
</li>
<li>
<p>输入数据：X = [1, 1, 1, 1]</p>
<ul>
<li>模型A：w1 = [1, 0, 0, 0]</li>
<li>模型B：w2 = [0.25, 0.25, 0.25, 0.25]</li>
</ul>
</li>
<li>
<p>两者的结果都等于1，那两者的可以说一样吗？是不是模型B的W更可靠。那么损失函数还得加入一个东西</p>
</li>
</ul>
<p>损失函数 = 数据损失 + 正则化惩罚项</p>
<ul>
<li>正则化惩罚项：<img src="/2023/12/31/deeplearning/1609308398263.png" alt="1609308398263"></li>
<li>正则化惩罚项关注权重w，w越大则该公式的结果越大，我们希望模型不要太复杂，过拟合的模型是没用的。往往还有个 λ 。</li>
</ul>
<p>回归任务的解决了，还有分类任务的。</p>
<h5 id="softmax分类器-分类任务">Softmax分类器（分类任务）</h5>
<ul>
<li>
<p>归一化：<img src="/2023/12/31/deeplearning/1609309168103.png" alt="1609309168103">where<img src="/2023/12/31/deeplearning/1609309191428.png" alt="1609309191428"></p>
</li>
<li>
<p>计算损失值：<img src="/2023/12/31/deeplearning/1609309232205.png" alt="1609309232205"></p>
</li>
</ul>
<p>举例：</p>
<p><img src="/2023/12/31/deeplearning/1609309309120.png" alt="1609309309120"></p>
<blockquote>
<p>其中3.2exp表示e^3.2=24.5，24.5normalize表示24.5 / (24.5+164+0.18) = 0.13，这就是概率，同时我们再做-log(0.13)可以得到0.89这个损失值，log(1)的时候为0，即没有损失，表示概率值越接近于1损失的越少。</p>
</blockquote>
<p>这些都是前向传播，一步步的得到损失值，那么如何以损失值来更新W更新模型呢，这就是反向传播。</p>
]]></content>
  </entry>
  <entry>
    <title>classification</title>
    <url>/2024/01/31/classification/</url>
    <content><![CDATA[<h2 id="四种基本分类方法">四种基本分类方法</h2>
<p>样本示例</p>
<table>
<thead>
<tr>
<th>x1</th>
<th>x2</th>
<th>y</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr>
<td>1531</td>
<td>4320</td>
<td>-1</td>
<td>0</td>
</tr>
<tr>
<td>2220</td>
<td>2262</td>
<td>-1</td>
<td>0</td>
</tr>
<tr>
<td>1181</td>
<td>2141</td>
<td>-1</td>
<td>0</td>
</tr>
<tr>
<td>4740</td>
<td>3840</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>4856</td>
<td>4116</td>
<td>1</td>
<td>1</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读入训练数据</span></span><br><span class="line">train = np.loadtxt(<span class="string">&#x27;images1.csv&#x27;</span>, delimiter=<span class="string">&#x27;,&#x27;</span>, skiprows=<span class="number">1</span>)</span><br><span class="line">train_x = train[:,<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">train_y = train[:,<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 权重初始化</span></span><br><span class="line">w = np.random.rand(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 判别函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">if</span> np.dot(w, x) &gt;= <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重复次数</span></span><br><span class="line">epoch = <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新次数</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 学习权重</span></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(epoch):</span><br><span class="line">    <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(train_x, train_y):</span><br><span class="line">        <span class="keyword">if</span> f(x) != y:</span><br><span class="line">            w = w + y * x</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 输出日志</span></span><br><span class="line">            count += <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;第 &#123;&#125; 次 : w = &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(count, w))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘图确认</span></span><br><span class="line">x1 = np.arange(<span class="number">0</span>, <span class="number">500</span>)</span><br><span class="line">plt.plot(train_x[train_y ==  <span class="number">1</span>, <span class="number">0</span>], train_x[train_y ==  <span class="number">1</span>, <span class="number">1</span>], <span class="string">&#x27;o&#x27;</span>)</span><br><span class="line">plt.plot(train_x[train_y == -<span class="number">1</span>, <span class="number">0</span>], train_x[train_y == -<span class="number">1</span>, <span class="number">1</span>], <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">plt.plot(x1, -w[<span class="number">0</span>] / w[<span class="number">1</span>] * x1, linestyle=<span class="string">&#x27;dashed&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line"></span><br><span class="line"># 读入训练数据</span><br><span class="line">train = np.loadtxt(&#x27;images2.csv&#x27;, delimiter=&#x27;,&#x27;, skiprows=1)</span><br><span class="line">train_x = train[:,0:2]</span><br><span class="line">train_y = train[:,2]</span><br><span class="line"></span><br><span class="line"># 参数初始化</span><br><span class="line">theta = np.random.rand(3)</span><br><span class="line"></span><br><span class="line"># 标准化</span><br><span class="line">mu = train_x.mean(axis=0)</span><br><span class="line">sigma = train_x.std(axis=0)</span><br><span class="line">def standardize(x):</span><br><span class="line">    return (x - mu) / sigma</span><br><span class="line"></span><br><span class="line">train_z = standardize(train_x)</span><br><span class="line"></span><br><span class="line"># 增加 x0</span><br><span class="line">def to_matrix(x):</span><br><span class="line">    x0 = np.ones([x.shape[0], 1])</span><br><span class="line">    return np.hstack([x0, x])</span><br><span class="line"></span><br><span class="line">X = to_matrix(train_z)</span><br><span class="line"></span><br><span class="line"># sigmoid 函数</span><br><span class="line">def f(x):</span><br><span class="line">    return 1 / (1 + np.exp(-np.dot(x, theta)))</span><br><span class="line"></span><br><span class="line"># 分类函数</span><br><span class="line">def classify(x):</span><br><span class="line">    return (f(x) &gt;= 0.5).astype(np.int)</span><br><span class="line"></span><br><span class="line"># 学习率</span><br><span class="line">ETA = 1e-3</span><br><span class="line"></span><br><span class="line"># 重复次数</span><br><span class="line">epoch = 5000</span><br><span class="line"></span><br><span class="line"># 更新次数</span><br><span class="line">count = 0</span><br><span class="line"></span><br><span class="line"># 重复学习</span><br><span class="line">for _ in range(epoch):</span><br><span class="line">    theta = theta - ETA * np.dot(f(X) - train_y, X)</span><br><span class="line"></span><br><span class="line">    # 日志输出</span><br><span class="line">    count += 1</span><br><span class="line">    print(&#x27;第 &#123;&#125; 次 : theta = &#123;&#125;&#x27;.format(count, theta))</span><br><span class="line"></span><br><span class="line"># 绘图确认</span><br><span class="line">x0 = np.linspace(-2, 2, 100)</span><br><span class="line">plt.plot(train_z[train_y == 1, 0], train_z[train_y == 1, 1], &#x27;o&#x27;)</span><br><span class="line">plt.plot(train_z[train_y == 0, 0], train_z[train_y == 0, 1], &#x27;x&#x27;)</span><br><span class="line">plt.plot(x0, -(theta[0] + theta[1] * x0) / theta[2], linestyle=&#x27;dashed&#x27;)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line"></span><br><span class="line"># 读入训练数据</span><br><span class="line">train = np.loadtxt(&#x27;data3.csv&#x27;, delimiter=&#x27;,&#x27;, skiprows=1)</span><br><span class="line">train_x = train[:,0:2]</span><br><span class="line">train_y = train[:,2]</span><br><span class="line"></span><br><span class="line"># 参数初始化</span><br><span class="line">theta = np.random.rand(4)</span><br><span class="line"></span><br><span class="line"># 标准化</span><br><span class="line">mu = train_x.mean(axis=0)</span><br><span class="line">sigma = train_x.std(axis=0)</span><br><span class="line">def standardize(x):</span><br><span class="line">    return (x - mu) / sigma</span><br><span class="line"></span><br><span class="line">train_z = standardize(train_x)</span><br><span class="line"></span><br><span class="line"># 增加 x0 和 x3</span><br><span class="line">def to_matrix(x):</span><br><span class="line">    x0 = np.ones([x.shape[0], 1])</span><br><span class="line">    x3 = x[:,0,np.newaxis] ** 2</span><br><span class="line">    return np.hstack([x0, x, x3])</span><br><span class="line"></span><br><span class="line">X = to_matrix(train_z)</span><br><span class="line"></span><br><span class="line"># sigmoid 函数</span><br><span class="line">def f(x):</span><br><span class="line">    return 1 / (1 + np.exp(-np.dot(x, theta)))</span><br><span class="line"></span><br><span class="line"># 分类函数</span><br><span class="line">def classify(x):</span><br><span class="line">    return (f(x) &gt;= 0.5).astype(np.int)</span><br><span class="line"></span><br><span class="line"># 学习率</span><br><span class="line">ETA = 1e-3</span><br><span class="line"></span><br><span class="line"># 重复次数</span><br><span class="line">epoch = 5000</span><br><span class="line"></span><br><span class="line"># 更新次数</span><br><span class="line">count = 0</span><br><span class="line"></span><br><span class="line"># 重复学习</span><br><span class="line">for _ in range(epoch):</span><br><span class="line">    theta = theta - ETA * np.dot(f(X) - train_y, X)</span><br><span class="line"></span><br><span class="line">    # 日志输出</span><br><span class="line">    count += 1</span><br><span class="line">    print(&#x27;第 &#123;&#125; 次 : theta = &#123;&#125;&#x27;.format(count, theta))</span><br><span class="line"></span><br><span class="line"># 绘图确认</span><br><span class="line">x1 = np.linspace(-2, 2, 100)</span><br><span class="line">x2 = -(theta[0] + theta[1] * x1 + theta[3] * x1 ** 2) / theta[2]</span><br><span class="line">plt.plot(train_z[train_y == 1, 0], train_z[train_y == 1, 1], &#x27;o&#x27;)</span><br><span class="line">plt.plot(train_z[train_y == 0, 0], train_z[train_y == 0, 1], &#x27;x&#x27;)</span><br><span class="line">plt.plot(x1, x2, linestyle=&#x27;dashed&#x27;)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line"></span><br><span class="line"># 读入训练数据</span><br><span class="line">train = np.loadtxt(&#x27;data3.csv&#x27;, delimiter=&#x27;,&#x27;, skiprows=1)</span><br><span class="line">train_x = train[:,0:2]</span><br><span class="line">train_y = train[:,2]</span><br><span class="line"></span><br><span class="line"># 参数初始化</span><br><span class="line">theta = np.random.rand(4)</span><br><span class="line"></span><br><span class="line"># 标准化</span><br><span class="line">mu = train_x.mean(axis=0)</span><br><span class="line">sigma = train_x.std(axis=0)</span><br><span class="line">def standardize(x):</span><br><span class="line">    return (x - mu) / sigma</span><br><span class="line"></span><br><span class="line">train_z = standardize(train_x)</span><br><span class="line"></span><br><span class="line"># 增加 x0 和 x3</span><br><span class="line">def to_matrix(x):</span><br><span class="line">    x0 = np.ones([x.shape[0], 1])</span><br><span class="line">    x3 = x[:,0,np.newaxis] ** 2</span><br><span class="line">    return np.hstack([x0, x, x3])</span><br><span class="line"></span><br><span class="line">X = to_matrix(train_z)</span><br><span class="line"></span><br><span class="line"># sigmoid 函数</span><br><span class="line">def f(x):</span><br><span class="line">    return 1 / (1 + np.exp(-np.dot(x, theta)))</span><br><span class="line"></span><br><span class="line"># 分类函数</span><br><span class="line">def classify(x):</span><br><span class="line">    return (f(x) &gt;= 0.5).astype(np.int)</span><br><span class="line"></span><br><span class="line"># 学习率</span><br><span class="line">ETA = 1e-3</span><br><span class="line"></span><br><span class="line"># 重复次数</span><br><span class="line">epoch = 5000</span><br><span class="line"></span><br><span class="line"># 更新次数</span><br><span class="line">count = 0</span><br><span class="line"></span><br><span class="line"># 重复学习</span><br><span class="line">for _ in range(epoch):</span><br><span class="line">    # 使用随机梯度下降法更新参数</span><br><span class="line">    p = np.random.permutation(X.shape[0])</span><br><span class="line">    for x, y in zip(X[p,:], train_y[p]):</span><br><span class="line">        theta = theta - ETA * (f(x) - y) * x</span><br><span class="line"></span><br><span class="line">    # 日志输出</span><br><span class="line">    count += 1</span><br><span class="line">    print(&#x27;第 &#123;&#125; 次 : theta = &#123;&#125;&#x27;.format(count, theta))</span><br><span class="line"></span><br><span class="line"># 绘图确认</span><br><span class="line">x1 = np.linspace(-2, 2, 100)</span><br><span class="line">x2 = -(theta[0] + theta[1] * x1 + theta[3] * x1 ** 2) / theta[2]</span><br><span class="line">plt.plot(train_z[train_y == 1, 0], train_z[train_y == 1, 1], &#x27;o&#x27;)</span><br><span class="line">plt.plot(train_z[train_y == 0, 0], train_z[train_y == 0, 1], &#x27;x&#x27;)</span><br><span class="line">plt.plot(x1, x2, linestyle=&#x27;dashed&#x27;)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>classfication</tag>
      </tags>
  </entry>
  <entry>
    <title>five industrial algorithm</title>
    <url>/2023/04/29/five-industrial-algorithm/</url>
    <content><![CDATA[<p>[TOC]</p>
<p><img src="/2023/04/29/five-industrial-algorithm/%E5%BB%BA%E6%A8%A1Rplot.png" alt></p>
<p>标准的机器学习流程：</p>
<ol>
<li>数据输入：这是机器学习流程的第一步，它涉及收集、加载和准备数据集。数据可以来自不同的来源，包括文件、数据库、API等。一旦数据被加载，就需要对其进行初步的数据探索，以了解数据的结构、特征和异常值。</li>
<li>特征工程：特征工程是机器学习流程中最重要的步骤之一。它涉及到对数据进行预处理和特征提取的过程，以准备数据用于机器学习模型的训练。在这个步骤中，需要将原始数据转换为可供模型使用的格式，例如将文本数据转换为数字，将分类数据转换为二进制变量等。</li>
<li>缺失值处理：在数据预处理过程中，可能会发现数据中存在缺失值。在这种情况下，需要使用填充或删除等方法来处理数据中的缺失值。如果缺失值很少，可以使用填充方法填充缺失值，例如使用平均值、中位数等来填充。但是，如果缺失值占数据集的很大比例，则建议删除缺失值。</li>
<li>特征编码：机器学习模型通常只能处理数字数据。因此，如果数据中包含非数值型特征，则需要将其转换为数字数据。这个过程被称为特征编码。有几种不同的特征编码方法，例如独热编码、标签编码等。</li>
<li>特征缩放：特征缩放是将数据进行缩放以消除特征之间的差异的过程。这可以帮助模型更好地处理数据，从而提高模型的性能。常用的特征缩放方法包括归一化和标准化等。</li>
<li>数据划分：数据划分是将数据集分为训练集和测试集的过程。训练集用于训练模型，而测试集用于评估模型的性能。通常，将数据集的80％用于训练，20％用于测试。</li>
<li>训练模型：在这个步骤中，使用训练集对机器学习模型进行训练。训练模型的过程涉及将数据输入到模型中，并调整模型的参数，以使其能够适应数据并提高其性能。</li>
<li>选择算法：在训练模型之前，需要选择合适的机器学习算法。选择算法的过程取决于数据类型和问题类型。一些常用的算法包括线性回归、逻辑回归、决策树、随机森林、XGBoost等。</li>
<li>超参数调优：超参数是模型的参数，这些参数不能通过训练数据进行学习，而需要手动设置。在这个步骤中，需要调整算法的超参数以提高模型性能。这个过程称为超参数调优。</li>
<li>模型评估：在这一步骤中，使用测试集对训练好的机器学习模型进行评估。评估模型的性能通常需要使用一些指标，例如准确率、精确率、召回率、F1分数等。</li>
<li>选择评估指标：在评估模型性能之前，需要选择合适的评估指标。这取决于问题类型和数据类型。例如，如果是二元分类问题，可以使用准确率、精确率、召回率等。</li>
<li>模型调优：根据模型评估结果对模型进行调优。调优的过程可能涉及到超参数调整和特征工程等。</li>
<li>对测试集预测：最后，使用训练好的模型对新数据进行预测。这个过程涉及将新数据输入模型，并生成模型的预测结果。</li>
</ol>
<h1>逻辑回归</h1>
<p><img src="/2023/04/29/five-industrial-algorithm/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92.png" alt></p>
<h2 id="流程">流程</h2>
<p><strong>data_input</strong>：数据输入是指将逻辑回归模型的输入数据传递给模型进行训练和预测的过程。通常，数据输入包括自变量和因变量，其中自变量包括特征和标签，因变量是需要预测的目标变量。</p>
<p><strong>feature_scaling</strong>：特征缩放是指对自变量进行预处理的步骤，以提高模型的性能。特征缩放的目的是将不同的自变量放在同一尺度上，避免某些自变量对模型的影响过大。通常，特征缩放使用scale和center两种方法来缩放特征。scale会将自变量缩放到(0,1)或(-1,1)的范围内，而center会将自变量平移到均值为0的位置上。</p>
<p><strong>model_fit</strong>：拟合模型是指将逻辑回归模型与训练数据进行拟合的过程。通常使用广义线性模型（GLM）来拟合逻辑回归模型。在拟合模型时，模型会根据训练数据来学习自变量和因变量之间的关系，以便在后续的预测中使用。</p>
<p><strong>optimization_algorithm</strong>：选择优化算法是指选择用于拟合模型的优化算法。逻辑回归通常使用梯度下降法或Fisher Scoring等算法来最小化损失函数。梯度下降法是一种迭代算法，用于最小化损失函数。它通过计算每个参数的梯度来更新参数值，以便找到最小化损失函数的最优参数。Fisher Scoring也是一种迭代算法，用于最小化损失函数。它使用牛顿-拉夫逊方法来计算参数的更新值。</p>
<p><strong>loss_function</strong>：选择损失函数是指选择用于衡量模型预测误差的损失函数。逻辑回归通常使用二元交叉熵或对数损失等损失函数来最小化预测误差。二元交叉熵是一种常用的损失函数，用于衡量二元分类模型的预测误差。对数损失也是一种常用的损失函数，用于衡量逻辑回归模型的预测误差。</p>
<p><strong>predict</strong>：对测试集预测是指使用训练好的模型对测试数据进行预测的过程。通常使用决策边界和预测概率等方法来预测测试数据。决策边界是指将预测概率转换为二元分类结果的阈值。通常将预测概率大于0.5的样本归为正例，否则归为负例。预测概率是指模型预测某个样本为正例的概率值。通常使用sigmoid函数来计算预测概率。</p>
<p><strong>二元交叉熵</strong>（binary_cross_entropy）是一种常用的损失函数，用于衡量二元分类模型的预测误差。它的公式为：$$L(y,\hat{y})=-y\log(\hat{y})-(1-y)\log(1-\hat{y})$$ 其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>表示真实标签，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>表示模型预测的标签。当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">y=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>时，交叉熵只考虑<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>为1的情况，当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">y=0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span>时，交叉熵只考虑<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>为0的情况。交叉熵越小，说明模型预测的结果越接近真实结果。</p>
<p><strong>对数损失</strong>（logistic_loss）是一种常用的损失函数，用于衡量逻辑回归模型的预测误差。它的公式为：$$logL(y,\hat{y})=-y\log(\hat{y})-(1-y)\log(1-\hat{y})$$ 其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>表示真实标签，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>表示模型预测的标签。对数损失与二元交叉熵相同，只是输出形式做了对数转换不同，通常在逻辑回归中使用。</p>
<p>对测试集预测（predict）是使用训练好的模型对测试数据进行预测的步骤。在预测过程中，通常使用训练好的模型进行预测，得到预测结果后再将预测结果转化为二元分类结果。</p>
<p>决策边界（decision_boundary）是指将预测概率转换为二元分类结果的阈值。在二元分类问题中，模型通常会输出一个预测概率值，该值表示模型预测某个样本为正例的概率。为了将预测概率转换为二元分类结果，需要设定一个阈值，通常为0.5。如果预测概率大于0.5，则将该样本预测为正例，否则预测为负例。</p>
<p>预测概率（probability）是指模型预测某个样本为正例的概率值。通常在二元分类问题中，逻辑回归模型会输出一个预测概率值，该值表示模型预测某个样本为正例的概率。预测概率通常使用sigmoid函数来计算，其输出值在0到1之间，可以用来表示一个样本属于某个类别的概率。</p>
<p><strong>关键技术</strong></p>
<ul>
<li>
<p>特征缩放：使用R包中的<code>scale</code>函数进行缩放，使用<code>center</code>函数进行中心化。</p>
</li>
<li>
<p>拟合模型：使用R包中的<code>glm</code>函数进行模型拟合。可以选择不同的优化算法，例如梯度下降法或Fisher Scoring，也可以选择不同的损失函数，例如二元交叉熵或对数损失。</p>
</li>
<li>
<p>对测试集预测：使用训练好的模型进行预测。可以使用决策边界（即分类阈值）来确定类别，可以使用预测概率来进行分类。在R中，使用<code>predict</code>函数进行预测。</p>
<h2 id="数学思想详解">数学思想详解</h2>
</li>
</ul>
<p><strong>特征缩放</strong>：特征缩放是指将不同的特征按照一定比例进行缩放，使其在数值上具有可比性。对于不同的特征，它们的取值范围可能相差很大，这会导致某些特征对模型的影响比其他特征更大。为了避免这种情况的发生，通常需要对数据进行特征缩放。特征缩放的方法有很多种，其中常用的有两种：scale和center。scale将数据缩放到指定的范围内，比如[0,1]或[-1,1]，以便使不同特征的取值范围相同；center则将数据中心化，即减去数据的均值，以便消除特征间的偏移。</p>
<p><strong>梯度下降法</strong>：梯度下降法是一种常用的优化算法，用于最小化损失函数。在逻辑回归模型中，损失函数通常为交叉熵损失函数。梯度下降法的基本思想是通过不断迭代来更新模型参数，使损失函数逐渐减小。具体来说，每一次迭代都会计算损失函数关于模型参数的梯度，然后将梯度乘以一个学习率，得到参数的更新量，最后将更新量加到当前的参数值中。这样不断迭代，直到损失函数收敛或达到一定的迭代次数。</p>
<p><strong>费舍尔评分</strong>：费舍尔评分是一种统计方法，用于估计广义线性模型中的模型参数。它的基本思想是通过最大化似然函数来估计模型参数。具体来说，费舍尔评分通过求解似然方程的根来获得模型的参数估计值。相比于梯度下降法，费舍尔评分在估计参数时具有更高的效率和精度。</p>
<p><strong>二元交叉熵损失函数</strong>：二元交叉熵是一种常用的损失函数，用于评估分类模型的预测能力。它的基本思想是通过比较模型预测值与实际标签之间的差异来计算损失。具体来说，二元交叉熵损失函数将模型预测值转化为概率值，并与实际标签进行比较。相比于其他损失函数，二元交叉熵具有更好的数学性质和优化效果。</p>
<p><strong>对数损失函数</strong>：对数损失是一种常用的损失函数，用于评估逻辑回归模型的预测能力。它的基本思想是通过比较模型预测值与实际标签之间的差异来计算损失。具体来说，对数损失函数将模型预测值转化为概率值，并与实际标签进行比较。相比于其他损失函数，对数损失具有更好的数学性质和优化效果。</p>
<p><strong>决策边界</strong>：决策边界是指在分类模型中，将不同类别的数据分开的边界。它的位置和形状取决于模型的参数和特征的分布情况。通常情况下，决策边界是非线性的，需要通过复杂的数学方法来计算。在预测时，决策边界可以用来判断新的数据属于哪个类别。</p>
<p><strong>预测概率</strong>：预测概率是指分类模型对新的数据属于不同类别的概率。在逻辑回归模型中，预测概率是通过将模型输出的线性值转化为概率值得到的。在预测时，预测概率可以用来评估模型的预测能力，或者作为后续决策的依据。</p>
<p><strong>正则化</strong>：正则化是一种常用的方法，用于防止模型过拟合。在逻辑回归模型中，常用的正则化方法有L1正则化和L2正则化。L1正则化通过在损失函数中添加L1范数惩罚项，使得模型参数中的一些维度变得稀疏，即将一些参数设置为0，从而达到特征选择的效果。L2正则化通过在损失函数中添加L2范数惩罚项，使得模型参数变得更加平滑，从而防止模型过拟合。正则化的方法可以在模型训练过程中进行，也可以在模型训练完成后对模型参数进行调整。</p>
<h2 id="一个例子">一个例子</h2>
<p>逻辑回归分为多项式回归和二项式回归。</p>
<p>多项式逻辑回归（multinomial logistic regression）也称为多分类逻辑回归，是逻辑回归的一种扩展形式，用于处理多分类问题（目标变量有三个或以上的离散取值）。在多项式逻辑回归中，我们使用softmax函数将线性组合的特征转换为每个类别的概率，并选择概率最高的类别作为预测结果。</p>
<p>二项式逻辑回归（binomial logistic regression）是逻辑回归的最基本形式，用于处理二分类问题（目标变量有两个离散取值）。在二项式逻辑回归中，我们使用sigmoid函数将线性组合的特征转换为二分类概率，并选择概率大于等于0.5的类别作为预测结果。</p>
<h3 id="二元逻辑回归">二元逻辑回归</h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 加载tidyverse和dplyr包</span></span><br><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>dplyr<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 导入mtcars数据集</span></span><br><span class="line">data<span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 从mtcars数据集中选择mpg和am两个变量，并将结果存储在mtcars_select数据框中</span></span><br><span class="line">mtcars_select <span class="operator">&lt;-</span> mtcars <span class="operator">%&gt;%</span> select<span class="punctuation">(</span>mpg<span class="punctuation">,</span> am<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>mtcars_select<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 设置随机数种子，并将70%的数据分配给训练集，30%的数据分配给测试集</span></span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">123</span><span class="punctuation">)</span></span><br><span class="line">train_index <span class="operator">&lt;-</span> sample<span class="punctuation">(</span>nrow<span class="punctuation">(</span>mtcars_select<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0.7</span> <span class="operator">*</span> nrow<span class="punctuation">(</span>mtcars_select<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">train_data <span class="operator">&lt;-</span> mtcars_select<span class="punctuation">[</span>train_index<span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">test_data <span class="operator">&lt;-</span> mtcars_select<span class="punctuation">[</span><span class="operator">-</span>train_index<span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"><span class="comment"># 定义函数，函数使用逻辑回归模型对数据进行训练和测试，并返回模型的准确度和预测类别</span></span><br><span class="line">logit_train_test <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>train_data<span class="punctuation">,</span> test_data<span class="punctuation">,</span> threshold <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  logit_model <span class="operator">&lt;-</span> glm<span class="punctuation">(</span>am <span class="operator">~</span> mpg<span class="punctuation">,</span> data <span class="operator">=</span> train_data<span class="punctuation">,</span> family <span class="operator">=</span> binomial<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">   test_data<span class="operator">$</span>predict <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>logit_model<span class="punctuation">,</span> newdata <span class="operator">=</span> test_data<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&quot;response&quot;</span><span class="punctuation">)</span></span><br><span class="line">   test_data<span class="operator">$</span>predict_class <span class="operator">&lt;-</span> ifelse<span class="punctuation">(</span>test_data<span class="operator">$</span>predict <span class="operator">&gt;</span> threshold<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line">  accuracy <span class="operator">&lt;-</span> mean<span class="punctuation">(</span>test_data<span class="operator">$</span>predict_class <span class="operator">==</span> test_data<span class="operator">$</span>am<span class="punctuation">)</span></span><br><span class="line">  <span class="built_in">return</span><span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>accuracy <span class="operator">=</span> accuracy<span class="punctuation">,</span> predict_class <span class="operator">=</span> test_data<span class="operator">$</span>predict_class<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用默认阈值（0.5）对模型进行训练和测试，并输出模型的准确度</span></span><br><span class="line">default_model <span class="operator">&lt;-</span> logit_train_test<span class="punctuation">(</span>train_data<span class="punctuation">,</span> test_data<span class="punctuation">)</span></span><br><span class="line">print<span class="punctuation">(</span>paste0<span class="punctuation">(</span><span class="string">&quot;Default Model Accuracy: &quot;</span><span class="punctuation">,</span> default_model<span class="operator">$</span>accuracy<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">thresholds <span class="operator">&lt;-</span> seq<span class="punctuation">(</span><span class="number">0.1</span><span class="punctuation">,</span> <span class="number">0.9</span><span class="punctuation">,</span> <span class="number">0.1</span><span class="punctuation">)</span></span><br><span class="line">accuracy_results <span class="operator">&lt;-</span> sapply<span class="punctuation">(</span>thresholds<span class="punctuation">,</span> <span class="keyword">function</span><span class="punctuation">(</span>threshold<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  model <span class="operator">&lt;-</span> logit_train_test<span class="punctuation">(</span>train_data<span class="punctuation">,</span> test_data<span class="punctuation">,</span> threshold<span class="punctuation">)</span></span><br><span class="line">  <span class="built_in">return</span><span class="punctuation">(</span>model<span class="operator">$</span>accuracy<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 输出不同阈值下的模型准确度</span></span><br><span class="line">print<span class="punctuation">(</span>paste0<span class="punctuation">(</span><span class="string">&quot;Accuracy for different thresholds: &quot;</span><span class="punctuation">,</span> accuracy_results<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">best_threshold <span class="operator">&lt;-</span> thresholds<span class="punctuation">[</span>which.max<span class="punctuation">(</span>accuracy_results<span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">print<span class="punctuation">(</span>paste0<span class="punctuation">(</span><span class="string">&quot;Best threshold: &quot;</span><span class="punctuation">,</span> best_threshold<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">optimized_model <span class="operator">&lt;-</span> logit_train_test<span class="punctuation">(</span>train_data<span class="punctuation">,</span> test_data<span class="punctuation">,</span> best_threshold<span class="punctuation">)</span></span><br><span class="line">print<span class="punctuation">(</span>paste0<span class="punctuation">(</span><span class="string">&quot;Optimized Model Accuracy: &quot;</span><span class="punctuation">,</span> optimized_model<span class="operator">$</span>accuracy<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">##可视化</span></span><br><span class="line">plot_data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>mpg <span class="operator">=</span> seq<span class="punctuation">(</span><span class="built_in">min</span><span class="punctuation">(</span>mtcars_select<span class="operator">$</span>mpg<span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">max</span><span class="punctuation">(</span>mtcars_select<span class="operator">$</span>mpg<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0.1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">plot_data<span class="operator">$</span>predict <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>glm<span class="punctuation">(</span>am <span class="operator">~</span> mpg<span class="punctuation">,</span> data <span class="operator">=</span> train_data<span class="punctuation">,</span> family <span class="operator">=</span> binomial<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> newdata <span class="operator">=</span> plot_data<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&quot;response&quot;</span><span class="punctuation">)</span></span><br><span class="line">plot_data<span class="operator">$</span>predict_class <span class="operator">&lt;-</span> ifelse<span class="punctuation">(</span>plot_data<span class="operator">$</span>predict <span class="operator">&gt;</span> best_threshold<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 绘制散点图和预测结果线</span></span><br><span class="line">ggplot<span class="punctuation">(</span>mtcars_select<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> mpg<span class="punctuation">,</span> y <span class="operator">=</span> am<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_line<span class="punctuation">(</span>data <span class="operator">=</span> plot_data<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> mpg<span class="punctuation">,</span> y <span class="operator">=</span> predict_class<span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src="/2023/04/29/five-industrial-algorithm/%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92Rplot.png" alt></p>
<h3 id="多元逻辑回归">多元逻辑回归</h3>
<p>我们将使用鸢尾花数据集（Iris dataset）进行建模和分类。数据集包含了150个样本，每个样本有4个特征：萼片长度（sepal length）、萼片宽度（sepal width）、花瓣长度（petal length）和花瓣宽度（petal width），以及一个目标变量，即鸢尾花的种类（setosa、versicolor或virginica）</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 加载安装包和鸢尾花数据集</span></span><br><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span>  </span><br><span class="line">library<span class="punctuation">(</span>nnet<span class="punctuation">)</span>     </span><br><span class="line">library<span class="punctuation">(</span>glmnet<span class="punctuation">)</span>     </span><br><span class="line">data<span class="punctuation">(</span>iris<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 对数据集预处理</span></span><br><span class="line">iris <span class="operator">&lt;-</span> iris <span class="operator">%&gt;%</span> mutate<span class="punctuation">(</span>Species <span class="operator">=</span> factor<span class="punctuation">(</span>Species<span class="punctuation">)</span><span class="punctuation">)</span> </span><br><span class="line"><span class="comment"># 将数据集分为训练集和测试集</span></span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">123</span><span class="punctuation">)</span>    </span><br><span class="line">train_index <span class="operator">&lt;-</span> sample<span class="punctuation">(</span>nrow<span class="punctuation">(</span>iris<span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> nrow<span class="punctuation">(</span>iris<span class="punctuation">)</span> <span class="operator">*</span> <span class="number">0.7</span><span class="punctuation">)</span>  </span><br><span class="line">train_data <span class="operator">&lt;-</span> iris<span class="punctuation">[</span>train_index<span class="punctuation">,</span> <span class="punctuation">]</span>     </span><br><span class="line">test_data <span class="operator">&lt;-</span> iris<span class="punctuation">[</span><span class="operator">-</span>train_index<span class="punctuation">,</span> <span class="punctuation">]</span>     </span><br><span class="line"></span><br><span class="line"><span class="comment"># 进行多项式逻辑回归</span></span><br><span class="line">x <span class="operator">&lt;-</span> model.matrix<span class="punctuation">(</span>Species <span class="operator">~</span> .<span class="punctuation">,</span> data <span class="operator">=</span> train_data<span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span>  </span><br><span class="line">y <span class="operator">&lt;-</span> train_data<span class="operator">$</span>Species</span><br><span class="line">cv_model <span class="operator">&lt;-</span> cv.glmnet<span class="punctuation">(</span>x<span class="punctuation">,</span> y<span class="punctuation">,</span> family <span class="operator">=</span> <span class="string">&quot;multinomial&quot;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> type.measure <span class="operator">=</span> <span class="string">&quot;class&quot;</span><span class="punctuation">,</span> nfolds <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">best_alpha <span class="operator">&lt;-</span> cv_model<span class="operator">$</span>lambda.min  <span class="comment"># 选择最优的 alpha</span></span><br><span class="line">model <span class="operator">&lt;-</span> glmnet<span class="punctuation">(</span>x<span class="punctuation">,</span> y<span class="punctuation">,</span> family <span class="operator">=</span> <span class="string">&quot;multinomial&quot;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> lambda <span class="operator">=</span> best_alpha<span class="punctuation">)</span></span><br><span class="line">coef<span class="punctuation">(</span>model<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用测试集进行预测</span></span><br><span class="line">test_x <span class="operator">&lt;-</span> model.matrix<span class="punctuation">(</span>Species <span class="operator">~</span> .<span class="punctuation">,</span> data <span class="operator">=</span> test_data<span class="punctuation">)</span><span class="punctuation">[</span><span class="punctuation">,</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span>  </span><br><span class="line">test_predict <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>model<span class="punctuation">,</span> newx <span class="operator">=</span> test_x<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&quot;class&quot;</span><span class="punctuation">)</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算模型的准确率</span></span><br><span class="line">accuracy <span class="operator">&lt;-</span> <span class="built_in">sum</span><span class="punctuation">(</span>test_predict <span class="operator">==</span> test_data<span class="operator">$</span>Species<span class="punctuation">)</span> <span class="operator">/</span> nrow<span class="punctuation">(</span>test_data<span class="punctuation">)</span> </span><br><span class="line">cat<span class="punctuation">(</span><span class="string">&quot;Test Accuracy:&quot;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span>accuracy<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span> </span><br><span class="line"></span><br><span class="line">plot_data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  Predicted <span class="operator">=</span> as.factor<span class="punctuation">(</span>test_predict<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  Actual <span class="operator">=</span> test_data<span class="operator">$</span>Species</span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制一个矩阵图来可视化预测结果和真实结果的对比</span></span><br><span class="line">ggplot<span class="punctuation">(</span>plot_data<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> Predicted<span class="punctuation">,</span> y <span class="operator">=</span> Actual<span class="punctuation">,</span> fill <span class="operator">=</span> Actual<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>  </span><br><span class="line">  geom_tile<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span>                    </span><br><span class="line">  scale_fill_brewer<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;Set1&quot;</span><span class="punctuation">)</span> <span class="operator">+</span>  </span><br><span class="line">  theme_minimal<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span>               </span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;Predicted&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Actual&quot;</span><span class="punctuation">)</span>   </span><br></pre></td></tr></table></figure>
<img src="/2023/04/29/five-industrial-algorithm/多元逻辑回归.png" style="zoom:67%;">
<h1>随机森林</h1>
<p><img src="/2023/04/29/five-industrial-algorithm/%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97Rplot.png" alt></p>
<h2 id="流程">流程</h2>
<p><strong>条件推理树</strong>：基于条件推理方法构建的决策树算法。它通过条件概率来计算每个特征的重要性，并且可以处理数据集中的缺失值和噪声数据。</p>
<p><strong>回归和分类树</strong>：经典的基于递归二分法构建的决策树算法。它可以处理分类问题和回归问题，并且可以处理连续型数据和离散型数据。</p>
<p><strong>ctree</strong>：条件推理树，是一种基于条件推理方法构建的决策树算法。它可以处理缺失值和噪声数据，并且可以计算每个特征的重要性。</p>
<p><strong>rpart</strong>：回归和分类树，是一种经典的基于递归二分法构建的决策树算法。它可以处理分类问题和回归问题，并且可以处理连续型数据和离散型数据。</p>
<p><strong>bagging</strong>：装袋法，是一种基于自助采样的模型聚合方法。它通过对数据集进行自助采样来生成多个训练集，并且使用这些训练集来构建多个模型，最终将多个模型的预测结果进行平均或投票来得到最终的预测结果。</p>
<p><strong>boosting</strong>：提升法，是一种基于迭代加权的模型聚合方法。它通过对错误样本进行加权来生成多个训练集，并且使用这些训练集来构建多个模型，最终将多个模型的预测结果进行加权平均来得到最终的预测结果。</p>
<p><strong>stacking</strong>：堆叠泛化，是一种基于模型集成的元模型方法，它将多种基础模型的预测结果作为输入，再将这些结果送入一个元模型中进行训练和预测。元模型可以是任意的模型，例如线性回归模型、神经网络模型等。</p>
<p><strong>放回采样</strong>（with replacement）：是指在从一个包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span> 个元素的集合中进行 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 次采样时，每次采样后都将抽到的元素放回集合中，使得每次采样的元素独立于前面的采样结果。这意味着同一个元素可以在一次或多次采样中被选中。放回采样的优点是简单易行，适用于样本容量很大或者样本比较稀缺的情况。但是，由于每次采样都是独立的，因此放回采样可能会导致一些样本被多次采样，而其他样本则未被采样到。</p>
<p><strong>不放回采样</strong>（without replacement）：是指在从一个包含 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span> 个元素的集合中进行 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span> 次采样时，每次采样后都不将抽到的元素放回集合中，使得每次采样的元素互相独立且不重复。这意味着每个元素只能在一次采样中被选中。不放回采样的优点是可以避免样本重复采样的问题，适用于样本容量较小时或者需要确保每个样本只被采样一次的情况。但是，不放回采样可能会导致样本抽样不够随机或者抽样偏差较大的问题。</p>
<p><strong>关键技术</strong></p>
<p><strong>特征采样</strong>：使用R包中的<code>randomForest</code>函数进行特征采样，可以指定选取的特征数<code>mtry</code>和采样方式（有/无放回）。</p>
<p><strong>自助采样</strong>：使用R包中的<code>randomForest</code>函数进行自助采样，可以指定样本数<code>n</code>和采样方式（有/无放回）。</p>
<p><strong>构建决策树</strong>：使用R包中的<code>rpart</code>函数进行决策树的构建，可以选择不同的算法（例如条件推理树或回归和分类树）。</p>
<p><strong>模型聚合</strong>：使用R包中的<code>randomForest</code>函数进行模型聚合，可以选择不同的聚合方法（例如Bagging、Boosting或Stacking）。</p>
<h2 id="数学思想">数学思想</h2>
<p><strong>随机选择特征</strong>：在构建每个决策树时，随机森林会从所有特征中随机选择一部分特征来进行划分。这种随机选择特征的方法被称为“特征随机”，它可以减少决策树之间的相关性，因为每个决策树只使用了一部分特征进行划分，从而避免了某些特征对于分类或回归的过于重要而导致决策树相似度过高的问题。在实践中，通常会随机选择特征的数量，比如选择总特征数的平方根或者总特征数的一半等。</p>
<p><strong>自助采样法</strong>：随机森林采用自助采样法（bootstrap sampling）来随机选择训练数据，即从原始数据集中有放回地抽取一部分数据来训练每个决策树。这种方法可以使得每个决策树都有不同的训练数据，增加模型的多样性。在实践中，通常会使用大约2/3的样本进行训练，剩下的1/3用于测试。</p>
<p><strong>决策树的集成</strong>：随机森林将多个决策树进行集成，通过投票或平均预测值来决定最终的分类或回归结果。这种方法可以减小决策树的方差，提高模型的精度。在分类问题中，通常使用多数表决来进行投票，即每个决策树给出一个类别预测，最终的预测结果是得票最多的类别；在回归问题中，通常使用平均预测值来得到最终预测结果。</p>
<p><strong>调整超参数</strong>：随机森林有多个超参数需要调整，如决策树的数量、特征选择的数量、每个决策树的最大深度等。通过调整这些超参数可以优化模型的性能。在实践中，通常使用交叉验证来选择最优的超参数，比如使用网格搜索或随机搜索来搜索超参数的组合。</p>
<h2 id="一个例子">一个例子</h2>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>caTools<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>caret<span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">(</span>iris<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 拆分数据集为训练集和测试集</span></span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">123</span><span class="punctuation">)</span></span><br><span class="line">split <span class="operator">=</span> sample.split<span class="punctuation">(</span>iris<span class="operator">$</span>Species<span class="punctuation">,</span> SplitRatio <span class="operator">=</span> <span class="number">0.7</span><span class="punctuation">)</span></span><br><span class="line">train <span class="operator">=</span> subset<span class="punctuation">(</span>iris<span class="punctuation">,</span> split <span class="operator">==</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">test <span class="operator">=</span> subset<span class="punctuation">(</span>iris<span class="punctuation">,</span> split <span class="operator">==</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">train<span class="operator">$</span>Species <span class="operator">=</span> as.factor<span class="punctuation">(</span>train<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line">test<span class="operator">$</span>Species <span class="operator">=</span> as.factor<span class="punctuation">(</span>test<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#交叉验证</span></span><br><span class="line">folds <span class="operator">=</span> <span class="number">5</span></span><br><span class="line">ctrl <span class="operator">=</span> trainControl<span class="punctuation">(</span>method <span class="operator">=</span> <span class="string">&quot;cv&quot;</span><span class="punctuation">,</span> number <span class="operator">=</span> folds<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 训练随机森林模型</span></span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">123</span><span class="punctuation">)</span></span><br><span class="line">rf_model <span class="operator">=</span> train<span class="punctuation">(</span>Species<span class="operator">~</span>.<span class="punctuation">,</span> data <span class="operator">=</span> train<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&quot;rf&quot;</span><span class="punctuation">,</span> trControl <span class="operator">=</span> ctrl<span class="punctuation">,</span> ntree <span class="operator">=</span> <span class="number">1000</span><span class="punctuation">)</span></span><br><span class="line">rf_model</span><br><span class="line"><span class="comment">#预测</span></span><br><span class="line">rf_predict <span class="operator">=</span> predict<span class="punctuation">(</span>rf_model<span class="punctuation">,</span> test<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 计算混淆矩阵</span></span><br><span class="line">confusionMatrix<span class="punctuation">(</span>rf_predict<span class="punctuation">,</span> test<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line">importance <span class="operator">=</span> varImp<span class="punctuation">(</span>rf_model<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line">ggplot<span class="punctuation">(</span>importance<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>rownames<span class="punctuation">(</span>importance<span class="punctuation">)</span><span class="punctuation">,</span> y<span class="operator">=</span>Importance<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_bar<span class="punctuation">(</span>stat<span class="operator">=</span><span class="string">&quot;identity&quot;</span><span class="punctuation">,</span> fill<span class="operator">=</span><span class="string">&quot;blue&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  xlab<span class="punctuation">(</span><span class="string">&quot;Variables&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ylab<span class="punctuation">(</span><span class="string">&quot;Importance&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ggtitle<span class="punctuation">(</span><span class="string">&quot;Random Forest Variable Importance&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<img src="/2023/04/29/five-industrial-algorithm/随机森林.png" style="zoom: 50%;">
<h1>决策树</h1>
<p><img src="/2023/04/29/five-industrial-algorithm/%E5%86%B3%E7%AD%96%E6%A0%91Rplot.png" alt></p>
<h2 id="流程">流程</h2>
<p><strong>信息增益（information_gain）</strong>：这个节点是用于选择特征的准则之一。信息增益是指通过选择某个特征分割数据后，整个数据集的信息熵减少的程度。信息熵是指数据集中的混乱程度，如果数据集完全纯化，则信息熵为0。因此，信息增益越大，表示使用该特征分割数据后，整个数据集的纯度提高得越多，决策树的分类性能也会更好。<br>
<strong>增益比（gain_ratio）</strong>：这个节点也是用于选择特征的准则之一。增益比是信息增益准则的改进版本，它考虑了可能的分割数，并调整了信息增益的值。增益比可以避免选择具有大量分割的特征，这些分割可能会导致过度拟合。因此，增益比相对于信息增益更加稳定，适用于处理高维数据集。<br>
<strong>Gini指数（gini_index）</strong>：这个节点也是用于选择特征的准则之一。Gini指数是一个衡量数据集纯度的指标，它表示一次随机选择的数据点被错误分类的概率。选择Gini指数作为分割准则将导致选择最大化子集纯度的特征。与信息增益和增益比不同的是，Gini指数不需要计算信息熵，因此计算效率更高。<br>
<strong>二分法分割（binary_split）</strong>：这个节点表示使用二进制准则将数据划分为两个子集的过程。在这个过程中，将选择一个特征，并使用该特征的中值将数据分割为两个子集。二分法分割适用于处理连续型特征。<br>
<strong>多分法分割（multiway_split）</strong>：这个节点表示使用非二进制准则将数据分割为多个子集的过程。在这个过程中，将选择一个特征，并使用该特征中的每个唯一值将数据分割为多个子集。多分法分割适用于处理离散型特征。<br>
<strong>最大深度（max_depth）</strong>：这个节点表示决策树的最大深度。如果达到了这个深度，将停止递归构建决策树的过程。最大深度是控制决策树模型复杂度的一个重要参数。<br>
<strong>最小样本数（min_samples）</strong>：这个节点表示每个子集中的最小样本数。如果子集中的样本数小于这个值，将停止递归构建决策树的过程。最小样本数也是控制决策树模型复杂度的一个重要参数。<br>
<strong>最小叶节点样本数（min_leaf_samples）</strong>：这个节点表示每个叶子节点中的最小样本数。如果叶子节点中的样本数小于这个值，将停止递归构建决策树的过程。最小叶节点样本数也是控制决策树模型复杂度的一个重要参数。</p>
<p><strong>关键技术</strong></p>
<ul>
<li>特征选择：使用信息增益、增益比或Gini指数等方法选择最佳特征进行数据分割。在R中，可以使用<code>rpart</code>包中的<code>method = 'information'</code>、<code>'gain'</code>或<code>'gini'</code>参数来指定方法。</li>
<li>数据分割：根据选择的特征将数据集分割为子集，可以使用二分法或多分法等不同的分割方式。</li>
<li>构建决策树：递归地构建决策树，直到达到停止标准。例如，可以通过设置最大深度、最小样本数或最小叶节点样本数等来停止构建树。</li>
<li>对测试集预测：使用训练好的决策树进行预测。在R中，可以使用<code>predict</code>函数进行预测。</li>
</ul>
<h2 id="一个例子">一个例子</h2>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 加载iris数据集</span></span><br><span class="line">data<span class="punctuation">(</span>iris<span class="punctuation">)</span></span><br><span class="line">iris<span class="operator">$</span>Species <span class="operator">&lt;-</span> as.factor<span class="punctuation">(</span>iris<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 将数据集分为训练集和测试集</span></span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">123</span><span class="punctuation">)</span></span><br><span class="line">train_index <span class="operator">&lt;-</span> sample<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span>nrow<span class="punctuation">(</span>iris<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0.7</span><span class="operator">*</span>nrow<span class="punctuation">(</span>iris<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">train_set <span class="operator">&lt;-</span> iris<span class="punctuation">[</span>train_index<span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">test_set <span class="operator">&lt;-</span> iris<span class="punctuation">[</span><span class="operator">-</span>train_index<span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用交叉验证来优化模型</span></span><br><span class="line">library<span class="punctuation">(</span>rpart<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>rpart.plot<span class="punctuation">)</span></span><br><span class="line">cv_model <span class="operator">&lt;-</span> rpart<span class="punctuation">(</span>Species <span class="operator">~</span> .<span class="punctuation">,</span> data<span class="operator">=</span>train_set<span class="punctuation">,</span> method<span class="operator">=</span><span class="string">&quot;class&quot;</span><span class="punctuation">,</span> cp<span class="operator">=</span><span class="number">0</span><span class="punctuation">)</span></span><br><span class="line">cv_results <span class="operator">&lt;-</span> printcp<span class="punctuation">(</span>cv_model<span class="punctuation">)</span></span><br><span class="line">best_cp <span class="operator">&lt;-</span> cv_results<span class="punctuation">[</span>which.min<span class="punctuation">(</span>cv_results<span class="punctuation">[</span><span class="punctuation">,</span><span class="string">&quot;xerror&quot;</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&quot;CP&quot;</span><span class="punctuation">]</span></span><br><span class="line">pruned_model <span class="operator">&lt;-</span> prune<span class="punctuation">(</span>cv_model<span class="punctuation">,</span> cp<span class="operator">=</span>best_cp<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 剪枝</span></span><br><span class="line">summary<span class="punctuation">(</span>pruned_model<span class="punctuation">)</span></span><br><span class="line">text<span class="punctuation">(</span>pruned_model<span class="punctuation">,</span> use.n<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">plot<span class="punctuation">(</span>pruned_model<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line">library<span class="punctuation">(</span>PRP<span class="punctuation">)</span></span><br><span class="line">prp<span class="punctuation">(</span>pruned_model<span class="punctuation">,</span> box.col<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;pink&quot;</span><span class="punctuation">,</span><span class="string">&quot;orange&quot;</span><span class="punctuation">,</span><span class="string">&quot;skyblue&quot;</span><span class="punctuation">)</span><span class="punctuation">[</span>pruned_model<span class="operator">$</span>frame<span class="operator">$</span>yval<span class="punctuation">]</span><span class="punctuation">,</span> </span><br><span class="line">    shadow.col<span class="operator">=</span><span class="string">&quot;gray&quot;</span><span class="punctuation">,</span> compress<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> extra<span class="operator">=</span><span class="number">101</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 美化</span></span><br><span class="line">rpart.plot<span class="punctuation">(</span>pruned_model<span class="punctuation">,</span> type<span class="operator">=</span><span class="number">5</span><span class="punctuation">,</span> extra<span class="operator">=</span><span class="number">101</span><span class="punctuation">,</span> under<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> fallen.leaves<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">,</span> </span><br><span class="line">           branch.lty<span class="operator">=</span><span class="number">3</span><span class="punctuation">,</span> box.palette<span class="operator">=</span><span class="string">&quot;RdBu&quot;</span><span class="punctuation">,</span> box.col<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;pink&quot;</span><span class="punctuation">,</span><span class="string">&quot;orange&quot;</span><span class="punctuation">,</span><span class="string">&quot;skyblue&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">           shadow.col<span class="operator">=</span><span class="string">&quot;gray&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 评估模型</span></span><br><span class="line">predictions <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>pruned_model<span class="punctuation">,</span> test_set<span class="punctuation">,</span> type<span class="operator">=</span><span class="string">&quot;class&quot;</span><span class="punctuation">)</span></span><br><span class="line">table<span class="punctuation">(</span>predictions<span class="punctuation">,</span> test_set<span class="operator">$</span>Species<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<img src="/2023/04/29/five-industrial-algorithm/决策树.png" style="zoom: 50%;">
<h1>XGBoost</h1>
<p><img src="/2023/04/29/five-industrial-algorithm/XGboostRplot.png" alt></p>
<h2 id="流程">流程</h2>
<p><strong>data_input</strong>:data_input表示输入数据，通常是指训练集或测试集等待被处理的数据。在机器学习和深度学习中，数据是非常重要的，因为它们是模型训练和评估的基础。数据输入的格式和类型不同，取决于具体的任务和算法，可以是图像、文本、音频等。<br>
<strong>boosting_rounds</strong>:boosting_rounds是Boosting算法的迭代轮数，即确定了每一轮使用的弱学习器后，进行多少轮迭代。在每一轮迭代中，会训练一个新的弱学习器，并更新样本的权重以纠正错误分类的样本。迭代次数的多少会影响模型的性能和计算速度，需要根据实际情况进行调整。<br>
<strong>feature_sampling</strong>:feature_sampling是指在训练决策树时，从原始特征中随机选择一部分特征用于训练，从而减少特征维度，提高模型的泛化性能。特征采样可以降低模型的过拟合风险，并且可以加速模型训练的速度。在实践中，特征采样通常是通过随机选择一定数量的特征来实现的。<br>
<strong>mtry</strong>:mtry是特征采样中的一个参数，指定每个节点上选择的特征数。mtry的值可以控制模型的复杂度和泛化性能，通常设置为总特征数的平方根或者总特征数的一半。<br>
<strong>采样类型</strong>:特征采样的方式有两种，包括有放回采样（replacement）和无放回采样（without_replacement）。有放回采样允许同一特征在不同节点被多次选中，而无放回采样则不会重复选择同一特征。有放回采样可以增加模型的多样性，但也会增加模型的方差，因此需要根据实际情况进行选择。<br>
<strong>tree_building</strong>:tree_building是指根据训练数据和标签构建一个决策树模型，用于分类或回归任务。决策树是一种基于树形结构的分类和回归模型，将输入空间划分为一系列的矩形区域，每个区域对应一个预测值。决策树的构建通常是通过递归地对数据进行分裂，使得每个分裂后的子集更加纯净，从而实现对数据的分类或回归。<br>
<strong>tree_algorithm</strong>:构建决策树时，可以选择不同的算法来进行计算，包括精确算法（exact）和近似算法（approx）。精确算法需要对每个节点进行穷举搜索，计算所有可能的分裂点，因此计算复杂度较高。近似算法则采用一些快速的启发式方法来搜索分裂点，可以加速计算，但是有可能会影响模型的准确性。<br>
<strong>boosting</strong>:Boosting是一种集成学习算法，通过迭代地训练一系列的弱学习器来构建一个强大的集成模型。在每一轮迭代中，会训练一个新的弱学习器，并根据前面的弱学习器的错误来调整样本的权重。通过这种方式，Boosting可以逐步减少模型的偏差和方差，提高模型的泛化性能。<br>
<strong>loss_function</strong>:loss_function表示优化算法使用的损失函数，用于评估模型预测结果的好坏。在机器学习和深度学习中，损失函数通常是根据任务类型和模型结构进行选择的。对于分类任务，可以使用交叉熵损失函数或者对数损失函数，对于回归任务，可以使用均方误差损失函数或者平均绝对误差损失函数。<br>
<strong>learning_rate</strong>:learning_rate是Boosting算法中的一个超参数，用于控制每一轮迭代中对样本权重的调整幅度。较小的学习率可以使模型更加稳定，但是需要更多的迭代次数才能获得最优结果，较大的学习率可以加速模型的收敛速度，但是容易导致模型振荡或不稳定。需要根据实际情况进行调整。<br>
<strong>regularization</strong>: 正则化是一种防止过拟合的方法，通过在模型的损失函数中加入正则化项来惩罚模型的复杂度，从而提高模型的泛化性能。<br>
<strong>l1</strong>: L1正则化是一种正则化方法，它在模型的损失函数中加入L1（L1范数）正则化项，即权重向量的各个元素的绝对值之和乘以一个系数λ。L1正则化可以使得一部分权重趋向于0，从而实现特征选择的效果。<br>
<strong>l2</strong>: L2正则化是一种正则化方法，它在模型的损失函数中加入L2（L2范数）正则化项，即权重向量的各个元素的平方和乘以一个系数λ。L2正则化可以使得权重向量趋向于较小的值，从而平滑模型的复杂度，降低模型的方差，提高模型的泛化性能。</p>
<p><strong>关键技术</strong></p>
<p><strong>特征采样</strong>：使用<code>xgboost</code>函数进行特征采样，可以指定选取的特征数<code>mtry</code>和采样方式（有/无放回）。</p>
<p><strong>构建决策树</strong>：使用<code>xgboost</code>函数构建决策树，可以选择精确算法或近似算法。</p>
<p><strong>Boosting</strong>：使用梯度下降法更新权重，可以指定学习率和正则化方法（L1/L2）。</p>
<h2 id="一个例子">一个例子</h2>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>xgboost<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">(</span>mtcars<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>caret<span class="punctuation">)</span></span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">123</span><span class="punctuation">)</span></span><br><span class="line">trainIndex <span class="operator">&lt;-</span> createDataPartition<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">,</span> p <span class="operator">=</span> <span class="number">.8</span><span class="punctuation">,</span> </span><br><span class="line">                                  <span class="built_in">list</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> </span><br><span class="line">                                  times <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">train <span class="operator">&lt;-</span> mtcars<span class="punctuation">[</span> trainIndex<span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">test <span class="operator">&lt;-</span> mtcars<span class="punctuation">[</span><span class="operator">-</span>trainIndex<span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">dtrain <span class="operator">&lt;-</span> xgb.DMatrix<span class="punctuation">(</span>data <span class="operator">=</span> as.matrix<span class="punctuation">(</span>train<span class="punctuation">[</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">                      label <span class="operator">=</span> train<span class="operator">$</span>mpg<span class="punctuation">)</span></span><br><span class="line">dtest <span class="operator">&lt;-</span> xgb.DMatrix<span class="punctuation">(</span>data <span class="operator">=</span> as.matrix<span class="punctuation">(</span>test<span class="punctuation">[</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">                     label <span class="operator">=</span> test<span class="operator">$</span>mpg<span class="punctuation">)</span></span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">123</span><span class="punctuation">)</span></span><br><span class="line">xgb_params <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span></span><br><span class="line">  objective <span class="operator">=</span> <span class="string">&quot;reg:squarederror&quot;</span><span class="punctuation">,</span></span><br><span class="line">  eta <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span></span><br><span class="line">  max_depth <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line">  subsample <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">,</span></span><br><span class="line">  colsample_bytree <span class="operator">=</span> <span class="number">0.8</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line">xgb_cv <span class="operator">&lt;-</span> xgb.cv<span class="punctuation">(</span>params <span class="operator">=</span> xgb_params<span class="punctuation">,</span> </span><br><span class="line">                 data <span class="operator">=</span> dtrain<span class="punctuation">,</span> </span><br><span class="line">                 nrounds <span class="operator">=</span> <span class="number">1000</span><span class="punctuation">,</span> </span><br><span class="line">                 nfold <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> </span><br><span class="line">                 early_stopping_rounds <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> </span><br><span class="line">                 verbose <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> </span><br><span class="line">                 print_every_n <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> </span><br><span class="line">                 maximize <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> </span><br><span class="line">                 metrics <span class="operator">=</span> <span class="string">&quot;rmse&quot;</span><span class="punctuation">,</span> </span><br><span class="line">                 seed <span class="operator">=</span> <span class="number">123</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 找到最佳的迭代次数</span></span><br><span class="line">best_iter <span class="operator">&lt;-</span> xgb_cv<span class="operator">$</span>best_iteration</span><br><span class="line"><span class="comment"># 训练最终模型</span></span><br><span class="line">xgb_model <span class="operator">&lt;-</span> xgb.train<span class="punctuation">(</span>params <span class="operator">=</span> xgb_params<span class="punctuation">,</span> </span><br><span class="line">                       data <span class="operator">=</span> dtrain<span class="punctuation">,</span> </span><br><span class="line">                       nrounds <span class="operator">=</span> best_iter<span class="punctuation">,</span> </span><br><span class="line">                       watchlist <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>train <span class="operator">=</span> dtrain<span class="punctuation">,</span> test <span class="operator">=</span> dtest<span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">                       print_every_n <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> </span><br><span class="line">                       early_stopping_rounds <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> </span><br><span class="line">                       maximize <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> </span><br><span class="line">                       eval_metric <span class="operator">=</span> <span class="string">&quot;rmse&quot;</span><span class="punctuation">,</span> </span><br><span class="line">                       verbose <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">pred <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>xgb_model<span class="punctuation">,</span> dtest<span class="punctuation">)</span></span><br><span class="line">rmse <span class="operator">&lt;-</span> <span class="built_in">sqrt</span><span class="punctuation">(</span>mean<span class="punctuation">(</span><span class="punctuation">(</span>test<span class="operator">$</span>mpg <span class="operator">-</span> pred<span class="punctuation">)</span><span class="operator">^</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">cat<span class="punctuation">(</span><span class="string">&quot;RMSE:&quot;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span>rmse<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">xgb.plot.tree<span class="punctuation">(</span>model <span class="operator">=</span> xgb_model<span class="punctuation">,</span> trees <span class="operator">=</span> <span class="number">0</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">              feature_names <span class="operator">=</span> colnames<span class="punctuation">(</span>train<span class="punctuation">[</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">              label <span class="operator">=</span> <span class="string">&quot;mpg&quot;</span><span class="punctuation">,</span>max.depth <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><img src="/2023/04/29/five-industrial-algorithm/xgboost.png" alt></p>
<h1>朴素贝叶斯</h1>
<p><img src="/2023/04/29/five-industrial-algorithm/%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AFRplot.png" alt></p>
<h2 id="流程">流程</h2>
<p><strong>tokenization</strong>：分词，将文本数据分成词语。分词是文本处理的基本步骤，它将文本数据转换为单词序列，便于后续处理。</p>
<p><strong>vectorization</strong>：向量化，将文本数据表示为数值型特征向量。向量化是将文本数据转换为机器学习算法可以处理的数值型数据的一种方法。在这里，通常使用词袋模型将文本数据表示为向量，即用一个向量表示文本中所有单词的出现情况。</p>
<p><strong>feature_selection</strong>：特征选择的节点，用于从所有特征中选出一个子集。特征选择是为了避免过拟合和提高分类器的性能。该节点包含以下子节点：</p>
<p><strong>feature_evaluation</strong>：特征评估，用于评估每个特征的重要性。特征评估的目的是为了找出和分类任务相关的特征，同时去除掉那些无关或冗余的特征。</p>
<p><strong>chi_squared</strong>：卡方检验，用于衡量每个特征与类别之间的相关性。卡方检验是一种用于衡量两个变量之间相关性的统计方法，它可以用于特征选择，帮助找出和分类任务相关的特征。</p>
<p><strong>mutual_information</strong>：互信息，用于衡量每个特征与类别之间的相关性。互信息也是一种衡量两个变量之间相关性的方法，它可以用来评估每个特征对分类任务的贡献程度。</p>
<p><strong>training</strong>：训练模型的节点，用于训练 Naive Bayes 分类器。在训练过程中，分类器会学习如何将输入的特征映射到输出的类别上。</p>
<p><strong>predict</strong>：对测试集进行预测的节点，用于使用训练好的分类器对新数据进行分类。在预测过程中，分类器会使用训练好的模型对测试集的特征进行分类，并输出预测结果。</p>
<p><strong>关键技术</strong></p>
<p><strong>特征提取</strong>：将文本数据转换为数值特征，通常使用分词、去除停用词、词干化和向量化等技术。在R中，可以使用<code>tm</code>包中的函数实现这些技术。</p>
<p><strong>特征选择</strong>：选择一部分最具有代表性的特征来训练模型，可以使用卡方检验或互信息等方法进行特征评估。在R中，可以使用<code>caret</code>或<code>FSelector</code>等包中的函数实现特征选择。</p>
<p><strong>训练模型</strong>：使用训练集训练朴素贝叶斯分类器，可以使用<code>naiveBayes</code>函数进行训练。</p>
<h2 id="例子1">例子1</h2>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 导入所需的包</span></span><br><span class="line">library<span class="punctuation">(</span>e1071<span class="punctuation">)</span>   </span><br><span class="line">library<span class="punctuation">(</span>caret<span class="punctuation">)</span>   </span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span> </span><br><span class="line"><span class="comment"># 载入数据</span></span><br><span class="line">data<span class="punctuation">(</span>iris<span class="punctuation">)</span></span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">123</span><span class="punctuation">)</span></span><br><span class="line">train.index <span class="operator">&lt;-</span> createDataPartition<span class="punctuation">(</span>iris<span class="operator">$</span>Species<span class="punctuation">,</span> p <span class="operator">=</span> <span class="number">0.7</span><span class="punctuation">,</span> <span class="built_in">list</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">train.data <span class="operator">&lt;-</span> iris<span class="punctuation">[</span>train.index<span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">test.data <span class="operator">&lt;-</span> iris<span class="punctuation">[</span><span class="operator">-</span>train.index<span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 朴素贝叶斯分类器</span></span><br><span class="line">nb_model <span class="operator">&lt;-</span> naiveBayes<span class="punctuation">(</span>Species <span class="operator">~</span> .<span class="punctuation">,</span> data <span class="operator">=</span> train.data<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 对测试数据进行预测</span></span><br><span class="line">nb_pred <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>nb_model<span class="punctuation">,</span> newdata <span class="operator">=</span> test.data<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 模型评估</span></span><br><span class="line">confusionMatrix<span class="punctuation">(</span>nb_pred<span class="punctuation">,</span> test.data<span class="operator">$</span>Species<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 可视化</span></span><br><span class="line">ggplot<span class="punctuation">(</span>train.data<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> Sepal.Length<span class="punctuation">,</span> y <span class="operator">=</span> Sepal.Width<span class="punctuation">,</span> color <span class="operator">=</span> Species<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>title <span class="operator">=</span> <span class="string">&quot;Scatter Plot of Sepal Length and Width&quot;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="string">&quot;Sepal Length&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Sepal Width&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>train.data<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> Petal.Length<span class="punctuation">,</span> y <span class="operator">=</span> Petal.Width<span class="punctuation">,</span> color <span class="operator">=</span> Species<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>title <span class="operator">=</span> <span class="string">&quot;Scatter Plot of Petal Length and Width&quot;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="string">&quot;Petal Length&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Petal Width&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>train.data<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> Sepal.Length<span class="punctuation">,</span> fill <span class="operator">=</span> Species<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_histogram<span class="punctuation">(</span>binwidth <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>title <span class="operator">=</span> <span class="string">&quot;Histogram of Sepal Length&quot;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="string">&quot;Sepal Length&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Count&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>train.data<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> Petal.Length<span class="punctuation">,</span> color <span class="operator">=</span> Species<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_density<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>title <span class="operator">=</span> <span class="string">&quot;Density Plot of Petal Length&quot;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="string">&quot;Petal Length&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Density&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">Overall Statistics</span><br><span class="line">                                          </span><br><span class="line">               Accuracy <span class="operator">:</span> <span class="number">0.9111</span>          </span><br><span class="line">                 <span class="number">95</span>% CI <span class="operator">:</span> <span class="punctuation">(</span><span class="number">0.7878</span><span class="punctuation">,</span> <span class="number">0.9752</span><span class="punctuation">)</span></span><br><span class="line">    No Information Rate <span class="operator">:</span> <span class="number">0.3333</span>          </span><br><span class="line">    P<span class="operator">-</span>Value <span class="punctuation">[</span>Acc <span class="operator">&gt;</span> NIR<span class="punctuation">]</span> <span class="operator">:</span> <span class="number">8.467e-16</span>       </span><br><span class="line">                                          </span><br><span class="line">                  Kappa <span class="operator">:</span> <span class="number">0.8667</span>          </span><br><span class="line">                                          </span><br><span class="line"> Mcnemar<span class="string">&#x27;s Test P-Value : NA              </span></span><br></pre></td></tr></table></figure>
<h2 id="例子2">例子2</h2>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 加载需要用到的包</span></span><br><span class="line">library<span class="punctuation">(</span>e1071<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>caret<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>tm<span class="punctuation">)</span>  </span><br><span class="line">library<span class="punctuation">(</span>text2vec<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">data<span class="punctuation">(</span><span class="string">&quot;movie_review&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将文本数据转换为语料库对象</span></span><br><span class="line">corpus <span class="operator">&lt;-</span> Corpus<span class="punctuation">(</span>VectorSource<span class="punctuation">(</span>movie_review<span class="operator">$</span>review<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">dtm <span class="operator">&lt;-</span> DocumentTermMatrix<span class="punctuation">(</span>corpus<span class="punctuation">)</span></span><br><span class="line">dtm <span class="operator">&lt;-</span> removeSparseTerms<span class="punctuation">(</span>dtm<span class="punctuation">,</span> <span class="number">0.95</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dtm_with_labels <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span>as.data.frame<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>dtm<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> sentiment <span class="operator">=</span> factor<span class="punctuation">(</span>movie_review<span class="operator">$</span>sentiment<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将数据集分割为训练集和测试集</span></span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">123</span><span class="punctuation">)</span></span><br><span class="line">trainIndex <span class="operator">&lt;-</span> createDataPartition<span class="punctuation">(</span>dtm_with_labels<span class="operator">$</span>sentiment<span class="punctuation">,</span> p <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">,</span> <span class="built_in">list</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">train <span class="operator">&lt;-</span> dtm_with_labels<span class="punctuation">[</span>trainIndex<span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">test <span class="operator">&lt;-</span> dtm_with_labels<span class="punctuation">[</span><span class="operator">-</span>trainIndex<span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 训练朴素贝叶斯模型</span></span><br><span class="line">ctrl <span class="operator">&lt;-</span> trainControl<span class="punctuation">(</span>method <span class="operator">=</span> <span class="string">&quot;repeatedcv&quot;</span><span class="punctuation">,</span> number <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> repeats <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">model <span class="operator">&lt;-</span> train<span class="punctuation">(</span>sentiment <span class="operator">~</span> .<span class="punctuation">,</span> data <span class="operator">=</span> train<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&quot;bayesglm&quot;</span><span class="punctuation">,</span> trControl <span class="operator">=</span> ctrl<span class="punctuation">,</span> family <span class="operator">=</span> <span class="string">&quot;binomial&quot;</span><span class="punctuation">)</span></span><br><span class="line">predictions <span class="operator">&lt;-</span> predict<span class="punctuation">(</span>model<span class="punctuation">,</span> newdata <span class="operator">=</span> test<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 评估模型性能</span></span><br><span class="line">confusionMatrix<span class="punctuation">(</span>predictions<span class="punctuation">,</span> test<span class="operator">$</span>sentiment<span class="punctuation">)</span><span class="operator">$</span>table</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化模型性能</span></span><br><span class="line">plot <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>data <span class="operator">=</span> as.data.frame<span class="punctuation">(</span>confusionMatrix<span class="punctuation">(</span>predictions<span class="punctuation">,</span> test<span class="operator">$</span>sentiment<span class="punctuation">)</span><span class="operator">$</span>table<span class="punctuation">)</span><span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> Prediction<span class="punctuation">,</span> y <span class="operator">=</span> Reference<span class="punctuation">,</span> fill <span class="operator">=</span> Freq<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_tile<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_bw<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_gradient<span class="punctuation">(</span>low <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> high <span class="operator">=</span> <span class="string">&quot;steelblue&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>title <span class="operator">=</span> <span class="string">&quot;Confusion Matrix&quot;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="string">&quot;Predictions&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Actual&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">plot</span><br></pre></td></tr></table></figure>
<img src="/2023/04/29/five-industrial-algorithm/朴素贝叶斯.png" style="zoom:50%;">]]></content>
      <tags>
        <tag>algorithm</tag>
      </tags>
  </entry>
  <entry>
    <title>如何避免建模中的陷阱</title>
    <url>/2023/05/16/how-to-modeling/</url>
    <content><![CDATA[<p>[TOC]</p>
<h1>作者简介</h1>
<p><strong>How to avoid machine learning pitfalls: a guide for academic researchersMichael Lones</strong></p>
<p><strong>爱丁堡赫瑞瓦特大学（Heriot-Watt University）数学和计算机科学学院（School of Mathematical and Computer Sciences）的副教授。研究领域包括优化、机器学习、数据科学、复杂系统和非标准计算等领域，并致力于生物学、医学、机器人和安全等领域的问题。</strong></p>
<h1>摘要</h1>
<p>机器学习有五个基本步骤，按照流程通俗的讲就是：在建立模型之前做什么，如何可靠地建立模型，如何稳健地评估模型，如何公平地比较模型，以及如何报告结果。在实际建模过程中，我们往往会不经意的犯各种错误，以至于建模效果不理想，最终的结果是导致人们对建模结果始终处于不信任状态。为了得到更好的建模效果，避免在上述步骤中犯错，重新建立人们对建模的信心，本文分章节编写了各步骤中需要避免的错误。</p>
<h1>Before you start to build models</h1>
<p>If you don’t do these things, then you may end up with results that are hard to publish, or models that<br>
are not appropriate for their intended purpose.</p>
<h2 id="花点时间了解数据可靠性">花点时间了解数据可靠性</h2>
<p>If you train your model using bad data, then you will most likely generate a bad model: a process known as garbage in garbage out.</p>
<p>这个步骤中主要做以下事情：</p>
<p>1、检查数据出处。</p>
<p>2、查找缺失和不匹配信息。</p>
<p>需要注意的是：即使发表过论文，也不代表该数据集是好的。可能只是被设计好的，符合论文目标而已。</p>
<h2 id="不要过分仔细的分析所有数据">不要过分仔细的分析所有数据</h2>
<p>该步骤主要是为了避免在分析前对数据做出不可靠的假设。仔细的分析会让你只专注细节，忽略了其它你无法通过观察进行建模的信息。最终会导致模型泛化能力大打折扣。甚至会有错误的</p>
<p>安斯库姆四重奏</p>
<h2 id="确保数据量足够充足">确保数据量足够充足</h2>
<p>如果你没有足够的数据，训练一个泛化的模型基本是不可能的。在这里，这这针对数据量不足给出了以下建议：</p>
<p>1、 you can make better use of existing data by using <strong>cross-validation</strong>（交叉验证）</p>
<p>2、You can also use <strong>data augmentation techniques</strong> （数据扩充技术）</p>
<p>对于数据集内，可以局部扩充一个类型的数据；对于不同类型数据集的扩充应该使用不同的方法。</p>
<p>3、降低模型复杂度。特别是针对神经网络，很容易过拟合小数据集。</p>
<h2 id="专业人士的经验">专业人士的经验</h2>
<p>往往最有用的建议都来自这些人。</p>
<h2 id="文献调研">文献调研</h2>
<p><strong>It may be discouraging to find that someone has already explored your great idea</strong></p>
<p>了解以前做过什么和没有做过什么很重要，别人做过了不一定是坏事，可以优化，也可以尝试新的解决方法。</p>
<p>同时你需要写综述，梳理思路</p>
<h2 id="考虑清楚为何和如何构建机器学习模型">考虑清楚为何和如何构建机器学习模型</h2>
<p>该部分中你需要想清楚三个问题</p>
<p>1、为什么构建模型。是学术建模，还是应用研究？</p>
<p>2、对于应用研究，问题的时间复杂度和空间复杂度侧重的是哪个？</p>
<p>3、对于学术研究，模型部署到什么软件上更合适？python /R /C++ ?</p>
<h1>如何可靠地构建模型</h1>
<p>Building models is one of the more enjoyable parts of ML</p>
<p>该部分的核心是要以有组织的方式进行模型构建，充分考虑模型的优劣和、可数学化表述以及可解释性。</p>
<h2 id="训练集和数据集不可交叉">训练集和数据集不可交叉</h2>
<p>将数据交叉会导致模型分泛化能力大幅降低，这也是很多模型在现实世界中表现不理想的原因之一。需要注意两点：</p>
<p>1、训练数据之前需要拆分出一部分数据作为测试集</p>
<p>2、当数据量不足需要扩充时，需要先拆分然后扩充数据集，而且这种扩充只能发生在训练集中，测试集不要进行数据扩充</p>
<h2 id="尝试多种模型进行建模">尝试多种模型进行建模</h2>
<p>In fact, there’s a proof of this, in the form of the <strong>No Free Lunch theorem</strong>, which shows that no ML approach is any better than any other when considered over every possible problem</p>
<p>无免费午餐理论：没有通用的模型让你可以去套用。因此，需要使用不同类型的模型进行尝试。</p>
<p>唯一且有效的方法就是：全部尝试！！同时需要在<strong>验证集</strong>（validation）中进行超参数优化</p>
<p><img src="/2023/05/16/how-to-modeling/1683886399.png" alt="各种算法"></p>
<h2 id="不要使用不合适的模型和假设">不要使用不合适的模型和假设</h2>
<p>你必须充分了解模型的适用性。需要避免诸如：</p>
<p>1、将依靠期望分类的模型应用于图像分类中。</p>
<p>2、将回归模型应用于分类问题，有时候尽管回归看起来更有意义，但是问题的本质却是分类问题</p>
<p>3、混淆相关和因果。如：随着年龄的增加，增大运动量会增加罹患皮肤癌的概率。</p>
<h2 id="跟上时代"><strong>跟上时代</strong></h2>
<p>确保只是更新，并了解发展史尤其是深度学习</p>
<p>多层感知器（MLP）和递归神经网络（尤其是LSTM）越多地被卷积神经网络（CNN）和变换器(transformers)所取代。</p>
<p><strong>CNNs</strong>流行的主要动力是使用了线性矫正函数（激活函数）、Adam优化器、丢弃层（dropout layers ）、批归一化（batch normalisation ）</p>
<p>变换器（transformers）也正在逐渐取代递归神经网络，成为序列数据模型构建的首选</p>
<p><strong>但是CNNs和变换器有一个共同缺陷：参数量巨大，需要大量数据</strong></p>
<p>建议：小数据集使用迁移学习（transfer learning）</p>
<h2 id="深度学习不一定是最好的方法">深度学习不一定是最好的方法</h2>
<p>摆脱深度学习取代一切的陷阱。如<strong>树模型中，SVM优于深度学习；变换器不太适合时间序列</strong></p>
<p><strong>还要注意：如果数据有限、模型底层模式简单，或者该模型解释，应该放弃深度神经网络。深度神经网络本质生是一些列非线性函数叠加的结果，因为非线性函数即使在最少参数量的时候也很难被解释。把他们放在一起会更加难以解释。虽然有一些可解释的机器学习方法，但是他们往往是消除复杂度之后的结果，可能会导致在得出结论的时候出错误</strong></p>
<h2 id="必须要优化超参数"><strong>必须要优化超参数</strong></h2>
<p>深度神经网络的参数，一般分为两类，第一类是可以利用梯度下降法进行学习更新的网络权重，第二类是在训练前设定的训练参数，也称为超参数。 超参数会影响模型的参数和配置，如SVM和函数数量，随机森林中树的数量、神经网路架构等等。</p>
<p>不要使用babysearch来优化超参数，使用超参数优化策略可以高效的优化超参数。常见的策略有随机搜索和网格搜索。GridSearch用于替代人类专家完成参数组合的重复性劳动。 RandomSearch则是在GridSearch的基础上引入了随机性，使得搜索过程的参数组合更加多样，两者都属于暴力搜索方法。</p>
<p>此外，超参数优化算法还有贝叶斯优化（Bayesian Optimization） 和 进化算法（Evolution Search）。</p>
<p>此外还有更一步发展出的提前停止算法，目的是尽可能少的消耗时间和计算成本。目前主要有两种：前向评估算法和后向评估算法，代表算法分别为，MedianStop和Extrapolation of Learning Curves。</p>
<h2 id="特征选择需要注意时机">特征选择需要注意时机</h2>
<p>需要注意，特征选择应该是模型训练中的步骤，而不是训练前。就是说：在拆分数据集前不要进行特征选择。</p>
<p>对于降维和交叉验证同样适用</p>
<p>对于降维，需要保证训练集和测试集处于同一权重中进行。</p>
<p>对于交叉验证，迭代中需要独立进行特征和超参数选择。必要时，使用嵌套交叉验证可以使得模型有更好的稳健性。</p>
<p><img src="/2023/05/16/how-to-modeling/1684058637.png" alt></p>
<p><img src="/2023/05/16/how-to-modeling/1684058652.png" alt></p>
<h2 id="采样需要避免发生虚假相关性的信息">采样需要避免发生虚假相关性的信息</h2>
<p>样本需要处于同一状态。比如图像处理中，需要保证照片或视频在同一天气条件下拍摄和处理。</p>
<h1>如何稳定的评估模型</h1>
<h2 id="务必使用适当的测试集">务必使用适当的测试集</h2>
<p>需要保证采集设备的兼容能力，例如对于同一类型图片，尽管经过了图片压缩，600×800的数据集与800×1200数据得到的结果可能是不同的。</p>
<h2 id="在拆分数据之前不要进行数据扩充"><strong>在拆分数据之前不要进行数据扩充</strong></h2>
<p>需要注意的是，需要针对<strong>训练集</strong>进行扩充，而不是测试集。原因可能是数据可能会过拟合扩充出来的数据特征，而不是原始样本。</p>
<h2 id="一定要使用验证集">一定要使用验证集</h2>
<p>验证集：可以是扩充训练样本后分出的一部分，不参与训练只是用于指导训练。使用验证集的好处是：可以提前停止训练模型，如果在验证集的分数逐渐下降，就可以停止训练模型了。</p>
<p><img src="/2023/05/16/how-to-modeling/1684063598.png" alt></p>
<p><img src="/2023/05/16/how-to-modeling/1684063609.png" alt></p>
<h2 id="对模型进行多次评估">对模型进行多次评估</h2>
<p>许多机器学习模型很不稳定，不同的训练次数和参数微调结果相差很大，这时候就需要对模型进行多种评估。</p>
<p>进行多次评估通常需要使用不同的数据集，其中最常见的就是<strong>交叉验证</strong>。交叉验证通常使用<strong>十折交叉验证</strong>这一标准。</p>
<p>其中需要注意的是，交叉验证在时间序列中的特殊变体。还要注意的是，如果数据集某一类型数据量很少，需要对数据进行分层处理，以减少偏差。同时需要报告多次评估的平均值和标准差，以备以后使用统计测试来比较模型。</p>
<h2 id="保留测试集用来评估模型">保留测试集用来评估模型</h2>
<p>建模过程中，对于模型的潜力和模型的性能要进行区分。模型潜力值得是：模型解决问题的能力。模型性能指的是模型对特定数据集产生的效果。他们之间有很大的差异，前者更重要。</p>
<p>以交叉验证为例：交叉验证可以很好的评估模型潜力，对特定数据集评估用处不大。如果使用交叉验证所得的最高分中的参数作为模型的最终参数，会导致模型可靠性问题，因为单折中的数据量可能不具备代表性。</p>
<p><strong>如果数据量足够，最好保留一些数据进行无偏估计。</strong></p>
<h2 id="精度这一概念不要乱用">精度这一概念不要乱用</h2>
<p>分类模型中最常见的评价指标为精度。其使用范围需要引起最够的重视，如果数据分布平衡，可以使用；如果数据分布不平衡，可能失效。例如：在二分类中，如果某个类别只有总数据量的10%，假设这10%全部错误，但是另外的90%全部预测正确，其精度依然高达90%，如下：</p>
<p><img src="/2023/05/16/how-to-modeling/1684121937.png" alt></p>
<p><img src="/2023/05/16/how-to-modeling/1684121947.png" alt></p>
<p>这是应该使用：F1分数、Cohen’s kappa系数（κ）或Matthews Correlation coefficient（MCC）等指标。</p>
<h2 id="不要忽视时间序列数据中的时间依赖性"><strong>不要忽视时间序列数据中的时间依赖性</strong></h2>
<p>时间序列数据与许多其他类型的数据不同，因为数据点的顺序很重要。时间序列中需要注意的是：数据会受到一种特殊类型的数据渗入，即：**前瞻性偏差（<strong>look ahead bias</strong>）。当用于训练模型的部分或全部数据点在时间序列中出现的时间晚于用于测试模型的数据点时，<strong>前瞻性偏差</strong>（<strong>look ahead bias</strong>）就会发生。因为时间序列的关系，测试集优先于训练集出现，使得，未来未发生的数据，被用于检验。</p>
<p>另一种是：未来出现了以前未出现的情况，导致前瞻性偏差，如下：</p>
<p>数据压缩后，训练集中最高点为0.75，但是后来的最高点为1，使用测试集对前面的训练模型进行测试，则会发生偏差。</p>
<p>这时候标准的交叉验证也不起作用，需要阻塞交叉验证进行评估<strong>blocked cross-validation</strong></p>
<p><img src="/2023/05/16/how-to-modeling/1684208200.png" alt="前瞻性偏见"></p>
<h1><strong>如何公平的比较模型</strong></h1>
<p>比较模型是学术研究的基础，但要做到这一点却非常困难。</p>
<h2 id="不要认为精度高意味着模型好">不要认为精度高意味着模型好</h2>
<p>例如精度达到了94%和精度达到了97%，谁更好？答案是无法判断，如果</p>
<p>为了真正确保两种方法之间的公平比较，您应该新实施您正在比较的所有模型，将每个模型优化到相同的程度，进行多次评估。然后使用统计测试来确定性能差异是否显著。</p>
<h2 id="一定要使用统计测试来比较模型">一定要使用统计测试来比较模型</h2>
<p>对于两个机器学习模型的比较一般有两种方式：</p>
<p>第一种是比较单个模型的实例。如：<strong>McNemar`s test</strong>常用来比较分类器的分类效果，其原理是评估测试集中每个样本的分类器输出标签。</p>
<p>第二类是多重评估，用于评估更一般的模型，比如是用决策树还是神经网络等。一般的方法有<strong>交叉验证或多重采样</strong>，使用<strong>t检验</strong>（正态分布）比较结果的分布情况。或者直接使用<strong>u检验</strong>。</p>
<h2 id="校正多重比较">校正多重比较</h2>
<p>对于两个以上的模型评估时，事情会变得复杂。一般地，我们常使用95%作为置信度，但是这意味着，20次就会出现以1次假阳性，该效应就是著名的<strong>multiplicity effect</strong>在数据科学中称为<strong>data dredging 或 p-hacking</strong>。对于一次测试，这个错误率是可以忍受的，但是不要忘记，他会积累。</p>
<p>避免上述原因，最常见的方法是进行<strong>Bonferroni</strong>校正，这种矫正考虑了样本数量的权重</p>
<h2 id="不要相信数据集基准测试结果">不要相信数据集基准测试结果</h2>
<p>你无法保证有人使用了测试集作为训练集并提交结果</p>
<h2 id="考虑模型组合">考虑模型组合</h2>
<p>不同模型之间的组合也是有意义的，这种方法现在被称作<strong>集成学习（ensemble learning</strong>）。</p>
<p>集成学习通常分两类，第一类为相同模型间的组合，第二类不同模型框架间的组合。第一类有很多方法，比如<strong>装袋法和助推法（bagging and boosting）</strong>；第二类则成为<strong>堆叠（stacking or stacked generalisation）</strong></p>
<h1>如何报告结果</h1>
<p><strong>The aim of academic research is not self-aggrandisement, but rather an opportunity to contribute to knowledge.</strong></p>
<h2 id="数据透明"><strong>数据透明</strong></h2>
<p>试着对你所做的事情和你所发现的事情保持透明</p>
<p>分享你的工作也会鼓励你更加小心，把你的实验记录好，并编写干净的代码，这对你和其他人一样有益。要注意重现性问题，除非你的工作流程得到充分的记录和共享，否则你可能无法发布工作。</p>
<h2 id="以多种方式报告模型性能">以多种方式报告模型性能</h2>
<p>有以下几种方法：</p>
<p>1、使用多个数据集。</p>
<p>2、报告每个数据集的多个指标。例如，如果你使用准确率，那么还需要报告数据平衡指标。</p>
<p>同时评价错误模型时候不能仅仅只谈准确率，还需要谈精度、召回率；敏感性、特意性等指标。如你谈论F分数时，要清楚这是F1还是精度、召回率。如果报告AUC,请指出这是ROC还是PR曲线下面的面积。</p>
<h2 id="不要通过数据引申概括">不要通过数据引申概括</h2>
<p>即使模型有很好的鲁棒性，但这并不意味着通过当前数据集可以的得出所有的结论，因为凡是抽样都有误差。</p>
<h2 id="注意统计显著性">注意统计显著性</h2>
<p>注意，不显著不意味着结果不好。可以只保留p值，不讨论显著性。如果样本量足够大，总可以找出差异，即使实际差异很小。为了更好的表明时间是否重要可以测量效应大小（effect size），具体有：<strong>Cohen·d统计，Kolmogorov-Smirnov统计</strong>。也可以使用<strong>贝叶斯统计</strong></p>
<h2 id="关重模型本身"><strong>关重模型本身</strong></h2>
<p>Remember that the aim of research is not to get a slightly higher accuracy than everyone else. Rather, it’s to generate knowledge and understanding and share this with the research community.</p>
<p>模型的建立并不是追求精度，而是要了解可以从模型得到什么新的知识。对于决策树模型，可以<strong>可视化</strong>。对于深度神经网络，则需要考虑可解释AI(<strong>explainable AI</strong>)来解释模型。</p>
<h1>final</h1>
<p>Therefore, you have to approach ML in much the same way you would any other aspect of research: with an open mind, a willingness to keep up with recent developments, and the humility to accept you don’t know everything</p>
]]></content>
      <tags>
        <tag>Modeling</tag>
      </tags>
  </entry>
  <entry>
    <title>Transformer</title>
    <url>/2023/11/30/Transformer/</url>
    <content><![CDATA[<p>[TOC]</p>
<h1>[转]Transformer通俗笔记：从Word2Vec、Seq2Seq逐步理解到GPT</h1>
<h2 id="本文导读">本文导读</h2>
<p>想快速学懂任何一个模型，除了通俗易懂的资料外，最重要的一点就是理解透彻该模型的目的/目标是啥，比如本文篇幅很长、涉及的模型很多，但不论再多，都请把握住一点：它们在某种意义上都是<a href="https://so.csdn.net/so/search?q=%E9%A2%84%E8%AE%AD%E7%BB%83%E6%A8%A1%E5%9E%8B&amp;spm=1001.2101.3001.7020">预训练模型</a><br>
为何会有本文等一系列预训练模型（注意，明白这点非常重要）？原因在于</p>
<ol>
<li><strong>很多机器学习模型都需要依托带标签的数据集做训练</strong>，此话怎讲？举个例子，让机器去学习和让小孩去学习是类似的<br>
比如小孩是怎么辨别猫或狗的，无非是父母每次看到一只猫或一条狗，告诉小孩这是猫/狗，小孩不断记忆猫的特征，久而久之，小孩见到一只新猫/狗，不用父母告诉TA，也能知道是猫/狗了<br>
机器也是一样的，给1000张猫的图片告诉机器是猫，机器不断记忆猫的特征，等给它1001张不标注是猫的图片的时候，机器能立马认出来是猫，而前面这1000张猫的图片就是训练机器的过程，且通过已知样本不断校准机器的判断能力、不断迭代降低误差(误差 = 真实结果与实验结果的差距)</li>
<li>但是<strong>我们身边存在大量没有标注的数据</strong>，例如文本、图片、代码等等，标注这些数据需要花费大量的人力和时间，标注的速度远远不及数据产生的速度，所以带有标签的数据往往只占有总数据集很小的一部分</li>
<li>而如果手头任务的训练集数据量较少的话，那现阶段的好用的CNN比如Resnet/Densenet/Inception等网络结构层数很深(几百万上千万甚至上亿的参数量)，当训练数据少则很难很好地训练这么复杂的网络，但如果<br>
<img src="https://latex.csdn.net/eq?%5Crightarrow" alt="\rightarrow"> 先把好用的这些大模型的大量参数通过大的训练集合比如『ImageNet』<strong>预训练</strong>好(大规模图像数据集ImageNet有超过1000万的图像和1000类物体的标注)，即直接用ImageNet初始化大模型的大部分参数<br>
<img src="https://latex.csdn.net/eq?%5Crightarrow" alt="\rightarrow"> 接下来再通过手头上少的可怜的数据去Fine-tuning(即<strong>微调</strong>参数)，以更适合解决当前的任务，那事情就顺理成章了</li>
</ol>
<h2 id="第一部分-理解基本概念：从nnlm到word2vec">第一部分 理解基本概念：从NNLM到Word2Vec</h2>
<p>我博客内之前写过一篇word2vec笔记，如今再看 写的并不通俗易懂，巧的是，写本文开头那篇图解transformer文章的作者，他也有写一篇<a href="https://jalammar.github.io/illustrated-word2vec/">图解word2vec</a>，本部分中的核心阐述和大部分配图均来自此文。</p>
<p>为了让每一个初学者可以从头看到尾，不至于因行文过程中的任何一句话而卡壳看不下去，我在原英文的基础上，加了大量自己的学习心得、说明解释(得益于看过很多文学和哲学书，且学过算法，所以文笔尚可、逻辑尚可)。</p>
<h3 id="从向量表示到词嵌入">从向量表示到词嵌入</h3>
<p>不知你可曾听说过华为对于求职人员的性格测试？ 这个测试会问你一系列的问题，然后在很多维度给你打分，内向/外向就是其中之一，然后用0到100的范围来表示你是多么内向/外向（其中0是最内向的，100是最外向的）</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/c757183fe507acde590ad1e7d1d73b61.png" alt="img"></p>
<p>假设一个叫Jay的人，其内向/外向得分为38/100，则可以用下图表示这个得分：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/477df3becf6872bf2ff1d040839b75e7.png" alt="img"></p>
<p>为了更好的表达数据，我们把范围收缩到-1到1：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/cd4d8c6626380ae119976c75726e7357.png" alt="img"></p>
<p>考虑到人性复杂，对于一个人的描述只有一条信息显然是不够的，为此，我们添加另一测试的得分作为一个新的第二维度，而这两个维度均可以表现为图上的一个点（或称为从原点到该点的向量)</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/c2f2e3bbbbd2bfb024f60d94d7252046.png" alt="img"></p>
<p>然后可以说这个向量部分地代表了Jay的人格。当你想要将另外两个人与Jay进行比较时，这种表示法就有用了。假设Jay是一家公司的CEO，某天被公共汽车给撞住院了，住院期间需要一个与Jay性格相似的人代行Jay的CEO之责。那在下图中，这两个人中哪一个更像Jay呢，更适合做代理CEO呢？</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/2cce32e676a02e898395a940b7f62af5.png" alt="img"></p>
<p>而<strong>计算两个向量之间相似度得分的常用方法是余弦相似度</strong>，可曾还记得夹角余弦的计算公式？</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWctbXkuY3Nkbi5uZXQvdXBsb2Fkcy8yMDEyMTEvMjEvMTM1MzUwMzU5OF85ODU4LnBuZw?x-oss-process=image/format,png" alt="img"></p>
<p>通过该计算公式可得</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/0af46ee5f1d80f7899e09bc50bdf9d55.png" alt="img"></p>
<p>从而可知，person 1在性格上与Jay更相似。其实，从坐标系里也可以看出，person1的向量指向与Jay的向量指向更相近，即他俩具有更高的余弦相似度。</p>
<p>更进一步，两个维度还不足以捕获有关不同人群的足够信息。可曾听说国内有七重人格，而国外心理学也研究出了五个主要人格特征（以及大量的子特征）。</p>
<p>为从简起见，就不用七个维度了，而用五个维度再度比较Jay与person1 2的相似性：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/fa3b06a67625a681ba4e127a3be10cc0.png" alt="img"></p>
<p>当使用五个维度时，我们没法在二维平面绘制向量小箭头了(毕竟你我都不曾见过五维坐标系)。而实际生活中，我们经常要在更高维度的空间中做研究(有的人把研究一词表达成思考，实际上，大部分人没法在高维度空间思考，但科学研究人员经常干这事，故表达成研究更准确)，好在余弦相似度仍然有效，它适用于任意维度：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/2acce61223fd0d086b8d489b18200e54.png" alt="img"></p>
<p>这些得分比上次的得分看起来更准确(对，目前为止，咱只能说看起来更准确，最近学哲学给我最大的感悟是，凡事客观，不要轻易绝对化)，毕竟它们是根据被比较事物的更高维度算出的。</p>
<p>小结一下，有两点</p>
<p>1.我们可以将人和事物表示为代数向量</p>
<p>2.我们可以很容易地计算出相似向量之间的相互关系。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/2526a376e956527a86a57e7f99ae0c9a.png" alt="img"></p>
<hr>
<p>行文至此，可能有同学要问了，为何要把词向量化表示呢，其背后的深意在哪？</p>
<p>众所周知，咱们居住在各个国家的人们通过各自的语言进行交流，但机器无法直接理解人类的语言，所以需要先把人类的语言“计算机化”，那如何变成计算机可以理解的语言呢？</p>
<p><img src="https://img-blog.csdnimg.cn/17536a831d5648bda7ff58766358df0f.png" alt="img"></p>
<p>对于这个问题，我们考虑一个很简单的问题，比如对于计算机，它是如何判断一个词的词性，是动词还是名词的呢？</p>
<p>假定我们有一系列样本(x,y)，其中的 x 是词语，y 是它们的词性，我们要构建<img src="https://latex.csdn.net/eq?f%28x%29%20%5Cto%20y" alt="f(x) \to y">的映射：</p>
<ol>
<li>
<p>首先，这个数学模型 f（比如神经网络、SVM）只接受数值型输入；</p>
</li>
<li>
<p>而 NLP 里的词语是人类语言的抽象总结，是符号形式的（比如中文、英文、拉丁文等等）；</p>
</li>
<li>
<p>如此一来，咱们便需要把NLP里的词语转换成数值形式，或者嵌入到一个数学空间里；</p>
</li>
<li>
<p>进一步，可以把文本分散嵌入到另一个离散空间，称作分布式表示，又称为词嵌入（word embedding）或词向量</p>
</li>
<li>
<p>在各种词向量中，有一个简单的词向量是one-hot encoder。所谓one-hot编码，本质上是用一个只含一个 1、其他都是 0 的向量来唯一表示词语</p>
<p>当然，不是所有的编码都是01编码，且one-hot编码无法反应词与词之间的语义相似度</p>
<p><img src="https://img-blog.csdnimg.cn/8a4e1b7b1ee94c9fafb418cb65f0aa9e.png" alt="img"></p>
</li>
</ol>
<p>这就是所谓的词嵌入了，而<strong>一个单词表达成Word Embedding后，便很容易找出语义相近的其它词汇</strong></p>
<p>再举一个例子，这是一个单词“king”的词嵌入（在维基百科上训练的GloVe向量）：</p>
<p>[ 0.50451 , 0.68607 , -0.59517 , -0.022801, 0.60046 , -0.13498 , -0.08813 , 0.47377 , -0.61798 , -0.31012 , -0.076666, 1.493 , -0.034189, -0.98173 , 0.68229 , 0.81722 , -0.51874 , -0.31503 , -0.55809 , 0.66421 , 0.1961 , -0.13495 , -0.11476 , -0.30344 , 0.41177 , -2.223 , -1.0756 , -1.0783 , -0.34354 , 0.33505 , 1.9927 , -0.04234 , -0.64319 , 0.71125 , 0.49159 , 0.16754 , 0.34344 , -0.25663 , -0.8523 , 0.1661 , 0.40102 , 1.1685 , -1.0137 , -0.21585 , -0.15155 , 0.78321 , -0.91241 , -1.6106 , -0.64426 , -0.51042 ]</p>
<p>这是一个包含50个数字的列表。通过观察数值我们看不出什么，但是让我们稍微给它可视化，以便比较其它词向量。故我们把所有这些数字放在一行：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/30bfc0d6863fb24ae629fe8deb16b10a.png" alt="img"></p>
<p>让我们根据它们的值对单元格进行颜色编码（如果它们接近2则为红色，接近0则为白色，接近-2则为蓝色）：</p>
<p>我们将忽略数字并仅查看颜色以指示单元格的值。现在让我们将“king”与其它单词进行比较（注意，世间有相似之人，也有相似之词）：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/0d9a5a90d7aae9d3d4c1c827a6b7e968.png" alt="img"></p>
<p>你会发现“Man”这个词和“Woman”相比，比与“King”相比更相似，而这些向量图示很好的展现了这些单词的含义与关联</p>
<p>这是另一个示例列表：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/b7ab108e1e948a7a5e9d771f2e366d6c.png" alt="img"></p>
<p>通过垂直扫描列来查找具有相似颜色的列，相信你可以看到以下这几点</p>
<ol>
<li>“woman”和“girl”在很多地方是相似的，“man”和“boy”也是一样</li>
<li>当然，“boy”和“girl”也有彼此相似的地方，但这些地方却与“woman”或“man”不同，为何呢，毕竟boy/girl特指青春年少，而woman/man更多指成人</li>
<li>此外，“king”和“queen”彼此之间相似，毕竟都是所谓的王室成员</li>
</ol>
<h3 id="从n-gram模型-nnlm到-word2vec">从N-gram模型、<strong>NNLM</strong>到**Word2Vec</h3>
<h4 id="什么是n-gram模型与神经网络语言模型nnlm">什么是N-gram模型与神经网络语言模型NNLM</h4>
<p>我们每天都会用手机或者电脑，比如我们经常会用到智能手机输入法中的下一单词预测功能，或者你在电脑上用Google搜索也会遇到类似的搜索智能提示（详见<a href="https://blog.csdn.net/v_JULY_v/article/details/11288807">此文</a>）。</p>
<p>比如当你输入thou shalt时，系统会预测/提示你想输入的下一个单词是不是not？</p>
<p><img src="https://img-blog.csdnimg.cn/7a893095d9654a9fa65ca7e5fafb2bbd.png" alt="img"></p>
<p>系统是根据什么来预测/提示下一个单词的呢？它的依据有两点</p>
<ol>
<li>
<p>在上面这个手机截屏中，该模型已经接收到了两个绿色单词(thou shalt)后</p>
</li>
<li>
<p>为此推荐一组单词且要计算比如“not” 是其中最有可能被选用的一个</p>
<p>说白了，就是要让预测的单词连成整个句子后最像一句人话，所以便得计算加上某个预测单词成为整个句子的概率</p>
<p>而计算句子概率的概率模型很多，n-gram模型便是其中的一种，什么是n-gram呢</p>
<p>假设一个长度为m的句子，包含这些词：<img src="https://latex.csdn.net/eq?%28w_1%2Cw_2%2Cw_3%2C..%2Cw_m%29" alt="(w_1,w_2,w_3,..,w_m)">，那么这个句子的概率（也就是这m个词共同出现的概率）是：<img src="https://latex.csdn.net/eq?P%5Cleft%20%28%20sen%20%3D%20%28w_1%2Cw_2%2C%5Ccdots%20%2Cw_m%29%20%5Cright%20%29%20%3D%20P%28w_1%29P%28w_2%7Cw_1%29P%28w_3%7Cw_2%2Cw_1%29%5Ccdots%20P%28w_m%7Cw_%7Bm-1%7D%5Ccdots%20w_1%29" alt="P\left ( sen = (w_1,w_2,\cdots ,w_m) \right ) = P(w_1)P(w_2|w_1)P(w_3|w_2,w_1)\cdots P(w_m|w_{m-1}\cdots w_1)"></p>
<p>一般来说，语言模型都是为了使得条件概率<img src="https://latex.csdn.net/eq?P%28w_t%7Cw_1%2Cw_2%2C..%2Cw_%7Bt-1%7D%29" alt="P(w_t|w_1,w_2,..,w_{t-1})">最大化，不过考虑到近因效应，当前词只与距离它比较近的<img src="https://latex.csdn.net/eq?n" alt="n">个词更加相关(一般<img src="https://latex.csdn.net/eq?n" alt="n">不超过5，所以局限性很大)</p>
</li>
</ol>
<p><img src="https://img-blog.csdnimg.cn/img_convert/c662ea4c1137ac8be4b1eaa11c6e3f06.png" alt="img"></p>
<p>那神经网络语言模型(Neural Network Language Model，简称NNLM)的思路呢？</p>
<blockquote>
<p>NNLM的核心是一个多层感知机（Multi-Layer Perceptron，简称MLP），它将词向量序列映射到一个固定长度的向量表示，然后将这个向量输入到一个softmax层中，计算出下一个词的概率分布</p>
</blockquote>
<p>举例来说，我们可以把这个模型想象为这个黑盒：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/d369d818c140892e9b6bca1eeab4ee39.png" alt="img"></p>
<p>当然，该模型不会只推荐一个单词。实际上，它对所有它知道的单词(模型的词库，可能有几千到几百万个单词)均按可能性打分，最终输入法程序选出其中分数最高的推荐给用户，比如not</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/f5c9bff7f0a59caa72a96d5c8eb80b20.png" alt="img"></p>
<p>模型的输出就是模型所知单词的概率评分，比如40%或者0.4，最终在完成训练后按下图中所示的三个步骤完成预测(请参考Bengio 2003)：</p>
<ol>
<li>第一步就是Look up Embedding，由于<strong>模型在经过另外一个训练</strong>之后可以生成一个映射单词表所有单词的矩阵，也称词嵌入矩阵，从而在进行预测的时候，我们的算法可以在这个映射矩阵(词嵌入矩阵)中查询输入的单词(即Look up embeddings)</li>
<li>第二步则是计算出预测值</li>
<li>第三步则输出结果</li>
</ol>
<p>接下来，我们重点看下上面所说的「模型在经过另外一个训练」到底说的啥意思，即探讨如何构建这个映射矩阵(词嵌入矩阵)</p>
<h4 id="语言模型训练：-如何构建映射矩阵-词嵌入矩阵">语言模型训练：**如何构建映射矩阵(词嵌入矩阵)</h4>
<p>我们通过找常出现在每个单词附近的词，就能获得它们的映射关系。机制如下：</p>
<ol>
<li>先是获取大量文本数据(例如所有维基百科内容)</li>
<li>然后我们建立一个可以沿文本滑动的窗(例如一个窗里包含三个单词)</li>
<li>利用这样的滑动窗就能为训练模型生成大量样本数据</li>
</ol>
<p>当这个窗口沿着文本滑动时，我们就能(真实地)<strong>生成一套用于模型训练的数据集</strong>。</p>
<p>不用多久，我们就能得到一个较大的数据集，从数据集中我们能看到在不同的单词组后面会出现的单词：</p>
<p>在实际应用中，模型往往在我们滑动窗口时就被训练的，而怎么训练模型呢？</p>
<p>举个例子，请你根据下面这句话前面的信息进行填空：</p>
<p>在空白前面，我提供的背景是五个单词(如果事先提及到‘bus’)，可以肯定，大多数人都会把bus填入空白中。但是如果我再给你一条信息——比如空白后的一个单词，那答案会有变吗？</p>
<p>这下空白处改填的内容完全变了。这时’red’这个词最有可能适合这个位置的词之一。</p>
<p>从上面那个例子可以看到，一个单词的前后词语其实都带着有价值的信息，而且要尽可能考虑两个方向的单词(目标单词的左侧单词与右侧单词)。</p>
<h4 id="word2vec的两种架构：从cbow到skipgram模型">Word2Vec的两种架构：从<strong>CBOW到</strong>Skipgram模型**</h4>
<p>更进一步，为了更好的预测，其实不仅要考虑目标单词的前两个单词，还要考虑其后两个单词。以上下文词汇预测当前词』架构被称为连续词袋(CBOW)，简单引用下<a href="https://blog.csdn.net/v_JULY_v/article/details/102708459">此文</a>的内容做个简单概括（详见原文或参考文献16）：</p>
<blockquote>
<p>CBOW包括以下三层：</p>
<ul>
<li>
<p>输入层：包含<img src="https://latex.csdn.net/eq?context%28w%29" alt="context(w)">中<img src="https://latex.csdn.net/eq?2c" alt="2c">个词的词向量<img src="https://latex.csdn.net/eq?v%5Cleft%28%5Coperatorname%7BContext%7D%5Cleft%28w_%7B1%7D%5Cright%29%5Cright%29%2C%20v%28%5Coperatorname%7BContext%7D%28w%202%29%29%2C%20v%28%5Coperatorname%7BContext%7D%28w%202%20c%29%29%20%5Cepsilon%20R%5E%7Bm%7D" alt="v\left(\operatorname{Context}\left(w_{1}\right)\right), v(\operatorname{Context}(w 2)), v(\operatorname{Context}(w 2 c)) \epsilon R^{m}">，其中，<img src="https://latex.csdn.net/eq?v" alt="v">表示单词的向量化表示函数，相当于此函数把一个个单词转化成了对应的向量化表示(类似one-hot编码似的)，<img src="https://latex.csdn.net/eq?2c" alt="2c">表示上下文取的总词数，<img src="https://latex.csdn.net/eq?m" alt="m">表示向量的维度；</p>
</li>
<li>
<p>投影层：将输入层的<img src="https://latex.csdn.net/eq?2c" alt="2c">个向量做累加求和；</p>
</li>
<li>
<p>输出层：按理我们要通过确定的上下文决定一个我们想要的中心词</p>
<p>，但怎么决定想要的中心词具体是</p>
<p>中的哪个呢？</p>
<p>通过计算各个可能中心词的概率大小，取概率最大的词便是我们想要的中心词</p>
<p>，相当于是针对一个N维数组进行多分类，但计算复杂度太大，所以输出层改造成了一棵Huffman树，以语料中出现过的词当叶子结点，然后各个词出现的频率大小做权重</p>
<p><img src="https://img-blog.csdnimg.cn/eae3314083b542f9aa704536484120ab.png" alt="img"></p>
</li>
</ul>
</blockquote>
<p>还有另一种架构，刚好反过来，根据当前词推测当前单词可能的前后单词，这种架构就是所谓的Skipgram架构</p>
<p><img src="https://img-blog.csdnimg.cn/20191023230922448.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3ZfSlVMWV92,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>顺带提一句，关于什么是负采样，可以参见网上相关资料，比如参考文献1。</p>
<h3 id="word2vec训练流程：不断缩小-error-target-sigmoid-scores">** Word2vec训练流程：不断缩小**error(target - sigmoid_scores)</h3>
<p>在训练过程开始之前，我们预先处理我们正在训练模型的文本</p>
<p>具体做法是先创建两个矩阵：词嵌入Embedding矩阵(<em>注意：这个 Embedding矩阵其实就是网络Onehot层到Embedding层映射的网络参数矩阵，所以使用Word Embedding等价于把Onehot层到Embedding层的网络用预训练好的参数矩阵初始化了</em>)、上下文Context矩阵，这两个矩阵在我们的词汇表中嵌入了每个单词，且两个矩阵都有这两个维度</p>
<ol>
<li>
<p>第一个维度，词典大小即vocab_size，比如可能10000，代表一万个词</p>
</li>
<li>
<p>第二个维度，每个词其嵌入的长度即embedding_size，比如300是一个常见值（当然，我们在前文也看过50的例子，比如上文1.1节中最后关于单词“king”的词嵌入长度）</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/c4d818d40f353c792ab0f19e626ad88e.png" alt="img"></p>
</li>
</ol>
<p>训练的过程还是这个标准套路/方法，比如</p>
<ol>
<li>
<p>第一步，先用随机值初始化这些矩阵。在每个训练步骤中，我们采取一个相邻的例子及其相关的非相邻例子</p>
<p>具体而言，针对这个例子：“Thou shalt not make a machine in the likeness of a human mind”，我们来看看我们的第一组（对于not 的前后各两个邻居单词分别是：Thou shalt 、make a）：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/53bf9c9d6f04d7d6e8abc60795baab3b.png" alt="img"></p>
<p>现在有四个单词：输入单词not，和上下文单词：<strong>thou（实际邻居词）</strong>，aaron和taco（负面例子）<br>
我们继续查找它们的嵌入<br>
对于输入词not，我们查看Embedding矩阵<br>
对于上下文单词，我们查看Context矩阵</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/74368756e892a696fbad9171bc37f5c9.png" alt="img"></p>
</li>
<li>
<p>第二步，计算输入嵌入与每个上下文嵌入的点积</p>
<p>还记得点积的定义否<br>
两个向量a = [a1, a2,…, an]和b = [b1, b2,…, bn]的点积定义为：<img src="https://latex.csdn.net/eq?a%5Ccdot%20b%20%3D%20a_%7B1%7Db_%7B1%7D%20+%20a_%7B2%7Db_%7B2%7D%20+%20%5Ccdots%20+%20a_%7Bn%7Db_%7Bn%7D" alt="a\cdot b = a_{1}b_{1} + a_{2}b_{2} + \cdots + a_{n}b_{n}"></p>
<p>而这个<strong>点积的结果意味着</strong>『<strong>输入</strong>』<strong>和</strong>『<strong>上下文各个嵌入</strong>』<strong>的各自相似性程度，结果越大代表越相似</strong>。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/e68a76a5b17995b45d6efdea27f29c51.png" alt="img"></p>
<p>为了将这些分数转化为看起来像概率的东西——比如正值且处于0到1之间，可以通过sigmoid这一逻辑函数转换下。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/31bfa57cc9c715958a059beb99a24887.png" alt="img"></p>
<p>可以看到taco得分最高，aaron最低，无论是sigmoid操作之前还是之后。</p>
</li>
<li>
<p>第三步，既然未经训练的模型已做出预测，而且我们拥有真实目标标签来作对比，接下来便可以计算模型预测中的误差了，即让目标标签值减去sigmoid分数，得到所谓的损失函数</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/2a73281367bf7e0ef3782e14c719f488.png" alt="img"></p>
<p><strong>error = target - sigmoid_scores</strong></p>
</li>
<li>
<p>第四步，我们可以利用这个错误分数来调整not、thou、aaron和taco的嵌入，使下一次做出这一计算时，结果会更接近目标分数</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/dadb2abaf3a8cfb78fab6d4ad04d1b6f.png" alt="img"></p>
<p>训练步骤到此结束，我们从中得到了这一步所使用词语更好一些的嵌入（not，thou，aaron和taco）</p>
</li>
<li>
<p>第五步，针对下一个相邻样本及其相关的非相邻样本再次执行相同的过程</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/3e46433783c7ebfad45bc9898c723515.png" alt="img"></p>
<p>当我们循环遍历整个数据集多次时，嵌入会继续得到改进。然后我们就可以停止训练过程，丢弃Context矩阵，并使用Embeddings矩阵作为下一项任务的已被训练好的嵌入</p>
</li>
</ol>
<h2 id="第二部分-从seq2seq到seq2seq-with-attention">第二部分 从Seq2Seq到Seq2Seq with Attention</h2>
<h3 id="从seq2seq序列到encoder-decoder模型">从Seq2Seq序列到Encoder-Decoder模型</h3>
<h4 id="什么是seq2seq：输入一个序列-输出一个序列">什么是Seq2Seq：输入一个序列 输出一个序列</h4>
<p>Seq2Seq（Sequence-to-sequence）正如字面意思：输入一个序列，输出另一个序列，当然，其中输入序列和输出序列的长度是可变的。</p>
<p>比如我们翻译英国经验派哲学家弗兰西斯・培根的一句名言“知识就是力量”，如下图：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/7de837145a4b5f801bc7dbd3f79ed858.gif" alt="img"></p>
<p>简言之，只要满足「输入序列、输出序列」的目的，都可以统称为 Seq2Seq序列。</p>
<h4 id="什么是encoder-decoder模型：rnn-lstm与gru">什么是Encoder-Decoder模型：RNN/LSTM与GRU</h4>
<p>针对Seq2Seq序列问题，比如翻译一句话，可以通过Encoder-Decoder模型来解决。</p>
<p>从上文我们已经接触到编码的概念，有编码则自然有解码，而这种编码、解码的框架可以称之为Encoder-Decoder，中间一个向量C传递信息，且C的长度是固定的。</p>
<p>本节配图大半来源于参考文献2。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/ab77150713e2ba2c019e37f7acf70ca0.png" alt="img"></p>
<p>没太明白？可以这么理解，在上图中，我们可以根据不同的任务可以选择不同的编码器和解码器，具体化可以是一个RNN。</p>
<p>在参考文献3里《<a href="https://blog.csdn.net/v_JULY_v/article/details/89894058">如何从RNN起步，一步一步通俗理解LSTM</a>》，我们已经详细了解了RNN和LSTM，如果忘了，一定要复习下（这是继续理解下文的重中之重）</p>
<blockquote>
<p>为了建模序列问题，RNN引入了隐状态h（hidden state）的概念，<strong>隐状态h可以对序列形的数据提取特征，接着再转换为输出</strong>。</p>
<p>在学习RNN之前，首先要了解一下最基本的单层网络，它的结构如下图所示：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/50aebf29216b34ee48f4432404748ea0.png" alt="img"></p>
<p>输入是x，经过变换<img src="https://latex.csdn.net/eq?Wx+b" alt="Wx+b">和激活函数f，得到输出y。相信大家对这个已经非常熟悉了。</p>
<p>在实际应用中，我们还会遇到很多序列形的数据：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/de565ecf43e0bda278ce99eebd875322.png" alt="img"></p>
<p>如：</p>
<ol>
<li>自然语言处理问题。x1可以看做是第一个单词，x2可以看做是第二个单词，依次类推</li>
<li>语音处理。此时，x1、x2、x3……是每帧的声音信号</li>
<li>时间序列问题。例如每天的股票价格等等</li>
</ol>
<p>而其中，序列形的数据就不太好用原始的神经网络处理了。</p>
<p>为了建模序列问题，RNN引入了隐状态h（hidden state）的概念，<strong>隐状态h可以对序列形的数据提取特征，接着再转换为输出</strong>。</p>
<p>先从<img src="https://latex.csdn.net/eq?h_%7B1%7D" alt="h_{1}">计算开始看：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/f22cb1de22144ad6806b83acb3fb45a4.png" alt="img"></p>
<p>RNN可以被看做是上述同一神经网络的多次复制，每个神经网络模块会把消息传递给下一个：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/eb598be0682804c2e3896176d00243b6.webp?x-oss-process=image/format,png" alt="img"></p>
<p>当然，更多通常是其变种LSTM或者GRU</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/7df8e797439589e7305d3bb1d5e39be5.webp?x-oss-process=image/format,png" alt="img"></p>
</blockquote>
<p>这样你就明白了吧，而只要是符合类似的框架，都可以统称为 Encoder-Decoder 模型。</p>
<h3 id="从seq2seq到seq2seq-with-attention">从Seq2Seq到Seq2Seq with Attention</h3>
<h4 id="attention应运而生：解决信息过长时信息丢失的问题">Attention应运而生：解决信息过长时信息丢失的问题</h4>
<p>上文提到：Encoder（编码器）和 Decoder（解码器）之间只有一个「向量C」来传递信息，且C的长度固定。</p>
<p>比如翻译一段语句，翻译的句子短还好，句子一长呢？当输入句子比较长时，<strong>所有语义完全转换为一个中间语义向量C来表示</strong>，单词原始的信息已经消失，可想而知会丢失很多细节信息。</p>
<p>所以Encoder-Decoder是有缺陷的，其缺陷在于：当输入信息太长时，会丢失掉一些信息。</p>
<p>而为了解决「信息过长，信息丢失」的问题，Attention 机制就应运而生了。</p>
<p>Attention 模型的特点是 Eecoder 不再将整个输入序列编码为固定长度的「中间向量Ｃ」，而是编码成一个向量的序列(包含多个向量)。引入了Attention的Encoder-Decoder 模型如下图：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/2b00497744edfb93461dcbae45e2a75b.png" alt="img"></p>
<ul>
<li>从输出的角度讲<br>
每个输出的词Y会受到每个输入<img src="https://latex.csdn.net/eq?X_%7B1%7D" alt="X_{1}">、<img src="https://latex.csdn.net/eq?X_%7B2%7D" alt="X_{2}">、<img src="https://latex.csdn.net/eq?X_%7B3%7D" alt="X_{3}">、<img src="https://latex.csdn.net/eq?X_%7B4%7D" alt="X_{4}">的整体影响，不是只受某一个词的影响，毕竟整个输入语句是整体而连贯的，但同时每个输入词对每个输出的影响又是不一样的，即每个输出Y受输入<img src="https://latex.csdn.net/eq?X_%7B1%7D" alt="X_{1}">、<img src="https://latex.csdn.net/eq?X_%7B2%7D" alt="X_{2}">、<img src="https://latex.csdn.net/eq?X_%7B3%7D" alt="X_{3}">、<img src="https://latex.csdn.net/eq?X_%7B4%7D" alt="X_{4}">的影响权重不一样，而这个权重便是由Attention计算，也就是所谓的注意力分配系数，计算每一项输入对输出权重的影响大小</li>
<li>从编码的角度讲<br>
在根据给到的信息进行编码时（或称特征提取），不同信息的重要程度是不一样的（可用权重表示），即有些信息是无关紧要的，比如一些语气助词之类的，所以这个时候在编码时，就可以有的放矢，根据不同的重要程度针对性汲取相关信息</li>
</ul>
<h4 id="通过翻译tom-chase-jerry揭示attention的算法流程">通过翻译Tom chase Jerry揭示Attention的算法流程</h4>
<p>再举一个机器翻译的例子（本猫追老鼠例子的配图和核心阐述均来源于参考文献4），即用Google翻译这句话：Tom chase Jerry</p>
<ol>
<li>
<p>在翻译“杰瑞”的时候，带有注意力机制的模型会体现出英文单词对于翻译当前中文单词不同的影响程度，比如给出类似这样一个概率分布值：（Tom,0.3）(Chase,0.2) (Jerry,0.5)，每个英文单词的概率代表了翻译当前单词“杰瑞”时，注意力分配模型分配给不同英文单词的注意力大小（类似我司七月在线开董事会，虽然每个人都有发言权，但对不同议题进行决策时，很明显对具体议题更擅长的人拥有更大的发言权，而这个发言权就像权重一样，不同的人对最终决策结果的产生有着不同大小的影响）</p>
</li>
<li>
<p>目标句子中的每个单词都应该学会其对应的源语句子中单词的注意力分配概率信息。这意味着在生成每个单词<img src="https://latex.csdn.net/eq?y_%7Bi%7D" alt="y_{i}">的时候，原先都是相同的中间语义表示C会被替换成根据当前生成单词而不断变化的<img src="https://latex.csdn.net/eq?C_%7Bi%7D" alt="C_{i}">（注：这里就是Attention模型的关键，即由固定的中间语义表示C换成了根据当前输出单词来调整成加入注意力模型的变化的<img src="https://latex.csdn.net/eq?C_%7Bi%7D" alt="C_{i}">）。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/78df8537c4b8e681e472668a776f4260.png" alt="img"></p>
</li>
<li>
<p>生成目标句子单词的过程成了下面的形式：</p>
</li>
</ol>
<p><img src="https://img-blog.csdnimg.cn/img_convert/9f07d90b3a5e0d7c42f3f0b4aace80fd.png" alt="img"></p>
<p>而每个<img src="https://latex.csdn.net/eq?C_%7Bi%7D" alt="C_{i}">可能对应着不同的源语句子单词的注意力分配概率分布，比如对于上面的英汉翻译来说，其对应的信息可能如下：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/906501ef6328bf7f3ecc0f02cc57305d.png" alt="img"></p>
<p>其中，<img src="https://latex.csdn.net/eq?f_%7B2%7D" alt="f_{2}">函数代表Encoder对输入英文单词的某种变换函数，比如如果Encoder是用的RNN模型的话，这个<img src="https://latex.csdn.net/eq?f_%7B2%7D" alt="f_{2}">函数的结果往往是某个时刻输入<img src="https://latex.csdn.net/eq?x_%7Bi%7D" alt="x_{i}">后隐层节点的状态值；g代表Encoder根据单词的中间表示合成整个句子中间语义表示的变换函数，一般的做法中，g函数就是对构成元素加权求和，即下列公式：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/c6a6cb296455b36bf3416d3e91a6e3c9.png" alt="img"></p>
<p>其中，<img src="https://latex.csdn.net/eq?L_%7Bx%7D" alt="L_{x}">代表输入句子Source的长度，<img src="https://latex.csdn.net/eq?a_%7Bij%7D" alt="a_{ij}">代表在Target输出第i个单词时Source输入句子中第j个单词的注意力分配系数，而<img src="https://latex.csdn.net/eq?h_%7Bj%7D" alt="h_{j}">则是Source输入句子中第j个单词的语义编码。</p>
<ol start="4">
<li>
<p>假设<img src="https://latex.csdn.net/eq?C_%7Bi%7D" alt="C_{i}">下标i就是上面例子所说的“ 汤姆” ，那么<img src="https://latex.csdn.net/eq?L_%7Bx%7D" alt="L_{x}">就是3，h1=f(“Tom”)、h2=f(“Chase”)、h3=f(“Jerry”)分别是输入句子每个单词的语义编码，对应的注意力模型权值则分别是0.6,0.2,0.2，所以g函数本质上就是个加权求和函数。如果形象表示的话，翻译中文单词“汤姆”的时候，数学公式对应的中间语义表示<img src="https://latex.csdn.net/eq?C_%7Bi%7D" alt="C_{i}">的形成过程类似下图。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/3b516347112f14b5c0fde5aa215ba193.png" alt="img"></p>
</li>
</ol>
<p>这里有一个问题：生成目标句子某个单词，比如“汤姆”的时候，如何知道Attention模型所需要的输入句子单词注意力分配概率分布值呢？就是说“汤姆”对应的输入句子Source中各个单词的概率分布：(Tom,0.6) (Chase,0.2) (Jerry,0.2) 是如何得到的呢？为做说明，特引用参考文献4对应的内容，如下</p>
<blockquote>
<p>为了便于说明，我们假设对非Attention模型的Encoder-Decoder框架进行细化，Encoder采用RNN模型，Decoder也采用RNN模型，这是比较常见的一种模型配置</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/309f5158c52f4362ccd9b93a673093da.png" alt="img"></p>
<p>那么用下图便可以较为便捷地说明注意力分配概率分布值的通用计算过程。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/1d91a686c492378519bff3a12d384db5.png" alt="img"></p>
<p>对于采用RNN的Decoder来说</p>
<ol>
<li>在时刻i，如果要生成<img src="https://latex.csdn.net/eq?y_%7Bi%7D" alt="y_{i}">单词，我们是可以知道Target在生成<img src="https://latex.csdn.net/eq?y_%7Bi%7D" alt="y_{i}">之前的时刻i-1时，隐层节点在i-1时刻的输出值<img src="https://latex.csdn.net/eq?H_%7Bi-1%7D" alt="H_{i-1}">的（这是RNN结构的特性，如果忘了RNN结构特性请回顾参考文献3）</li>
<li>而我们的目的是要计算生成<img src="https://latex.csdn.net/eq?y_%7Bi%7D" alt="y_{i}">时输入句子中的单词“Tom”、“Chase”、“Jerry”对<img src="https://latex.csdn.net/eq?y_%7Bi%7D" alt="y_{i}">来说的注意力分配概率分布，那么可以用Target输出句子i-1时刻的隐层节点状态<img src="https://latex.csdn.net/eq?H_%7Bi-1%7D" alt="H_{i-1}">去一一和输入句子Source中每个单词对应的RNN隐层节点状态<img src="https://latex.csdn.net/eq?h_%7Bj%7D" alt="h_{j}">进行对比，即通过函数<img src="https://latex.csdn.net/eq?F%28h_%7Bj%7D%2CH_%7Bi-1%7D%29" alt="F(h_{j},H_{i-1})">来获得目标单词<img src="https://latex.csdn.net/eq?y_%7Bi%7D" alt="y_{i}">和每个输入单词对应的对齐可能性，<strong>这个F函数在不同论文里可能会采取不同的方法</strong>，然后函数F的输出经过Softmax进行归一化就得到了符合概率分布取值区间的注意力分配概率分布数值</li>
</ol>
</blockquote>
<p>对上面这段，还是有必要再好好解释一下</p>
<ul>
<li>
<p>如我司杜助教所言：“ 这里举的例子是由 Tom chase Jerrry 得到 汤姆追逐杰瑞，现在我们假设要预测杰瑞（已经预测出来汤姆追逐），那么这个时候，i 就表示的是杰瑞这个时刻，i-1时刻的hidden就包含了<strong>汤姆追逐</strong>的信息，就是想计算i-1时刻的hidden和Tom、chase、Jerry的各自不同的Attention数值，进而更好地预测杰瑞这个词 ”</p>
</li>
<li>
<p>至于注意力分配概率的分布数值，有多种不同的计算方法，具体参见此文：</p>
<p>Attention? Attention!</p>
<p>，或者参看参考文献14（33min至37min，以及50min都有讲）</p>
<p><img src="https://img-blog.csdnimg.cn/445cf49afb604fe68a75cdf085cfc2f1.png" alt="img"></p>
</li>
</ul>
<p>考虑到后来有读者qqw0829反馈对于本节的这个翻译“Tom chase Jerry”的例子依然不是特别理解，如此的话，我用比较易懂的话 再解释下</p>
<ol>
<li>即当我们在翻译<br>
Tom chase Jerry为汤姆追逐杰瑞</li>
<li>其实可以简单粗暴的认为计算“汤姆”与“Tom chase Jerry”中各个词的相似度<br>
从而得到了“汤姆”对应的输入句子Source中各个单词的概率分布：(Tom,0.6) (Chase,0.2) (Jerry,0.2)</li>
<li>这个概率分布意味着“汤姆”与“Tom”更相似，从而给“Tom”更大的权重<br>
使得最终把“汤姆”对应到“Tom”，达到的效果就是“Tom”翻译为“汤姆”</li>
</ol>
<h4 id="2-2-3-attention的算法流程总结：通过计算相似性得出权重最后加权求和">2.2.3 Attention的算法流程总结：通过计算相似性得出权重最后加权求和</h4>
<p>再比如，图书馆（source）里有很多书（value），为了方便查找，我们给书做了编号（key）。当我们想要了解漫威（query）的时候，我们就可以看看那些动漫、电影、甚至二战（美国队长）相关的书籍。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/066744f17a322d41029315a892b10800.png" alt="img"></p>
<p>为了提高效率，并不是所有的书都会仔细看，针对漫威来说，动漫，电影相关的会看的仔细一些（权重高），但是二战的就只需要简单扫一下即可（权重低）。</p>
<p>当我们全部看完后就对漫威有一个全面的了解了。</p>
<p>可以看到，将Source中的构成元素想象成是由一系列的&lt;Key,Value&gt;数据对构成，此时给定Target中的某个元素Query，通过计算Query和各个Key的相似性或者相关性，得到每个Key对应Value的权重系数，然后对Value进行加权求和，即得到了最终的Attention数值。</p>
<p>所以本质上Attention机制是对Source中元素的Value值进行加权求和，而Query和Key用来计算对应Value的权重系数。即可以将其本质思想改写为如下公式：</p>
<p><img src="https://img-blog.csdn.net/20171210214835727" alt="img"></p>
<p>整个过程具体如下图所示：</p>
<p><img src="https://img-blog.csdnimg.cn/49304e9412c2473091460b50dcf86e56.png" alt="img"></p>
<p>归纳整理一下，则为</p>
<ol>
<li>第一步：代表漫威漫画的query 和 代表某本书的key 进行相似度计算（常见的方法包括：求两者的向量点积、求两者的向量Cosine相似性等），得到权值</li>
<li>第二步：将权值进行归一化（将原始计算分值整理成所有元素权重之和为1的概率分布，或者说通过SoftMax的内在机制更加突出重要元素的权重），得到直接可用的权重<br>
<img src="https://img-blog.csdn.net/20171210215032165" alt="img"></li>
<li>第三步：将权重和 value 进行加权求和<br>
<img src="https://img-blog.csdn.net/20171210215055844" alt="img"></li>
</ol>
<p>值得一提的是，Attention 并不一定要在 Encoder-Decoder 框架下使用的，他是可以脱离 Encoder-Decoder 框架的。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/66e7f8d36c71bb58891c9ec63122908c.png" alt="img"></p>
<p>了解了Attention的本质思想，理解所谓的Self-Attention就容易了，具体下文会详细阐述，这里先简单提一嘴：</p>
<blockquote>
<p>在一般任务的Encoder-Decoder框架中，输入Source和输出Target内容是不一样的，比如对于英-中机器翻译来说，Source是英文句子，Target是对应的翻译出的中文句子，Attention机制发生在Target的元素Query和Source中的所有元素之间。</p>
<p>而Self Attention顾名思义，指的不是Target和Source之间的Attention机制，而是Source内部元素之间或者Target内部元素之间发生的Attention机制，也可以理解为Target=Source这种特殊情况下的注意力计算机制。其具体计算过程是一样的，只是计算对象发生了变化而已。</p>
</blockquote>
<h2 id="第三部分-通俗理解transformer：通过自注意力机制开启大规模预训练时代"><strong>第三部分 通俗理解Transformer：通过自注意力机制开启大规模预训练时代</strong></h2>
<p>自从2017年此文《<a href="https://arxiv.org/pdf/1706.03762.pdf">Attention is All You Need</a>》提出来Transformer后，便开启了大规模预训练的新时代，也在历史的长河中一举催生出了GPT、BERT这样的里程碑模型 (2018年3月份华盛顿大学提出ELMO、2018年6月份OpenAI提出GPT、2018年10月份Google提出BERT、2019年6月份CMU+google brain提出XLNet等等)</p>
<blockquote>
<p><img src="https://img-blog.csdnimg.cn/0a9151721dee403cbe55614f36f6fe02.png" alt="img"></p>
</blockquote>
<p>不过，据目前我所看到的文章里面，介绍Transformer比较好懂的还是开头所提的这篇《The Illustrated Transformer》**，**本部分中的核心阐述和大部分配图均来自此文。</p>
<p>接下来，我在此文的基础上加以大量解释、说明，以让之成为全网最通俗易懂的Transformer导论。因为这些解释、说明是你在其他文章中看不到的，而正因为有了这些解释、说明，才足以真正让每一个初学者都能快速理解到底什么是Transformer。</p>
<h3 id="3-1-transformer之编码：自注意力-位置编码-求和与归一化">3.1 Transformer之编码：自注意力/位置编码/求和与归一化</h3>
<h4 id="3-1-1-从机器翻译模型开始谈起">3.1.1 从机器翻译模型开始谈起</h4>
<p>还是考虑上文中已经出现过的机器翻译的模型(值得一提的是，Transformer一开始的提出即是为了更好的解决机器翻译问题)。当我们从外部现象来看的话，这个机器翻译技术就像是一个黑箱操作：输入一种语言，系统输出另一种语言：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/feaa01981ce3ab2f50012dcfa86ff40a.png" alt="img"></p>
<p>当我们拆开这个黑箱后，我们可以看到它是由编码组件、解码组件和它们之间的连接组成。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/e69279b508c770fac37ee6c24d129331.png" alt="img"></p>
<p>其中</p>
<ul>
<li>编码组件部分由一堆编码器/Encoder构成（具体个数可以调，论文中是6个）</li>
<li>解码组件部分也是由相同数量(与编码器对应)的解码器Decoder组成</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/img_convert/8c4b1b6c2e23e4c3e10be29c14009ac8.png" alt="img"></p>
<p>进一步拆开这个编码器会发现，所有的编码器在结构上都是相同的，但是并不共享参数，且每个编码器都可以分解成两个子层：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/1a52c76159f239b0787ecefa4bcd990b.jpeg" alt="img"></p>
<p>从而，当我们把编码器和解码器联合起来看待的话，则整个流程就是（如下图从左至右所示）：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/85b45b16351cf6a04b8d59bcca2384ed.jpeg" alt="img"></p>
<ol>
<li>首先，从编码器输入的句子会先经过一个自注意力层（即self-attention，下文会具体阐述），它会帮助编码器在对每个单词编码时关注输入句子中的的其他单词</li>
<li>接下来，自注意力层的输出会传递到前馈(feed-forward)神经网络中，每个位置的单词对应的前馈神经网络的结构都完全一样（注意：仅结构相同，但各自的参数不同）</li>
<li>最后，流入解码器中，解码器中除了也有自注意力层、前馈层外，这两个层之间还有一个编码-解码注意力层，用来关注输入句子的相关部分（和seq2seq模型的注意力作用相似）</li>
</ol>
<h4 id="3-1-2-将张量引入">3.1.2 将张量引入</h4>
<p>我们已经了解了模型的主要部分，接下来我们看一下各种向量或张量(注：张量概念是矢量概念的推广，可以简单理解矢量是一阶张量、矩阵是二阶张量)是怎样在模型的不同部分中，将输入转化为输出的。</p>
<p>像大部分NLP应用一样，我们首先将每个输入单词通过词嵌入算法转换为词向量</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/5a872ef655bc85126ea29c230052991f.png" alt="img"></p>
<p>具体而言，流程如下</p>
<ol>
<li>每个单词都被嵌入为512维的向量（512是Transformer论文中设定的一个维度，类似编码器/解码器的数量一样，都是可以设置的超参数。顺带提句，训练集中最长句子的长度论文中也设置的512。为方便后续一系列的图示，这里用4个格子代表512维，即虽然你只看到4维，但你要明白实际背后代表着512维）</li>
<li>最底下的那个编码器接收的是嵌入向量，之后的编码器接收的是前一个编码器的输出</li>
</ol>
<p><img src="https://img-blog.csdnimg.cn/img_convert/15dfeaa4db05178319010b7d4c86d0dc.jpeg" alt="img"></p>
<p>此时，我们可以看出Transformer的一个核心特性</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/5d5de25d8b30e3e371204f01afa026fb.jpeg" alt="img"></p>
<ol>
<li>输入序列中每个位置的单词都各自单独的路径流入编码器，即各个单词同时流入编码器中，不是排队进入…</li>
<li>在自注意力self-attention层中，这些路径两两之间是相互依赖的，而前馈层(feed-forward）则没有这些依赖性，所以这些路径在流经前馈层(feed-forward)时可以并行计算</li>
</ol>
<h4 id="3-1-3-什么是自注意力机制：从宏观视角看自注意力机制"><strong>3.1.3 什么是自注意力机制：从宏观视角看自注意力机制</strong></h4>
<p>下面，咱们再通过一个例子了解自注意力机制的工作原理，假定现在要翻译下列句子：<br>
“The animal didn’t cross the street because <strong>it</strong> was too tired”</p>
<p>上面这个“it”是指的什么呢？它指的是street 还是这个 animal 呢？对人来说很简单的问题(必然是animal，因为animal才可能cross，才可能tired)，但是对算法而言并不简单，算法不一定知道it指的是animal还是street。</p>
<p>那self-attention机制咋做呢？一般的文章会这么解释：</p>
<blockquote>
<p>当模型处理单词“it”时，self-attention允许将“it”和“animal”联系起来。当模型处理每个位置的词时，self-attention允许模型看到句子中其他位置有关联或相似的单词/信息作为辅助线索，以更好地编码当前单词。</p>
<p>回想一下RNN对隐藏状态的处理：将之前的隐藏状态与当前位置的输入结合起来。在Transformer中，自注意力机制则将对其他单词的“理解”融入到当前处理的单词中。</p>
</blockquote>
<p>说的直白点就是，你如果要更好的理解句中某个特定单词的含义，你要把它放到整个语境之中去理解，比如通过对上下文的把握(<em>包括即便遇到那种一词多义的情况，你也能<strong>通过其上下文推断其准确含义</strong>，这就是上下文的重要性，也是transformer计算每个单词与上下文各个词的相似度的意义所在</em> )</p>
<p>那上下文哪些词对理解该特定词更重要呢？这个重要程度便用所谓的权重表示(权重来自于该词/向量本身跟其他各个词/向量之间的相似度)，权重越大的单词代表与『该词』越相关(某种意义上可以认为是越相似)，从而对理解『该词』越重要，然后把该词编码为包括该词在内所有词的加权和</p>
<p>比如下图中，it的上下文中，很明显the anima和tired等单词对it 的编码更重要(或更相关更相似)，所以自注意力机制在编码it 时把更多的注意力/权重放在了the animal和tired等单词上</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/77e86008772b231c277afdae86bac801.png" alt="img"></p>
<p>接下来的关键是如何计算自注意力，计算自注意力有两种方式：一种通过向量，一种通过矩阵。下面，先看向量的方式</p>
<h4 id="3-1-4-通过向量计算自注意力：先三个向量后计算得分且softmax最后加权求和">3.1.4 通过向量计算自注意力：先三个向量后计算得分且softmax最后加权求和</h4>
<h5 id="3-1-4之1-4-计算自注意力第一步：生成查询向量-键向量和值向量"><strong>3.1.4之1/4 计算自注意力第一步：生成查询向量、键向量和值向量</strong></h5>
<p>通过向量方式计算自注意力的第一步，就是从每个编码器的输入向量(即每个单词的词向量)生成三个向量：查询向量query-vec、键向量key-vec、值向量value-vec</p>
<blockquote>
<p>查询向量、键向量、值向量这三个向量的维度在论文中设置的是<strong>64</strong>，在维度上比词嵌入向量更低，因为词嵌入和编码器的输入/输出向量的维度是512，但也不是必须比编码器输入输出的维数小，这样做主要是为了让后续多头注意力的计算更稳定<br>
（<em>在下文你会看到，transformer通过多头注意力机制multi headed attention，对每个512维的输入向量都设置了8个头，不同的头关注每个输入向量不同的部分，而<strong>每个头的维度则是：512/8 = 64</strong>，且再多说一句，也可以设置为2个头，不一定非得设置为8个头</em>）</p>
</blockquote>
<p>至于这三个向量的生成方法是把输入的向量分别乘以三个不同的权重矩阵<img src="https://latex.csdn.net/eq?W%5E%7BQ%7D" alt="W^{Q}">、<img src="https://latex.csdn.net/eq?W%5E%7BK%7D" alt="W^{K}">、<img src="https://latex.csdn.net/eq?W%5E%7BV%7D" alt="W^{V}">，得到Q、K、V，而这些权重矩阵是在模型训练阶段中训练出来的「<em>对于权重矩阵<img src="https://latex.csdn.net/eq?W%5E%7BQ%7D" alt="W^{Q}">/<img src="https://latex.csdn.net/eq?W%5E%7BK%7D" alt="W^{K}">/<img src="https://latex.csdn.net/eq?W%5E%7BV%7D" alt="W^{V}">如何训练出来的，还是标准老套路：先随机初始化，然后在损失函数中表示出来，最后通过反向传播不断优化学习得出，最终目标是最小化模型的预测误差，至于什么是反向传播，请参见<a href="https://www.julyedu.com/questions/interview-detail?kp_id=26&amp;cate=%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0&amp;quesId=2921">参考文献17</a></em>」</p>
<p>为形象起见，还是举例来说明，在我们有了权重矩阵后，对于单词<img src="https://latex.csdn.net/eq?X_%7B1%7D" alt="X_{1}">、<img src="https://latex.csdn.net/eq?X_%7B2%7D" alt="X_{2}">分别而言（假定X1是Thinking，X2是Machines）：</p>
<ul>
<li><img src="https://latex.csdn.net/eq?X_%7B1%7D" alt="X_{1}">与<img src="https://latex.csdn.net/eq?W%5E%7BQ%7D" alt="W^{Q}">权重矩阵相乘得到与这个单词相关的查询向量<img src="https://latex.csdn.net/eq?q_%7B1%7D" alt="q_{1}">、<img src="https://latex.csdn.net/eq?X_%7B1%7D" alt="X_{1}">与<img src="https://latex.csdn.net/eq?W%5E%7BK%7D" alt="W^{K}">权重矩阵相乘得到与这个单词相关的键向量****<img src="https://latex.csdn.net/eq?k_%7B1%7D" alt="k_{1}">****、<img src="https://latex.csdn.net/eq?X_%7B1%7D" alt="X_{1}">与<img src="https://latex.csdn.net/eq?W%5E%7BV%7D" alt="W^{V}">权重矩阵相乘得到与这个单词相关的值向量<img src="https://latex.csdn.net/eq?v_%7B1%7D" alt="v_{1}"></li>
<li>对于单词<img src="https://latex.csdn.net/eq?X_%7B2%7D" alt="X_{2}">而言，依上类推：<img src="https://latex.csdn.net/eq?X_%7B2%7D" alt="X_{2}">分别与<img src="https://latex.csdn.net/eq?W%5E%7BQ%7D" alt="W^{Q}">、<img src="https://latex.csdn.net/eq?W%5E%7BK%7D" alt="W^{K}">、<img src="https://latex.csdn.net/eq?W%5E%7BV%7D" alt="W^{V}">相乘得到该单词的查询向量****<img src="https://latex.csdn.net/eq?q_%7B2%7D" alt="q_{2}">*<em><strong>、键向量</strong></em>*<img src="https://latex.csdn.net/eq?k_%7B2%7D" alt="k_{2}">*<em><strong>、值向量</strong></em>*<img src="https://latex.csdn.net/eq?v_%7B2%7D" alt="v_{2}">****</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/img_convert/74843c907a1ea3ff862ff898dc22fce5.jpeg" alt="img"></p>
<p>最终使得输入序列的每个单词各自创建一个查询向量、一个键向量和一个值向量</p>
<p>可能有的读者有疑问了，设置这三个向量的用意何在或有何深意，实际上</p>
<ul>
<li>查询向量Query是当前单词的表示形式，用于对所有其他单词(key)进行评分，我们只需要关注当前正在处理的token的query</li>
<li>键向量Key可以看做是序列中所有单词的标签，是在我们找相关单词时候的对照物</li>
<li>值向量Value是单词的实际表示，一旦我们对每个单词的相关度打分之后，我们就要对value进行相加表示当前正在处理单词的value</li>
</ul>
<h5 id="3-1-4之2-4-计算自注意力第二步：计算得分"><strong>3.1.4之2/4 计算自注意力第二步：计算得分</strong></h5>
<p>接下来，我们需要针对这个例子中的第一个单词“Thinking”（pos#1）计算attention分值，即计算每个词对“Thinking”的打分，这个分决定着编码“Thinking”时(某个固定位置时)，应该对其他位置上的单词<strong>各自</strong>给予多少关注度</p>
<p>这个得分通过“Thinking”所对应的查询向量query和所有词的键向量key，依次乘积得出来。所以如果我们是处理位置最靠前的词的attention分值的话</p>
<ul>
<li>第一个分数是q1和k1的点积(根据点积结果可以判断<strong>q1和k1这个向量的相似性</strong>)</li>
<li>第二个分数是q1和k2的点积(根据点积结果可以判断q1<strong>和k2这个向量的相似性</strong>)</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/img_convert/921a5287939700d160fbb2a27f33f30f.jpeg" alt="img"></p>
<h5 id="3-1-4之3-4-计算自注意力第三-四步：分数除以8然后softmax下"><strong>3.1.4之3/4 计算自注意力第三、四步：分数除以8然后softmax下</strong></h5>
<p>第三步和第四步分别是：</p>
<ul>
<li>将分数除以8（8是论文中使用的键向量的维数64的平方根，这会让梯度更稳定，也可以使用其它值）</li>
<li>然后通过softmax传递结果，softmax的作用是使所有单词的分数归一化，得到的分数都是正值且它们的和为1</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/img_convert/6fc06ee880115438b233d12939755797.jpeg" alt="img"></p>
<p>这个softmax分数决定了在编码当下位置（“Thinking”）时，包括当下位置单词（“Thinking”）在内每个单词的所获得的关注度。显然，正在当下位置上的<strong>Thinking</strong>获得最高的softmax分数(毕竟自己跟自己最相似嘛，所以编码thinking时对Thinking、Machines的注意力分数分配是：0.88 0.12)。</p>
<h5 id="3-1-4之4-4-计算自注意力第五-六步：值向量乘以softmax分数后对加权值向量求和"><strong>3.1.4之4/4 计算自注意力第五、六步：值向量乘以softmax分数后对加权值向量求和</strong></h5>
<p>第五步是将softmax分值乘以每个值向量，这样操作的意义在于留下我们想要关注的单词的value，并把其他不相关的单词丢掉(例如，让它们乘以0.001这样的小数)</p>
<p>第六步是对加权值向量求和，产生“<strong>Thinking</strong>”的self-attention的输出结果</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/19a3e9fed1959e276be2f9ee902c1bb0.jpeg" alt="img"></p>
<p>接下来，针对每个单词都进行上述六个步骤的自注意力得分计算，相当于</p>
<ol>
<li>
<p>先是“Thinking”对应的query(q1)与各个不同的key(k1、k2)计算相似度，然后除以8继而softmax，最后softmax值乘以值向量v1、v2并加权求和</p>
<p>即：下图里的b1相当于z1</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/ff0f9bff8d7626e2e40a34e7d77deb8e.webp?x-oss-process=image/format,png" alt="img"></p>
</li>
<li>
<p>再是“Machines”对应的query(q2)与各个不同的key(k1、k2)计算相似度，然后也除以8继而softmax，最后softmax值乘以值向量v1、v2并加权求和下图里的b2相当于z2</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/023f00c574399d072db409c581052dea.webp?x-oss-process=image/format,png" alt="img"></p>
</li>
</ol>
<p>最终每个词的输出向量<img src="https://latex.csdn.net/eq?z_i" alt="z_i">都包含了其他词的信息，每个词都不再是孤立的了，而且词与词的相关程度可以通过softmax输出的权重进行分析</p>
<p><img src="https://img-blog.csdnimg.cn/05b64b744bc74d828e0394a95ce4e487.png" alt="img"></p>
<p>如此，所有单词的自注意力计算就完成了，得到的向量就可以传给前馈神经网络。然而实际中，这些计算是以矩阵形式完成的，以便算得更快。下面咱们再看看如何用矩阵实现的。</p>
<h4 id="3-1-5-通过矩阵运算实现自注意力机制"><strong>3.1.5 通过矩阵运算实现自注意力机制</strong></h4>
<p>第一步是计算查询矩阵、键矩阵和值矩阵。为此，我们将输入词向量合并成输入矩阵<img src="https://latex.csdn.net/eq?X" alt="X">（矩阵的每一行代表输入句子中的一个单词，所以整个矩阵就代表整个句子），将其乘以我们训练的权重矩阵：<img src="https://latex.csdn.net/eq?W%5E%7BQ%7D" alt="W^{Q}">/<img src="https://latex.csdn.net/eq?W%5E%7BK%7D" alt="W^{K}">/<img src="https://latex.csdn.net/eq?W%5E%7BV%7D" alt="W^{V}">「<em>再次提醒：词嵌入向量 (512，或图中的4个格子)，和q/k/v向量(64，或图中的3个格子)的大小差异</em>」</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/1bed15c3749c8760dc9975361148523a.png" alt="img"></p>
<p>最后，由于我们处理的是矩阵，我们可以将步骤2到步骤6合并为一个公式来计算自注意力层的输出，下图是自注意力的矩阵运算形式：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/9c58346d0fceebd90ada8f1021177e68.png" alt="img"></p>
<p>如果觉得不够形象的话，可以再看下台大李宏毅画的这几个图</p>
<blockquote>
<ol>
<li>
<p>将输入向量按列组合成一个矩阵，与 相乘得到矩阵，其中矩阵包含了所有输入向量对应的query，同理可以得到key和value对应的矩阵</p>
<p><img src="https://img-blog.csdnimg.cn/67b789b15f974fb18939241c1d219c1d.png" alt="img"></p>
</li>
<li>
<p>将各个向量对应的key按行组合，与输入向量相乘，得到与输入向量之间的所有关联性分数</p>
<p><img src="https://img-blog.csdnimg.cn/ae2246b69f9f464d9e28223f0942984b.png" alt="img"></p>
<p>由此可知，将矩阵转置后，与矩阵相乘得到矩阵，其中矩阵包含了所有输入向量之间的关联性分数</p>
<p><img src="https://img-blog.csdnimg.cn/41e3c57b51404431a067e2948c701bee.png" alt="img"></p>
<p>然后再将矩阵</p>
<p>给到Softmax激活函数，得到矩阵</p>
<p><img src="https://img-blog.csdnimg.cn/aaf875f2b2ac4986b7e45f9f8d0e72cf.png" alt="img"></p>
</li>
<li>
<p>最后将各个输入向量对应的value按列组合成一个矩阵，并与矩阵相乘得到Self-attention的输出矩阵「<em>其中的b1 b2 b3 b4相当于上文的z1 z2 z3 z4</em>」</p>
<p><img src="https://img-blog.csdnimg.cn/990b15ff4ade439484d250281da9e762.png" alt="img"></p>
</li>
</ol>
</blockquote>
<h4 id="多头注意力机制-multi-headed-attention">多头注意力机制“multi-headed” attention**</h4>
<p>为进一步完善自注意力层，下面增加一种叫做“多头”注意力（“multi-headed” attention）的机制，并在两方面提高了注意力层的性能：</p>
<ol>
<li>它扩展了模型专注于不同位置的能力。编码“Thinking”的时候，虽然最后Z1或多或少包含了其他位置单词的信息，但是它实际编码中把过多的注意力放在“Thinking”单词本身(当然了，这也无可厚非，毕竟自己与自己最相似嘛)<br>
且如果我们翻译一个句子，比如“The animal didn’t cross the street because it was too tired”，我们会想知道“it”和哪几个词<strong>都</strong>最有关联，这时模型的“多头”注意机制会起到作用</li>
<li>它给出了注意力层的多个“表示子空间”（representation subspaces）</li>
</ol>
<blockquote>
<p>July注：第一次看到这里的朋友，可能会有疑问，正如知乎上有人问(<a href="https://www.zhihu.com/question/341222779?sort=created">https://www.zhihu.com/question/341222779?sort=created</a>)：为什么Transformer 需要进行Multi-head Attention，即多头注意力机制？</p>
<ul>
<li>
<p>叫TniL的答道：可以类比CNN中同时使用多个滤波器的作用，直观上讲，多头的注意力有助于网络捕捉到更丰富的特征/信息<br>
且论文中是这么说的：<em>Multi-head attention allows the model to jointly attend to information from different representation subspaces at different positions.</em><br>
关于different representation subspaces，举一个不一定妥帖的例子：当你浏览网页的时候，你可能在颜色方面更加关注深色的文字，而在字体方面会去注意大的、粗体的文字。这里的颜色和字体就是两个不同的表示子空间。同时关注颜色和字体，可以有效定位到网页中强调的内容。使用多头注意力，也就是综合利用各方面的信息/特征（毕竟，不同的角度有着不同的关注点）</p>
</li>
<li>
<p>叫LooperXX的则答道：在Transformer中使用的多头注意力出现前，基于各种层次的各种fancy的注意力计算方式，层出不穷。而Transformer的多头注意力借鉴了CNN中同一卷积层内使用多个卷积核的思想，原文中使用了 8 个 scaled dot-product attention ，在同一multi-head attention 层中，输入均为 KQV，同时进行注意力的计算，彼此之前参数不共享，最终将结果拼接起来，这样可以允许模型在不同的表示子空间里学习到相关的信息，在此之前的 A Structured Self-attentive Sentence Embedding 也有着类似的思想</p>
<p>简而言之，就是希望每个注意力头，只关注最终输出序列中一个子空间，互相独立，其核心思想在于，抽取到更加丰富的特征信息</p>
</li>
</ul>
</blockquote>
<p>OK，接下来，我们将看到对于“多头”注意机制，我们有多个查询/键/值权重矩阵集（Transformer使用8个注意力头，则对于每个编码器/解码器都有8个“<img src="https://latex.csdn.net/eq?W%5E%7BQ%7D" alt="W^{Q}"> <img src="https://latex.csdn.net/eq?W%5E%7BK%7D" alt="W^{K}"> <img src="https://latex.csdn.net/eq?W%5E%7BV%7D" alt="W^{V}">”的矩阵集合），每一组都是随机初始化，经过训练之后，输入向量可以被映射到不同的子表达空间中，具体而言</p>
<ol>
<li>
<p>在“多头”注意机制下，我们为每个头保持独立的查询/键/值权重矩阵，从而产生不同的查询/键/值矩阵。和之前一样，我们拿乘以矩阵来产生查询/键/值矩阵</p>
<p><img src="https://img-blog.csdnimg.cn/c7ef68d441014d869b3744878549e0b0.png" alt="img"></p>
</li>
<li>
<p>如果我们做与上述相同的自注意力计算，只需8次不同的权重矩阵运算，我们就会得到8个不同的Z矩阵</p>
<p><img src="https://img-blog.csdnimg.cn/1dc008cab4294402b44c07329e87d816.png" alt="img"></p>
</li>
<li>
<p>这给我们带来了一点挑战。前馈层没法一下子接收8个矩阵，它需要一个单一的矩阵(</p>
<p>最终这个单一<strong>矩阵类似输入矩阵</strong><img src="https://latex.csdn.net/eq?X" alt="X"><strong>那样，矩阵中每个的行向量对应一个单词，比如矩阵的第一行对应单词Thinking、矩阵的第二行对应单词Machines</strong></p>
<p>)</p>
<p>所以我们需要一种方法把这8个矩阵合并成一个矩阵。那该怎么做？其实可以直接把这些矩阵拼接在一起，然后乘以一个附加的权重矩阵</p>
<p><img src="https://img-blog.csdnimg.cn/8cc143c0a77c4c44b354360d181d2f39.png" alt="img"></p>
</li>
</ol>
<p>以上基本就是多头自注意力的全部了，接下来把所有矩阵集中展示下，如下图所示</p>
<p><img src="https://img-blog.csdnimg.cn/06b3561f8fcb4789aee244cf4a774135.png" alt="img"></p>
<p>现在我们已经看过什么是多头注意力了，让我们回顾一下之前的一个例子：“The animal didn’t cross the street because it was too tired”，再看一下编码“it”的时候每个头的关注点都在哪里：</p>
<p><img src="https://img-blog.csdnimg.cn/6a11e3084d834ba585f8f1ca51fd7856.png" alt="img"></p>
<p>编码it，用两个head的时候：其中一个更关注<strong>the animal</strong>（注意看图中黄线的指向），另一个更关注<strong>tired</strong>（注意看图中绿线的指向）。<br>
恍然大悟没有？！总有一个头会关注到咱们想关注的点，避免在编码it时只重点关注到了the animal，而没重点关注tired。</p>
<p>如果我们把所有的头的注意力都可视化一下，就是下图这样</p>
<p><img src="https://img-blog.csdnimg.cn/2faf7e7bb7284f04b912814b4c23d473.png" alt="img"></p>
<h4 id="相比cnn-rnn的优势与位置编码">相比CNN/RNN的优势与位置编码</h4>
<p>首先，CNN提取的是局部特征，但是对于文本数据，忽略了长距离的依赖，比如来自<a href="https://www.zhihu.com/question/580810624/answer/2979260071">这里</a>的这个例子</p>
<blockquote>
<p>假设有如下这句话：小明在星期天要去露营，他准备叫上小红</p>
<p>在屏幕前的你，你会很快看出来后半句中的「他」指的就是「小明」，因为你可以一眼扫过去 看到差不多整个句子，且一眼看出这些词之间的关联，但对于计算机来说，可没那么容易，毕竟“小明”和“他”之间之间相距8个字<br>
具体而言，对于CNN会怎么处理呢？</p>
<ol>
<li>
<p>一般会从最左侧开始，通过「同时扫描三个词的滑动窗口」从左到右扫描整个句子</p>
<p><img src="https://img-blog.csdnimg.cn/15a9e270ce2848b483324eac1e1ac7b9.png" alt="img"></p>
</li>
<li>
<p>且每次往右移动一格</p>
<p><img src="https://img-blog.csdnimg.cn/22d2ddf0859248e4b87f30a0675e57f8.png" alt="img"></p>
</li>
<li>
<p>重复这个过程，对整个文本进行处理，便得到一个「卷积核」计算出的所有特征，如下图所示，此时</p>
<p>“小明”两个字只共同参与了特征A1的计算</p>
<p>，而“他”字则参与了特征</p>
<p>A9、A10、A11</p>
<p>的计算，其中A9距离A1最近(因为A1中含有“小明”的信息，而A9中含有“他”的信息)</p>
<p>但在此时卷积操作本身并没有同时作用于“小明”和“他”这两个词，所以它无法建立它们之间的任何关系(因为模型的卷积操作都没有同时看到它们)</p>
<p><img src="https://img-blog.csdnimg.cn/b49d1598a6664e20a918f525d09e2693.png" alt="img"></p>
</li>
<li>
<p>怎么办呢？好在不管怎么着，特征A1和特征A9之间的距离相较于“小明”和“他”的距离变近了。所以我们可以继续在特征A上再堆叠一层卷积B 然后计算，然后再堆叠卷积C 再计算，直到卷积操作比如E能直接获取到“小明”和“他”的信息</p>
<p><img src="https://img-blog.csdnimg.cn/b2f9a9dd6628485288965dcf05f36101.png" alt="img"></p>
</li>
</ol>
</blockquote>
<p>就这样，通过更多的卷积操作，把卷积网络堆叠的更深，以此来让它有机会捕捉“长距离依赖”。换言之，卷积网络主要依靠深度来捕捉长距离依赖。但这个过程太间接了，因为信息在网络中实际传播了太多层。究竟哪些信息被保留，哪些被丢弃了，弄不清楚。所以从实践经验来看，卷积网络捕捉长依赖的能力非常弱。这也是为什么在大多数需要长依赖关系建模的场景中，CNN用的并不多的原因</p>
<p>那RNN的问题又在哪呢？如下图所示，当计算隐向量<img src="https://latex.csdn.net/eq?h_4" alt="h_4">时，用到了两个信息：一个输入<img src="https://latex.csdn.net/eq?X_4" alt="X_4">，一个上一步算出来的隐向量<img src="https://latex.csdn.net/eq?h_3" alt="h_3"> (前面所有节点的信息现在都寄存在了<img src="https://latex.csdn.net/eq?h_3" alt="h_3">中)</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/f6650dd74f4288d047e2fdad8aab4803.png" alt="img"></p>
<ol>
<li>意味着<img src="https://latex.csdn.net/eq?h_4" alt="h_4">中包含最多的信息是当前的输入<img src="https://latex.csdn.net/eq?X_4" alt="X_4">，越往前的输入，随着距离的增加，信息衰减得越多。对于每一个输出隐向量<img src="https://latex.csdn.net/eq?h" alt="h">都是如此，包含信息最多得是当前的输入，随着距离拉远，包含前面输入的信息越来越少<br>
但是Transformer这个结构就不存在这个问题，不管当前词和其他词的空间距离有多远，包含其他词的信息不取决于距离，而是取决于两者的相关性，这是Transformer的第一个优势</li>
<li>第二个优势在于，对于Transformer来说，在对当前词进行计算的时候，不仅可以用到前面的词，也可以用到后面的词，而RNN只能用到前面的词(当然，这倒不是个有多严重的问题，因为这可以通过双向RNN来解决)</li>
<li>第三点，RNN是一个顺序的结构，必须要一步一步地计算，只有计算出<img src="https://latex.csdn.net/eq?h_1" alt="h_1">，才能计算<img src="https://latex.csdn.net/eq?h_2" alt="h_2">，其次再计算<img src="https://latex.csdn.net/eq?h_3" alt="h_3">，即隐向量无法同时并行计算，导致RNN的计算效率不高<br>
通过前文的介绍，可以看到Transformer不存在这个问题</li>
</ol>
<p>不过有个细节值得注意下，不知有读者发现没有，即RNN的结构包含了序列的时序信息，而Transformer却完全把时序信息给丢掉了</p>
<p>毕竟**“他欠我100万”，和“我欠他100万”，两者的意思千差万别，故为了解决时序的问题，Transformer的作者用了一个绝妙的办法：位置编码（Positional Encoding）**。</p>
<p>即给每个位置编号，从而每个编号对应一个向量，最终通过<strong>结合位置向量和词向量，作为输入embedding</strong>，就给每个词都引入了一定的位置信息，这样Attention就可以分辨出不同位置的词了：</p>
<p><img src="https://img-blog.csdnimg.cn/71fe84a2a89d45699da903bf0462f321.png" alt="img"></p>
<p>关于『使用位置编码表示序列的位置』的细节请参看此文的1.1节：<a href="https://blog.csdn.net/v_JULY_v/article/details/130090649">从零实现Transformer的简易版与强大版：从300多行到3000多行</a></p>
<h3 id="transformer之解码：求和与归一化-线性层和softmax层">Transformer之解码：求和与归一化、线性层和softmax层</h3>
<h4 id="求和与归一化">求和与归一化</h4>
<p>最后，在回顾整个Transformer架构之前，还需再提一下编码器中的一个细节：每个编码器中的每个子层都有一个残差连接，然后做了一个：层归一化(layer-normalization)</p>
<p><img src="https://img-blog.csdnimg.cn/cf4ba05e16d64b10b197514bcd1f9b44.png" alt="img"></p>
<p>这个过程中的向量“求和层归一化”的示意图如下所示：</p>
<p><img src="https://img-blog.csdnimg.cn/b0a45c6a0dde463aa6e360ba40344206.png" alt="img"></p>
<p>当然在解码器子层中也是这样的，从而当有着两个编码器和两个解码器的Transformer就是下图这样的：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/fc657ecca0a6d942ea9bfa5a5c828edb.png" alt="img"></p>
<p>现在我们已经介绍了编码器的大部分概念，由于encoder的decoder组件差不多，所以也就基本知道了解码器的组件是如何工作的。最后，我们直接看下二者是如何协同工作的 (可以很直观的看到，解码输出时 是一个一个输出的)：</p>
<p><img src="https://img-blog.csdnimg.cn/a94d5aea0229438b942c80822d679f40.gif#pic_center" alt="在这里插入图片描述"></p>
<h4 id="解码器中的两个注意力层">解码器中的两个注意力层</h4>
<p>通过上文的介绍可知，解码器中的自注意力层和编码器中的不太一样，解码器中有两个注意力层，从底至上</p>
<ul>
<li>一个带masked的Multi-Head Attention，本质是Self-Attention<br>
该<strong>自注意力层只允许关注已输出位置的信息</strong>，实现方法是在自注意力层的softmax之前进行mask，将未输出位置的权重设置为一个非常大的负数(进一步softmax之后基本变为0，相当于直接屏蔽了未输出位置的信息)</li>
<li>一个不带masked的Multi-Head Attention，本质是Encoder-Decoder Attention</li>
</ul>
<p>对于第二个注意力层，即Encoder-Decoder Attention</p>
<ul>
<li>
<p>与Encoder中的Q、K、V全部来自于上一层单元的输出不同，</p>
<p>Decoder只有Q来自于上一个Decoder单元的输出，K与V都来自于Encoder最后一层的输出</p>
<p>注意，这点很关键，也就是说，Decoder是要通过当前状态Q与Encoder的输出K算出权重后(计算query与各个key的相似度)，最后与Encoder的V加权得到下一层的状态</p>
<p><img src="https://img-blog.csdnimg.cn/40abdb5d1768410ea3291f753639cf32.png" alt="img"></p>
</li>
<li>
<p>比如当我们要把“<strong>Hello</strong> Word”翻译为“<strong>你好</strong>，世界”时<br>
编码器是针对：Hello Word<br>
解码器是针对：你好 世界</p>
<p>Decoder会计算“你好”这个query分别与“Hello”、“Word”这两个key的相似度<br>
很明显，“你好”与“Hello”更相似，从而给“Hello”更大的权重，最终把“你好”对应到“Hello”，达到的效果就是“Hello”翻译为“你好”</p>
</li>
</ul>
<h4 id="最后的线性层和softmax层">最后的线性层和softmax层</h4>
<p>Decoder输出的是一个浮点型向量，如何把它变成一个词？这就是最后一个线性层和softmax要做的事情。</p>
<p>线性层就是一个简单的全连接神经网络，它将解码器生成的向量映射到logits向量中。<br>
假设我们的模型词汇表是10000个英语单词，它们是从训练数据集中学习的。那logits向量维数也是10000，每一维对应一个单词的分数。</p>
<p>然后，softmax层将这些分数转化为概率（全部为正值，加起来等于1.0），选择其中概率最大的位置的词汇作为当前时间步的输出</p>
<p><img src="https://img-blog.csdnimg.cn/c8fef938155d460db008d19950238bfe.png" alt="img"></p>
<p>更多细节请继续参看此文：<a href="https://blog.csdn.net/v_JULY_v/article/details/130090649">类ChatGPT代码级解读：如何从零起步实现Transformer、llama/ChatGLM</a></p>
<h2 id="第四部分-通俗理解bert：-从elmo-gpt到集大成者bert">第四部分 通俗理解BERT： 从Elmo/GPT到集大成者BERT</h2>
<p>本部分内容主要参考自本文开头所说的张俊林老师的文章，或文末参考文献6：《<a href="https://www.julyedu.com/questions/interview-detail?kp_id=30&amp;cate=NLP&amp;quesId=3008">说说NLP中的预训练技术发展史：从Word Embedding到Bert模型</a>》</p>
<h3 id="从word-embedding到elmo">从Word Embedding到ELMO</h3>
<h4 id="word-embedding的缺陷：无法处理多义词问题">Word Embedding的缺陷：无法处理多义词问题</h4>
<p>在本文的第一部分中，我们介绍了word2vec，但实际生产应用中，word2vec的效果并没有特别好。所以，Word Embedding存在什么问题？</p>
<p>考虑下面两个句子：</p>
<ul>
<li>Sentence A：He got bit by Python.</li>
<li>Sentence B：Python is my favorite programming language.</li>
</ul>
<p>在句子A中，Python是蟒蛇的意思，而句子B中是一种编程语言。<br>
如果我们得到上面两个句子中单词Python的嵌入向量，那么像word2vec这种嵌入模型就会为这两个句子中的<strong>Python</strong>赋予相同的嵌入，因为它是上下文无关的。</p>
<p>所以word embedding无法区分多义词的不同语义，问题的产生总是无情的推动技术的发展，这不ELMO就来了。</p>
<h4 id="根据上下文动态调整的elmo：预训练-双层双向lstm-特征融合"><strong>根据上下文动态调整的</strong>ELMO：预训练(<strong>双层双向LSTM</strong>) + 特征融合</h4>
<p>ELMO是“Embedding from Language Models”的简称，提出ELMO的论文题目：“Deep contextualized word representation”更能体现其精髓，而精髓在哪里？在deep contextualized这个短语，一个是deep，一个是context，其中context更关键。</p>
<p>它与之前的Word2Vec有何本质区别？</p>
<ul>
<li>在此之前的Word Embedding本质上是个静态的方式，所谓静态指的是训练好之后每个单词的表达就固定住了，以后使用的时候，不论新句子上下文单词是什么，这个单词的Word Embedding不会跟着上下文场景的变化而改变</li>
<li>而ELMO的本质思想是：我事先用语言模型学好一个单词的Word Embedding，然后在我实际使用Word Embedding的时候，单词已经具备了特定的上下文了，这个时候我<strong>可以根据上下文单词的语义去调整单词的Word Embedding表示</strong>，这样经过调整后的Word Embedding更能表达在这个上下文中的具体含义，自然也就解决了多义词的问题了</li>
</ul>
<p>所以<strong>ELMO本身是个根据当前上下文对Word Embedding动态调整的思路</strong></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/da1a8850c5c75f116349b24aa3a62c1d.png" alt="img"></p>
<p>具体而言，ELMO采用了典型的两阶段过程：</p>
<ol>
<li>第一个阶段是通过语言模型LSTM进行预训练所以，你看到：<br>
上图左端的前向双层LSTM代表正方向编码器，输入的是从左到右顺序的上文Context-before；<br>
右端的逆向双层LSTM代表反方向编码器，输入的是从右到左的逆序的下文Context-after</li>
<li>同时，每个编码器的深度都是两层LSTM叠加</li>
<li>第二个阶段是在做下游任务时，从预训练网络中提取对应单词的网络各层的Word Embedding作为新特征补充到下游任务中</li>
</ol>
<p>上图展示的是其预训练过程，它的网络结构采用了<strong>双层双向LSTM</strong>，双向LSTM可以干啥？可以根据单词的上下文去预测单词，毕竟这比只通过上文去预测单词更准确。</p>
<p>这时有同学有疑问了，ELMO采用双向结构不就能看到需要预测的单词了么，你都能看到参考答案了，那岂不影响最终模型训练的效率与准确性，因为哪有做题时看着参考答案做题的。不过，巧就巧在ELMO虽然采用的双向结构，但两个方向是彼此独立训练的，从而避免了这个问题！</p>
<blockquote>
<p>好家伙，一般的文章可能面对这个问题就是一笔带过，但我July不行啊，咱得解释清楚啥叫“ELMO虽然采用的双向结构，但两个方向是彼此独立训练的”，啥叫既然是双向的，又何来什么独立，然后避免see itself的问题呢？<br>
好问题！虽然ELMO用双向LSTM来做encoding，但是这<strong>两个方向的LSTM其实是分开训练的</strong>（看到上图中那两个虚线框框没，分开看左边的双层LSTM和右边的双层LSTM，一个从左向右预测，一个从右向左预测，但在左边和右边的内部结构里，其本质不还是单向么，所以其实就是个伪双向，^_^），<strong>只是在最后在loss层做了个简单相加</strong></p>
<p>换言之，两个关键点</p>
<ol>
<li>对于每个方向上的单词来说，因为两个方向彼此独立训练，故在一个方向被encoding的时候始终是看不到它另一侧的单词的，从而避免了see itself的问题</li>
<li>而再考虑到句子中有的单词的语义会同时依赖于它左右两侧的某些词，仅仅从单方向做encoding是不能描述清楚的，所以再来一个反向encoding，故称双向</li>
</ol>
<p>看似完美！“伪双向”既解决了see itself的问题，又充分用上了上下文的语义</p>
<hr>
<p>然，BERT的作者指出这种两个方向彼此独立训练即伪双向的情况下，即便双层的双向编码也可能没有发挥最好的效果，而且我们可能不仅需要真正的双向编码，还应该要加深网络的层数，但暂且不管加不加深，真正的双向编码网络还是会不得不面对这个老问题：导致模型最终可以间接地“窥探”到需要预测的词，即还是那个see itself的问题。此点，下文细谈</p>
</blockquote>
<p>ELMO这个网络结构其实在NLP中是很常用的。使用这个网络结构利用大量语料做语言模型任务就能预先训练好这个网络，如果<strong>训练好这个网络后，再输入一个新句子，句子中每个单词都能得到对应的三个Embedding：</strong></p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/29508eef85e802223ef53bd31cbb74c2.png" alt="img"></p>
<ol>
<li>第一个Embedding，是单词的Word Embedding</li>
<li>第二个Embedding，是双层双向LSTM中第一层LSTM对应单词位置的Embedding，这层编码单词的句法信息更多一些</li>
<li>第三个Embedding，是双层双向LSTM中第二层LSTM对应单词位置的Embedding，这层编码单词的语义信息更多一些</li>
</ol>
<p>也就是说，ELMO的预训练过程不仅仅学会单词的Word Embedding，还学会了一个双层双向的LSTM网络结构，而这两者后面都有用</p>
<p>预训练好网络结构后，如何给下游任务使用呢？下图展示了下游任务的使用过程，比如我们的下游任务仍然是QA问题，此时对于问句X</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/4c745b794769a28651312412ef1286ef.png" alt="img"></p>
<ol>
<li>可以先将句子X作为预训练好的ELMO网络的输入</li>
<li>这样句子X中每个单词在ELMO网络中都能获得对应的三个Embedding</li>
<li>之后给予这三个Embedding中的每一个Embedding一个权重a，这个权重可以学习得来</li>
<li>根据各自权重累加求和，将三个Embedding整合成一个</li>
<li>然后将整合后的这个Embedding作为X句在自己任务的那个网络结构中对应单词的输入，以此作为补充的新特征给下游任务使用</li>
</ol>
<p>对于上图所示下游任务QA中的回答句子Y来说也是如此处理。因为ELMO给下游提供的是每个单词的特征形式，所以这一类预训练的方法被称为“<strong>Feature-based Pre-Training</strong>”。</p>
<hr>
<p>技术迭代的长河永不停歇，那么站在现在这个时间节点看，ELMO有什么值得改进的缺点呢？</p>
<ol>
<li>首先，一个非常明显的缺点在特征抽取器选择方面，ELMO使用了LSTM而不是新贵Transformer，毕竟很多研究已经证明了Transformer提取特征的能力是要远强于LSTM</li>
<li>另外一点，ELMO采取双向拼接这种融合特征的能力可能比BERT一体化的融合特征方式弱</li>
</ol>
<p>此外，不得不说除了以ELMO为代表的这种“Feature-based Pre-Training + 特征融合(将预训练的参数与特定任务的参数进行融合)”的方法外，NLP里还有一种典型做法，称为“预训练 + 微调(Fine-tuning)的模式”，而GPT就是这一模式的典型开创者</p>
<h4 id="微调-fine-tuning-：把在源数据集上训练的源模型的能力迁移到新数据新模型上">微调(Fine-tuning)：把在源数据集上训练的源模型的能力迁移到新数据新模型上</h4>
<p>既然提到了Fine-tuning，则有必要详细解释一下什么是Fine-tuning。而要了解什么是Fine-tuning，就要先提到迁移学习概念</p>
<p>所谓迁移学习(Transfer learning) ，就是把已训练好的模型（预训练模型）参数迁移到新的模型来帮助新模型训练。考虑到大部分数据或任务都是存在相关性的，所以通过迁移学习我们可以将已经学到的模型参数（也可理解为模型学到的知识），通过某种方式来分享给新模型从而加快并优化模型的学习效率，从而不用像大多数网络那样从零学习</p>
<p>其中，实现迁移学习有以下三种手段：</p>
<ul>
<li>Transfer Learning：冻结预训练模型的全部卷积层，只训练自己定制的全连接层</li>
<li>Extract Feature Vector：先计算出预训练模型的卷积层对所有训练和测试数据的特征向量，然后抛开预训练模型，只训练自己定制的简配版全连接网络</li>
<li>Fine-tuning：冻结预训练模型的部分卷积层（通常是靠近输入的多数卷积层，因为这些层保留了大量底层信息）甚至不冻结任何网络层，训练剩下的卷积层（通常是靠近输出的部分卷积层）和全连接层</li>
</ul>
<p>为了更好的说明什么是Fine-tuning，再引用下动手学深度学习一书上的例子，最后归纳Fine-tuning的步骤/流程</p>
<p>假设我们想从图像中识别出不同种类的椅子，然后将购买链接推荐给用户。一种可能的方法是</p>
<ol>
<li>先找出100种常见的椅子，为每种椅子拍摄1,000张不同角度的图像，然后在收集到的10万张图像数据集上训练一个分类模型<br>
这个椅子数据集虽然可能比一般的小数据集要庞大，但样本数仍然不及ImageNet数据集中样本数的十分之一</li>
<li>所以如果把适用于ImageNet数据集的复杂模型用在这个椅子数据集上便会过拟合。同时，因为椅子数据量有限，最终训练得到的模型的精度也可能达不到实用的要求</li>
<li>比较经济的解决办法便是应用迁移学习，将从ImageNet数据集学到的知识迁移到椅子数据集上<br>
毕竟虽然ImageNet数据集的图像大多跟椅子无关，但在该数据集上训练的模型可以抽取较通用的图像特征，从而能够帮助识别边缘、纹理、形状和物体组成等，这些类似的特征对于识别椅子也同样有效</li>
</ol>
<p>而这，就是所谓的迁移学习中一种常用技术：微调，如下图所示，微调由以下4步构成</p>
<p><img src="https://img-blog.csdnimg.cn/ebd475e785b842bda203b694566b9f93.png" alt="img"></p>
<ol>
<li>在源数据集（如ImageNet数据集）上预训练一个神经网络模型，即源模型</li>
<li>创建一个新的神经网络模型，即目标模型，它复制了源模型上除了输出层外的所有模型设计及其参数<br>
我们假设这些模型参数包含了源数据集上学习到的知识，且这些知识同样适用于目标数据集<br>
我们还假设源模型的输出层与源数据集的标签紧密相关，因此在目标模型中不予采用</li>
<li>为目标模型添加一个输出大小为目标数据集类别个数的输出层，并随机初始化该层的模型参数</li>
<li>在目标数据集(如椅子数据集)上训练目标模型，我们将从头训练输出层，而其余层的参数都是基于源模型的参数微调得到的</li>
</ol>
<blockquote>
<p>最终，Fine-tuning意义在于以下三点</p>
<ol>
<li>站在巨人的肩膀上：前人花很大精力训练出来的模型在大概率上会比你自己从零开始搭的模型要强悍，没有必要重复造轮子</li>
<li>训练成本可以很低：如果采用导出特征向量的方法进行迁移学习，后期的训练成本非常低，用CPU都完全无压力，没有深度学习机器也可以做</li>
<li>适用于小数据集：对于数据集本身很小（几千张图片）的情况，从头开始训练具有几千万参数的大型神经网络是不现实的，因为越大的模型对数据量的要求越大，过拟合无法避免。这时候如果还想用上大型神经网络的超强特征提取能力，只能靠迁移学习</li>
</ol>
</blockquote>
<h3 id="从word-embedding到gpt">从Word Embedding到GPT</h3>
<h4 id="生成式的预训练之gpt：预训练-单向transformer-fine-tuning">生成式的预训练之GPT：预训练(单向Transformer) + Fine-tuning</h4>
<p>GPT是“Generative Pre-Training”的简称，从名字看其含义是指的生成式的预训练。<br>
GPT也采用两阶段过程，第一个阶段是利用语言模型进行预训练，第二阶段通过Fine-tuning的模式解决下游任务</p>
<p>下图展示了GPT的预训练过程，其实和ELMO是类似的，主要不同在于两点：</p>
<ol>
<li>首先，特征抽取器不是用的LSTM，而是用的Transformer，毕竟它的特征抽取能力要强于LSTM，这个选择很明显是很明智的；</li>
<li>其次，GPT的预训练虽然仍然是以语言模型作为目标任务，但是采用的是单向的语言模型</li>
</ol>
<p><img src="https://img-blog.csdnimg.cn/img_convert/801922b26169dd269be29abc282b1ce8.png" alt="img"></p>
<h4 id="生成式的预训练之gpt：为何采用单向transformer">生成式的预训练之GPT：为何采用单向Transformer</h4>
<p>ELMO在做语言模型预训练的时候，预测单词可以同时使用上文和下文，用的双向LSTM结构，而GPT则只采用单词的上文来进行单词预测，而抛开了下文。说人话，就是让你根据提示造句，从左到右，是单向的</p>
<blockquote>
<p>什么是单向Transformer？在Transformer的文章中，提到了Encoder与Decoder使用的Transformer Block是不同的。怎么个不同？通过本文第三部分对Transformer的介绍可得知：</p>
<ul>
<li>Encoder因为要编码整个句子，所以每个词都需要考虑上下文的关系。所以每个词在计算的过程中都是可以看到句子中所有的词的；</li>
<li>但是Decoder与Seq2Seq中的解码器类似，每个词都只能看到前面词的状态，所以是一个单向的Self-Attention结构</li>
</ul>
<p>换言之，在解码Decoder Block中，使用了Masked Self-Attention（所谓Masked，即遮蔽的意思），即句子中的每个词，都只能对包括自己在内的前面所有词进行Attention，这就是单向Transformer。</p>
<p>而GPT使用的Transformer结构就是将Encoder中的Self-Attention替换成了Masked Self-Attention，从而每个位置的词看不到后面的词</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/655085e6ce07069ae50868b0b18bdd42.png" alt="img"></p>
<hr>
<p>July写博客嘛，就喜欢抠细节 不抠清楚不罢休，故帮本文的读者发挥下想象。</p>
<p>比如有人可能立马就疑问了，既然我们已经确定通过上下文预测单词可以更准确，为何GPT还抛弃下文只通过上文预测单词呢？</p>
<ul>
<li>首先，GPT把特征提取器从LSTM换成了更强的transformer，此举已经很是创新了（GPT之后大部分模型都开始用Transformer做特征提取器）</li>
<li>而此时如果用Transformer的结构提取上下文去做单词预测，那就势必用上Transformer双向结构，而Transformer不像ELMO的双向结构各个方向独立训练而不会see itself，但双向Transformer会出现see itself 啊！<br>
这可万万不行，因为咱们原本就要训练模型的预测能力，而如果你通过双向非独立的结构都能看到中间要被预测的单词、看到答案了（比如当你用前面的词逐个的预测下一个词的时候，结果你从另一个方向看到每个词，你品、细品，举个例子，预测a <strong>b c d</strong> f，一开始从左至右逐个预测第二位置 第三位置 第四位置的词：b c d，然后你从右往左预测时，能逐个看到：第四位置 第三位置 第二位置的词：d c b），还做个啥子预测？</li>
<li>最终两相权衡，才导致GPT放弃Transformer的双向结构，改用Transformer的单向结构，此举也决定了GPT更适合根据已有文本然后生成下文的任务，要不它叫生成式模型呢</li>
</ul>
</blockquote>
<p>上面讲的是GPT如何进行第一阶段的预训练，那么假设预训练好了网络模型，后面下游任务怎么用？它有自己的个性，和ELMO的方式大有不同</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/47310365fdd2442e464a9d9362eb4df1.png" alt="img"></p>
<p>上图展示了GPT在第二阶段如何使用：</p>
<ul>
<li>首先，对于不同的下游任务来说，本来你可以任意设计自己的网络结构，现在不行了，你要向GPT的网络结构看齐，把任务的网络结构改造成和GPT的网络结构是一样的</li>
<li>然后，在做下游任务的时候，任务的网络结构的参数初始化为预训练好的GPT网络结构的参数，这样通过预训练学到的语言学知识就被引入到你手头的任务里来了</li>
<li>再次，你可以用手头的任务去训练这个网络，对网络参数进行Fine-tuning，使得这个网络更适合解决手头的问题</li>
</ul>
<p>关于GPT的更多及其后续的迭代版本甚至火爆全球的ChatGPT，可再看下这篇<a href="https://blog.csdn.net/v_JULY_v/article/details/128579457">ChatGPT通俗导论：从RL之PPO算法、RLHF到GPT-N、instructGPT</a></p>
<h3 id="4-3-集大成者之bert：双向transformer版的gpt">4.3 集大成者之BERT：双向Transformer版的GPT</h3>
<h4 id="bert模型的架构：预训练-双向transformer-fine-tuning"><a href="https://so.csdn.net/so/search?q=BERT%E6%A8%A1%E5%9E%8B&amp;spm=1001.2101.3001.7020">BERT模型</a>的架构：预训练(双向Transformer) + Fine-Tuning</h4>
<p>我们经过跋山涉水，终于到了目的地BERT模型了。GPT是使用「单向的Transformer Decoder模块」构建的，而 BERT则是通过「双向的Transformer Encoder 模块」构建的</p>
<p>至此，我们可以梳理下BERT、ELMO、GPT之间的演进关系：</p>
<ul>
<li>比如如果我们把GPT的单项语言模型换成双向语言模型，就得到了BERT</li>
<li>而如果我们把ELMO的特征抽取器换成Transformer，我们也会得到BERT</li>
</ul>
<p>说白了，<strong>BERT综合了ELMO的双向优势与GPT的Transformer特征提取优势</strong>，即关键就两点</p>
<ul>
<li>第一点是特征抽取器采用Transformer</li>
<li>第二点是预训练的时候采用双向语言模型<br>
<img src="https://img-blog.csdnimg.cn/36b3e4458dc348608c50afa567807feb.png" alt="img"></li>
</ul>
<p>进一步，BERT采用和GPT完全相同的两阶段模型</p>
<ol>
<li>
<p>首先是预训练(通过不同的预训练任务在未标记的数据上进行模型训练)，其次是使用Fine-Tuning模式解决下游任务</p>
</li>
<li>
<p>和GPT的最主要不同在于在预训练阶段采用了类似ELMO的双向语言模型，当然另外一点是语言模型的数据规模要比GPT大</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/8ce7989d10e8a73e30de1b83c79c7c41.png" alt="img"></p>
</li>
</ol>
<p>总之，预训练之后，针对下游每个不同的任务都会有一个任务模型，只是这些任务模型一开始全都初始化为预训练好的BERT模型，然后根据下游任务的特点针对性微调(The same pre-trained model parameters are used to initialize models for different down-stream tasks. During fine-tuning, all parameters are fine-tune)</p>
<p>值得注意的是，这里面有一系列CLS、SEP等标记，意味着什么呢，这涉及到BERT的输入输出了</p>
<h4 id="bert对输入-输出部分的处理">BERT对输入、输出部分的处理</h4>
<p>为了适配多任务下的迁移学习，BERT设计了更通用的输入层和输出层。</p>
<p>具体而言，BERT的输入部分是个线性序列，两个句子之间通过分隔符「SEP」分割，最前面是起始标识「CLS」，每个单词有三个embedding：</p>
<ol>
<li>单词embedding，这个就是我们之前一直提到的单词embedding，值得一提的是，有的单词会拆分成一组有限的公共子词单元，例如下图示例中‘playing’被拆分成了‘play’和‘ing’；</li>
<li>句子embedding，用于区分两个句子，例如B是否是A的下文（对话场景，问答场景等）；</li>
<li>位置信息embedding，句子有前后顺序，组成句子的单词也有前后顺序，否则不通顺杂乱无章就是零散单词而非语句了，所以单词顺序是很重要的特征，要对位置信息进行编码</li>
</ol>
<p><img src="https://img-blog.csdnimg.cn/2199fbf262ab4ca49ec157d85855e2f9.png" alt="img"></p>
<p>把单词对应的三个embedding叠加（没错，直接相加），就形成了BERT的输入。</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/e8f36c8c3a2afbaf84273c977a6c16b5.png" alt="img"></p>
<p>至于BERT在预训练的输出部分如何组织，可以参考上图的注释</p>
<p><img src="https://img-blog.csdnimg.cn/9e239d1698fd41e5a00d97a2dce3fac8.png" alt="img"></p>
<p>我们说过Bert效果特别好，那么到底是什么因素起作用呢？如上图所示，对比试验可以证明，跟GPT相比，双向语言模型起到了最主要的作用，对于那些需要看到下文的任务来说尤其如此。而预测下个句子来说对整体性能来说影响不算太大，跟具体任务关联度比较高。</p>
<p>更多关于BERT输入问题的细节，可以参看参看文献13或20。</p>
<h4 id="bert的两个创新点：masked语言模型与next-sentence-prediction">BERT的两个创新点：Masked语言模型与Next Sentence Prediction</h4>
<p>通过之前内容的多处示例，我们早已得知，预测一个单词只通过上文预测不一定准确，只有结合该词的上下文预测该词才能更准确</p>
<p>那么新问题来了：对于Transformer来说，怎样才能在这个结构上做双向语言模型任务呢？</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/71da3125f632d5325d04e0413c81f7a6.png" alt="img"></p>
<p>很简单，它借鉴了Word2Vec的CBOW方法：根据需要预测单词的上文Context-Before和下文Context-after去预测单词。</p>
<p>现在我们来总结、对比下ELMO、GPT、BERT预测中间词的不同：</p>
<ul>
<li>如上文4.1.2节所说，ELMO采用双向LSTM结构，因为两个方向是彼此独立训练的，所以可以根据上下文预测中间词，尽管效果可能不是最佳</li>
<li>如上文4.2.2节所说，GPT由于采取了Transformer的单向结构，只能够看见当前以及之前的词，故只能根据上文预测下一个单词</li>
<li>而BERT没有像GPT一样完全放弃下文信息，而是采用了双向的Transformer。恩？！立马就有人要问了：用双向Transformer结构的话，不就导致上文4.2.2节说过的“看见”参考答案，也就是“see itself”的问题了么？</li>
</ul>
<p>好问题啊！BERT原始论文里也提到了这点：“因为双向条件会让每个词间接地 ‘看到自己/see itself’，从而模型在多层上下文中可以十分容易地预测目标词”，而BERT用的双向Transformer结构，而非各个方向独立训练的双向LSTM结构，那咋办呢？</p>
<p>如果BERT只是一个大杂烩，没有任何创新，便只会注定BERT平凡的命运，也就不是我们目前所熟知的BERT了。但BERT强就强在除了集众所长之外，还做了<strong>两个创新：一个是论文中指出的Masked 语言模型，一个是Next Sentence Prediction</strong>。</p>
<blockquote>
<p>首先来看第一个创新点，即什么是“Masked Language Model（MLM）呢？所谓MLM是指在训练的时候随即从输入预料上mask掉一些单词，然后通过的上下文预测该单词，该任务非常像训练一个中学生做完形填空的能力。</p>
</blockquote>
<p>也就是说</p>
<p><strong>为了让BERT具备通过上下文做完形填空的能力，自然就得让BERT不知道中间待预测词的信息，所以就干脆不要告诉模型这个中间待预测词的信息好了****即在输入的句子中，挖掉一些需要预测的词，然后通过上下文来分析句子，最终使用其相应位置的输出来预测被挖掉的词</strong></p>
<p>绝！但是，直接将大量的词替换为<MASK>标签可能会造成一些问题，模型可能会认为只需要预测<MASK>相应的输出就行，其他位置的输出就无所谓。同时Fine-Tuning阶段的输入数据中并没有<MASK>标签，也有数据分布不同的问题。</MASK></MASK></MASK></p>
<p>为了减轻这样训练带来的不利影响，BERT采用了如下的方式：输入数据中随机选择15%的词用于预测，这15%的词中</p>
<ul>
<li>80%的词向量输入时被替换为<MASK>，比如my dog is hairy -&gt; my dog is [mask]</MASK></li>
<li>10%的词的词向量在输入时被替换为其他词的词向量，比如my dog is hairy -&gt; my dog is apple</li>
<li>另外10%保持不动，比如my dog is hairy -&gt; my dog is hairy</li>
</ul>
<p>这样一来就相当于告诉模型，我可能给你答案，也可能不给你答案，也可能给你错误的答案，有<MASK>的地方我会检查你的答案，没<MASK>的地方我也可能检查你的答案，所以<MASK>标签对你来说没有什么特殊意义，所以无论如何，你都要好好预测所有位置的输出。</MASK></MASK></MASK></p>
<p>至于BERT的第二个创新点：“Next Sentence Prediction”，其任务是判断句子B是否是句子A的下文，如果是的话输出’IsNext‘，否则输出’NotNext‘，这个关系保存在BERT输入表示图中的[CLS]符号中</p>
<p><img src="https://img-blog.csdnimg.cn/974e52b0089244a1acb07d11f12d6d53.png" alt="img"></p>
<p>至于训练数据的生成方式是从平行语料中随机抽取的两句话：</p>
<ul>
<li>其中50%是选择语料库中真正顺序相连的两个句子，符合IsNext关系</li>
<li>另外50%是第二个句子从语料库中随机选择出一个拼到第一个句子后面，它们的关系是NotNext</li>
</ul>
<p>相当于我们要求模型除了做上述的Masked语言模型任务外，附带再做个句子关系预测，判断第二个句子是不是真的是第一个句子的后续句子。</p>
<p>之所以这么做，是考虑到很多NLP任务是句子关系判断任务，单词预测粒度的训练到不了句子关系这个层级，增加这个任务有助于下游句子关系判断任务。所以可以看到，它的<strong>预训练是个多任务过程</strong>，即有上文提到的这两个训练目标：</p>
<ol>
<li>一个Token级别或称为词级别，Token级别简言之就是完形填空，一个句子中间挖个词，让模型预测那个空的是哪个词<br>
与传统语言模型相比，通过上下文来预测中间某个缺失的单词，是否比从左往右（或者从右往左）的单词预测来的更直观和容易呢<br>
与新一代ELMO相比，BERT作者Jacob的这种类似挖洞的做法，即每个单层内部都是双向的做法，是否比『ELMo从左往右的语言模型和从右往左的语言模型独立开来训练，共享embedding，然后把loss平均一下，最后用的时候再把两个方向的语言模型输出拼接在一起』，而更加符合你的直觉呢</li>
<li>一个句子级别，即给两句句子，判断这两句是不是原文中的连在一起的互为上下文（句子级别的任务对于阅读理解，推理等任务提升较大）</li>
</ol>
<p>这个多任务或多目标的训练过程也算是BERT额外的第三个创新了。</p>
<p>下图是微博公司张老师团队此前利用微博数据和开源的BERT做预训练时随机抽出的一个中文训练实例，从中可以体会下上面讲的masked语言模型和下句预测任务，训练数据就长这种样子</p>
<p><img src="https://img-blog.csdnimg.cn/71bd43c01fb64168b6e7051b5ef2dde1.png" alt="img"></p>
<h4 id="bert总结与评价：借鉴多个模型设计的集大成者">BERT总结与评价：借鉴多个模型设计的集大成者</h4>
<p>BERT的横空出世基本也是NLP模型不断发展、演变的结果，如参考文献7所总结的：</p>
<ol>
<li>
<p>早期的NLP模型基于规则解决问题，比如专家系统，这种方式扩展性差，因为无法通过人来书写所有规则。</p>
</li>
<li>
<p>之后提出了基于统计学的自然语言处理，早期主要是基于浅层机器学习解决NLP问题。例如，通过马尔科夫模型获得语言模型，通过条件随机场CRF进行词性标注。如果你去看StandFord的NLP工具，里面处理问题的早期方法，都是这类方法。</p>
</li>
<li>
<p>当深度学习在图像识别领域得到快速发展时，人们也开始将深度学习应用于NLP领域。</p>
<p>首先是<strong>Word Embedding</strong>。它可以看成是对『单词特征』提取得到的产物，它也是深度学习的副产物。随后，人们又提出了<strong>Word2Vec</strong>，GloVe等类似预训练的词向量，作为对单词的特征抽象，输入深度学习模型。</p>
<p>其次是<strong>RNN</strong>。RNN使得神经网络具有时序的特性，这种特性非常适合解决NLP这种词与词之间有顺序的问题。但是，深度学习存在梯度消失问题，这在RNN中尤其明显，于是人们提出了<strong>LSTM/GRU</strong>等技术，以解决这种梯度消失问题。在2018年以前，LSTM和GRU在NLP技术中占据了绝对统治地位。</p>
<p>当时RNN有个致命的问题，就是训练慢，无法并行处理，这限制了其发展。于是人们想到了是否可以用CNN替代RNN，以解决这个问题。于是人们提出了用<strong>1D CNN</strong>来解决NLP问题。但是这种方式也有个明显问题，就是丢掉了RNN的时序优势。</p>
<p>除了时序问题，我们还不得不提另外一个关键问题，即<strong>注意力Attention</strong>。Attention最早用于图像识别领域，然后再被用于NLP领域。</p>
<p>有了Attention技术，我们急需新技术既可以保证并行处理，又可以解决时序问题。于是<strong>Transformer</strong>腾空出世。它也是BERT的基础之一。</p>
<p>除此之外，<strong>ELMO</strong>提出的预训练双向语言模型以及<strong>GPT</strong>提出的单向Tranformer也是最新双向Transformer发展的基础，在《Attention Is All You Need》一文，Transformer上升到另外一个高度。</p>
<p><strong>BERT</strong>正是综合以上这些优势提出的方法（预训练 + Fine-Tuning + 双向Transformer，再加上其两个创新点：Masked语言模型、Next Sentence Prediction），可以解决NLP中大部分问题。</p>
</li>
</ol>
<h2 id="参考文献与推荐阅读">参考文献与推荐阅读</h2>
<ol>
<li>国外一牛人Jay Alammar写的 <a href="https://jalammar.github.io/illustrated-word2vec/">图解Word2Vec</a>（如果你打不开英文原文，可看此<a href="https://www.julyedu.com/questions/interview-detail?kp_id=30&amp;cate=NLP&amp;quesId=2968">翻译版</a>）…</li>
<li><a href="https://easyai.tech/ai-definition/encoder-decoder-seq2seq/">Encoder-Decoder 和 Seq2Seq</a></li>
<li>《<a href="https://blog.csdn.net/v_JULY_v/article/details/89894058">如何从RNN起步，一步一步通俗理解LSTM</a>》，July</li>
<li>《<a href="https://blog.csdn.net/malefactor/article/details/78767781">深度学习中的注意力机制(2017版)</a>》，张俊林</li>
<li>Transformer原始论文：<a href="https://arxiv.org/pdf/1706.03762">Attention Is All You Need</a>，相信读完本文再读原始论文就没啥问题了，另 这是<a href="https://www.bilibili.com/video/BV1pu411o7BE/?spm_id_from=333.999.top_right_bar_window_history.content.click&amp;vd_source=02a7bf3dbb14104d4c31a9017ba6bd89">李沐的解读</a></li>
<li>还是Jay Alammar写的<a href="https://jalammar.github.io/illustrated-transformer">图解transformer</a>（如果打不开英文原文，可看：<a href="https://blog.csdn.net/qq_36667170/article/details/124359818">翻译版1</a>、<a href="https://blog.csdn.net/yujianmin1990/article/details/85221271">翻译版2</a>）</li>
<li><a href="https://github.com/aespresso/a_journey_into_math_of_ml/blob/master/03_transformer_tutorial_1st_part/transformer_1.ipynb">a_journey_into_math_of_ml/03_transformer_tutorial_1st_part</a>，这篇关于Transformer的文章，启发我细究权重矩阵如何而来</li>
<li>《<a href="https://www.julyedu.com/questions/interview-detail?kp_id=30&amp;cate=NLP&amp;quesId=3008">说说NLP中的预训练技术发展史：从Word Embedding到Bert模型</a>》，张俊林</li>
<li><a href="http://www.bdpt.net/cn/2019/01/22/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%EF%BC%9A%E5%89%8D%E6%B2%BF%E6%8A%80%E6%9C%AF-%E4%BB%8Eattentiontransformerelmogpt%E5%88%B0bert/">深度学习：前沿技术-从Attention,Transformer,ELMO,GPT到BERT</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/53099098">自然语言处理中的Transformer和BERT</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/132554155">超细节的BERT/Transformer知识点</a></li>
<li><a href="https://link.zhihu.com/?target=https%3A//jalammar.github.io/illustrated-gpt2/">《The Illustrated GPT-2 (Visualizing Transformer Language Models)</a>》（<a href="https://lolitasian.blog.csdn.net/article/details/125529598">翻译版1</a> <a href="https://zhuanlan.zhihu.com/p/79714797">翻译版2</a>）</li>
<li><a href="https://zhuanlan.zhihu.com/p/69290203">Transformer结构及其应用详解–GPT、BERT、MT-DNN、GPT-2</a></li>
<li><a href="https://www.yiyibooks.cn/nlp/bert/main.html">BERT原始论文及与一翻译版本的对照阅读</a>，注意翻译有些小问题，所以建议对照阅读</li>
<li><a href="https://www.julyedu.com/video/play/264/7858">NLP陈博士：从BERT原始论文看BERT的原理及实现</a></li>
<li><a href="https://www.julyedu.com/video/play/264/8444">NLP陈博士：Transformer通用特征提取器</a>，和上面这两个公开课值得仔细学习</li>
<li><a href="https://blog.csdn.net/v_JULY_v/article/details/51812459">CNN笔记：通俗理解卷积神经网络</a>，July</li>
<li><a href="https://blog.csdn.net/v_JULY_v/article/details/102708459">如何通俗理解Word2Vec</a></li>
<li><a href="https://www.julyedu.com/question/big/kp_id/26/ques_id/2921">如何理解反向传播算法BackPropagation</a></li>
<li><a href="https://blog.csdn.net/xiayto/article/details/84730009">词向量经典模型：从word2vec、glove、ELMo到BERT</a></li>
<li>《预训练语言模型》，电子工业出版社</li>
<li><a href="https://blog.csdn.net/yjw123456/article/details/120211601">【理论篇】是时候彻底弄懂BERT模型了(收藏)</a></li>
<li><a href="https://www.julyedu.com/course/getDetail/84">迁移学习和Fine-tuning的一个小课</a></li>
<li><a href="https://www.zhihu.com/question/298203515">如何评价 BERT 模型？</a></li>
<li><a href="https://kexue.fm/archives/4765">《Attention is All You Need》浅读（简介+代码）</a></li>
<li>Transformer的编码实现：<a href="http://nlp.seas.harvard.edu/2018/04/03/attention.html">The Annotated Transformer</a></li>
<li><a href="https://blog.csdn.net/v_JULY_v/article/details/127411638">动手学深度学习 9.2节微调</a></li>
<li><a href="https://www.bilibili.com/video/BV1pu411o7BE/?vd_source=02a7bf3dbb14104d4c31a9017ba6bd89">Transformer论文逐段精读</a></li>
<li><a href="https://www.zhihu.com/question/580810624/answer/2979260071">transformer架构的核心公式其实类似于数学期望，理解起来也不复杂，但为什么这个模型这么强呢？</a></li>
<li><a href="https://www.bilibili.com/video/BV1v3411r78R?p=1&amp;vd_source=02a7bf3dbb14104d4c31a9017ba6bd89">台大李宏毅自注意力机制和Transformer详解</a>(<em>这是其PDF课件：<a href="https://speech.ee.ntu.edu.tw/~hylee/ml/ml2021-course-data/self_v7.pdf">self-attention</a>、<a href="https://speech.ee.ntu.edu.tw/~hylee/ml/ml2021-course-data/seq2seq_v9.pdf">Transformer</a>，这是其视频笔记：<a href="https://blog.csdn.net/baoli8425/article/details/123708620">李宏毅深度学习课程笔记（一）——Self-attention和Transformer</a></em>）</li>
<li><a href="https://blog.csdn.net/v_JULY_v/article/details/130090649">从零实现Transformer的简易版与强大版：从300多行到3000多行</a></li>
</ol>
]]></content>
      <tags>
        <tag>NLP</tag>
      </tags>
  </entry>
  <entry>
    <title>AHP and TOPSIS</title>
    <url>/2023/06/11/mathmodeling1/</url>
    <content><![CDATA[<p>[TOC]</p>
<h1>层次分析法</h1>
<p>The analytic hierarchy process, 简称AHP，<strong>其主要用于解决评价类问题</strong>（例如：选择哪种方案最好、哪位运动员或者员工表现的更优秀）</p>
<p>其实就是以下三个问题：</p>
<ol>
<li>
<p>我们评价的<strong>目标</strong>是什么？</p>
<p>这个所有人的目标都一样，<strong>优选</strong></p>
</li>
<li>
<p>我们为了达到这个目标有哪几种可选的<strong>方案</strong>？</p>
<p>其实就是要对<strong>哪些东西</strong>进行优选</p>
</li>
<li>
<p>评价的准则或者说<strong>指标</strong>是什么？</p>
<p>优选的指标（需要搜索或者根据常识选择指标）</p>
</li>
</ol>
<p>使用打分法解决评价问题，只需要我们补充完成下面这张表格即可：</p>
<p>TABLE1：层次分析法打分表格</p>
<table>
<thead>
<tr>
<th>指标</th>
<th>权重</th>
<th>方案1</th>
<th>方案2…</th>
<th>方案n</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>B</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>C</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>SUM=1</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>权重：根据分治思想确定，想要一次性考虑所有指标往往考虑不周，可以考虑进行两两考虑。比如三种指标需要考虑<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>C</mi><mn>5</mn><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">C_5^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0622159999999998em;vertical-align:-0.24810799999999997em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-2.4518920000000004em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span></span></span></span>次。数学建模中可以使用下面的表进行判断重要程度，并根据表格填写矩阵。</p>
<p>层次结构图</p>
<p><img src="/2023/06/11/mathmodeling1/Snipaste_2023-06-11_00-41-40.png" alt></p>
<p>O-C</p>
<img src="/2023/06/11/mathmodeling1/Snipaste_2023-06-11_00-49-48.png" style="zoom:50%;">
<p>C-P</p>
<p><img src="/2023/06/11/mathmodeling1/Snipaste_2023-06-11_00-54-28.png" alt></p>
<h2 id="构造两类一致性矩阵-数据需要-专家-填写">构造两类一致性矩阵(数据需要“专家”填写)</h2>
<p>TABLE2：层次分析法权重判断标准</p>
<table>
<thead>
<tr>
<th>标度</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>具有同样重要性</td>
</tr>
<tr>
<td>3</td>
<td>一个因素比另一个因素稍微重要</td>
</tr>
<tr>
<td>5</td>
<td>一个因素比另一个因素明显重要</td>
</tr>
<tr>
<td>7</td>
<td>一个因素比另一个因素强烈重要</td>
</tr>
<tr>
<td>9</td>
<td>一个因素比另一个因素极端重要</td>
</tr>
<tr>
<td>2,4,6,8</td>
<td>上述两相邻判断的中值</td>
</tr>
<tr>
<td>倒数</td>
<td>A和B相比如果标度为3，那么B和A相比就是1/3</td>
</tr>
</tbody>
</table>
<h3 id="指标的一致性矩阵-o-c">指标的一致性矩阵（O-C）</h3>
<p>TABLE3：层次分析法正互反矩阵</p>
<table>
<thead>
<tr>
<th></th>
<th>指标A</th>
<th>指标B</th>
<th>指标C</th>
</tr>
</thead>
<tbody>
<tr>
<td>指标A</td>
<td>1</td>
<td>B/A=1/2</td>
<td>C/B=4</td>
</tr>
<tr>
<td>指标B</td>
<td>A/B=2</td>
<td>1</td>
<td>8</td>
</tr>
<tr>
<td>指标C</td>
<td>1/4</td>
<td>B/C=1/8</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>如: 比较A和B的重要程度，A/B略微重要,A/B=2；B和C的重要程度，C/B重要得多，B/C=8，直到填满为止。上面的矩阵称为<strong>正互反矩阵</strong>，也就是<strong>判断矩阵</strong>。</p>
<h3 id="方案的一致性矩阵-c-p">方案的一致性矩阵(C-P)</h3>
<p>同样的方法：填写下面的矩阵</p>
<table>
<thead>
<tr>
<th>指标A</th>
<th>方案1</th>
<th>方案2</th>
<th>方案3</th>
</tr>
</thead>
<tbody>
<tr>
<td>方案1</td>
<td>1</td>
<td>B/A=1/3</td>
<td>C/B=1/5</td>
</tr>
<tr>
<td>方案2</td>
<td>A/B=3</td>
<td>1</td>
<td></td>
</tr>
<tr>
<td>方案3</td>
<td></td>
<td>B/C=5</td>
<td>1</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>指标B</th>
<th>方案1</th>
<th>方案2</th>
<th>方案3</th>
</tr>
</thead>
<tbody>
<tr>
<td>方案1</td>
<td>1</td>
<td>B/A=1</td>
<td>C/B=7</td>
</tr>
<tr>
<td>方案2</td>
<td>A/B=1</td>
<td>1</td>
<td></td>
</tr>
<tr>
<td>方案3</td>
<td></td>
<td>B/C=1/7</td>
<td>1</td>
</tr>
</tbody>
</table>
<h3 id="一致矩阵判断">一致矩阵判断</h3>
<p>在正互反矩阵的基础上存在：</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>12</mn></msub><mo>=</mo><msub><mi>w</mi><mrow><mtext>方案</mtext><mn>1</mn></mrow></msub><mi mathvariant="normal">/</mi><msub><mi>w</mi><mrow><mtext>方案</mtext><mn>2</mn></mrow></msub><mo separator="true">;</mo></mrow><annotation encoding="application/x-tex">w_{12}=w_{方案1}/w_{方案2};</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">方</span><span class="mord cjk_fallback mtight">案</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">方</span><span class="mord cjk_fallback mtight">案</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">;</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>23</mn></msub><mo>=</mo><msub><mi>w</mi><mrow><mtext>方案</mtext><mn>2</mn></mrow></msub><mi mathvariant="normal">/</mi><msub><mi>w</mi><mrow><mtext>方案</mtext><mn>3</mn></mrow></msub></mrow><annotation encoding="application/x-tex">w_{23}=w_{方案 2}/w_{方案3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">方</span><span class="mord cjk_fallback mtight">案</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">方</span><span class="mord cjk_fallback mtight">案</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>13</mn></msub><mo>=</mo><msub><mi>w</mi><mrow><mtext>方案</mtext><mn>1</mn></mrow></msub><mi mathvariant="normal">/</mi><msub><mi>w</mi><mrow><mtext>方案</mtext><mn>3</mn></mrow></msub><mo>=</mo><msub><mi>w</mi><mn>12</mn></msub><mo>∗</mo><msub><mi>w</mi><mrow><mi>w</mi><mn>23</mn></mrow></msub></mrow><annotation encoding="application/x-tex">w_{13}=w_{方案1}/w_{方案3}=w_{12}*w_{w23}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">方</span><span class="mord cjk_fallback mtight">案</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord cjk_fallback mtight">方</span><span class="mord cjk_fallback mtight">案</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.61528em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span><span class="mord mtight">2</span><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>则该矩阵为一致矩阵。简单判断：<strong>一致矩阵的行和列成倍数关系</strong>。</p>
<h3 id="判断方法：一致性检验">判断方法：一致性检验</h3>
<ol>
<li>计算一致性指标CI</li>
<li>查找RI表</li>
<li>计算CR</li>
</ol>
<p>CR=CR/RI。CR&lt;0.1,可以接受判断矩阵（0.1是通过多次蒙特卡洛检验得出）</p>
<h2 id="计算权重">计算权重</h2>
<p>如果判断矩阵通过一致性检验就可以进行这一步。</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mrow><mtext>指</mtext><msub><mtext>标</mtext><mn>1</mn></msub></mrow><mo>=</mo><mtext>指</mtext><msub><mtext>标</mtext><mn>1</mn></msub><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mtext>指</mtext><msub><mtext>标</mtext><mn>1</mn></msub><mo>+</mo><mtext>指</mtext><msub><mtext>标</mtext><mn>2</mn></msub><mo>+</mo><mtext>指</mtext><msub><mtext>标</mtext><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w{指标_1}=指标_1/(指标_1+指标_2+指标_n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord cjk_fallback">指</span><span class="mord"><span class="mord cjk_fallback">标</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">指</span><span class="mord"><span class="mord cjk_fallback">标</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mopen">(</span><span class="mord cjk_fallback">指</span><span class="mord"><span class="mord cjk_fallback">标</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback">指</span><span class="mord"><span class="mord cjk_fallback">标</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">指</span><span class="mord"><span class="mord cjk_fallback">标</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mrow><mtext>方</mtext><msub><mtext>案</mtext><mn>1</mn></msub><mtext>中指</mtext><msub><mtext>标</mtext><mi>A</mi></msub><mtext>权重</mtext></mrow><mo>=</mo><mtext>方</mtext><msub><mtext>案</mtext><mn>1</mn></msub><mtext>中指</mtext><msub><mtext>标</mtext><mi>A</mi></msub><mtext>权重</mtext><mi mathvariant="normal">/</mi><mo stretchy="false">(</mo><mtext>方</mtext><msub><mtext>案</mtext><mn>1</mn></msub><mtext>中指</mtext><msub><mtext>标</mtext><mi>A</mi></msub><mtext>权重</mtext><mo>+</mo><mtext>方</mtext><msub><mtext>案</mtext><mn>2</mn></msub><mtext>中指</mtext><msub><mtext>标</mtext><mi>A</mi></msub><mtext>权重</mtext><mo>+</mo><mtext>方</mtext><msub><mtext>案</mtext><mi>n</mi></msub><mtext>中指</mtext><msub><mtext>标</mtext><mi>A</mi></msub><mtext>权重</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">w{方案_1中指标_A权重}=方案_1中指标_A权重/(方案_1中指标_A权重+方案_2中指标_A权重+方案_n中指标_A权重)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord cjk_fallback">方</span><span class="mord"><span class="mord cjk_fallback">案</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">中</span><span class="mord cjk_fallback">指</span><span class="mord"><span class="mord cjk_fallback">标</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">权</span><span class="mord cjk_fallback">重</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">方</span><span class="mord"><span class="mord cjk_fallback">案</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">中</span><span class="mord cjk_fallback">指</span><span class="mord"><span class="mord cjk_fallback">标</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">权</span><span class="mord cjk_fallback">重</span><span class="mord">/</span><span class="mopen">(</span><span class="mord cjk_fallback">方</span><span class="mord"><span class="mord cjk_fallback">案</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">中</span><span class="mord cjk_fallback">指</span><span class="mord"><span class="mord cjk_fallback">标</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">权</span><span class="mord cjk_fallback">重</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback">方</span><span class="mord"><span class="mord cjk_fallback">案</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">中</span><span class="mord cjk_fallback">指</span><span class="mord"><span class="mord cjk_fallback">标</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">权</span><span class="mord cjk_fallback">重</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">方</span><span class="mord"><span class="mord cjk_fallback">案</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">中</span><span class="mord cjk_fallback">指</span><span class="mord"><span class="mord cjk_fallback">标</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">A</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">权</span><span class="mord cjk_fallback">重</span><span class="mclose">)</span></span></span></span></p>
<p>此时有个问题：就是方案不止一个，每一列都可以获得n个指标权重和方案-指标权重。</p>
<p>因此需要进行平均化，有三种方式（下面均是按行计算）</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>11</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>12</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mrow><mn>1</mn><mi>n</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>21</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mn>22</mn></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mrow><mn>2</mn><mi>n</mi></mrow></msub></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋱</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mi><mi mathvariant="normal">⋮</mi><mpadded height="+0em" voffset="0em"><mspace mathbackground="black" width="0em" height="1.5em"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mrow><mi>n</mi><mn>2</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mo lspace="0em" rspace="0em">⋯</mo></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>a</mi><mrow><mi>n</mi><mi>n</mi></mrow></msub></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">A=\left[\begin{array}{cccc}{a_{11}} &amp; {a_{12}} &amp; {\cdots} &amp; {a_{1 n}} \\{a_{21}} &amp; {a_{22}} &amp; {\cdots} &amp; {a_{2 n}} \\{\vdots} &amp; {\vdots} &amp; {\ddots} &amp; {\vdots} \\{a_{n 1}} &amp; {a_{n 2}} &amp; {\cdots} &amp; {a_{n n}}\end{array}\right]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:5.459999999999999em;vertical-align:-2.4799999999999995em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎣</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎢</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎡</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.64em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="mord"><span class="minner">⋯</span></span></span></span><span style="top:-4.44em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="mord"><span class="minner">⋯</span></span></span></span><span style="top:-2.5799999999999996em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="mord"><span class="minner">⋱</span></span></span></span><span style="top:-1.3800000000000006em;"><span class="pstrut" style="height:3.5em;"></span><span class="mord"><span class="mord"><span class="minner">⋯</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.9799999999999995em;"><span style="top:-5.8275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-4.6275em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-2.7674999999999996em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord">⋮</span><span class="mord rule" style="border-right-width:0em;border-top-width:1.5em;bottom:0em;"></span></span></span></span></span><span style="top:-1.5675000000000006em;"><span class="pstrut" style="height:3.6875em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4799999999999995em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.953995em;"><span style="top:-1.3499850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎦</span></span></span><span style="top:-2.4999850000000006em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.0959850000000007em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.6919850000000003em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-3.712975em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎥</span></span></span><span style="top:-4.953995em;"><span class="pstrut" style="height:3.1550000000000002em;"></span><span class="delimsizinginner delim-size4"><span>⎤</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.4500349999999997em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="算数平均化">算数平均化</h3>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ω</mi><mi>i</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mfrac><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>a</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub></mrow></mfrac><mtext>（</mtext><mi>i</mi><mo>=</mo><mn>1</mn><mtext>，</mtext><mn>2</mn><mtext>，</mtext><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi>n</mi><mtext>）</mtext></mrow><annotation encoding="application/x-tex">\omega_{i}=\frac{1}{n} \sum_{j=1}^{n} \frac{a_{i j}}{\sum_{k=1}^{n} a_{k j}}（i=1，2，...n）
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.305708em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.994002em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord cjk_fallback">（</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord cjk_fallback">，</span><span class="mord">2</span><span class="mord cjk_fallback">，</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord mathdefault">n</span><span class="mord cjk_fallback">）</span></span></span></span></span></p>
<h3 id="几何平均化">几何平均化</h3>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ω</mi><mi>i</mi></msub><mo>=</mo><mfrac><msup><mrow><mo fence="true">(</mo><munderover><mo>∏</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo fence="true">)</mo></mrow><mfrac><mn>1</mn><mi>n</mi></mfrac></msup><mrow><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msup><mrow><mo fence="true">(</mo><munderover><mo>∏</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>a</mi><mrow><mi>k</mi><mi>j</mi></mrow></msub><mo fence="true">)</mo></mrow><mfrac><mn>1</mn><mi>n</mi></mfrac></msup></mrow></mfrac><mo separator="true">,</mo><mspace width="1em"><mo stretchy="false">(</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mspace></mrow><annotation encoding="application/x-tex">\omega_{i}=\frac{\left(\prod_{j=1}^{n} a_{i j}\right)^{\frac{1}{n}}}{\sum_{k=1}^{n}\left(\prod_{j=1}^{n} a_{k j}\right)^{\frac{1}{n}}}, \quad(i=1,2, \cdots, n)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:4.56788em;vertical-align:-2.03394em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.53394em;"><span style="top:-2.1100000000000003em;"><span class="pstrut" style="height:3.49392em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.49392em;"><span style="top:-3.9029em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443142857142858em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.72392em;"><span class="pstrut" style="height:3.49392em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.53394em;"><span class="pstrut" style="height:3.49392em;"></span><span class="mord"><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.49392em;"><span style="top:-3.9029em;margin-right:0.05em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mopen nulldelimiter sizing reset-size3 size6"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8443142857142858em;"><span style="top:-2.656em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-3.2255000000000003em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line mtight" style="border-bottom-width:0.049em;"></span></span><span style="top:-3.384em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.344em;"><span></span></span></span></span></span><span class="mclose nulldelimiter sizing reset-size3 size6"></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.03394em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:1em;"></span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></span></p>
<h3 id="特征值法">特征值法</h3>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>det</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>A</mi><mo>−</mo><mi>λ</mi><mi>I</mi><mo stretchy="false">)</mo><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\det(A - \lambda I) = 0
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">det</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">λ</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">u</mi><mo>=</mo><mfrac><mi mathvariant="bold">v</mi><mrow><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi><mi mathvariant="bold">v</mi><mi mathvariant="normal">∣</mi><mi mathvariant="normal">∣</mi></mrow></mfrac><mo>=</mo><mfrac><mn>1</mn><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>v</mi><mi>i</mi><mn>2</mn></msubsup></mrow></msqrt></mfrac><mo stretchy="false">(</mo><msub><mi>v</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>v</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>v</mi><mi>n</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathbf{u} = \frac{\mathbf{v}}{||\mathbf{v}||} = \frac{1}{\sqrt{\sum_{i=1}^n v_i^2}}(v_1, v_2, \dots, v_n)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">u</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.12144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∣</span><span class="mord">∣</span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="mord">∣</span><span class="mord">∣</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.45144em;vertical-align:-1.13em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.1727090000000002em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.937291em;"><span class="svg-align" style="top:-3.2em;"><span class="pstrut" style="height:3.2em;"></span><span class="mord" style="padding-left:1em;"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7959080000000001em;"><span style="top:-2.4231360000000004em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.27686399999999994em;"><span></span></span></span></span></span></span></span></span><span style="top:-2.897291em;"><span class="pstrut" style="height:3.2em;"></span><span class="hide-tail" style="min-width:1.02em;height:1.28em;"><svg width="400em" height="1.28em" viewbox="0 0 400000 1296" preserveaspectratio="xMinYMin slice"><path d="M263,681c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l0 -0
c4.7,-7.3,11,-11,19,-11
H40000v40H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M1001 80h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.302709em;"><span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.13em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>怎样吹牛：以往的论文利用层次分析法解决实际问题时，都是采用其中某一种方法求权重，而不同的计算方法可能会导致结果有所偏差。为了保证结果的稳健性，本文采用了三种方法分别求出了权重，再根据得到的权重矩阵计算各方案的得分，并进行排序和综合分析，这样避免了采用单一方法所产生的偏差，得出的结论将更全面、更有效。</p>
<h2 id="得出结论">得出结论</h2>
<p>指标权重*方案权重，然后求和，得到权重排名</p>
<p><strong>改进：使用秩和检验判断排名是否有有意义</strong></p>
<h2 id="层次分析法的一些局限性">层次分析法的一些局限性</h2>
<p>评价的<strong>决策层（方案层）不能太多</strong>，太多的话n会很大，判断矩阵和一致矩阵差异可能会很大，不能通过一致性检验，n最多为15。</p>
<p>决策层中无法利用已知数据</p>
<h1>TOPSIS分析法</h1>
<p>我们知道了AHP有一些天然的不足，就是当决策层太多、或者有现有数据的情况下，如何利用数据内在特征进行建模，就需要新的方法。针对AHP的改进之一就是TOPSIS法。</p>
<p>C.L.Hwang和K.Yoon于1981年首次提出TOPSIS (Technique for Order Preference by Similarity to an Ideal Solution)，可翻译为逼近理想解排序法，国内常简称为<strong>优劣解距离法</strong>。TOPSIS 法是一种常用的综合评价方法，能充分利用原始数据的信息，其结果能精确地反映各评价方案之间的差距。</p>
<h2 id="统一指标类型">统一指标类型</h2>
<p>指标正向化，将负向指标转换为正向（如果优化指标为越大越好）；反向同理</p>
<h3 id="极小型">极小型</h3>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo>−</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">max-x
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span></span></p>
<table>
<thead>
<tr>
<th>指标名称</th>
<th>指标特点</th>
<th>例子</th>
</tr>
</thead>
<tbody>
<tr>
<td>极大型（效益型）指标</td>
<td>越大（多）越好</td>
<td>成绩、GDP增速、利润</td>
</tr>
<tr>
<td>极小型（成本型）指标</td>
<td>越小（少）越好</td>
<td>费用、污染程度</td>
</tr>
<tr>
<td>中间型指标</td>
<td>越接近某个值越好</td>
<td>水质量的PH值</td>
</tr>
<tr>
<td>区间型指标</td>
<td>落在某个区间最好</td>
<td>体温、营养物的量</td>
</tr>
</tbody>
</table>
<h3 id="中间型">中间型</h3>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mi>max</mi><mo>⁡</mo><mrow><mo fence="true">{</mo><mrow><mo fence="true">∣</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>x</mi><mtext>best</mtext></msub><mo fence="true">∣</mo></mrow><mo fence="true">}</mo></mrow><mo separator="true">,</mo><msub><mover accent="true"><mi>x</mi><mo>~</mo></mover><mi>i</mi></msub><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mo fence="true">∣</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>x</mi><mtext>best</mtext></msub><mo fence="true">∣</mo></mrow><mi>M</mi></mfrac></mrow><annotation encoding="application/x-tex">M=\max \left\{\left|x_{i}-x_{\text {best}}\right|\right\}, \tilde{x}_{i}=1-\frac{\left|x_{i}-x_{\text {best}}\right|}{M}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">best</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mclose delimcenter" style="top:0em;">}</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6678599999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">M</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">best</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h3 id="区间型">区间型</h3>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mi>max</mi><mo>⁡</mo><mrow><mo fence="true">{</mo><mi>a</mi><mo>−</mo><mi>min</mi><mo>⁡</mo><mrow><mo fence="true">{</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">}</mo></mrow><mo separator="true">,</mo><mi>max</mi><mo>⁡</mo><mrow><mo fence="true">{</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">}</mo></mrow><mo>−</mo><mi>b</mi><mo fence="true">}</mo></mrow><mspace linebreak="newline"></mspace><msub><mover accent="true"><mi>x</mi><mo>~</mo></mover><mi>i</mi></msub><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.15999999999999992em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo>−</mo><mfrac><mrow><mi>a</mi><mo>−</mo><mi>x</mi></mrow><mi>M</mi></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>&lt;</mo><mi>a</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mi>a</mi><mo>≤</mo><mi>x</mi><mo>≤</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1</mn><mo>−</mo><mfrac><mrow><mi>x</mi><mo>−</mo><mi>b</mi></mrow><mi>M</mi></mfrac></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo stretchy="false">(</mo><mi>x</mi><mo>&gt;</mo><mi>b</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">M=\max \left\{a-\min \left\{x_{i}\right\}, \max \left\{x_{i}\right\}-b\right\}\\
\tilde{x}_{i}=\left\{\begin{array}{ll}
{1-\frac{a-x}{M}} &amp; {(x&lt;a)} \\
{1} &amp; { (a \leq x \leq b)} \\
{1-\frac{x-b}{M}} &amp; {(x&gt;b)}
\end{array}\right.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">min</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">}</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">max</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">}</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">b</span><span class="mclose delimcenter" style="top:0em;">}</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8178599999999999em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6678599999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3.35em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.640108em;vertical-align:-1.5700540000000003em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05002em;"><span style="top:-2.49999em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.20499em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-3.15001em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.00501em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎪</span></span></span><span style="top:-4.30002em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55002em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.070054em;"><span style="top:-4.230054em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.802331em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span><span style="top:-3.0300539999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">1</span></span></span></span><span style="top:-1.7899459999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8801079999999999em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mbin mtight">−</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5700540000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.070054em;"><span style="top:-4.230054em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span><span style="top:-3.0300539999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span><span style="top:-1.7899459999999998em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5700540000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h2 id="消除量纲-标准化">消除量纲(标准化)</h2>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mi mathvariant="normal">/</mi><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup></mrow></msqrt></mrow><annotation encoding="application/x-tex">z_{ij}=a_{ij}/ \sqrt{\sum_{i=1}^{n}a_{ij}^{2} }
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.1568160000000005em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8791470000000006em;"><span class="svg-align" style="top:-5.116816em;"><span class="pstrut" style="height:5.116816em;"></span><span class="mord" style="padding-left:1.056em;"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.795908em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.0448000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.4129719999999999em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.8391470000000005em;"><span class="pstrut" style="height:5.116816em;"></span><span class="hide-tail" style="min-width:0.742em;height:3.196816em;"><svg width="400em" height="3.196816em" viewbox="0 0 400000 3196" preserveaspectratio="xMinYMin slice"><path d="M702 80H40000040
H742v3062l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1
h-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170
c-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667
219 661 l218 661zM702 80H400000v40H742z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span></span></span></span></span></p>
<p><strong>标准化的方法有很多种</strong>，其主要目的就是去除量纲的影响，未来我们还可能见到更多 种的标准化方法，例如：(x‐x的均值)/x的标准差；<strong>具体选用哪一种标准化的方法在多数情况下 并没有很大的限制</strong></p>
<h3 id="对于矩阵"><strong>对于矩阵</strong></h3>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">A</mi><mrow><mi>n</mi><mi>o</mi><mi>r</mi><mi>m</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi mathvariant="bold">A</mi><mo>−</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">A</mi><mo stretchy="false">)</mo></mrow><mrow><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">A</mi><mo stretchy="false">)</mo><mo>−</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">A</mi><mo stretchy="false">)</mo></mrow></mfrac><mspace linebreak="newline"></mspace><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">(</mo><mi mathvariant="bold">A</mi><mo stretchy="false">)</mo><mo>=</mo><mi>m</mi><mi>i</mi><msub><mi>n</mi><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>m</mi><mo separator="true">;</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mi>n</mi></mrow></msub><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathbf{A}_{norm} = \frac{\mathbf{A}-\min(\mathbf{A})}{\max(\mathbf{A})-\min(\mathbf{A})}\\min(\mathbf{A}) = min_{i=1,2,\cdots,m;j=1,2,\cdots,n} a_{ij}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83611em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">max</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">A</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">A</span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathbf">A</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">A</span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">A</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.9456279999999999em;vertical-align:-0.286108em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span><span class="mpunct mtight">,</span><span class="minner mtight">⋯</span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">m</span><span class="mpunct mtight">;</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span><span class="mpunct mtight">,</span><span class="minner mtight">⋯</span><span class="mspace mtight" style="margin-right:0.19516666666666668em;"></span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">A</span></span></span></span></span>是一个大小为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mo>×</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">m\times n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>的矩阵，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">a_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>表示矩阵<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">A</span></span></span></span></span>中第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>行、第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span>列的元素。</p>
<h3 id="距离">距离</h3>
<p>向量到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\min(\mathbf{A})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">A</span></span><span class="mclose">)</span></span></span></span>的距离可以使用向量范数来计算。具体地，可以使用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">L^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>范数或<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">L^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span>范数来计算向量到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\min(\mathbf{A})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">A</span></span><span class="mclose">)</span></span></span></span>的距离。</p>
<p>假设待归一化的向量为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">v</mi></mrow><annotation encoding="application/x-tex">\mathbf{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span></span></span>，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\min(\mathbf{A})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">A</span></span><span class="mclose">)</span></span></span></span>是待归一化矩阵<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">A</mi></mrow><annotation encoding="application/x-tex">\mathbf{A}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">A</span></span></span></span></span>中的最小值，则向量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">v</mi></mrow><annotation encoding="application/x-tex">\mathbf{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span></span></span>到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\min(\mathbf{A})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">A</span></span><span class="mclose">)</span></span></span></span>的距离可以表示为：</p>
<ol>
<li>使用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">L^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>范数（欧几里得范数）：</li>
</ol>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∥</mi><mi mathvariant="bold">v</mi><mo>−</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">A</mi><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∥</mi><mn>2</mn></msub><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo>−</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">A</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">\|\mathbf{v}-\min(\mathbf{A})\|_2=\sqrt{\sum_{i=1}^{n}(v_i-\min(\mathbf{A}))^2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">A</span></span><span class="mclose">)</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.1568160000000005em;vertical-align:-1.277669em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8791470000000006em;"><span class="svg-align" style="top:-5.116816em;"><span class="pstrut" style="height:5.116816em;"></span><span class="mord" style="padding-left:1.056em;"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">A</span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.8391470000000005em;"><span class="pstrut" style="height:5.116816em;"></span><span class="hide-tail" style="min-width:0.742em;height:3.196816em;"><svg width="400em" height="3.196816em" viewbox="0 0 400000 3196" preserveaspectratio="xMinYMin slice"><path d="M702 80H40000040
H742v3062l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1
h-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170
c-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667
219 661 l218 661zM702 80H400000v40H742z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">v_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>表示向量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="bold">v</mi></mrow><annotation encoding="application/x-tex">\mathbf{v}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.44444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span></span></span></span>的第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>个元素，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>是向量的长度。</p>
<ol start="2">
<li>使用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>L</mi><mn>1</mn></msup></mrow><annotation encoding="application/x-tex">L^1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">L</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span>范数（曼哈顿范数）</li>
</ol>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∥</mi><mi mathvariant="bold">v</mi><mo>−</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">A</mi><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∥</mi><mn>1</mn></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant="normal">∣</mi><msub><mi>v</mi><mi>i</mi></msub><mo>−</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">A</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">\|\mathbf{v}-\min(\mathbf{A})\|_1=\sum_{i=1}^{n}|v_i-\min(\mathbf{A})|
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">A</span></span><span class="mclose">)</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∣</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">A</span></span><span class="mclose">)</span><span class="mord">∣</span></span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∣</mi><mi>x</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">|x|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mord">∣</span></span></span></span>表示<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>的绝对值。</p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">max(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mclose">)</span></span></span></span>以及<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>−</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">v-max(A)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">(</span><span class="mord mathdefault">A</span><span class="mclose">)</span></span></span></span>同上</p>
<p><strong>实际中，一般使用欧氏距离</strong></p>
<h3 id="带有权重的距离">带有权重的距离</h3>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">∥</mi><mi mathvariant="bold">v</mi><mo>−</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">A</mi><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∥</mi><mn>2</mn></msub><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><mo stretchy="false">(</mo><msub><mi>v</mi><mi>i</mi></msub><mo>−</mo><mi>min</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi mathvariant="bold">A</mi><mo stretchy="false">)</mo><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding="application/x-tex">\|\mathbf{v}-\min(\mathbf{A})\|_2=\sqrt{\sum_{i=1}^{n}w_i(v_i-\min(\mathbf{A}))^2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∥</span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">A</span></span><span class="mclose">)</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.1568160000000005em;vertical-align:-1.277669em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8791470000000006em;"><span class="svg-align" style="top:-5.116816em;"><span class="pstrut" style="height:5.116816em;"></span><span class="mord" style="padding-left:1.056em;"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">min</span><span class="mopen">(</span><span class="mord"><span class="mord mathbf">A</span></span><span class="mclose">)</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.8391470000000005em;"><span class="pstrut" style="height:5.116816em;"></span><span class="hide-tail" style="min-width:0.742em;height:3.196816em;"><svg width="400em" height="3.196816em" viewbox="0 0 400000 3196" preserveaspectratio="xMinYMin slice"><path d="M702 80H40000040
H742v3062l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1
h-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170
c-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667
219 661 l218 661zM702 80H400000v40H742z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span></span></span></span></span></p>
<p>其中的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>就是上节提到的层次分析法确定的权重</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_{j=1}^{m}w_{i}=1
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span></p>
<p>此外还可以根据熵权法确定权重，见3.0</p>
<h2 id="归一化">归一化</h2>
<p>反映出不同组之间，数据的排序相同时，数值变动带来的差异，同时压缩到0-1。</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>x</mi><mo>−</mo><mn>0</mn></mrow><mrow><mn>100</mn><mo>−</mo><mi>x</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{x-0}{100-x}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.09077em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mi>x</mi><mo>−</mo><mi>m</mi><mi>i</mi><mi>n</mi></mrow><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo>−</mo><mi>m</mi><mi>i</mi><mi>n</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><mi>x</mi><mo>−</mo><mi>m</mi><mi>i</mi><mi>n</mi></mrow><mrow><mo stretchy="false">(</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>−</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo stretchy="false">)</mo></mrow></mfrac><mspace linebreak="newline"></mspace></mrow><annotation encoding="application/x-tex">\frac{x-min}{max-min}=\frac{x-min}{(max-x)+(x-min)}\\
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.10585em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3365200000000002em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.27252em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3365200000000002em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span></span></span></span></p>
<p>公式（14）中max、min的两个数被压缩成1和0.不会随数值变动</p>
<h1>熵权法</h1>
<p>指标的<strong>变异程度</strong>越小，所反映的信息量也越少，其对应的权值也应该越低。怎么衡量事情发生的可能性大小？<strong>概率</strong></p>
<p>1948年，克劳德·爱尔伍德·香农将热力学中的熵引入信息论，所以也被称为香农熵 (Shannon entropy)，信息熵 (information entropy)</p>
<h2 id="自信息量-self-information">自信息量（self-information）</h2>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">I(x)=-log(p(x_i))
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></span></p>
<p><img src="/2023/06/11/mathmodeling1/self-information.png" alt></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">I(X_0)=-log(0.9)=0.152003</span><br><span class="line">I(X_1)=-log(0.1)=3.321928</span><br></pre></td></tr></table></figure>
<p><strong>越有可能发生的事情，信息量越少，越不可能发生的事情，信息量就越多。</strong></p>
<h2 id="度量信息量的大小">度量信息量的大小</h2>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>p</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mi>log</mi><mo>⁡</mo><mi>p</mi><mrow><mo fence="true">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">H(X)=-\sum_{i=1}^{n} p\left(x_{i}\right) \log p\left(x_{i}\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">H(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span>表示随机变量<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>的熵，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>是<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span></span>的取值个数，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><msub><mi>x</mi><mi>i</mi></msub></msub></mrow><annotation encoding="application/x-tex">p_{x_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68066em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139199999999997em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span></span></span></span>表示事件<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>发生的概率。</p>
<p>在最优编码中，为了使所有信息的平均编码长度最小，通常会为出现频率较大的字符赋予较短的编码长度。如在文本中则可以表示字符x在整个语料库中出现的频率为P(x)，则编码长度应为：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><mfrac><mn>1</mn><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log (\frac{1}{P(x)})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.365108em;vertical-align:-0.52em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">P</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span>，当且仅当等概率时取得最大值：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><msup><mi>n</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">ln^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span></p>
<p>概率</p>
<hr>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mfrac><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">p_{ij}=\frac{x_{ij}}{\sum_{i=1}^n  x_{ij}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.101562em;vertical-align:-0.994002em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.305708em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.994002em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>熵值</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>j</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mfrac><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo stretchy="false">)</mo><mi>ln</mi><mo>⁡</mo><mfrac><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">E_j=\sum_{i=1}^n(\frac{x_{ij}}{\sum_{i=1}^n x_{ij}})\ln\frac{x_{ij}}{\sum_{i=1}^n x_{ij}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.305708em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.994002em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.305708em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.994002em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>信息熵</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mi>j</mi></msub><mo>=</mo><mo>−</mo><mfrac><mn>1</mn><mrow><mi>ln</mi><mo>⁡</mo><mi>n</mi></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mfrac><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac><mo stretchy="false">)</mo><mi>ln</mi><mo>⁡</mo><mfrac><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">H_j=-\frac{1}{\ln n}\sum_{i=1}^n(\frac{x_{ij}}{\sum_{i=1}^n x_{ij}})\ln\frac{x_{ij}}{\sum_{i=1}^n x_{ij}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.305708em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.994002em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">ln</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.305708em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.994002em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>表示评价指标矩阵中第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>个决策对象的第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span>个评价指标值，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>为评价指标的个数。</p>
<p>信息效应值</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>j</mi></msub><mo>=</mo><mfrac><mrow><mn>1</mn><mo>−</mo><msub><mi>H</mi><mi>j</mi></msub></mrow><mrow><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>E</mi><mi>j</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">w_j=\frac{1-H_j}{ln(n)-\sum_{i=1}^n E_j}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.3543320000000003em;vertical-align:-0.994002em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.305708em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.08125em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.994002em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span>为常数，取值一般为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi><mi>n</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">ln(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></p>
<p><strong>个人建议：熵权法的概率改进方法，使用正态化之后的标准差替代，欢迎合作</strong></p>
]]></content>
      <tags>
        <tag>Mathmodeling</tag>
      </tags>
  </entry>
  <entry>
    <title>Interpolation and Fitting</title>
    <url>/2023/06/11/mathmodeling2/</url>
    <content><![CDATA[<p>[TOC]</p>
<h1>插值法</h1>
<p>建模时，常常需要根据已知的函数点进行数据、模型的处理和分析，而有时候现有的数据是极少的，不足以支撑分析的进行，这时就需要使用一些数学的方法，“<strong>模拟产生”一些新的但又比较靠谱的值</strong>来满足需求，这就是插值的作用。</p>
<h2 id="插值问题">插值问题</h2>
<p>已知f(x)上n个点的坐标，需要插入一个新的坐标。思路：构造函数y=p(x)，使得所有n+1个点，都在p(x)上，求p(x)的方法即为插值法。</p>
<h2 id="拉格朗日插值">拉格朗日插值</h2>
<p>在数值分析中，拉格朗日插值法是以法国十八世纪数学家约瑟夫∙路易斯∙拉格朗日命名的一种多项式插值方法。在若干个不同的地方得到相应的观测值，拉格朗日插值法可以找到一个多项式，其恰好在各个观测的点取到观测到的值</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>y</mi><mi>i</mi></msub><mfrac><mrow><munder><mo>∏</mo><mrow><mi>j</mi><mo mathvariant="normal">≠</mo><mi>i</mi></mrow></munder><mo stretchy="false">(</mo><mi>x</mi><mtext>−</mtext><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munder><mo>∏</mo><mrow><mi>j</mi><mo mathvariant="normal">≠</mo><mi>i</mi></mrow></munder><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mtext>−</mtext><msub><mi>x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">f(x)=∑_{i=1}^n\limits y_i\frac{∏_{j≠i}(x−x_j)}{∏_{j≠i}(x_i−x_j)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.575818em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.18639799999999984em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="rlap mtight"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel mtight"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">−</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.825818em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∏</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.18639799999999984em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="rlap mtight"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel mtight"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.43581800000000004em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mord">−</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1218180000000002em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h3 id="runge-phenomenon-龙格现象">runge phenomenon(龙格现象)</h3>
<p>拉格朗日插值的问题：一般来说函数描述越精确，要求的x次数越高，拉格朗日插值中，次数越高误差越小吗（越精确吗）？</p>
<p><img src="/2023/06/11/mathmodeling2/Screen_Shot_2022-03-25.png" alt></p>
<p>高次插值会产生<strong>龙格现象</strong>，即在两端处波动极大,产生明显的震荡。<strong>在不熟悉曲线运动趋势的前提下，不要轻易使用高次插值</strong>。</p>
<h2 id="牛顿插值法">牛顿插值法</h2>
<h3 id="差商">差商</h3>
<p>和拉格朗日插值法不同，在加入新的次幂的情况下，牛顿插值法不需要重新计计算，也就是说有<strong>继承性</strong>。</p>
<p>实际问题中，不仅要求插值函数与被插值函数在所有节点处有相同的函数值，它也需要在一个或全部节点上插值多项式与被插函数有相同的低阶甚至高阶的导数值。上面两种插值都做不到。也就是说：二者都存在runge phenomenon，也不能全面反映被插值函数的性态（高阶导数），通俗讲就是不平滑。建模中不常用。</p>
<h2 id="埃尔米特插值法-hermite">埃尔米特插值法（hermite）</h2>
<p>基于上述两种插值法的缺点，人们发明出了hermite多项式，它可以确定唯一一个不超过2n+1次幂的多项式，完全拟合所有插值点。当然runge phenomenon也更严重。</p>
<h2 id="分段插值">分段插值</h2>
<p>在没有足够信息的情况下，我们很可能找不到低次幂多项式穿过所有的点，而次幂太高会产生runge phenomenon。自然地，我们可以想到限制次幂，使之在小范围内达到高度拟合效果，因此，要做的就是分段。目前常用的插值法有</p>
<p><strong>分段二次插值（分段抛物插值）</strong></p>
<p><strong>分段三次埃尔米特插值（最常用）</strong></p>
<h2 id="三次样条插值">三次样条插值</h2>
<p>添加条件：二阶连续可微</p>
<p>好处：相比于三次埃尔米特插值更加光滑</p>
<h2 id="其它插值">其它插值</h2>
<h3 id="n维数据的插值">n维数据的插值</h3>
<h3 id="三角插值">三角插值</h3>
<h1>拟合算法</h1>
<h2 id="插值和拟合">插值和拟合</h2>
<p>拟合需要很多样本点，样本点不需要经过所有的点，插值需要经过所有已知的点。数据的维度过高，插值法会产生龙格现象，精度下降。拟合法可以很好的解决这个问题。</p>
<p>与插值问题不同，在拟合问题中不需要曲线一定经过给定的点。<strong>拟合问题的目标是寻求一个函数（曲线），使得该曲线在某种准则下与所有的数据点最为接近</strong>，即曲线拟合的最好（最小化损失函数）。</p>
<h2 id="最小二乘法">最小二乘法</h2>
<p>如何判断接近程度。基本想法是：我们需要构造一个表示距离的函数，求导数和极值点。</p>
<p>假设有<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span>个样本数据<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo stretchy="false">)</mo><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>m</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>m</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_1,y_1),(x_2,y_2),\ldots,(x_m,y_m)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>表示自变量的值，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>表示因变量的值。线性模型的表达式为：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>β</mi><mn>0</mn></msub><mo>+</mo><msub><mi>β</mi><mn>1</mn></msub><mi>x</mi></mrow><annotation encoding="application/x-tex">y=\beta_0+\beta_1 x
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathdefault">x</span></span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\beta_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>分别是截距和斜率。</p>
<p>因此我们可以构造形如下面的式子</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><munder><mo><mi mathvariant="normal">argmin</mi><mo>⁡</mo></mo><mrow><msub><mi>β</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>β</mi><mn>1</mn></msub></mrow></munder></mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mi>β</mi><mn>0</mn></msub><mo>−</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>x</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\underset{\beta_0,\beta_1}{\operatorname{argmin}} \sum_{i=1}^{m}(y_i-\beta_0-\beta_1 x_i)^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6678600000000001em;"><span style="top:-2.153452em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.05278em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.05278em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mop"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0826559999999998em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>通过优化拟合模型的参数<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\beta_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，使得所有样本数据点到拟合直线的垂直距离的平方和最小。垂直距离即为样本数据点的因变量值与拟合直线上对应<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>值的预测值之间的差值。</p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mi>β</mi><mn>0</mn></msub><mo>−</mo><msub><mi>β</mi><mn>1</mn></msub><msub><mi>x</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">\sum_{i=1}^{m}(y_i-\beta_0-\beta_1 x_i)^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>表示所有样本数据点到拟合直线的垂直距离的平方和，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><munder><mo><mi mathvariant="normal">argmin</mi><mo>⁡</mo></mo><mrow><msub><mi>β</mi><mn>0</mn></msub><mo separator="true">,</mo><msub><mi>β</mi><mn>1</mn></msub></mrow></munder></mi></mrow><annotation encoding="application/x-tex">\underset{\beta_0,\beta_1}{\operatorname{argmin}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.750516em;vertical-align:-1.0826559999999998em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.6678600000000001em;"><span style="top:-2.153452em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.05278em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31731428571428577em;"><span style="top:-2.357em;margin-left:-0.05278em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mop"><span class="mord mathrm">a</span><span class="mord mathrm">r</span><span class="mord mathrm" style="margin-right:0.01389em;">g</span><span class="mord mathrm">m</span><span class="mord mathrm">i</span><span class="mord mathrm">n</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.0826559999999998em;"><span></span></span></span></span></span></span></span></span></span>表示对<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\beta_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\beta_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>进行最小化操作，使得目标函数取得最小值。机器学习中，该项也叫损失函数。</p>
<h3 id="为什么是二乘法">为什么是二乘法</h3>
<p>也就是说：为什么要取平方而不是差值、绝对值、或者更高次幂？</p>
<ol>
<li>首先，取差值会导致正负抵消达不到产生“距离”的目的。</li>
<li>有绝对值，不容易求导，计算比较复杂</li>
<li>取得三次幂以及更高的基数次幂同差值一样，会抵消。</li>
<li>取四次幂以及更高的偶数次幂会造成极值点的权重过高，拟合效果变差</li>
</ol>
<h3 id="最优解求法">最优解求法</h3>
<p>最小二乘法的优化问题可以通过求解目标函数的偏导数，得到最优解的闭式解表达式：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><mfrac><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>x</mi><mo>ˉ</mo></mover><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>y</mi><mo>ˉ</mo></mover><mo stretchy="false">)</mo></mrow><mrow><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>x</mi><mo>ˉ</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi>β</mi><mn>0</mn></msub><mo>=</mo><mover accent="true"><mi>y</mi><mo>ˉ</mo></mover><mo>−</mo><msub><mi>β</mi><mn>1</mn></msub><mover accent="true"><mi>x</mi><mo>ˉ</mo></mover></mrow></mstyle></mtd></mtr></mtable></mrow><mtext>​</mtext></mrow><annotation encoding="application/x-tex">\begin{cases}\beta_1=\frac{\sum_{i=1}^{m}(x_i-\bar{x})(y_i-\bar{y})}{\sum_{i=1}^{m}(x_i-\bar{x})^2}\\ \beta_0=\bar{y}-\beta_1\bar{x}\end{cases}​
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.0700140000000005em;vertical-align:-1.2850070000000005em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.785007em;"><span style="top:-3.785007em;"><span class="pstrut" style="height:3.0600069999999997em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.060007em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7046857142857144em;"><span style="top:-2.1785614285714283em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.8971428571428572em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32143857142857146em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7463142857142857em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5350070000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7385428571428572em;"><span style="top:-2.1785614285714283em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32143857142857146em;"><span></span></span></span></span></span></span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord accent mtight"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord mtight">ˉ</span></span></span></span></span></span></span><span class="mclose mtight">)</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:-0.03588em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span><span class="mbin mtight">−</span><span class="mord accent mtight"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord mtight">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5700069999999999em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-2.2069999999999994em;"><span class="pstrut" style="height:3.0600069999999997em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord">ˉ</span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2850070000000005em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">​</span></span></span></span></span></p>
<p>其中，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>x</mi><mo>ˉ</mo></mover><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\bar{x}=\frac{1}{m}\sum_{i=1}^{m}x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.56778em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>y</mi><mo>ˉ</mo></mover><mo>=</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></msubsup><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\bar{y}=\frac{1}{m}\sum_{i=1}^{m}y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7622199999999999em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.845108em;"><span style="top:-2.6550000000000002em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>分别表示自变量和因变量的均值。</p>
<h3 id="拟合优度">拟合优度</h3>
<p>判断拟合的好坏。我们可以使用SSE来判断。总体来说：SSE越小越好，但是实际中存在量纲的问题，因此需要改造一下，归一化，使用拟合优度<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">R^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>,如下：</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mfrac><mrow><mi>S</mi><mi>S</mi><mi>R</mi></mrow><mrow><mi>S</mi><mi>S</mi><mi>T</mi></mrow></mfrac><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>i</mi><mo>−</mo><mover accent="true"><mi>y</mi><mo>ˉ</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>y</mi><mo>ˉ</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">R^2=\frac{SSR}{SST}=\frac{\sum_{i=1}^{n}(\hat{y}i-\bar{y})^2}{\sum_{i=1}^{n}(y_i-\bar{y})^2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.49782em;vertical-align:-0.994002em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5038179999999999em;"><span style="top:-2.305708em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6897100000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.994002em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mi>S</mi><mi>S</mi><mi>E</mi></mrow><mrow><mi>S</mi><mi>S</mi><mi>T</mi></mrow></mfrac><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>y</mi><mo>^</mo></mover><mi>i</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>y</mi><mo>ˉ</mo></mover><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">R^2=1-\frac{SSE}{SST}=1-\frac{\sum_{i=1}^{n}(y_i-\hat{y}i)^2}{\sum_{i=1}^{n}(y_i-\bar{y})^2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8641079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.49782em;vertical-align:-0.994002em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5038179999999999em;"><span style="top:-2.305708em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6897100000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mord mathdefault">i</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.994002em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>S</mi><mi>T</mi><mo>=</mo><mi>S</mi><mi>S</mi><mi>E</mi><mo>+</mo><mi>S</mi><mi>S</mi><mi>R</mi></mrow><annotation encoding="application/x-tex">SST=SSE+SSR
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><msub><mi>y</mi><mi>i</mi></msub><mo>^</mo></mover></mrow><annotation encoding="application/x-tex">\hat{y_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;"><span class="mord">^</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>表示预测值，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>y</mi><mo>ˉ</mo></mover></mrow><annotation encoding="application/x-tex">\bar{y}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7622199999999999em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span></span></span>表示均值，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>表示原始值。</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>M</mi><mi>S</mi><mi>E</mi><mo>=</mo><msqrt><mfrac><mrow><mi>S</mi><mi>S</mi><mi>E</mi></mrow><mi>n</mi></mfrac></msqrt></mrow><annotation encoding="application/x-tex">RMSE=\sqrt{\frac{SSE}{n}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.44em;vertical-align:-0.7689599999999999em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.67104em;"><span class="svg-align" style="top:-4.4em;"><span class="pstrut" style="height:4.4em;"></span><span class="mord" style="padding-left:1em;"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">E</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span style="top:-3.6310400000000005em;"><span class="pstrut" style="height:4.4em;"></span><span class="hide-tail" style="min-width:1.02em;height:2.48em;"><svg width="400em" height="2.48em" viewbox="0 0 400000 2592" preserveaspectratio="xMinYMin slice"><path d="M424,2478
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l0 -0c4,-6.7,10,-10,18,-10 H400000
v40H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M1001 80
h400000v40h-400000z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7689599999999999em;"><span></span></span></span></span></span></span></span></span></span></p>
<p><strong>需要注意：如果拟合函数非线性，则不能用<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>R</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">R^2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span>来判断。例如比较线性拟合和复杂指数函数拟合，只需看SSE或者RMSE</strong>。</p>
<p>此处的线性，讲的是参数为线性，而不是变量为线性。</p>
<h3 id="置信度检验">置信度检验</h3>
<p><strong>上面的解决的好不好的问题</strong>，就是系数拟合的好不好，但是<strong>该不该有这个参数</strong>还没有解决。就需要进行假设检验。原假设：系数为0，如果经过统计（配对检验），发现位于极端值处的概率和小于阈值（0.05），说明需要推翻原假设，该系数不为0。</p>
<p>这里说一下阈值，小于某一阈值说明<strong>发生了</strong>比预想更极端的事情，也就是说原假设不成立。</p>
<p>举个例子：一个人去做一件看起来不可能完成的事情（比如剥生鸡蛋，这里假设剥开和不能剥开的成功率随机），**一般人都不会相信他会剥开（这就是我们的原假设）**更不用说他能成功剥开n次了，那就是不可能发生的事情。但是事实上，经过观察，每8个鸡蛋，他都至少成功剥开7个。这时候我们就不能坚持他不会剥生鸡蛋这个假设了。是什么让我们相信他会剥生鸡蛋呢？7次以上，这里的7就是阈值。就是说，你只要成功7次以上，我就会相信你。换成数学语言就是，<strong>成功7次以上对应的概率概率值之和就是我们设定的阈值</strong>。（具体数值可以看《女士品茶》）</p>
]]></content>
      <tags>
        <tag>Mathmodeling</tag>
      </tags>
  </entry>
  <entry>
    <title></title>
    <url>/2023/12/31/nero/</url>
    <content><![CDATA[<h3 id="第二章-走进深度学习的世界-神经网络模型">第二章——走进深度学习的世界 神经网络模型</h3>
<h4 id="反向传播计算方法">反向传播计算方法</h4>
<p>简单的例子：<img src="/2023/12/31/nero/1609311709861.png" alt="1609311709861"></p>
<p><img src="/2023/12/31/nero/1609311772390.png" alt="1609311772390"></p>
<p>如何让 f 值更小，就是改变x、y、z，而损失函数也是这样，那么我们分别求偏导，则能得出每个值对结果的影响<img src="/2023/12/31/nero/1609311878585.png" alt="1609311878585"></p>
<p><strong>链式法则</strong></p>
<ul>
<li>
<p>梯度是一步一步传的</p>
<p><img src="/2023/12/31/nero/1609312362417.png" alt="1609312362417"></p>
</li>
</ul>
<p>复杂的例子：<img src="/2023/12/31/nero/1609313400358.png" alt="1609313400358"></p>
<p><img src="/2023/12/31/nero/1609313438317.png" alt="1609313438317"></p>
<h4 id="神经网络整体架构">神经网络整体架构</h4>
<p>类生物神经元</p>
<p><img src="/2023/12/31/nero/1609313874088.png" alt="1609313874088"></p>
<blockquote>
<p>左半边是生物学上的神经元，右半边是数学上的“神经元”，可以说是非常像。</p>
</blockquote>
<p>整体架构</p>
<p><img src="/2023/12/31/nero/1609313994725.png" alt="1609313994725"></p>
<ul>
<li>
<p>input layer输入层：比如输入X，有多少个x即有多少个input，比如前面的猫有3千多像素点，那么就有3千多个“圈”进行input。</p>
</li>
<li>
<p>hidden layer 1：指将X做了某些变换，且每个圈与前者的全部圈都连接，即是全连接，为什么多了1个圈，是表示可能会在原始特征的基础上做变换，变成4个特征。具体如：假设X输入的是年龄，第一圈表示对年龄做平方，第二个圈表示将年龄与其它值相加相乘等等。</p>
</li>
<li>
<p>W1：input是3个，hidden layer 1是4个，那么夹在中间的W1就是[3,4]的权重矩阵。</p>
</li>
<li>
<p>hidden layer 2：指在1的基础上再进行变换，防止如果hidden layer 1的效果不好，那么加多一层，进行再加工。</p>
</li>
<li>
<p>W2：hidden layer 1是4个，hidden layer 2是4个，那么夹在中间的W2就是[4,4]的权重矩阵。</p>
</li>
<li>
<p>output layer：输出结果。</p>
</li>
<li>
<p>W3：hidden layer 2是4个，output layer 2是1个，那么夹在中间的W3就是[4,1]的权重矩阵。</p>
</li>
</ul>
<p>整体大致公式：</p>
<ul>
<li>
<p>基本架构：<img src="/2023/12/31/nero/1609314876275.png" alt="1609314876275"></p>
</li>
<li>
<p>继续堆叠一层：<img src="/2023/12/31/nero/1609314948479.png" alt="1609314948479"></p>
</li>
<li>
<p>神经网络的强大之处在于，用更多的参数来拟合复杂的数据</p>
</li>
</ul>
<h4 id="神经元个数对结果的影响">神经元个数对结果的影响</h4>
<p><a href="https://cs.stanford.edu/people/karpathy/convnetjs/demo/classify2d.html">https://cs.stanford.edu/people/karpathy/convnetjs/demo/classify2d.html</a></p>
<p>越多的神经元个数，切分的越明显</p>
<p>如1个神经元：</p>
<p><img src="/2023/12/31/nero/1609318446028.png" alt="1609318446028"></p>
<blockquote>
<p>目的是区分绿色和红色的点，当只有1个神经元时，可以明显看到类似一刀切。</p>
</blockquote>
<p>如10个神经元：</p>
<p><img src="/2023/12/31/nero/1609318573993.png" alt="1609318573993"></p>
<blockquote>
<p>可以看到已经切分的非常明显了</p>
</blockquote>
<p>另外：在机器学习中，如果数据是完全随机的情况，模型是无法分辨的，但神经网络可以。如下图</p>
<p><img src="/2023/12/31/nero/1609318694326.png" alt="1609318694326"></p>
<p>这就是神经网络的强大之处，越多神经元区分的越明显，不过也可能存在过拟合，因为太强大了。</p>
<h4 id="正则化与激活函数">正则化与激活函数</h4>
<ul>
<li>惩罚力度对结果的影响：</li>
</ul>
<p><img src="/2023/12/31/nero/1609375337258.png" alt="1609375337258"></p>
<blockquote>
<p>惩罚力度过小（左图），导致的结果是过拟合，有几个红色点明明应该更靠近绿色也被评定为红色。这些一般是训练集的情况，有标签能学到，但是在测试集可能就是灾难了。随着lambda的增大，切分的会相对平滑。</p>
</blockquote>
<ul>
<li>参数个数对结果的影响：</li>
</ul>
<p><img src="/2023/12/31/nero/1609375557007.png" alt="1609375557007"></p>
<blockquote>
<p>同样，神经元个数越多，也越容易过拟合</p>
</blockquote>
<ul>
<li>激活函数</li>
</ul>
<p><img src="/2023/12/31/nero/1609375641306.png" alt="1609375641306"></p>
<blockquote>
<p>做非线性变换，如Sigmoid、Relu、Tanh等</p>
</blockquote>
<p>激活函数对比</p>
<ul>
<li>
<p>Sigmoid：<img src="/2023/12/31/nero/1609375872490.png" alt="1609375872490"></p>
<blockquote>
<p>其缺点是，靠两边的线过于平缓，无法计算梯度或者约等于0，那么值就不会进行更新或者前向传播，而我们恰恰需要传播来更新我们的W值（前面讲到）</p>
</blockquote>
</li>
<li>
<p>Relu：<img src="/2023/12/31/nero/1609376004260.png" alt="1609376004260"></p>
<blockquote>
<p>市面上绝大多数神经网络用的激活函数，这个是绝对会有梯度，不会出现梯度消失。</p>
</blockquote>
</li>
</ul>
<h4 id="神经网络过拟合解决方法">神经网络过拟合解决方法</h4>
<ul>
<li>
<p>不同的预处理结果会使模型的结果发生很大的差异：</p>
<p><img src="/2023/12/31/nero/1609376154021.png" alt="1609376154021"></p>
<blockquote>
<p>如常见的标准化</p>
</blockquote>
</li>
<li>
<p>参数初始化：通常使用随机策略进行参数初始化</p>
<p><img src="/2023/12/31/nero/1609376305237.png" alt="1609376305237"></p>
</li>
<li>
<p>DROP-OUT：在神经网络训练过程中，随机去掉部分神经元，以减少神经元的个数，并不是简单的去掉部分，而且每次训练都随机去掉部分。</p>
<p><img src="/2023/12/31/nero/1609376454005.png" alt="1609376454005"></p>
<blockquote>
<p>这样保证每次训练的神经网络都相对简单，每次训练可以DROP-OUT一部分神经元</p>
</blockquote>
</li>
</ul>
]]></content>
  </entry>
  <entry>
    <title>50_ggplot_picture</title>
    <url>/2023/10/31/picture/</url>
    <content><![CDATA[<h1>50个ggplot2可视化案例</h1>
<p><strong>一个有效的图标:</strong></p>
<ul>
<li>在不歪曲事实的情况下传达正确的信息</li>
<li>简单而优雅的表达信息内容</li>
<li>通过美学表达信息，而不是掩盖信息</li>
<li>没有信息负载</li>
</ul>
<p>下面介绍了八类常见的图表可视化情景。在绘图之前，请仔细考虑你准备如何通过可视化的方式表达统计事实或事件关系。也许就是这八类情景中的一个。</p>
<h2 id="类型一：相关性">类型一：相关性</h2>
<p>以及几个图用于检查两个变量见的相关性</p>
<h3 id="散点图">散点图</h3>
<p>散点图是数据分析过程中使用最多的图标之一。当你想了解两个变量间的相关性时，首先想到的就是散点图。<br>
我们可以用ggplot2里的geom_point()绘制散点图。另外，还可以用geom_smooth来绘制平滑曲线，通过设置methon='lm’来绘制最佳拟合曲线。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">options(scipen=999) </span><br><span class="line">library(ggplot2)</span><br><span class="line">theme_set(theme_bw())  </span><br><span class="line">data(&quot;midwest&quot;, package = &quot;ggplot2&quot;)</span><br><span class="line"># midwest &lt;- read.csv(&quot;http://goo.gl/G1K41K&quot;)  </span><br><span class="line"></span><br><span class="line"># Scatterplot</span><br><span class="line">gg &lt;- ggplot(midwest, aes(x=area, y=poptotal)) + </span><br><span class="line">  geom_point(aes(col=state, size=popdensity)) + </span><br><span class="line">  geom_smooth(method=&quot;loess&quot;, se=F) + </span><br><span class="line">  xlim(c(0, 0.1)) + </span><br><span class="line">  ylim(c(0, 500000)) + </span><br><span class="line">  labs(subtitle=&quot;Area Vs Population&quot;, </span><br><span class="line">       y=&quot;Population&quot;, </span><br><span class="line">       x=&quot;Area&quot;, </span><br><span class="line">       title=&quot;Scatterplot&quot;, </span><br><span class="line">       caption = &quot;Source: midwest&quot;)</span><br><span class="line"></span><br><span class="line">plot(gg)</span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyPOH89nNxhA1P4ib5x3GgSicG8SxBriaQYiclawurDWdu8SWryAo1EUYAPw/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="带有环绕的散点图">带有环绕的散点图</h3>
<p>在展示结果时，有时可以将某个特殊的区域包围起来，从而达到突出展示的效果。<br>
我们可以通过ggalt包里的geom_encircle()实现。<br>
在geom_encircle()中，我们可以指定需要突出的数据集，此外还可以扩展曲线，以便在点之外传递；以及修改曲线的颜色及大小。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># install &#x27;ggalt&#x27; pkg</span><br><span class="line"># devtools::install_github(&quot;hrbrmstr/ggalt&quot;)</span><br><span class="line">options(scipen = 999)</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggalt)</span><br><span class="line">midwest_select &lt;- midwest[midwest$poptotal &gt; 350000 &amp; </span><br><span class="line">                            midwest$poptotal &lt;= 500000 &amp; </span><br><span class="line">                            midwest$area &gt; 0.01 &amp; </span><br><span class="line">                            midwest$area &lt; 0.1, ]</span><br><span class="line"></span><br><span class="line"># Plot</span><br><span class="line">ggplot(midwest, aes(x=area, y=poptotal)) + </span><br><span class="line">  geom_point(aes(col=state, size=popdensity)) +   # draw points</span><br><span class="line">  geom_smooth(method=&quot;loess&quot;, se=F) + </span><br><span class="line">  xlim(c(0, 0.1)) + </span><br><span class="line">  ylim(c(0, 500000)) +   # draw smoothing line</span><br><span class="line">  geom_encircle(aes(x=area, y=poptotal), </span><br><span class="line">                data=midwest_select, </span><br><span class="line">                color=&quot;red&quot;, </span><br><span class="line">                size=2, </span><br><span class="line">                expand=0.08) +   # encircle</span><br><span class="line">  labs(subtitle=&quot;Area Vs Population&quot;, </span><br><span class="line">       y=&quot;Population&quot;, </span><br><span class="line">       x=&quot;Area&quot;, </span><br><span class="line">       title=&quot;Scatterplot + Encircle&quot;, </span><br><span class="line">       caption=&quot;Source: midwest&quot;)    </span><br><span class="line">        </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyScv1s3ZiaH0AMfJYwaHibOuwgZG5qBcyYicXnXJM4ZHcAlXfO9AzeCIjA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="jitter图">Jitter图</h3>
<p>我们看看先用一组新的数据绘制散点图。这次，我将使用mpg数据集来绘制城市里程（cty）与公路里程。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># load package and data</span><br><span class="line">library(ggplot2)</span><br><span class="line">data(mpg, package=&quot;ggplot2&quot;) # alternate source: &quot;http://goo.gl/uEeRGu&quot;)theme_set(theme_bw())  # pre-set the bw theme.</span><br><span class="line"></span><br><span class="line">g &lt;- ggplot(mpg, aes(cty, hwy))</span><br><span class="line"></span><br><span class="line"># Scatterplot</span><br><span class="line">g + geom_point() + </span><br><span class="line">  geom_smooth(method=&quot;lm&quot;, se=F) +</span><br><span class="line">  labs(subtitle=&quot;mpg: city vs highway mileage&quot;, </span><br><span class="line">       y=&quot;hwy&quot;, </span><br><span class="line">       x=&quot;cty&quot;, </span><br><span class="line">       title=&quot;Scatterplot with overlapping points&quot;, </span><br><span class="line">       caption=&quot;Source: midwest&quot;)</span><br><span class="line">       </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZygZIxic5KfCticbZSULtzPTY5vTkHCXdIsxGvETIhrxjHU1YNb5tPqzqA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<p>虽然我们能够从图中看出，两个变量存在相关性。但是不难发现，很多散点被隐藏了，因为数据存在重叠的问题。由于cty和hvy两个变量都是整数，所以数据重叠的现象更加严重。对于这类数据集的散点图，展示过程中应该格外小心。<br>
那么应该如何解决一个问题呢？我们可以使用jitter_geom()对数据增加抖动，通过设置wigth，使得重叠的点在原始位置随机抖动。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">  # load package and data</span><br><span class="line">library(ggplot2)</span><br><span class="line">data(mpg, package=&quot;ggplot2&quot;)</span><br><span class="line"># mpg &lt;- read.csv(&quot;http://goo.gl/uEeRGu&quot;)</span><br><span class="line"></span><br><span class="line"># Scatterplot</span><br><span class="line">theme_set(theme_bw())  # pre-set the bw theme.</span><br><span class="line">g &lt;- ggplot(mpg, aes(cty, hwy))</span><br><span class="line">g + geom_jitter(width = .5, size=1) +</span><br><span class="line">  labs(subtitle=&quot;mpg: city vs highway mileage&quot;, </span><br><span class="line">       y=&quot;hwy&quot;, </span><br><span class="line">       x=&quot;cty&quot;, </span><br><span class="line">       title=&quot;Jittered Points&quot;)    </span><br><span class="line">       </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZys2gZoWwCDUItZofQyJrZ7lO51sdIk4ibORVhDN3XLjPLvRhGfdRStuA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="计数图">计数图</h3>
<p>第二种解决散点重叠的方法是使用计数图。当数据存在散点重叠时，我们可以用散点大小来表达数据重叠的程度。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># load package and data</span><br><span class="line">library(ggplot2)</span><br><span class="line">data(mpg, package=&quot;ggplot2&quot;)</span><br><span class="line"># mpg &lt;- read.csv(&quot;http://goo.gl/uEeRGu&quot;)</span><br><span class="line"></span><br><span class="line"># Scatterplot</span><br><span class="line">theme_set(theme_bw())  # pre-set the bw theme.</span><br><span class="line">g &lt;- ggplot(mpg, aes(cty, hwy))</span><br><span class="line">g + geom_count(col=&quot;tomato3&quot;, show.legend=F) +</span><br><span class="line">  labs(subtitle=&quot;mpg: city vs highway mileage&quot;, </span><br><span class="line">       y=&quot;hwy&quot;, </span><br><span class="line">       x=&quot;cty&quot;, </span><br><span class="line">       title=&quot;Counts Plot&quot;)</span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyxlOZVSgQpLGVhQLyCCk1ForMt0KZo19Gjv2S6M9hreZyF5GtVLnHdA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="气泡图">气泡图</h3>
<p>虽然散点图能够表示两个连续变量间的相关关系。但如果想在以下两个方面了解数据间的潜在关系时，气泡图会更有用：</p>
<p>1.基于分类变量，修改散点颜色<br>
2.基于另一个连续变量，表示散点的大小</p>
<p>简单来说，如果你有一个四维变量的数据，两个连续变量，一个分类变量用以表示颜色，一个连续变量表示点的大小，那么气泡图就非常适合了。</p>
<p>比如下面这个例子，气泡图清楚地区分了制造商之间的差异以及最佳拟合曲线的斜率变化，从而能够更好的比较不同组群间的差异。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># load package and data</span><br><span class="line">library(ggplot2)</span><br><span class="line">data(mpg, package=&quot;ggplot2&quot;)</span><br><span class="line"># mpg &lt;- read.csv(&quot;http://goo.gl/uEeRGu&quot;)</span><br><span class="line"></span><br><span class="line">mpg_select &lt;- mpg[mpg$manufacturer %in% c(&quot;audi&quot;, &quot;ford&quot;, &quot;honda&quot;, &quot;hyundai&quot;), ]</span><br><span class="line"></span><br><span class="line"># Scatterplot</span><br><span class="line">theme_set(theme_bw())  # pre-set the bw theme.</span><br><span class="line">g &lt;- ggplot(mpg_select, aes(displ, cty)) + </span><br><span class="line">  labs(subtitle=&quot;mpg: Displacement vs City Mileage&quot;,</span><br><span class="line">       title=&quot;Bubble chart&quot;)</span><br><span class="line"></span><br><span class="line">g + geom_jitter(aes(col=manufacturer, size=hwy)) + </span><br><span class="line">  geom_smooth(aes(col=manufacturer), method=&quot;lm&quot;, se=F)</span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZy34Via4kH9Gn63TcSIn1GNd4tGTc0AQbcyr930XQZqibqkeyhsib0EDpdA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="动态气泡图">动态气泡图</h3>
<p>对于动态气泡图的实现，可以使用gganimate包。动态气泡图和普通气泡图的区别就在于使用第五维数据(一般是时间)来展示数据间的变化。<br>
动态气泡图的处理方法和其它图形基本一致，不同的是需要在aes层指定动画展示的变量。构建绘图后，可以使用gganimate()通过设置动画的时间间隔。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Source: https://github.com/dgrtwo/gganimate</span><br><span class="line"># install.packages(&quot;cowplot&quot;)  # a gganimate dependency</span><br><span class="line"># devtools::install_github(&quot;dgrtwo/gganimate&quot;)</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(gganimate)</span><br><span class="line">library(gapminder)</span><br><span class="line">theme_set(theme_bw())  # pre-set the bw theme.</span><br><span class="line"></span><br><span class="line">g &lt;- ggplot(gapminder, aes(gdpPercap, lifeExp, size = pop, frame = year)) +  geom_point() +</span><br><span class="line">  geom_smooth(aes(group = year), </span><br><span class="line">              method = &quot;lm&quot;, </span><br><span class="line">              show.legend = FALSE) +</span><br><span class="line">  facet_wrap(~continent, scales = &quot;free&quot;) +</span><br><span class="line">  scale_x_log10()  # convert to log scale</span><br><span class="line"></span><br><span class="line">gganimate(g, interval=0.2) </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_gif/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyT14Ma7kt3LkDlcicVSMojDBiayzoCJadML14VkUvM3sLkZCLdcJ2GpHQ/640?wx_fmt=gif&amp;wxfrom=5&amp;wx_lazy=1" alt="图片"></p>
<h3 id="边缘分布的直方图-箱型图">边缘分布的直方图／箱型图</h3>
<p>如果你想在用一张图表中显示两个变量的关系以及分布，那么可以使用边缘分布直方图。它可以在散点图的X、Y周，显示变量的直方图。<br>
边缘分布直方图可以通过ggExtra包的ggMarginal()函数实现。除了绘制直方图外，还支持绘制边缘分布的箱型图和密度函数。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># load package and data</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggExtra)</span><br><span class="line">data(mpg, package=&quot;ggplot2&quot;)</span><br><span class="line"># mpg &lt;- read.csv(&quot;http://goo.gl/uEeRGu&quot;)</span><br><span class="line"></span><br><span class="line"># Scatterplot</span><br><span class="line">theme_set(theme_bw())  # pre-set the bw theme.</span><br><span class="line">mpg_select &lt;- mpg[mpg$hwy &gt;= 35 &amp; mpg$cty &gt; 27, ]</span><br><span class="line">g &lt;- ggplot(mpg, aes(cty, hwy)) + </span><br><span class="line">  geom_count() + </span><br><span class="line">  geom_smooth(method=&quot;lm&quot;, se=F)</span><br><span class="line"></span><br><span class="line">ggMarginal(g, type = &quot;histogram&quot;, fill=&quot;transparent&quot;)</span><br><span class="line">ggMarginal(g, type = &quot;boxplot&quot;, fill=&quot;transparent&quot;)</span><br><span class="line"># ggMarginal(g, type = &quot;density&quot;, fill=&quot;transparent&quot;)     </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyY1eHmDJAcHxzoIQfPXGrjpxicqPZghiauZ3t4rx3VPBiajiceUX1uqsTxQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZy1qfRPctflyG6eFI0AtB44TicGpEJxK1cUqpypV4aHUicBUnS9VFcpDgg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="相关关系图">相关关系图</h3>
<p>相关关系图可以同时显示统一组数据中多个变量间的相关性。通过ggcorrplot包可以很方便的实现它。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># devtools::install_github(&quot;kassambara/ggcorrplot&quot;)</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggcorrplot)</span><br><span class="line"></span><br><span class="line"># Correlation matrix</span><br><span class="line">data(mtcars)</span><br><span class="line">corr &lt;- round(cor(mtcars), 1)</span><br><span class="line"></span><br><span class="line"># Plot</span><br><span class="line">ggcorrplot(corr, hc.order = TRUE, </span><br><span class="line">           type = &quot;lower&quot;, </span><br><span class="line">           lab = TRUE, </span><br><span class="line">           lab_size = 3, </span><br><span class="line">           method=&quot;circle&quot;, </span><br><span class="line">           colors = c(&quot;tomato2&quot;, &quot;white&quot;, &quot;springgreen3&quot;), </span><br><span class="line">           title=&quot;Correlogram of mtcars&quot;, </span><br><span class="line">           ggtheme=theme_bw) </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyUNT5licNh8JzWrhRicpOMsRQgiaayJBIqYWsoS9wh4vrUepI2uhyHSTRA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h2 id="类型二-偏差">类型二: 偏差</h2>
<h3 id="条形图">条形图</h3>
<p>条形图，是一种可以同时处理正负值的条形图表。一般通过geom<em>bar()函数就能实现，但是使用geom</em>bar()函数时，往往会出现概念上的混淆。因为该函数既可以画直方图也可以画条形图。<br>
比如，geom_bar()函数的stat参数默认值是count，这也意味着，当指定的数据是连续变量时，系统会生成直方图。为了创建条形图而不是直方图，需要作如下修改：</p>
<ul>
<li>设置参数stat=identity</li>
<li>在aes()中提供x和y两维变量，其中x是字符或因子型变量，y是数值型变量</li>
</ul>
<p>在下面的示例中，首先对mtcars数据集的mpg进行标准化。将那些mpg大于零的车辆标记为绿色，小于零的车辆标记为红色。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">theme_set(theme_bw())  </span><br><span class="line"></span><br><span class="line"># Data Prep</span><br><span class="line">data(&quot;mtcars&quot;)  # load data</span><br><span class="line">mtcars$`car name` &lt;- rownames(mtcars)  </span><br><span class="line">mtcars$mpg_z &lt;- round((mtcars$mpg - mean(mtcars$mpg))/sd(mtcars$mpg), 2)  </span><br><span class="line">mtcars$mpg_type &lt;- ifelse(mtcars$mpg_z &lt; 0, &quot;below&quot;, &quot;above&quot;)  </span><br><span class="line">mtcars &lt;- mtcars[order(mtcars$mpg_z), ]  # sort</span><br><span class="line">mtcars$`car name` &lt;- factor(mtcars$`car name`,                             levels = mtcars$`car name`)  #Diverging Barcharts</span><br><span class="line">ggplot(mtcars, aes(x=`car name`, y=mpg_z, label=mpg_z)) + </span><br><span class="line">  geom_bar(stat=&#x27;identity&#x27;, aes(fill=mpg_type), width=.5)  +</span><br><span class="line">  scale_fill_manual(name=&quot;Mileage&quot;, </span><br><span class="line">              labels = c(&quot;Above Average&quot;, &quot;Below Average&quot;), </span><br><span class="line">              values = c(&quot;above&quot;=&quot;#00ba38&quot;, &quot;below&quot;=&quot;#f8766d&quot;)) + </span><br><span class="line">  labs(subtitle=&quot;Normalised mileage from &#x27;mtcars&#x27;&quot;, </span><br><span class="line">       title= &quot;Diverging Bars&quot;) + </span><br><span class="line">  coord_flip()    </span><br></pre></td></tr></table></figure>
<p>![图片](data:image/svg+xml,&lt;%3Fxml version=‘1.0’ encoding=‘UTF-8’%3F&gt;<svg width="1px" height="1px" viewbox="0 0 1 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title/><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" fill-opacity="0"><g transform="translate(-249.000000, -126.000000)" fill="%23FFFFFF"><rect x="249" y="126" width="1" height="1"/></g></g></svg>)</p>
<h3 id="棒棒糖图">棒棒糖图</h3>
<p>棒棒糖图与条形图类似。一般可以使用geom_*point()和geom_*segment()来画棒棒糖图。借用条形图的数据，我们这里用棒棒糖图来实现它。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">theme_set(theme_bw())</span><br><span class="line"></span><br><span class="line">ggplot(mtcars, aes(x=`car name`, y=mpg_z, label=mpg_z)) + </span><br><span class="line">  geom_point(stat=&#x27;identity&#x27;, fill=&quot;black&quot;, size=6)  +</span><br><span class="line">  geom_segment(aes(y = 0, </span><br><span class="line">                   x = `car name`, </span><br><span class="line">                   yend = mpg_z, </span><br><span class="line">                   xend = `car name`), </span><br><span class="line">               color = &quot;black&quot;) +</span><br><span class="line">  geom_text(color=&quot;white&quot;, size=2) +</span><br><span class="line">  labs(title=&quot;Diverging Lollipop Chart&quot;, </span><br><span class="line">       subtitle=&quot;Normalized mileage from &#x27;mtcars&#x27;: Lollipop&quot;) + </span><br><span class="line">  ylim(-2.5, 2.5) +</span><br><span class="line">  coord_flip()    </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZy7TD9gVLJicbbwITMYGianAIQvSbeuwh2DPYXtYheTlbLf7xl5TolcRicw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="点图">点图</h3>
<p>点图与条形图原理一致，只是表达形式不同。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">theme_set(theme_bw())</span><br><span class="line"></span><br><span class="line"># Plot</span><br><span class="line">ggplot(mtcars, aes(x=`car name`, y=mpg_z, label=mpg_z)) + </span><br><span class="line">  geom_point(stat=&#x27;identity&#x27;, aes(col=mpg_type), size=6)  +</span><br><span class="line">  scale_color_manual(name=&quot;Mileage&quot;, </span><br><span class="line">                labels = c(&quot;Above Average&quot;, &quot;Below Average&quot;), </span><br><span class="line">                values = c(&quot;above&quot;=&quot;#00ba38&quot;, &quot;below&quot;=&quot;#f8766d&quot;)) + </span><br><span class="line">  geom_text(color=&quot;white&quot;, size=2) +</span><br><span class="line">  labs(title=&quot;Diverging Dot Plot&quot;, </span><br><span class="line">       subtitle=&quot;Normalized mileage from &#x27;mtcars&#x27;: Dotplot&quot;) + </span><br><span class="line">  ylim(-2.5, 2.5) +</span><br><span class="line">  coord_flip()    </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyib0ZFg0BaJ3ANGwpr51p3WQghQm4v7iboGkGibenzS6fqanC7BHvlTZvg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="面积图">面积图</h3>
<p>面积图一般用来表示某指标与基准指标相比的变化情况。通常可以用geom_area()函数实现它。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">library(quantmod)</span><br><span class="line">data(&quot;economics&quot;, package = &quot;ggplot2&quot;)</span><br><span class="line"></span><br><span class="line"># Compute % Returns</span><br><span class="line">economics$returns_perc &lt;- c(0, diff(economics$psavert)/    economics$psavert[-length(economics$psavert)])</span><br><span class="line"># Create break points and labels for axis ticks</span><br><span class="line">brks &lt;- economics$date[seq(1, length(economics$date), 12)]</span><br><span class="line">lbls &lt;- lubridate::year(economics$date[seq(1,         length(economics$date), 12)])</span><br><span class="line"># Plot</span><br><span class="line">ggplot(economics[1:100, ], aes(date, returns_perc)) + </span><br><span class="line">  geom_area() + </span><br><span class="line">  scale_x_date(breaks=brks, labels=lbls) + </span><br><span class="line">  theme(axis.text.x = element_text(angle=90)) + </span><br><span class="line">  labs(title=&quot;Area Chart&quot;, </span><br><span class="line">       subtitle = &quot;Perc Returns for Personal Savings&quot;, </span><br><span class="line">       y=&quot;% Returns for Personal savings&quot;, </span><br><span class="line">       caption=&quot;Source: economics&quot;)   </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyf7GW4bAqhlaR1BjUgjaI5XAibbTF3WqAlsM0Mf2vpLdpDtAqwphWktA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h2 id="类型三-排序">类型三: 排序</h2>
<p>排序图一般用于比较多个项目之间的指标大小。</p>
<h3 id="有序条形图">有序条形图</h3>
<p>有序条形图是按照Y轴变量大小进行排序的条形图。让我们用mpg数据集绘制每个制造商的平均城市里程数的有序条形图。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cty_mpg &lt;- aggregate(mpg$cty, by=list(mpg$manufacturer), FUN=mean) </span><br><span class="line">colnames(cty_mpg) &lt;- c(&quot;make&quot;, &quot;mileage&quot;)  </span><br><span class="line">cty_mpg &lt;- cty_mpg[order(cty_mpg$mileage), ]  </span><br><span class="line">cty_mpg$make &lt;- factor(cty_mpg$make, levels = cty_mpg$make)  </span><br><span class="line"> library(ggplot2)</span><br><span class="line">theme_set(theme_bw())</span><br><span class="line"></span><br><span class="line"># Draw plot</span><br><span class="line">ggplot(cty_mpg, aes(x=make, y=mileage)) + </span><br><span class="line">  geom_bar(stat=&quot;identity&quot;, width=.5, fill=&quot;tomato3&quot;) + </span><br><span class="line">  labs(title=&quot;Ordered Bar Chart&quot;, </span><br><span class="line">       subtitle=&quot;Make Vs Avg. Mileage&quot;, </span><br><span class="line">       caption=&quot;source: mpg&quot;) + </span><br><span class="line">  theme(axis.text.x = element_text(angle=65, vjust=0.6))</span><br></pre></td></tr></table></figure>
<p>![图片](data:image/svg+xml,&lt;%3Fxml version=‘1.0’ encoding=‘UTF-8’%3F&gt;<svg width="1px" height="1px" viewbox="0 0 1 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title/><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" fill-opacity="0"><g transform="translate(-249.000000, -126.000000)" fill="%23FFFFFF"><rect x="249" y="126" width="1" height="1"/></g></g></svg>)</p>
<h3 id="棒棒糖图">棒棒糖图</h3>
<p>与条形图类似，棒棒糖图也具备类似的图形展示效果。通过将条形改为细线，可以让图形显得更简洁，更美观。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">theme_set(theme_bw())</span><br><span class="line"></span><br><span class="line"># Plot</span><br><span class="line">ggplot(cty_mpg, aes(x=make, y=mileage)) + </span><br><span class="line">  geom_point(size=3) + </span><br><span class="line">  geom_segment(aes(x=make, </span><br><span class="line">                   xend=make, </span><br><span class="line">                   y=0, </span><br><span class="line">                   yend=mileage)) + </span><br><span class="line">  labs(title=&quot;Lollipop Chart&quot;, </span><br><span class="line">       subtitle=&quot;Make Vs Avg. Mileage&quot;, </span><br><span class="line">       caption=&quot;source: mpg&quot;) + </span><br><span class="line">  theme(axis.text.x = element_text(angle=65, vjust=0.6))</span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyMImNNgTC5NcsD0Lc6YibxB5LMA6YkzHZUAUlDxS7yM7Z01LnkpcjMpQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="点图">点图</h3>
<p>点图其实和棒棒糖图类似，但是没有线条，并且指标被反转到了X轴。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">library(scales)</span><br><span class="line">theme_set(theme_classic())</span><br><span class="line"></span><br><span class="line"># Plot</span><br><span class="line">ggplot(cty_mpg, aes(x=make, y=mileage)) + </span><br><span class="line">  geom_point(col=&quot;tomato2&quot;, size=3) +   # Draw points</span><br><span class="line">  geom_segment(aes(x=make, </span><br><span class="line">                   xend=make, </span><br><span class="line">                   y=min(mileage), </span><br><span class="line">                   yend=max(mileage)), </span><br><span class="line">               linetype=&quot;dashed&quot;, </span><br><span class="line">               size=0.1) +   # Draw dashed lines</span><br><span class="line">  labs(title=&quot;Dot Plot&quot;, </span><br><span class="line">       subtitle=&quot;Make Vs Avg. Mileage&quot;, </span><br><span class="line">       caption=&quot;source: mpg&quot;) +  </span><br><span class="line">  coord_flip()     </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyDiaUrzomwm1vqu2zj51icElm41csFo2UILhACzy9XWAo9pyfa1iabYiaZA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="倾斜图">倾斜图</h3>
<p>斜率图是比较2个时间点之间位置的绝佳方法，既能展示值的大小变化，也能同时展示排名的变化。下图可以作为倾斜图的一个展示。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">library(scales)</span><br><span class="line">theme_set(theme_classic())</span><br><span class="line"></span><br><span class="line"># prep data</span><br><span class="line">df &lt;- read.csv(&quot;https://raw.githubusercontent.com/</span><br><span class="line">selva86/datasets/master/gdppercap.csv&quot;)</span><br><span class="line">colnames(df) &lt;- c(&quot;continent&quot;, &quot;1952&quot;, &quot;1957&quot;)</span><br><span class="line">left_label &lt;- paste(df$continent, round(df$`1952`),sep=&quot;, &quot;)</span><br><span class="line">right_label &lt;- paste(df$continent, round(df$`1957`),sep=&quot;, &quot;)</span><br><span class="line">df$class &lt;- ifelse((df$`1957` - df$`1952`) &lt; 0, &quot;red&quot;, &quot;green&quot;)</span><br><span class="line"></span><br><span class="line"># Plot</span><br><span class="line">p &lt;- ggplot(df) + </span><br><span class="line">     geom_segment(aes(x=1, xend=2, </span><br><span class="line">                      y=`1952`, yend=`1957`, </span><br><span class="line">                      col=class), size=.75, </span><br><span class="line">                      show.legend=F) + </span><br><span class="line">     geom_vline(xintercept=1, linetype=&quot;dashed&quot;, size=.1) + </span><br><span class="line">     geom_vline(xintercept=2, linetype=&quot;dashed&quot;, size=.1) +</span><br><span class="line">     scale_color_manual(labels = c(&quot;Up&quot;, &quot;Down&quot;), </span><br><span class="line">                      values = c(&quot;green&quot;=&quot;#00ba38&quot;, </span><br><span class="line">                      &quot;red&quot;=&quot;#f8766d&quot;)) +  </span><br><span class="line">     labs(x=&quot;&quot;, y=&quot;Mean GdpPerCap&quot;) +  </span><br><span class="line">     xlim(.5, 2.5) + ylim(0,(1.1*(max(df$`1952`, df$`1957`))))  </span><br><span class="line"></span><br><span class="line"># Add texts</span><br><span class="line">p &lt;- p + geom_text(label=left_label, y=df$`1952`, </span><br><span class="line">                   x=rep(1, NROW(df)), hjust=1.1, size=3.5)</span><br><span class="line">p &lt;- p + geom_text(label=right_label, y=df$`1957`, </span><br><span class="line">                   x=rep(2, NROW(df)), hjust=-0.1, size=3.5)</span><br><span class="line">p &lt;- p + geom_text(label=&quot;Time 1&quot;, x=1, y=1.1*(max(df$`1952`, </span><br><span class="line">                   df$`1957`)), hjust=1.2, size=5)  </span><br><span class="line">p &lt;- p + geom_text(label=&quot;Time 2&quot;, x=2, y=1.1*(max(df$`1952`, </span><br><span class="line">                   df$`1957`)), hjust=-0.1, size=5)  </span><br><span class="line"></span><br><span class="line"># Minify theme</span><br><span class="line">p + theme(panel.background = element_blank(), </span><br><span class="line">           panel.grid = element_blank(),</span><br><span class="line">           axis.ticks = element_blank(),</span><br><span class="line">           axis.text.x = element_blank(),</span><br><span class="line">           panel.border = element_blank(),</span><br><span class="line">           plot.margin = unit(c(1,2,1,2), &quot;cm&quot;))    </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyybecsomzfdw7zVeE8LUF5fYId5xpLMdD6nUNW9AMOs7FJsZWGLicJxw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="哑铃图">哑铃图</h3>
<p>哑铃图适合展示两个时间点之间的相对位置，比较两个类别之间的距离。正确的哑铃图要求Y轴变量是一个因子，并且因子水平与指标顺序相同。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># devtools::install_github(&quot;hrbrmstr/ggalt&quot;)</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggalt)</span><br><span class="line">theme_set(theme_classic())</span><br><span class="line"></span><br><span class="line">health &lt;- read.csv(&quot;https://raw.githubusercontent.com/</span><br><span class="line">selva86/datasets/master/health.csv&quot;)</span><br><span class="line">health$Area &lt;- factor(health$Area, levels=as.character(health$Area))  </span><br><span class="line"></span><br><span class="line"># health$Area &lt;- factor(health$Area)</span><br><span class="line">gg &lt;- ggplot(health, aes(x=pct_2013, xend=pct_2014, </span><br><span class="line">y=Area, group=Area)) + </span><br><span class="line">        geom_dumbbell(color=&quot;#a3c4dc&quot;, </span><br><span class="line">                      size=0.75, </span><br><span class="line">                      point.colour.l=&quot;#0e668b&quot;) + </span><br><span class="line">        scale_x_continuous(label=percent) + </span><br><span class="line">        labs(x=NULL, </span><br><span class="line">             y=NULL, </span><br><span class="line">             title=&quot;Dumbbell Chart&quot;, </span><br><span class="line">             subtitle=&quot;Pct Change: 2013 vs 2014&quot;, </span><br><span class="line">             caption=&quot;Source: https://github.com/hrbrmstr/ggalt&quot;) +</span><br><span class="line">        theme(plot.title = element_text(hjust=0.5, face=&quot;bold&quot;),</span><br><span class="line">              plot.background=element_rect(fill=&quot;#f7f7f7&quot;),</span><br><span class="line">              panel.background=element_rect(fill=&quot;#f7f7f7&quot;),</span><br><span class="line">              panel.grid.minor=element_blank(),</span><br><span class="line">              panel.grid.major.y=element_blank(),</span><br><span class="line">              panel.grid.major.x=element_line(),</span><br><span class="line">              axis.ticks=element_blank(),</span><br><span class="line">              legend.position=&quot;top&quot;,</span><br><span class="line">              panel.border=element_blank())</span><br><span class="line">plot(gg)    </span><br></pre></td></tr></table></figure>
<p>![图片](data:image/svg+xml,&lt;%3Fxml version=‘1.0’ encoding=‘UTF-8’%3F&gt;<svg width="1px" height="1px" viewbox="0 0 1 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title/><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" fill-opacity="0"><g transform="translate(-249.000000, -126.000000)" fill="%23FFFFFF"><rect x="249" y="126" width="1" height="1"/></g></g></svg>)</p>
<h2 id="类型四-分布">类型四: 分布</h2>
<p>当拥有大量数据点并想要研究数据点的分布特点时，则可以画分布图。</p>
<h3 id="直方图">直方图</h3>
<p>连续变量直方图一般可以通过geom_bar()或者geom_histogram()来实现。当使用geom_histogram()时，可以选择使用bin参数来控制柱子的数量。或者也可以通过设置binwidth来设置bin的范围。因为geom_*histogram提供了控制箱数和binwidth的功能，因此一般可以选择geom_*histogram来绘制直方图。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">theme_set(theme_classic())</span><br><span class="line"></span><br><span class="line"># Histogram on a Continuous (Numeric) Variable</span><br><span class="line">g &lt;- ggplot(mpg, aes(displ)) +      scale_fill_brewer(palette = &quot;Spectral&quot;)</span><br><span class="line">g + geom_histogram(aes(fill=class), </span><br><span class="line">                   binwidth = .1, </span><br><span class="line">                   col=&quot;black&quot;, </span><br><span class="line">                   size=.1) +  # change binwidth</span><br><span class="line">  labs(title=&quot;Histogram with Auto Binning&quot;, </span><br><span class="line">       subtitle=&quot;Engine Displacement across Vehicle Classes&quot;)  </span><br><span class="line"></span><br><span class="line">g + geom_histogram(aes(fill=class), </span><br><span class="line">                   bins=5, </span><br><span class="line">                   col=&quot;black&quot;, </span><br><span class="line">                   size=.1) +   # change number of bins</span><br><span class="line">  labs(title=&quot;Histogram with Fixed Bins&quot;, </span><br><span class="line">       subtitle=&quot;Engine Displacement across Vehicle Classes&quot;)     </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZytyuRxm841U2cyhXZBTWg7Bj0Y9AXvFhlcURHaWbibYRDLicHMdorE0lA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<p>![图片](data:image/svg+xml,&lt;%3Fxml version=‘1.0’ encoding=‘UTF-8’%3F&gt;<svg width="1px" height="1px" viewbox="0 0 1 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title/><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" fill-opacity="0"><g transform="translate(-249.000000, -126.000000)" fill="%23FFFFFF"><rect x="249" y="126" width="1" height="1"/></g></g></svg>)</p>
<h3 id="分类变量直方图">分类变量直方图</h3>
<p>分类变量上的直方图将生成显示每个类别的条形图的频率图表。通过调整宽度，可以调整条形的厚度。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">theme_set(theme_classic())</span><br><span class="line"></span><br><span class="line"># Histogram on a Categorical variable</span><br><span class="line">g &lt;- ggplot(mpg, aes(manufacturer))</span><br><span class="line">g + geom_bar(aes(fill=class), width = 0.5) + </span><br><span class="line">  theme(axis.text.x = element_text(angle=65, vjust=0.6)) + </span><br><span class="line">  labs(title=&quot;Histogram on Categorical Variable&quot;, </span><br><span class="line">       subtitle=&quot;Manufacturer across Vehicle Classes&quot;)     </span><br></pre></td></tr></table></figure>
<p>![图片](data:image/svg+xml,&lt;%3Fxml version=‘1.0’ encoding=‘UTF-8’%3F&gt;<svg width="1px" height="1px" viewbox="0 0 1 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title/><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" fill-opacity="0"><g transform="translate(-249.000000, -126.000000)" fill="%23FFFFFF"><rect x="249" y="126" width="1" height="1"/></g></g></svg>)</p>
<h3 id="密度函数图">密度函数图</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">theme_set(theme_classic())</span><br><span class="line"></span><br><span class="line"># Plot</span><br><span class="line">g &lt;- ggplot(mpg, aes(cty))</span><br><span class="line">g + geom_density(aes(fill=factor(cyl)), alpha=0.8) + </span><br><span class="line">    labs(title=&quot;Density plot&quot;, </span><br><span class="line">         subtitle=&quot;City Mileage Grouped by Number of cylinders&quot;,</span><br><span class="line">         caption=&quot;Source: mpg&quot;,</span><br><span class="line">         x=&quot;City Mileage&quot;,</span><br><span class="line">         fill=&quot;# Cylinders&quot;)    </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyuJFWvvUKwLu1eEeRfh2BQloapUoiaBXQM00rdYLS6kTGs6qiaZACIWkw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="箱型图">箱型图</h3>
<p>箱形图是研究数据分布的一个好工具。它还可以显示多个组内的分布，以及中位数，范围和异常值。<br>
箱型图框内的黑线代表数据的中位数，箱子的顶部和底部分布时数据的75%和25%的分位数。线条的终点距离为1.5*IQR，IQR为第25和第75百分位数之间的距离。线条以外的点衬之为异常点。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">theme_set(theme_classic())</span><br><span class="line"></span><br><span class="line"># Plot</span><br><span class="line">g &lt;- ggplot(mpg, aes(class, cty))</span><br><span class="line">g + geom_boxplot(varwidth=T, fill=&quot;plum&quot;) + </span><br><span class="line">    labs(title=&quot;Box plot&quot;, </span><br><span class="line">         subtitle=&quot;City Mileage grouped by Class of vehicle&quot;,</span><br><span class="line">         caption=&quot;Source: mpg&quot;,</span><br><span class="line">         x=&quot;Class of Vehicle&quot;,</span><br><span class="line">         y=&quot;City Mileage&quot;)    </span><br></pre></td></tr></table></figure>
<p>![图片](data:image/svg+xml,&lt;%3Fxml version=‘1.0’ encoding=‘UTF-8’%3F&gt;<svg width="1px" height="1px" viewbox="0 0 1 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title/><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" fill-opacity="0"><g transform="translate(-249.000000, -126.000000)" fill="%23FFFFFF"><rect x="249" y="126" width="1" height="1"/></g></g></svg>)</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggthemes)</span><br><span class="line">g &lt;- ggplot(mpg, aes(class, cty))</span><br><span class="line">g + geom_boxplot(aes(fill=factor(cyl))) + </span><br><span class="line">  theme(axis.text.x = element_text(angle=65, vjust=0.6)) + </span><br><span class="line">  labs(title=&quot;Box plot&quot;, </span><br><span class="line">       subtitle=&quot;City Mileage grouped by Class of vehicle&quot;,</span><br><span class="line">       caption=&quot;Source: mpg&quot;,</span><br><span class="line">       x=&quot;Class of Vehicle&quot;,</span><br><span class="line">       y=&quot;City Mileage&quot;)</span><br></pre></td></tr></table></figure>
<p>![图片](data:image/svg+xml,&lt;%3Fxml version=‘1.0’ encoding=‘UTF-8’%3F&gt;<svg width="1px" height="1px" viewbox="0 0 1 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title/><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" fill-opacity="0"><g transform="translate(-249.000000, -126.000000)" fill="%23FFFFFF"><rect x="249" y="126" width="1" height="1"/></g></g></svg>)</p>
<h3 id="带点的箱型图">带点的箱型图</h3>
<p>除了箱型图的基本信息外，点图可以为箱型图提供更多的信息，在图中每个点代表一个观察点。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">theme_set(theme_bw())</span><br><span class="line"></span><br><span class="line"># plot</span><br><span class="line">g &lt;- ggplot(mpg, aes(manufacturer, cty))</span><br><span class="line">g + geom_boxplot() + </span><br><span class="line">  geom_dotplot(binaxis=&#x27;y&#x27;, </span><br><span class="line">               stackdir=&#x27;center&#x27;, </span><br><span class="line">               dotsize = .5, </span><br><span class="line">               fill=&quot;red&quot;) +</span><br><span class="line">  theme(axis.text.x = element_text(angle=65, vjust=0.6)) + </span><br><span class="line">  labs(title=&quot;Box plot + Dot plot&quot;, </span><br><span class="line">       subtitle=&quot;City Mileage vs Class: Each dot represents 1 row                 in source data&quot;,       caption=&quot;Source: mpg&quot;,</span><br><span class="line">       x=&quot;Class of Vehicle&quot;,</span><br><span class="line">       y=&quot;City Mileage&quot;)    </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZy3D6tUicrpq6bgNTNVhXeXk4icElxppw2ia6NibTRJr9ib9Z7XtqEvAjciaOg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="tufte-箱型图">Tufte 箱型图</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggthemes)</span><br><span class="line">library(ggplot2)</span><br><span class="line">theme_set(theme_tufte())  # from ggthemes</span><br><span class="line"></span><br><span class="line"># plot</span><br><span class="line">g &lt;- ggplot(mpg, aes(manufacturer, cty))</span><br><span class="line">g + geom_tufteboxplot() + </span><br><span class="line">      theme(axis.text.x = element_text(angle=65, vjust=0.6)) + </span><br><span class="line">      labs(title=&quot;Tufte Styled Boxplot&quot;, </span><br><span class="line">           subtitle=&quot;City Mileage grouped by Class of vehicle&quot;,</span><br><span class="line">           caption=&quot;Source: mpg&quot;,</span><br><span class="line">           x=&quot;Class of Vehicle&quot;,</span><br><span class="line">           y=&quot;City Mileage&quot;)</span><br></pre></td></tr></table></figure>
<p>![图片](data:image/svg+xml,&lt;%3Fxml version=‘1.0’ encoding=‘UTF-8’%3F&gt;<svg width="1px" height="1px" viewbox="0 0 1 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title/><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" fill-opacity="0"><g transform="translate(-249.000000, -126.000000)" fill="%23FFFFFF"><rect x="249" y="126" width="1" height="1"/></g></g></svg>)</p>
<h3 id="小提琴图">小提琴图</h3>
<p>小提琴图与箱型图类似，但是小提琴图还包含了数据的密度函数图。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">theme_set(theme_bw())</span><br><span class="line"></span><br><span class="line"># plot</span><br><span class="line">g &lt;- ggplot(mpg, aes(class, cty))</span><br><span class="line">g + geom_violin() + </span><br><span class="line">  labs(title=&quot;Violin plot&quot;, </span><br><span class="line">       subtitle=&quot;City Mileage vs Class of vehicle&quot;,</span><br><span class="line">       caption=&quot;Source: mpg&quot;,</span><br><span class="line">       x=&quot;Class of Vehicle&quot;,</span><br><span class="line">       y=&quot;City Mileage&quot;)</span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyGhFLO717lyClJfsMOSTyy3ZiayVb4kicnsibGcyJtV2ZqmLTGibniaPTg1g/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="人口金字塔图">人口金字塔图</h3>
<p>人口金字塔提供了一种独特的方式来可视化人口数量或人口百分比。下面的金字塔图，反映了在电子邮件营销活动渠道的每个阶段用户数。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">library(ggthemes)</span><br><span class="line">options(scipen = 999)  # turns of scientific notations like 1e+40</span><br><span class="line"></span><br><span class="line"># Read data</span><br><span class="line">email_campaign_funnel &lt;- read.csv(&quot;https://raw.githubusercontent.com/selva86/datasets/master/email_campaign_funnel.csv&quot;)</span><br><span class="line"># X Axis Breaks and Labels </span><br><span class="line">brks &lt;- seq(-15000000, 15000000, 5000000)</span><br><span class="line">lbls = paste0(as.character(c(seq(15, 0, -5), </span><br><span class="line">       seq(5, 15, 5))), &quot;m&quot;)</span><br><span class="line"></span><br><span class="line"># Plot</span><br><span class="line">ggplot(email_campaign_funnel, aes(x = Stage, </span><br><span class="line">       y = Users, fill = Gender)) +   # Fill column</span><br><span class="line">geom_bar(stat = &quot;identity&quot;, width = .6) +   # draw the bars</span><br><span class="line">scale_y_continuous(breaks = brks,   # Breaks</span><br><span class="line">labels = lbls) + # Labels</span><br><span class="line"> coord_flip() +  # Flip axes</span><br><span class="line">labs(title=&quot;Email Campaign Funnel&quot;) +</span><br><span class="line">theme_tufte() +  # Tufte theme from ggfortify</span><br><span class="line">theme(plot.title = element_text(hjust = .5), </span><br><span class="line">      axis.ticks = element_blank()) +   # Centre plot title</span><br><span class="line">scale_fill_brewer(palette = &quot;Dark2&quot;)  # Color palette    </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyDYA6yHMY8xn1Mz2tpEpuiaAIlK60FIMETUwUOzyMCJsanicH0zdhoxLw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h2 id="类型五-组成">类型五: 组成</h2>
<h3 id="华夫饼图">华夫饼图</h3>
<p>华夫饼图通常可以用来显示总人口分类。我们可以通过ggplot2的geom_tile()函数实现华夫饼图。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">var &lt;- mpg$class  # the categorical data </span><br><span class="line"></span><br><span class="line">nrows &lt;- 10</span><br><span class="line">df &lt;- expand.grid(y = 1:nrows, x = 1:nrows)</span><br><span class="line">categ_table &lt;- round(table(var) * ((nrows*nrows)/(length(var))))</span><br><span class="line">categ_table</span><br><span class="line"></span><br><span class="line">df$category &lt;- factor(rep(names(categ_table), categ_table))  </span><br><span class="line"></span><br><span class="line">## Plot</span><br><span class="line">ggplot(df, aes(x = x, y = y, fill = category)) + </span><br><span class="line">        geom_tile(color = &quot;black&quot;, size = 0.5) +</span><br><span class="line">        scale_x_continuous(expand = c(0, 0)) +</span><br><span class="line">        scale_y_continuous(expand = c(0, 0), trans = &#x27;reverse&#x27;) +</span><br><span class="line">        scale_fill_brewer(palette = &quot;Set3&quot;) +</span><br><span class="line">        labs(title=&quot;Waffle Chart&quot;, subtitle=&quot;&#x27;Class&#x27; of vehicles&quot;,</span><br><span class="line">             caption=&quot;Source: mpg&quot;)   </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZy8Y3ooQrryYeI3fo1dVFhUOxQlbAML6q4DPNpmice2F32674aCazJvjA/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="饼图">饼图</h3>
<p>饼图是显示数据组成的一种重要方式，在ggplot中，需要通过coord_polar()函数来实现。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">theme_set(theme_classic())</span><br><span class="line"></span><br><span class="line"># Source: Frequency table</span><br><span class="line">df &lt;- as.data.frame(table(mpg$class))</span><br><span class="line">colnames(df) &lt;- c(&quot;class&quot;, &quot;freq&quot;)</span><br><span class="line">pie &lt;- ggplot(df, aes(x = &quot;&quot;, y=freq, fill = factor(class))) + </span><br><span class="line">  geom_bar(width = 1, stat = &quot;identity&quot;) +</span><br><span class="line">  theme(axis.line = element_blank(), </span><br><span class="line">        plot.title = element_text(hjust=0.5)) + </span><br><span class="line">  labs(fill=&quot;class&quot;, </span><br><span class="line">       x=NULL, </span><br><span class="line">       y=NULL, </span><br><span class="line">       title=&quot;Pie Chart of class&quot;, </span><br><span class="line">       caption=&quot;Source: mpg&quot;)</span><br><span class="line"></span><br><span class="line">pie + coord_polar(theta = &quot;y&quot;, start=0)</span><br><span class="line"></span><br><span class="line"># Source: Categorical variable.</span><br><span class="line"># mpg$class</span><br><span class="line">pie &lt;- ggplot(mpg, aes(x = &quot;&quot;, fill = factor(class))) + </span><br><span class="line">  geom_bar(width = 1) +</span><br><span class="line">  theme(axis.line = element_blank(), </span><br><span class="line">        plot.title = element_text(hjust=0.5)) + </span><br><span class="line">  labs(fill=&quot;class&quot;, </span><br><span class="line">       x=NULL, </span><br><span class="line">       y=NULL, </span><br><span class="line">       title=&quot;Pie Chart of class&quot;, </span><br><span class="line">       caption=&quot;Source: mpg&quot;)</span><br><span class="line">  </span><br><span class="line">pie + coord_polar(theta = &quot;y&quot;, start=0)    </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyhzWDVOHib4kWQUBF5XcCEDLxYl2EdloZdDW9r09Mv2VO76CqmbicTJAw/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="树形图">树形图</h3>
<p>树形图是现实分层数据的好方法。在ggplot中，treemapify包含有树形图所需要的数据处理及绘图方法。<br>
为了创建树形图，需要先将数据转换成treemapify()需要的数据格式。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"> library(ggplot2) </span><br><span class="line">library(treemapify)</span><br><span class="line">proglangs &lt;- read.csv(&quot;https://raw.githubusercontent.com/             selva86/datasets/master/proglanguages.csv&quot;)</span><br><span class="line"># plot</span><br><span class="line">treeMapCoordinates &lt;- treemapify(proglangs,</span><br><span class="line">                                 area = &quot;value&quot;,</span><br><span class="line">                                 fill = &quot;parent&quot;,</span><br><span class="line">                                 label = &quot;id&quot;,</span><br><span class="line">                                 group = &quot;parent&quot;)</span><br><span class="line"></span><br><span class="line">treeMapPlot &lt;- ggplotify(treeMapCoordinates) + </span><br><span class="line">  scale_x_continuous(expand = c(0, 0)) +</span><br><span class="line">  scale_y_continuous(expand = c(0, 0)) +</span><br><span class="line">  scale_fill_brewer(palette = &quot;Dark2&quot;)</span><br><span class="line"></span><br><span class="line">print(treeMapPlot)</span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyVZB5ib6dpicBPrju8dWNTc0klS3mmP0HN7ibYg8codE3Xf1lMbjFuuqrQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="条形图">条形图</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">freqtable &lt;- table(mpg$manufacturer)</span><br><span class="line">df &lt;- as.data.frame.table(freqtable)    </span><br><span class="line">library(ggplot2)</span><br><span class="line">theme_set(theme_classic())</span><br><span class="line"></span><br><span class="line"># Plot</span><br><span class="line">g &lt;- ggplot(df, aes(Var1, Freq))</span><br><span class="line">g + geom_bar(stat=&quot;identity&quot;, width = 0.5, fill=&quot;tomato2&quot;) + </span><br><span class="line">      labs(title=&quot;Bar Chart&quot;, </span><br><span class="line">           subtitle=&quot;Manufacturer of vehicles&quot;, </span><br><span class="line">           caption=&quot;Source: Frequency of Manufacturers from            &#x27;mpg&#x27; dataset&quot;) +      theme(axis.text.x = element_text(angle=65, vjust=0.6))     </span><br><span class="line">          </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZygA91OcEFSk5b1nKibiaTwbTPO78M43SnPvZdmnfiaT5k71kdbYCwE8e7A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<p>当然还可以按组对数据进行着色</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># From on a categorical column variable</span><br><span class="line">g &lt;- ggplot(mpg, aes(manufacturer))</span><br><span class="line">g + geom_bar(aes(fill=class), width = 0.5) + </span><br><span class="line">  theme(axis.text.x = element_text(angle=65, vjust=0.6)) +</span><br><span class="line">  labs(title=&quot;Categorywise Bar Chart&quot;, </span><br><span class="line">       subtitle=&quot;Manufacturer of vehicles&quot;, </span><br><span class="line">       caption=&quot;Source: Manufacturers from &#x27;mpg&#x27; dataset&quot;)    </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyeCo1MqCDRHsV6IZKwybIWV9cQVib9dkvibzaT42uTfZluExhOI1pbq6Q/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h2 id="类型六-时序变化">类型六:时序变化</h2>
<h3 id="时间序列图">时间序列图</h3>
<p>ggfortify包支持autoplot函数直接从时间序列对象中自动绘制时间序列图。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">## From Timeseries object (ts)</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggfortify)</span><br><span class="line">theme_set(theme_classic())</span><br><span class="line"></span><br><span class="line"># Plot </span><br><span class="line">autoplot(AirPassengers) + </span><br><span class="line">  labs(title=&quot;AirPassengers&quot;)    </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyanmUk5Al6jV0OvbF2uV8BNZxMfIRbvGUlbnbUeNickw4zcoFY0V2hXQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="dataframe格式的时间序列图">dataframe格式的时间序列图</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">theme_set(theme_classic())</span><br><span class="line"></span><br><span class="line"># Allow Default X Axis Labels</span><br><span class="line">ggplot(economics, aes(x=date)) + </span><br><span class="line">  geom_line(aes(y=returns_perc)) + </span><br><span class="line">  labs(title=&quot;Time Series Chart&quot;, </span><br><span class="line">       subtitle=&quot;Returns Percentage from &#x27;Economics&#x27; Dataset&quot;, </span><br><span class="line">       caption=&quot;Source: Economics&quot;, </span><br><span class="line">       y=&quot;Returns %&quot;)    </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyricRP6CfMAvBlTL4a6L0FomzibJJSiaoNia3j8tOXeAC6n0H9laDo0070w/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="关于月度数据的时间序列图">关于月度数据的时间序列图</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">library(lubridate)</span><br><span class="line">theme_set(theme_bw())</span><br><span class="line"></span><br><span class="line">economics_m &lt;- economics[1:24, ]</span><br><span class="line"></span><br><span class="line"># labels and breaks for X axis text</span><br><span class="line">lbls &lt;- paste0(month.abb[month(economics_m$date)], &quot; &quot;, </span><br><span class="line">lubridate::year(economics_m$date))</span><br><span class="line">brks &lt;- economics_m$date</span><br><span class="line"></span><br><span class="line"># plot</span><br><span class="line">ggplot(economics_m, aes(x=date)) + </span><br><span class="line">  geom_line(aes(y=uempmed)) + </span><br><span class="line">  labs(title=&quot;Monthly Time Series&quot;, </span><br><span class="line">       subtitle=&quot;Returns Percentage from Economics Dataset&quot;, </span><br><span class="line">       caption=&quot;Source: Economics&quot;, </span><br><span class="line">       y=&quot;Returns %&quot;) +  # title and caption</span><br><span class="line">  scale_x_date(labels = lbls, </span><br><span class="line">               breaks = brks) +  </span><br><span class="line">  theme(axis.text.x = element_text(angle = 90, vjust=0.5),  </span><br><span class="line">        panel.grid.minor = element_blank())     </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyZMqoWMTnkzmbMbnpxtg4GiaqibSLZh3micu4tqibZbyXAzfwVWdeXjYiaVg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="关于年度数据的时间序列图">关于年度数据的时间序列图</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">library(lubridate)</span><br><span class="line">theme_set(theme_bw())</span><br><span class="line"></span><br><span class="line">economics_y &lt;- economics[1:90, ]</span><br><span class="line"></span><br><span class="line"># labels and breaks for X axis text</span><br><span class="line">brks &lt;- economics_y$date[seq(1, length(economics_y$date), 12)]</span><br><span class="line">lbls &lt;- lubridate::year(brks)</span><br><span class="line"></span><br><span class="line"># plot</span><br><span class="line">ggplot(economics_y, aes(x=date)) + </span><br><span class="line">  geom_line(aes(y=uempmed)) + </span><br><span class="line">  labs(title=&quot;Yearly Time Series&quot;, </span><br><span class="line">       subtitle=&quot;uempmed Percentage from Economics Dataset&quot;, </span><br><span class="line">       caption=&quot;Source: Economics&quot;, </span><br><span class="line">       y=&quot;uempmed %&quot;) +  # title and caption</span><br><span class="line">  scale_x_date(labels = lbls, </span><br><span class="line">               breaks = brks) + </span><br><span class="line">  theme(axis.text.x = element_text(angle = 90, vjust=0.5),          panel.grid.minor = element_blank())     </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZypneiaRbk16BsSNmq2v7TXxzd7icEiaRpXxg9ky1s1XFeaWtresGhLYpzg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="同时展示多个时间序列">同时展示多个时间序列</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">data(economics_long, package = &quot;ggplot2&quot;)</span><br><span class="line">head(economics_long)</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(lubridate)</span><br><span class="line">theme_set(theme_bw())</span><br><span class="line"></span><br><span class="line">df &lt;- economics_long[economics_long$variable %in% </span><br><span class="line"> c(&quot;psavert&quot;, &quot;uempmed&quot;), ]</span><br><span class="line">df &lt;- df[lubridate::year(df$date) %in% c(1967:1981), ]</span><br><span class="line"></span><br><span class="line"># labels and breaks for X axis text</span><br><span class="line">brks &lt;- df$date[seq(1, length(df$date), 12)]</span><br><span class="line">lbls &lt;- lubridate::year(brks)</span><br><span class="line"></span><br><span class="line"># plot</span><br><span class="line">ggplot(df, aes(x=date)) + </span><br><span class="line">  geom_line(aes(y=value, col=variable)) + </span><br><span class="line">  labs(title=&quot;Time Series of Returns Percentage&quot;, </span><br><span class="line">       subtitle=&quot;Drawn from Long Data format&quot;, </span><br><span class="line">       caption=&quot;Source: Economics&quot;, </span><br><span class="line">       y=&quot;Returns %&quot;, </span><br><span class="line">       color=NULL) +  # title and caption</span><br><span class="line">  scale_x_date(labels = lbls, breaks = brks) +  </span><br><span class="line">  scale_color_manual(labels = c(&quot;psavert&quot;, &quot;uempmed&quot;), </span><br><span class="line">                     values = c(&quot;psavert&quot;=&quot;#00ba38&quot;,  </span><br><span class="line">                     &quot;uempmed&quot;=&quot;#f8766d&quot;)) +  </span><br><span class="line">  theme(axis.text.x = element_text(angle = 90, vjust=0.5, size = 8),  </span><br><span class="line">        panel.grid.minor = element_blank())      </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyRKgr7tyibCyCYOnVjibUe5OdF3gfeFjCXoWJwwpffD5pOfVofTChaAWg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="堆积图">堆积图</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">library(lubridate)</span><br><span class="line">theme_set(theme_bw())</span><br><span class="line"></span><br><span class="line">df &lt;- economics[, c(&quot;date&quot;, &quot;psavert&quot;, &quot;uempmed&quot;)]</span><br><span class="line">df &lt;- df[lubridate::year(df$date) %in% c(1967:1981), ]</span><br><span class="line"></span><br><span class="line"># labels and breaks for X axis text</span><br><span class="line">brks &lt;- df$date[seq(1, length(df$date), 12)]</span><br><span class="line">lbls &lt;- lubridate::year(brks)</span><br><span class="line"></span><br><span class="line"># plot</span><br><span class="line">ggplot(df, aes(x=date)) + </span><br><span class="line">  geom_area(aes(y=psavert+uempmed, fill=&quot;psavert&quot;)) + </span><br><span class="line">  geom_area(aes(y=uempmed, fill=&quot;uempmed&quot;)) + </span><br><span class="line">  labs(title=&quot;Area Chart of Returns Percentage&quot;, </span><br><span class="line">       subtitle=&quot;From Wide Data format&quot;, </span><br><span class="line">       caption=&quot;Source: Economics&quot;, </span><br><span class="line">       y=&quot;Returns %&quot;) +  </span><br><span class="line">  scale_x_date(labels = lbls, breaks = brks) +  </span><br><span class="line">  scale_fill_manual(name=&quot;&quot;, </span><br><span class="line">  values = c(&quot;psavert&quot;=&quot;#00ba38&quot;, &quot;uempmed&quot;=&quot;#f8766d&quot;)) +  </span><br><span class="line">  theme(panel.grid.minor = element_blank())      </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyrJ2HTYO7PVf9icIsiaibfWLckR9F9kPkd8QRQ8MnGq2zhLIvu9hBanK9g/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="日历热图">日历热图</h3>
<p>当你想强调在日历格式中，数据变化情况(如股票数据)，那么就可以使用日历热图。通过数据准备，我们可以用geom_tile函数来实现日历热图。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">library(plyr)</span><br><span class="line">library(scales)</span><br><span class="line">library(zoo)</span><br><span class="line"></span><br><span class="line">df &lt;- read.csv(&quot;https://raw.githubusercontent.com/selva86/datasets/master/yahoo.csv&quot;)df$date &lt;- as.Date(df$date)  # format date</span><br><span class="line">df &lt;- df[df$year &gt;= 2012, ]  # filter reqd years</span><br><span class="line"></span><br><span class="line"># Create Month Week</span><br><span class="line">df$yearmonth &lt;- as.yearmon(df$date)</span><br><span class="line">df$yearmonthf &lt;- factor(df$yearmonth)</span><br><span class="line">df &lt;- ddply(df,.(yearmonthf), transform, monthweek=1+week-min(week))  </span><br><span class="line">df &lt;- df[, c(&quot;year&quot;, &quot;yearmonthf&quot;, &quot;monthf&quot;, </span><br><span class="line">&quot;week&quot;, &quot;monthweek&quot;, &quot;weekdayf&quot;, &quot;VIX.Close&quot;)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Plot</span><br><span class="line">ggplot(df, aes(monthweek, weekdayf, fill = VIX.Close)) + </span><br><span class="line">  geom_tile(colour = &quot;white&quot;) + </span><br><span class="line">  facet_grid(year~monthf) + </span><br><span class="line">  scale_fill_gradient(low=&quot;red&quot;, high=&quot;green&quot;) +</span><br><span class="line">  labs(x=&quot;Week of Month&quot;,</span><br><span class="line">       y=&quot;&quot;,</span><br><span class="line">       title = &quot;Time-Series Calendar Heatmap&quot;, </span><br><span class="line">       subtitle=&quot;Yahoo Closing Price&quot;, </span><br><span class="line">       fill=&quot;Close&quot;)    </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZye93T9EPfBX2kBGRMqsuaMmvUsxw04SibahoFHodqI5UTbAVibXI9uiazQ/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="季节性时间序列">季节性时间序列</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(ggplot2)</span><br><span class="line">library(forecast)</span><br><span class="line">theme_set(theme_classic())</span><br><span class="line"></span><br><span class="line"># Subset data</span><br><span class="line">nottem_small &lt;- window(nottem, start=c(1920, 1), end=c(1925, 12))  # subset a smaller timewindow</span><br><span class="line"># Plot</span><br><span class="line">ggseasonplot(AirPassengers) +    labs(title=&quot;Seasonal plot: International Airline Passengers&quot;)ggseasonplot(nottem_small) +    labs(title=&quot;Seasonal plot: Air temperatures at Nottingham Castle&quot;)   </span><br><span class="line"> </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyDcBLCxqEhArJiabn62xRyEsZaoGYSNSaibN9yQbdUopBqkA3UUOZFX7A/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyFmI8KgB4FK6hqDibvS6liahFAO4JDj6SAEQRdNUDia1IKU4hT0f3HWhUA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h2 id="类型七-分组">类型七: 分组</h2>
<h3 id="分层树形图">分层树形图</h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># install.packages(&quot;ggdendro&quot;)</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggdendro)</span><br><span class="line">theme_set(theme_bw())</span><br><span class="line"></span><br><span class="line">hc &lt;- hclust(dist(USArrests), &quot;ave&quot;)  # hierarchical clustering</span><br><span class="line"></span><br><span class="line"># plot</span><br><span class="line">ggdendrogram(hc, rotate = TRUE, size = 2)    </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyQic81dyMMPRHBrcwtGmhNsAadoia0leraFyTqaBaYN2Vib1Cjfgic8Xx7Q/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="组群">组群</h3>
<p>对于不同的数据蔟，我们可以用geom_<em>encircle()来显示。如果数据存在多维特征，可以考虑采用PCA降维，并将第一主成分与第二主成分作为图形的X、Y轴。geom</em>encircle（）将需要突出的数据蔟包围起来，从而达到突出数据的作用。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># devtools::install_github(&quot;hrbrmstr/ggalt&quot;)</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggalt)</span><br><span class="line">library(ggfortify)</span><br><span class="line">theme_set(theme_classic())</span><br><span class="line"></span><br><span class="line">df &lt;- iris[c(1, 2, 3, 4)]</span><br><span class="line">pca_mod &lt;- prcomp(df)  </span><br><span class="line"></span><br><span class="line">df_pc &lt;- data.frame(pca_mod$x, Species=iris$Species)  </span><br><span class="line">df_pc_vir &lt;- df_pc[df_pc$Species == &quot;virginica&quot;, ]  </span><br><span class="line">df_pc_set &lt;- df_pc[df_pc$Species == &quot;setosa&quot;, ]  </span><br><span class="line">df_pc_ver &lt;- df_pc[df_pc$Species == &quot;versicolor&quot;, ]  </span><br><span class="line"> </span><br><span class="line"># Plot ----------------------------------------------------</span><br><span class="line">ggplot(df_pc, aes(PC1, PC2, col=Species)) + </span><br><span class="line">  geom_point(aes(shape=Species), size=2) +   </span><br><span class="line">  labs(title=&quot;Iris Clustering&quot;, </span><br><span class="line">       subtitle=&quot;With principal components PC1 and </span><br><span class="line">       PC2 as X and Y axis&quot;,</span><br><span class="line">       caption=&quot;Source: Iris&quot;) + </span><br><span class="line">  coord_cartesian(xlim = 1.2 * c(min(df_pc$PC1), max(df_pc$PC1)), </span><br><span class="line">                  ylim = 1.2 * c(min(df_pc$PC2), max(df_pc$PC2))) +   </span><br><span class="line">  geom_encircle(data = df_pc_vir, aes(x=PC1, y=PC2)) +   </span><br><span class="line">  geom_encircle(data = df_pc_set, aes(x=PC1, y=PC2)) + </span><br><span class="line">  geom_encircle(data = df_pc_ver, aes(x=PC1, y=PC2))    </span><br></pre></td></tr></table></figure>
<p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyHg34x9NPRdU2kxicib4hw7mpEia84pktDJcKV7RVHSsH3Du8EYCSBicyZg/640?wx_fmt=jpeg&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h2 id="类型八-空间可视化">类型八: 空间可视化</h2>
<p>ggmap包提供了与google maps api交互的工具，并获取要绘制的地点的坐标 。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Better install the dev versions ----------</span><br><span class="line"># devtools::install_github(&quot;dkahle/ggmap&quot;)</span><br><span class="line"># devtools::install_github(&quot;hrbrmstr/ggalt&quot;)</span><br><span class="line"></span><br><span class="line"># load packages</span><br><span class="line">library(ggplot2)</span><br><span class="line">library(ggmap)</span><br><span class="line">library(ggalt)</span><br><span class="line"></span><br><span class="line"># Get Chennai&#x27;s Coordinates --------------------------------</span><br><span class="line">chennai &lt;-  geocode(&quot;Chennai&quot;)  </span><br><span class="line"></span><br><span class="line"># Get the Map ----------------------------------------------</span><br><span class="line"># Google Satellite Map</span><br><span class="line">chennai_ggl_sat_map &lt;- qmap(&quot;chennai&quot;, zoom=12, </span><br><span class="line">source = &quot;google&quot;, maptype=&quot;satellite&quot;)  </span><br><span class="line"></span><br><span class="line"># Google Road Map</span><br><span class="line">chennai_ggl_road_map &lt;- qmap(&quot;chennai&quot;, zoom=12, </span><br><span class="line">source = &quot;google&quot;, maptype=&quot;roadmap&quot;)  </span><br><span class="line"></span><br><span class="line"># Google Hybrid Map</span><br><span class="line">chennai_ggl_hybrid_map &lt;- qmap(&quot;chennai&quot;, zoom=12, </span><br><span class="line">source = &quot;google&quot;, maptype=&quot;hybrid&quot;)  </span><br><span class="line"></span><br><span class="line"># Open Street Map</span><br><span class="line">chennai_osm_map &lt;- qmap(&quot;chennai&quot;, zoom=12, source = &quot;osm&quot;)   </span><br><span class="line"></span><br><span class="line"># Get Coordinates for Chennai&#x27;s Places ---------------------</span><br><span class="line">chennai_places &lt;- c(&quot;Kolathur&quot;,</span><br><span class="line">                    &quot;Washermanpet&quot;,</span><br><span class="line">                    &quot;Royapettah&quot;,</span><br><span class="line">                    &quot;Adyar&quot;,</span><br><span class="line">                    &quot;Guindy&quot;)</span><br><span class="line"></span><br><span class="line">places_loc &lt;- geocode(chennai_places)  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># Plot Open Street Map -------------------------------------</span><br><span class="line">chennai_osm_map + geom_point(aes(x=lon, y=lat),</span><br><span class="line">                             data = places_loc, </span><br><span class="line">                             alpha = 0.7, </span><br><span class="line">                             size = 7, </span><br><span class="line">                             color = &quot;tomato&quot;) + </span><br><span class="line">  geom_encircle(aes(x=lon, y=lat),</span><br><span class="line">                data = places_loc, size = 2, color = &quot;blue&quot;)</span><br><span class="line"></span><br><span class="line"># Plot Google Road Map -------------------------------------</span><br><span class="line">chennai_ggl_road_map + geom_point(aes(x=lon, y=lat),</span><br><span class="line">                                  data = places_loc, </span><br><span class="line">                                  alpha = 0.7, </span><br><span class="line">                                  size = 7, </span><br><span class="line">                                  color = &quot;tomato&quot;) + </span><br><span class="line">  geom_encircle(aes(x=lon, y=lat),</span><br><span class="line">                data = places_loc, size = 2, color = &quot;blue&quot;)</span><br><span class="line"></span><br><span class="line"># Google Hybrid Map ----------------------------------------</span><br><span class="line">chennai_ggl_hybrid_map + geom_point(aes(x=lon, y=lat),</span><br><span class="line">                                    data = places_loc, </span><br><span class="line">                                    alpha = 0.7, </span><br><span class="line">                                    size = 7, </span><br><span class="line">                                    color = &quot;tomato&quot;) + </span><br><span class="line">  geom_encircle(aes(x=lon, y=lat),</span><br><span class="line">                data = places_loc, size = 2, color = &quot;blue&quot;)    </span><br></pre></td></tr></table></figure>
<h3 id="街道地图">街道地图</h3>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyibv5wAsWIKWLcVj2I1CsxRDWD12yiaHicZSHMEecibiaPdrQIicDrUHywBgA/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="谷歌道路图">谷歌道路图</h3>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZyWpgOIrSlAyCCiajfYkiavFhicKDGoBfn4Tyla7wKlwshZa7TCwS3nKeQQ/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
<h3 id="谷歌卫星地图">谷歌卫星地图</h3>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/mPW54JA3nXcz9vIcRgxOlHRRpjSbiaXZygbFyKzY8E3iao7saRrEWBZHhGWGgxk2xzibSAkR50AbWHrkJspCibuaibg/640?wx_fmt=png&amp;wxfrom=5&amp;wx_lazy=1&amp;wx_co=1" alt="图片"></p>
]]></content>
      <tags>
        <tag>ggplot</tag>
      </tags>
  </entry>
  <entry>
    <title>outlier_detection</title>
    <url>/2023/07/31/outlier-detection/</url>
    <content><![CDATA[<p>[TOC]</p>
<h1>单变量和多变量异常值</h1>
<p><strong>异常值</strong>是偏离数据集中大多数样本点的数据点。出现异常值的原因有很多，例如自然偏差、欺诈活动、人为或系统错误。不过，在我们进行任何统计分析或训练机器学习模型之前，对数据检测和识别异常值都是必不可少的，这个预处理的过程会影响最后的效果。</p>
<p>本文覆盖“单变量”和“多变量”异常值场景、以及使用统计方法和机器学习异常检测技术来识别它们，包括四分位距和标准差方法、孤立森林、DBSCAN模型以及 LOF 局部离群因子模型等。</p>
<p>通过使用<code>seaborn</code>的<code>pairplot</code>我们可以绘制数据集不同字段之间的两两分布关系，可以<strong>可视化</strong>地查看数据的分布情况。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#两两分布关系</span><br><span class="line">import pandas as pd</span><br><span class="line">glass = pd.read_csv(&#x27;glass.csv&#x27;)</span><br><span class="line">import seaborn as sns</span><br><span class="line">sns.pairplot(glass, diag_kws=&#123;&#x27;color&#x27;:&#x27;red&#x27;&#125;)</span><br></pre></td></tr></table></figure>
<p>pairplot 的结果包含两两数据的关联分析和每个变量的分布结果，其中对角线为单变量的分布可视化，我们发现并非所有属性字段都具有遵循<strong>正态分布</strong>。<strong>事实上，大多数属性都偏向较低值（即 Ba、Fe*）或较高值（即 Mg）</strong></p>
<p>如果要检测<strong>单变量异常值</strong>，我们应该关注单个属性的分布，并找到远离该属性大部分数据的数据点。例如，如果我们选择属性“Na”并绘制箱线图，可以找到哪些数据点在上下边界之外，可以标记为异常值。</p>
<p>如果要检测<strong>多变量异常值</strong>，我们应该关注 n 维空间中至少两个变量的组合。例如，在上述数据集中，我们可以使用玻璃的所有八个属性并将它们绘制在 n 维空间中，并通过检测哪些数据点落在远处来找到多元异常值。</p>
<p>但是因为绘制三维以上的图非常困难，我们要想办法将八个维度的数据在低维空间内表征。我们可以使用PCA（主成分分析）降维方法完成，具体的代码如下所示：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from sklearn.decomposition import PCA</span><br><span class="line">import plotly.express as px</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># Dimensionality reduction to 3 dimensions</span><br><span class="line">pca = PCA(n_components=3) </span><br><span class="line">glass_pca = pca.fit_transform(glass.iloc[:, :-1])</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># 3D scatterplot</span><br><span class="line">fig = px.scatter_3d(x=glass_pca[:, 0],</span><br><span class="line">                    y=glass_pca[:, 1], </span><br><span class="line">                    z=glass_pca[:, 2],</span><br><span class="line">                    color=glass.iloc[:, -1])</span><br><span class="line">fig.show()</span><br></pre></td></tr></table></figure>
<p>在上图中可以看到，有些数据点彼此靠近（组成密集区域），有些距离很远，可能是<strong>多变量异常值</strong>。</p>
<h1>单变量异常值检测</h1>
<p><img src="/2023/07/31/outlier-detection/resize4.png" alt></p>
<h2 id="基于分布-标准差法">基于分布–标准差法</h2>
<p>假设一个变量是正态分布的，那它的直方图应遵循正态分布曲线（如下图所示），其中 68.2% 的数据值位于距均值1个标准差范围内，95.4% 的数据值位于距均值2个标准差范围内，99.7% 的数据值位于距均值3个标准差范围内。因此，如果有数据点距离平均值超过3个标准差，我们就可以将其视作异常值。这也是著名的异常检测3sigma法。具体的的代码实现如下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Find mean, standard deviation and cut off value </span><br><span class="line">mean = glass[&quot;Na&quot;].mean()</span><br><span class="line">std = glass[&quot;Na&quot;].std()</span><br><span class="line">cutoff = 3 * std</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># Define lower and upper boundaries</span><br><span class="line">lower, upper = mean-cutoff, mean+cutoff</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># Define new dataset by masking upper and lower boundaries</span><br><span class="line">new_glass = glass[(glass[&quot;Na&quot;] &gt; lower) &amp; (glass[&quot;Na&quot;] &lt; upper)]</span><br></pre></td></tr></table></figure>
<p>通过使用标准偏差法，我们基于“Na”变量删除了2条极端记录。大家可以用同样的方法在其他属性上，检测和移除单变量异常值</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Shape of original dataset: (213, 9)</span><br><span class="line">Shape of dataset after removing outliers in Na column: (211, 9)</span><br></pre></td></tr></table></figure>
<h2 id="基于分布-四分位距法">基于分布–四分位距法</h2>
<p>四分位数间距方法是一个基于箱线图的统计方法，它通过定义三个数据分布位点将数据进行划分，并计算得到统计边界值：</p>
<ul>
<li>四分位数 1 (Q1) 表示第 25 个百分位数</li>
<li>四分位数 2 (Q2) 表示第 50 个百分位数</li>
<li>四分位数 3 (Q3) 表示第 75 个百分位数</li>
</ul>
<p>箱线图中的方框表示 IQR 范围，定义为 Q1 和 Q3 之间的范围：<code>IQR = Q3 — Q1</code></p>
<p>低于的数据点<code>Q1 - 1.5*IQR</code>或以上<code>Q3 + 1.5*IQR</code>被定义为异常值。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># Find Q1, Q3, IQR and cut off value </span><br><span class="line">q25, q75 = np.quantile(glass[&quot;Na&quot;], 0.25), np.quantile(glass[&quot;Na&quot;], 0.75)</span><br><span class="line">iqr = q75 - q25</span><br><span class="line">cutoff = 1.5 * iqr</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># Define lower and upper boundaries</span><br><span class="line">lower, upper = q25 - cutoff, q75 + cutoff</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"># Define new dataset by masking upper and lower boundaries</span><br><span class="line">new_glass = glass[(glass[&quot;Na&quot;] &gt; lower) &amp; (glass[&quot;Na&quot;] &lt; upper)]</span><br><span class="line">Shape of original dataset: (213, 9)</span><br><span class="line">Shape of dataset after removing outliers in Na column: (206, 9)</span><br></pre></td></tr></table></figure>
<p>我们可以看到，基于 IQR 技术，从“Na”变量维度我们删除了七个记录。我们注意到，基于标准偏差方法只能找到 2 个异常值，是非常极端的极值点，但是使用 IQR 方法我们能够检测到更多（5 个不是那么极端的记录）。</p>
<h2 id="基于分布-z-score">基于分布–Z-score</h2>
<p>Z-score为标准分数，测量数据点和平均值的距离，若A与平均值相差2个标准差，Z-score为2。当把Z-score=3作为阈值去剔除异常点时，便相当于3sigma。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">def z_score(s):</span><br><span class="line">  z_score = (s - np.mean(s)) / np.std(s)</span><br><span class="line">  return z_score</span><br></pre></td></tr></table></figure>
<h2 id="基于分布-grubbs假设检验">基于分布–Grubbs假设检验</h2>
<p>Grubbs’Test为一种假设检验的方法，常被用来检验服从正态分布的单变量数据集（univariate data set）Y中的单个异常值。若有异常值，则其必为数据集中的最大值或最小值。原假设与备择假设如下：</p>
<p>H0: 数据集中没有异常值<br>
H1: 数据集中有一个异常值<br>
使用Grubbs测试需要总体是正态分布的。算法流程：</p>
<ol>
<li>样本从小到大排序</li>
<li>求样本的mean和dev</li>
<li>计算min/max与mean的差距，更大的那个为可疑值</li>
<li>求可疑值的z-score (standard score)，如果大于Grubbs临界值，那么就是outlier</li>
</ol>
<p>Grubbs临界值可以查表得到，它由两个值决定：检出水平α（越严格越小），样本数量n，排除outlier，对剩余序列循环做 1-4 步骤 [1]。详细计算样例可以参考。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from outliers import smirnov_grubbs as grubbs</span><br><span class="line">print(grubbs.test([8, 9, 10, 1, 9], alpha=0.05))</span><br><span class="line">print(grubbs.min_test_outliers([8, 9, 10, 1, 9], alpha=0.05))</span><br><span class="line">print(grubbs.max_test_outliers([8, 9, 10, 1, 9], alpha=0.05))</span><br><span class="line">print(grubbs.max_test_indices([8, 9, 10, 50, 9], alpha=0.05))</span><br></pre></td></tr></table></figure>
<h2 id="基于距离的方法-knn">基于距离的方法-KNN</h2>
<p>依次计算每个样本点与它最近的K个样本的平均距离，再利用计算的距离与阈值进行比较，如果大于阈值，则认为是异常点。优点是不需要假设数据的分布，缺点是仅可以找出全局异常点，无法找到局部异常点。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pyod.models.knn import KNN</span><br><span class="line"></span><br><span class="line"># 初始化检测器clf</span><br><span class="line">clf = KNN( method=&#x27;mean&#x27;, n_neighbors=3, )</span><br><span class="line">clf.fit(X_train)</span><br><span class="line"># 返回训练数据上的分类标签 (0: 正常值, 1: 异常值)</span><br><span class="line">y_train_pred = clf.labels_</span><br><span class="line"># 返回训练数据上的异常值 (分值越大越异常)</span><br><span class="line">y_train_scores = clf.decision_scores_</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1>多变量异常值检测</h1>
<h2 id="孤立森林算法-isolation-forest">孤立森林算法-Isolation Forest</h2>
<p><strong>孤立森林</strong>是一种基于随机森林的无监督机器学习算法。我们都知道，随机森林是一种集成学习模型，它使用基模型（比如 100 个决策树）组合和集成完成最后的预估。孤立森林遵循随机森林的方法，但相比之下，它检测（或叫做隔离）异常数据点。它有两个基本假设：离群值是少数样本，且它们是分布偏离的。</p>
<p><strong>孤立森林通过随机选择一个特征，然后随机选择一个分割规则来分割所选特征的值来创建决策树</strong>。这个过程一直持续到达到设置的超参数值。在构建好的孤立森林中，如果树更短且对应分支样本数更少，则相应的值是异常值（少数和不寻常）。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from sklearn.ensemble import IsolationForest</span><br><span class="line">IsolationForest(n_estimators=100, max_samples=&#x27;auto&#x27;, contamination=&#x27;auto&#x27;, max_features=1.0, bootstrap=False, n_jobs=None, random_state=None, verbose=0, warm_start=False)</span><br><span class="line">n_estimators：表示要集成的基模型的数量。</span><br><span class="line">max_samples：表示用于训练模型的样本数。</span><br><span class="line">contamination：用于定义数据中异常值的比例。</span><br><span class="line">max_features：表示采样处的用于训练的特征数。</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from sklearn.ensemble import IsolationForest</span><br><span class="line"> </span><br><span class="line"># Initiate isolation forest</span><br><span class="line">isolation = IsolationForest(n_estimators=100, </span><br><span class="line">                            contamination=&#x27;auto&#x27;, </span><br><span class="line">                            max_features=glass.shape[1]) </span><br><span class="line"> </span><br><span class="line"># Fit and predict</span><br><span class="line">isolation.fit(glass)</span><br><span class="line">outliers_predicted = isolation.predict(glass)</span><br><span class="line"> </span><br><span class="line"># Address outliers in a new column</span><br><span class="line">glass[&#x27;outlier&#x27;] = outliers_predicted</span><br></pre></td></tr></table></figure>
<p>我们通过将基模型的数量设置为 100，将最大特征设置为特征总数，将异常值占比设置为<code>'auto'</code>，如果把它为 0.1，则总体 10% 的数据集将被定义为异常值。</p>
<p>我们在使用孤立森林学习后，调用 <code>glass['outlier'].value_counts()</code>可以看到有 19 条记录被标记为<code>-1</code>（即异常值），其余 195 条记录被标记为<code>1</code>（正常值）。</p>
<h2 id="基于空间密度的聚类算法-dbscan">基于空间密度的聚类算法-DBSCAN</h2>
<p><strong>DBSCAN</strong> 是一种流行的聚类算法，通常用作 K-means 的替代方法。它是基于分布密度的，专注于许多数据点所在的高密度区域。它通过测量数据之间的特征空间距离（即欧氏距离）来识别哪些样本可以聚类在一起。DBSCAN 作为聚类算法最大的优势之一就是我们不需要预先定义聚类的数量。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from sklearn.cluster import DBSCAN</span><br><span class="line">DBSCAN(eps=0.5, min_samples=5, metric=&#x27;euclidean&#x27;, metric_params=None, algorithm=&#x27;auto&#x27;, leaf_size=30, p=None, n_jobs=None)</span><br><span class="line">eps（epsilon）：考虑在同一个 cluster 中的两个数据点之间的最大距离。</span><br><span class="line">min_samples：核心点的接近数据点的数量。</span><br><span class="line">metric：用于计算不同点之间的距离度量方法。</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">from sklearn.cluster import DBSCAN</span><br><span class="line">from sklearn.preprocessing import MinMaxScaler</span><br><span class="line">  </span><br><span class="line"># Initiate DBSCAN</span><br><span class="line">dbscan = DBSCAN(eps=0.4, min_samples=10)</span><br><span class="line"> </span><br><span class="line"># Transform data</span><br><span class="line">glass_x = np.array(glass).astype(&#x27;float&#x27;)</span><br><span class="line"> </span><br><span class="line"># Initiate scaler and scale data</span><br><span class="line">scaler = MinMaxScaler()</span><br><span class="line">glass_scaled = scaler.fit_transform(glass_x)</span><br><span class="line">  </span><br><span class="line"># Fit DBSCAN on scaled data</span><br><span class="line">dbscan.fit(glass_scaled)</span><br><span class="line">  </span><br><span class="line"># Address outliers in a new column</span><br><span class="line">glass[&#x27;outlier&#x27;] = dbscan.labels_</span><br></pre></td></tr></table></figure>
<p>在启动 DBSCAN 时，仔细选择超参数非常重要。例如，如果 eps 值选择得太小，那么大部分数据都可以归类为离群值，因为邻域区域被定义为更小。相反，如果 eps 值选择太大，则大多数点会被聚类算法聚到一起，因为它们很可能位于同一邻域内。这里我们使用 k 距离图选择 eps 为 0.4。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> math </span><br><span class="line"> </span><br><span class="line"><span class="comment"># Function to calculate k distance</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">calculate_k_distance</span>(<span class="params">X,k</span>):</span><br><span class="line">  </span><br><span class="line">    k_distance = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(X)):</span><br><span class="line">        euclidean_dist = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(X)):</span><br><span class="line">            euclidean_dist.append(</span><br><span class="line">                math.sqrt(</span><br><span class="line">                    ((X[i,<span class="number">0</span>] - X[j,<span class="number">0</span>]) ** <span class="number">2</span>) +</span><br><span class="line">                    ((X[i,<span class="number">1</span>] - X[j,<span class="number">1</span>]) ** <span class="number">2</span>)))</span><br><span class="line">  </span><br><span class="line">        euclidean_dist.sort()</span><br><span class="line">        k_distance.append(euclidean_dist[k])</span><br><span class="line">  </span><br><span class="line">    <span class="keyword">return</span> k_distance</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Calculate and plot epsilon distance</span></span><br><span class="line">eps_distance = calculate_k_distance(glass_scaled, <span class="number">10</span>)</span><br><span class="line">px.histogram(eps_distance, labels=&#123;<span class="string">&#x27;value&#x27;</span>:<span class="string">&#x27;Epsilon distance&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>
<p>此外，<code>min_samples</code>是一个重要的超参数，通常等于或大于 3，大多数情况下选择 D+1，其中 D 是数据集的维度。在上述代码中，我们将<code>min_samples</code>设置为 10。</p>
<p>由于 DBSCAN 是通过密度来识别簇的，所以高密度区域是簇出现的地方，低密度区域是异常值出现的地方。经过DBSCAN建模，我们调用<code>glass['outlier'].value_counts()</code>可以看到有 22 条记录被标记为<code>-1</code>（异常值），其余 192 条记录被标记为<code>1</code>（正常值）。</p>
<h2 id="基于密度的方法-局部异常因子算法-lof">基于密度的方法–局部异常因子算法-LOF</h2>
<p>LOF是基于密度的经典算法（Breuning et. al. 2000），通过给每个数据点都分配一个依赖于邻域密度的离群因子 LOF，进而判断该数据点是否为离群点。它的好处在于可以量化每个数据点的异常程度（outlierness）。<strong>LOF</strong>是一种流行的无监督异常检测算法，它计算数据点相对于其邻居的<strong>局部密度偏差</strong>。计算完成后，密度较低的点被视为异常值。</p>
<p>数据点 的局部相对密度（局部异常因子）为点 邻域内点的平均局部可达密度跟数据 点 的局部可达密度的比值, 即：</p>
<p>数据点P的局部可达密度=P最近邻的平均可达距离的倒数。距离越大，密度越小。</p>
<p>点P到点O的第k可达距离=max(点O的k近邻距离，点P到点O的距离)。</p>
<p>点O的k近邻距离=第k个最近的点跟点O之间的距离。</p>
<p>整体来说，LOF算法流程如下：</p>
<p>对于每个数据点，计算它与其他所有点的距离，并按从近到远排序；<br>
对于每个数据点，找到它的K-Nearest-Neighbor，计算LOF得分。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from sklearn.neighbors import LocalOutlierFactor</span><br><span class="line">LocalOutlierFactor(n_neighbors=20, algorithm=&#x27;auto&#x27;, leaf_size=30, metric=&#x27;minkowski&#x27;, p=2, metric_params=None, contamination=&#x27;auto&#x27;, novelty=False, n_jobs=None)</span><br><span class="line">n_neighbors：用于选择默认等于 20 的邻居数量。</span><br><span class="line">contamination：用于定义离群值比例。</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> LocalOutlierFactor</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Initiate LOF</span></span><br><span class="line">lof = LocalOutlierFactor(n_neighbors=<span class="number">20</span>, contamination=<span class="string">&#x27;auto&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Transform data</span></span><br><span class="line">glass_x = np.array(glass).astype(<span class="string">&#x27;float&#x27;</span>) </span><br><span class="line"> </span><br><span class="line"><span class="comment"># Initiate scaler and scale data</span></span><br><span class="line">scaler = MinMaxScaler()</span><br><span class="line">glass_scaled = scaler.fit_transform(glass_x)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Fit and predict on scaled data</span></span><br><span class="line">clf = LocalOutlierFactor()</span><br><span class="line">outliers_predicted = clf.fit_predict(glass) </span><br><span class="line"> </span><br><span class="line"><span class="comment"># Address outliers in a new column</span></span><br><span class="line">glass[<span class="string">&#x27;outlier&#x27;</span>] = outliers_predicted</span><br></pre></td></tr></table></figure>
<h2 id="基于密度的方法-connectivity-based-outlier-factor-cof">基于密度的方法–Connectivity-Based Outlier Factor (COF)</h2>
<p>COF是LOF的变种，相比于LOF，COF可以处理低密度下的异常值，COF的局部密度是基于平均链式距离计算得到。在一开始的时候我们一样会先计算出每个点的k-nearest neighbor。而接下来我们会计算每个点的Set based nearest Path</p>
<p>假使我们今天我们的k=5，所以F的neighbor为B、C、D、E、G。而对于F离他最近的点为E，所以SBN Path的第一个元素是F、第二个是E。离E最近的点为D所以第三个元素为D，接下来离D最近的点为C和G，所以第四和五个元素为C和G，最后离C最近的点为B，第六个元素为B。所以整个流程下来，F的SBN Path为{F, E, D, C, G, C, B}。而对于SBN Path所对应的距离e={e1, e2, e3,…,ek}，依照上面的例子e={3,2,1,1,1}。</p>
<p>所以我们可以说假使我们想计算p点的SBN Path，我们只要直接计算p点和其neighbor所有点所构成的graph的minimum spanning tree，之后我们再以p点为起点执行shortest path算法，就可以得到我们的SBN Path。</p>
<p>而接下来我们有了SBN Path我们就会接着计算，p点的链式距离，有了ac_distance后，我们就可以计算COF：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from pyod.models.cof import COF</span><br><span class="line">cof = COF(contamination = 0.06,  ## 异常值所占的比例</span><br><span class="line">          n_neighbors = 20,      ## 近邻数量</span><br><span class="line">        )</span><br><span class="line">cof_label = cof.fit_predict(iris.values) # 鸢尾花数据</span><br><span class="line">print(&quot;检测出的异常值数量为:&quot;,np.sum(cof_label == 1))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="基于密度的方法-stochastic-outlier-selection-sos">基于密度的方法–Stochastic Outlier Selection (SOS)</h2>
<p>将特征矩阵（feature martrix）或者相异度矩阵（dissimilarity matrix）输入给SOS算法，会返回一个异常概率值向量（每个点对应一个）。SOS的思想是：当一个点和其它所有点的关联度（affinity）都很小的时候，它就是一个异常点。</p>
<p>SOS的流程：计算相异度矩阵D；计算关联度矩阵A；计算关联概率矩阵B；算出异常概率向量。</p>
<p>相异度矩阵D是各样本两两之间的度量距离, 比如欧式距离或汉明距离等。关联度矩阵反映的是 度量距离方差, 如图7, 点 的密度最大, 方差最小; 的密度最小, 方差最大。而关联概率 矩阵 (binding probability matrix)就是把关联矩阵(affinity matrix)按行归一化得到的</p>
<p><img src="/2023/07/31/outlier-detection/resize.png" alt></p>
<p>得到了binding probability matrix，每个点的异常概率值就用如下的公式计算，当一个点和其它所有点的关联度（affinity）都很小的时候，它就是一个异常点。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line">from sksos import SOS</span><br><span class="line">iris = pd.read_csv(&quot;http://bit.ly/iris-csv&quot;)</span><br><span class="line">X = iris.drop(&quot;Name&quot;, axis=1).values</span><br><span class="line">detector = SOS()</span><br><span class="line">iris[&quot;score&quot;] = detector.predict(X)</span><br><span class="line">iris.sort_values(&quot;score&quot;, ascending=False).head(10)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="基于分类的方法-oneclasssvm">基于分类的方法–OneClassSVM</h2>
<p>OneClassSVM是一种用于检测异常点的算法，是一种无监督学习算法。决策边界将数据点分为两类：内点和外点。非离群点是与训练集中的大多数点相似的点，而离群点是与训练集中的大多数点显着不同的点。</p>
<p>为了学习决策边界，OneClassSVM最大化边界和内点之间的距离，最终找到合适的超平面。这个超平面可以最大化内点和决策边界之间的边距。一旦学习了决策边界，就可以使用它来将新点分类为内点或异常点。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from sklearn.svm import OneClassSVM</span><br><span class="line">X = [[0], [0.44], [0.45], [0.46], [1]]</span><br><span class="line">clf = OneClassSVM(gamma=&#x27;auto&#x27;).fit(X)</span><br><span class="line"></span><br><span class="line"># 异常/离群值返回 -1，离群值返回 +1</span><br><span class="line">clf.predict(X)</span><br><span class="line">kernel：SVM内核类型</span><br><span class="line">nu：训练误差分数的上限</span><br></pre></td></tr></table></figure>
<p>在实际使用中OneClassSVM速度较慢，因此可以考虑使用随机梯度下降求解线性的SVM来代替，也就是SGDOneClassSVM。</p>
<h2 id="基于分类的方法-elliptic-envelope">基于分类的方法–Elliptic Envelope</h2>
<p>椭圆包络（Elliptic Envelope）是一种检测数据集中异常或异常数据点的方法。它是一种无监督学习方法，通过将椭圆拟合到训练集中的数据点来工作，但假设大多数点遵循高斯分布。</p>
<p>为了拟合椭圆，椭圆包络估计数据点的均值和协方差，并使用这些估计值来确定椭圆的形状和方向。一旦学习了椭圆，它就可以用来将新点分类为内点或异常点。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">import numpy as np</span><br><span class="line">from sklearn.covariance import EllipticEnvelope</span><br><span class="line">true_cov = np.array([[.8, .3],</span><br><span class="line">                     [.3, .4]])</span><br><span class="line">X = np.random.RandomState(0).multivariate_normal(mean=[0, 0],</span><br><span class="line">                                                 cov=true_cov,</span><br><span class="line">                                                 size=500)</span><br><span class="line">cov = EllipticEnvelope(random_state=0).fit(X)</span><br><span class="line"># predict returns 1 for an inlier and -1 for an outlier</span><br><span class="line">cov.predict([[0, 0],</span><br><span class="line">             [3, 3]])</span><br></pre></td></tr></table></figure>
<h2 id="基于降维的方法-principal-component-analysis-pca">基于降维的方法–Principal Component Analysis (PCA)</h2>
<p>PCA在异常检测方面的做法，大体有两种思路：</p>
<p>(1) 将数据映射到低维特征空间，然后在特征空间不同维度上查看每个数据点跟其它数据的偏差；</p>
<p>(2) 将数据映射到低维特征空间，然后由低维特征空间重新映射回原空间，尝试用低维特征重构原始数据，看重构误差的大小。</p>
<p>PCA在做特征值分解，会得到：</p>
<p>特征向量：反应了原始数据方差变化程度的不同方向；<br>
特征值：数据在对应方向上的方差大小。</p>
<p>所以，最大特征值对应的特征向量为数据方差最大的方向，最小特征值对应的特征向量为数据方差最小的方向。原始数据在不同方向上的方差变化反应了其内在特点。如果单个数据样本跟整体数据样本表现出的特点不太一致，比高。 是特征值, 用于归一化, 使不同方向上的偏离程度具有可比性。</p>
<p>在计算异常分数时，关于特征向量（即度量异常用的标杆）选择又有两种方式：</p>
<p>考虑在前k个特征向量方向上的偏差：前k个特征向量往往直接对应原始数据里的某几个特征，在前几个特征向量方向上偏差比较大的数据样本，往往就是在原始数据中那几个特征上的极值点。<br>
考虑后r个特征向量方向上的偏差：后r个特征向量通常表示某几个原始特征的线性组合，线性组合之后的方差比较小反应了这几个特征之间的某种关系。在后几个特征方向上偏差比较大的数据样本，表示它在原始数据里对应的那几个特征上出现了与预计不太一致的情况。<br>
得分大于阈值C则判断为异常。</p>
<p>第二种做法，PCA提取了数据的主要特征，如果一个数据样本不容易被重构出来，表示这个数据样本的特征跟整体数据样本的特征不一致，那么它显然就是一个异常的样本：</p>
<p>其中, 是基于 维特征向量重构的样本。</p>
<p>基于低维特征进行数据样本的重构时，舍弃了较小的特征值对应的特征向量方向上的信息。换一句话说，重构误差其实主要来自较小的特征值对应的特征向量方向上的信息。基于这个直观的理解，PCA在异常检测上的两种不同思路都会特别关注较小的特征值对应的特征向量。所以，我们说PCA在做异常检测时候的两种思路本质上是相似的，当然第一种方法还可以关注较大特征值对应的特征向量。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> sklearn.decomposition <span class="keyword">import</span> PCA</span><br><span class="line">pca = PCA()</span><br><span class="line">pca.fit(centered_training_data)</span><br><span class="line">transformed_data = pca.transform(training_data)</span><br><span class="line">y = transformed_data</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算异常分数</span></span><br><span class="line">lambdas = pca.singular_values_</span><br><span class="line">M = ((y*y)/lambdas)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 前k个特征向量和后r个特征向量</span></span><br><span class="line">q = <span class="number">5</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;Explained variance by first q terms: &quot;</span>, <span class="built_in">sum</span>(pca.explained_variance_ratio_[:q])</span><br><span class="line">q_values = <span class="built_in">list</span>(pca.singular_values_ &lt; <span class="number">.2</span>)</span><br><span class="line">r = q_values.index(<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对每个样本点进行距离求和的计算</span></span><br><span class="line">major_components = M[:,<span class="built_in">range</span>(q)]</span><br><span class="line">minor_components = M[:,<span class="built_in">range</span>(r, <span class="built_in">len</span>(features))]</span><br><span class="line">major_components = np.<span class="built_in">sum</span>(major_components, axis=<span class="number">1</span>)</span><br><span class="line">minor_components = np.<span class="built_in">sum</span>(minor_components, axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 人为设定c1、c2阈值</span></span><br><span class="line">components = pd.DataFrame(&#123;<span class="string">&#x27;major_components&#x27;</span>: major_components, </span><br><span class="line">                               <span class="string">&#x27;minor_components&#x27;</span>: minor_components&#125;)</span><br><span class="line">c1 = components.quantile(<span class="number">0.99</span>)[<span class="string">&#x27;major_components&#x27;</span>]</span><br><span class="line">c2 = components.quantile(<span class="number">0.99</span>)[<span class="string">&#x27;minor_components&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 制作分类器</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">classifier</span>(<span class="params">major_components, minor_components</span>):  </span><br><span class="line">    major = major_components &gt; c1</span><br><span class="line">    minor = minor_components &gt; c2    </span><br><span class="line">    <span class="keyword">return</span> np.logical_or(major,minor)</span><br><span class="line"></span><br><span class="line">results = classifier(major_components=major_components, minor_components=minor_components)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="基于降维的方法-autoencoder">基于降维的方法–AutoEncoder</h2>
<p>PCA是线性降维，AutoEncoder是非线性降维。根据正常数据训练出来的AutoEncoder，能够将正常样本重建还原，但是却无法将异于正常分布的数据点较好地还原，导致还原误差较大。因此如果一个新样本被编码，解码之后，它的误差超出正常数据编码和解码后的误差范围，则视作为异常数据。需要注意的是，AutoEncoder训练使用的数据是正常数据（即无异常值），这样才能得到重构后误差分布范围是多少以内是合理正常的。所以AutoEncoder在这里做异常检测时，算是一种有监督学习的方法。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Ref: [https://zhuanlan.zhihu.com/p/260882741](https://zhuanlan.zhihu.com/p/260882741)</span></span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> keras.models <span class="keyword">import</span> Sequential</span><br><span class="line"><span class="keyword">from</span> keras.layers <span class="keyword">import</span> Dense</span><br><span class="line"></span><br><span class="line"><span class="comment"># 标准化数据</span></span><br><span class="line">scaler = preprocessing.MinMaxScaler()</span><br><span class="line">X_train = pd.DataFrame(scaler.fit_transform(dataset_train),</span><br><span class="line">                              columns=dataset_train.columns,</span><br><span class="line">                              index=dataset_train.index)</span><br><span class="line"><span class="comment"># Random shuffle training data</span></span><br><span class="line">X_train.sample(frac=<span class="number">1</span>)</span><br><span class="line">X_test = pd.DataFrame(scaler.transform(dataset_test),</span><br><span class="line">                             columns=dataset_test.columns,</span><br><span class="line">                             index=dataset_test.index)</span><br><span class="line"></span><br><span class="line">tf.random.set_seed(<span class="number">10</span>)</span><br><span class="line">act_func = <span class="string">&#x27;relu&#x27;</span></span><br><span class="line"><span class="comment"># Input layer:</span></span><br><span class="line">model=Sequential()</span><br><span class="line"><span class="comment"># First hidden layer, connected to input vector X.</span></span><br><span class="line">model.add(Dense(<span class="number">10</span>,activation=act_func,</span><br><span class="line">                kernel_initializer=<span class="string">&#x27;glorot_uniform&#x27;</span>,</span><br><span class="line">                kernel_regularizer=regularizers.l2(<span class="number">0.0</span>),</span><br><span class="line">                input_shape=(X_train.shape[<span class="number">1</span>],)</span><br><span class="line">               )</span><br><span class="line">         )</span><br><span class="line">model.add(Dense(<span class="number">2</span>,activation=act_func,</span><br><span class="line">                kernel_initializer=<span class="string">&#x27;glorot_uniform&#x27;</span>))</span><br><span class="line">model.add(Dense(<span class="number">10</span>,activation=act_func,</span><br><span class="line">                kernel_initializer=<span class="string">&#x27;glorot_uniform&#x27;</span>))</span><br><span class="line">model.add(Dense(X_train.shape[<span class="number">1</span>],</span><br><span class="line">                kernel_initializer=<span class="string">&#x27;glorot_uniform&#x27;</span>))</span><br><span class="line">model.<span class="built_in">compile</span>(loss=<span class="string">&#x27;mse&#x27;</span>,optimizer=<span class="string">&#x27;adam&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(model.summary())</span><br><span class="line"></span><br><span class="line"><span class="comment"># Train model for 100 epochs, batch size of 10:</span></span><br><span class="line">NUM_EPOCHS=<span class="number">100</span></span><br><span class="line">BATCH_SIZE=<span class="number">10</span></span><br><span class="line">history=model.fit(np.array(X_train),np.array(X_train),</span><br><span class="line">                  batch_size=BATCH_SIZE,</span><br><span class="line">                  epochs=NUM_EPOCHS,</span><br><span class="line">                  validation_split=<span class="number">0.05</span>,</span><br><span class="line">                  verbose = <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">plt.plot(history.history[<span class="string">&#x27;loss&#x27;</span>],</span><br><span class="line">         <span class="string">&#x27;b&#x27;</span>,</span><br><span class="line">         label=<span class="string">&#x27;Training loss&#x27;</span>)</span><br><span class="line">plt.plot(history.history[<span class="string">&#x27;val_loss&#x27;</span>],</span><br><span class="line">         <span class="string">&#x27;r&#x27;</span>,</span><br><span class="line">         label=<span class="string">&#x27;Validation loss&#x27;</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;upper right&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Epochs&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Loss, [mse]&#x27;</span>)</span><br><span class="line">plt.ylim([<span class="number">0</span>,<span class="number">.1</span>])</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看训练集还原的误差分布如何，以便制定正常的误差分布范围</span></span><br><span class="line">X_pred = model.predict(np.array(X_train))</span><br><span class="line">X_pred = pd.DataFrame(X_pred,</span><br><span class="line">                      columns=X_train.columns)</span><br><span class="line">X_pred.index = X_train.index</span><br><span class="line"></span><br><span class="line">scored = pd.DataFrame(index=X_train.index)</span><br><span class="line">scored[<span class="string">&#x27;Loss_mae&#x27;</span>] = np.mean(np.<span class="built_in">abs</span>(X_pred-X_train), axis = <span class="number">1</span>)</span><br><span class="line">plt.figure()</span><br><span class="line">sns.distplot(scored[<span class="string">&#x27;Loss_mae&#x27;</span>],</span><br><span class="line">             bins = <span class="number">10</span>,</span><br><span class="line">             kde= <span class="literal">True</span>,</span><br><span class="line">            color = <span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line">plt.xlim([<span class="number">0.0</span>,<span class="number">.5</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 误差阈值比对，找出异常值</span></span><br><span class="line">X_pred = model.predict(np.array(X_test))</span><br><span class="line">X_pred = pd.DataFrame(X_pred,</span><br><span class="line">                      columns=X_test.columns)</span><br><span class="line">X_pred.index = X_test.index</span><br><span class="line">threshod = <span class="number">0.3</span></span><br><span class="line">scored = pd.DataFrame(index=X_test.index)</span><br><span class="line">scored[<span class="string">&#x27;Loss_mae&#x27;</span>] = np.mean(np.<span class="built_in">abs</span>(X_pred-X_test), axis = <span class="number">1</span>)</span><br><span class="line">scored[<span class="string">&#x27;Threshold&#x27;</span>] = threshod</span><br><span class="line">scored[<span class="string">&#x27;Anomaly&#x27;</span>] = scored[<span class="string">&#x27;Loss_mae&#x27;</span>] &gt; scored[<span class="string">&#x27;Threshold&#x27;</span>]</span><br><span class="line">scored.head()</span><br></pre></td></tr></table></figure>
<h1>离群检测与新奇检测</h1>
<p>离群检测（Outlier detection）：训练数据包含离群值，这些离群值被定义为与其他观察值相差甚远的观察值。<br>
新奇检测 (Novelty detection)：训练数据没有离群点，需要观察新的样本是否包含离群点。<br>
离群检测和新颖性检测都用于异常检测，其中人们对检测异常或不寻常的观察感兴趣。离群检测也称为无监督异常检测，新奇检测称为半监督异常检测。</p>
<p>在离群检测中离群值不能形成密集的集群，因为可以假设离群值位于低密度区域。相反在新颖性检测中，新颖性处于训练数据的低密度区域。</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line">​</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">​</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm</span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_moons, make_blobs</span><br><span class="line"><span class="keyword">from</span> sklearn.covariance <span class="keyword">import</span> EllipticEnvelope</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> IsolationForest</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> LocalOutlierFactor</span><br><span class="line">​</span><br><span class="line"><span class="built_in">print</span>(__doc__)</span><br><span class="line">​</span><br><span class="line">matplotlib.rcParams[<span class="string">&#x27;contour.negative_linestyle&#x27;</span>] = <span class="string">&#x27;solid&#x27;</span></span><br><span class="line">​</span><br><span class="line"><span class="comment"># Example settings</span></span><br><span class="line">n_samples = <span class="number">300</span></span><br><span class="line">outliers_fraction = <span class="number">0.15</span></span><br><span class="line">n_outliers = <span class="built_in">int</span>(outliers_fraction * n_samples)</span><br><span class="line">n_inliers = n_samples - n_outliers</span><br><span class="line">​</span><br><span class="line"><span class="comment"># define outlier/anomaly detection methods to be compared</span></span><br><span class="line">anomaly_algorithms = [</span><br><span class="line">    (<span class="string">&quot;Robust covariance&quot;</span>, EllipticEnvelope(contamination=outliers_fraction)),</span><br><span class="line">    (<span class="string">&quot;One-Class SVM&quot;</span>, svm.OneClassSVM(nu=outliers_fraction, kernel=<span class="string">&quot;rbf&quot;</span>,</span><br><span class="line">                                      gamma=<span class="number">0.1</span>)),</span><br><span class="line">    (<span class="string">&quot;Isolation Forest&quot;</span>, IsolationForest(contamination=outliers_fraction,</span><br><span class="line">                                         random_state=<span class="number">42</span>)),</span><br><span class="line">    (<span class="string">&quot;Local Outlier Factor&quot;</span>, LocalOutlierFactor(</span><br><span class="line">        n_neighbors=<span class="number">35</span>, contamination=outliers_fraction))]</span><br><span class="line">​</span><br><span class="line"><span class="comment"># Define datasets</span></span><br><span class="line">blobs_params = <span class="built_in">dict</span>(random_state=<span class="number">0</span>, n_samples=n_inliers, n_features=<span class="number">2</span>)</span><br><span class="line">datasets = [</span><br><span class="line">    make_blobs(centers=[[<span class="number">0</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">0</span>]], cluster_std=<span class="number">0.5</span>,</span><br><span class="line">               **blobs_params)[<span class="number">0</span>],</span><br><span class="line">    make_blobs(centers=[[<span class="number">2</span>, <span class="number">2</span>], [-<span class="number">2</span>, -<span class="number">2</span>]], cluster_std=[<span class="number">0.5</span>, <span class="number">0.5</span>],</span><br><span class="line">               **blobs_params)[<span class="number">0</span>],</span><br><span class="line">    make_blobs(centers=[[<span class="number">2</span>, <span class="number">2</span>], [-<span class="number">2</span>, -<span class="number">2</span>]], cluster_std=[<span class="number">1.5</span>, <span class="number">.3</span>],</span><br><span class="line">               **blobs_params)[<span class="number">0</span>],</span><br><span class="line">    <span class="number">4.</span> * (make_moons(n_samples=n_samples, noise=<span class="number">.05</span>, random_state=<span class="number">0</span>)[<span class="number">0</span>] -</span><br><span class="line">          np.array([<span class="number">0.5</span>, <span class="number">0.25</span>])),</span><br><span class="line">    <span class="number">14.</span> * (np.random.RandomState(<span class="number">42</span>).rand(n_samples, <span class="number">2</span>) - <span class="number">0.5</span>)]</span><br><span class="line">​</span><br><span class="line"><span class="comment"># Compare given classifiers under given settings</span></span><br><span class="line">xx, yy = np.meshgrid(np.linspace(-<span class="number">7</span>, <span class="number">7</span>, <span class="number">150</span>),</span><br><span class="line">                     np.linspace(-<span class="number">7</span>, <span class="number">7</span>, <span class="number">150</span>))</span><br><span class="line">​</span><br><span class="line">plt.figure(figsize=(<span class="built_in">len</span>(anomaly_algorithms) * <span class="number">2</span> + <span class="number">3</span>, <span class="number">12.5</span>))</span><br><span class="line">plt.subplots_adjust(left=<span class="number">.02</span>, right=<span class="number">.98</span>, bottom=<span class="number">.001</span>, top=<span class="number">.96</span>, wspace=<span class="number">.05</span>,</span><br><span class="line">                    hspace=<span class="number">.01</span>)</span><br><span class="line"></span><br><span class="line">plot_num = <span class="number">1</span></span><br><span class="line">rng = np.random.RandomState(<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i_dataset, X <span class="keyword">in</span> <span class="built_in">enumerate</span>(datasets):</span><br><span class="line">    <span class="comment"># Add outliers</span></span><br><span class="line">    X = np.concatenate([X, rng.uniform(low=-<span class="number">6</span>, high=<span class="number">6</span>,</span><br><span class="line">                       size=(n_outliers, <span class="number">2</span>))], axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> name, algorithm <span class="keyword">in</span> anomaly_algorithms:</span><br><span class="line">        t0 = time.time()</span><br><span class="line">        algorithm.fit(X)</span><br><span class="line">        t1 = time.time()</span><br><span class="line">        plt.subplot(<span class="built_in">len</span>(datasets), <span class="built_in">len</span>(anomaly_algorithms), plot_num)</span><br><span class="line">        <span class="keyword">if</span> i_dataset == <span class="number">0</span>:</span><br><span class="line">            plt.title(name, size=<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># fit the data and tag outliers</span></span><br><span class="line">        <span class="keyword">if</span> name == <span class="string">&quot;Local Outlier Factor&quot;</span>:</span><br><span class="line">            y_pred = algorithm.fit_predict(X)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            y_pred = algorithm.fit(X).predict(X)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># plot the levels lines and the points</span></span><br><span class="line">        <span class="keyword">if</span> name != <span class="string">&quot;Local Outlier Factor&quot;</span>:  <span class="comment"># LOF does not implement predict</span></span><br><span class="line">            Z = algorithm.predict(np.c_[xx.ravel(), yy.ravel()])</span><br><span class="line">            Z = Z.reshape(xx.shape)</span><br><span class="line">            plt.contour(xx, yy, Z, levels=[<span class="number">0</span>], linewidths=<span class="number">2</span>, colors=<span class="string">&#x27;black&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        colors = np.array([<span class="string">&#x27;#377eb8&#x27;</span>, <span class="string">&#x27;#ff7f00&#x27;</span>])</span><br><span class="line">        plt.scatter(X[:, <span class="number">0</span>], X[:, <span class="number">1</span>], s=<span class="number">10</span>, color=colors[(y_pred + <span class="number">1</span>) // <span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">        plt.xlim(-<span class="number">7</span>, <span class="number">7</span>)</span><br><span class="line">        plt.ylim(-<span class="number">7</span>, <span class="number">7</span>)</span><br><span class="line">        plt.xticks(())</span><br><span class="line">        plt.yticks(())</span><br><span class="line">        plt.text(<span class="number">.99</span>, <span class="number">.01</span>, (<span class="string">&#x27;%.2fs&#x27;</span> % (t1 - t0)).lstrip(<span class="string">&#x27;0&#x27;</span>),</span><br><span class="line">                 transform=plt.gca().transAxes, size=<span class="number">15</span>,</span><br><span class="line">                 horizontalalignment=<span class="string">&#x27;right&#x27;</span>)</span><br><span class="line">        plot_num += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>对于每个数据集，产生15%的样本作为随机均匀噪声。这个比例是给予OneClassSVM的nu参数和其他离群点检测算法的污染参数的值。由于局部离群因子(LOF)用于离群值检测时没有对新数据应用的预测方法，因此除了局部离群值因子(LOF)外，inliers和离群值之间的决策边界以黑色显示。</p>
<p>sklearn.svm。一个已知的eclasssvm对异常值很敏感，因此在异常值检测方面表现不太好。该估计器最适合在训练集没有异常值的情况下进行新颖性检测。也就是说，在高维的离群点检测，或者在不对嵌入数据的分布做任何假设的情况下，一个类支持向量机可能在这些情况下给出有用的结果，这取决于它的超参数的值。</p>
<p>sklearn.covariance。椭圆包络假设数据是高斯分布，并学习一个椭圆。因此，当数据不是单峰时，它就会退化。但是请注意，这个估计器对异常值是稳健的。</p>
<p>sklearn.ensemble。IsolationForest sklearn.neighbors。LocalOutlierFactor对于多模态数据集似乎表现得相当好。sklearn的优势。第三个数据集的局部离群因子超过其他估计显示，其中两种模式有不同的密度。这种优势是由LOF的局域性来解释的，即它只比较一个样本的异常分数与其相邻样本的异常分数。</p>
<p>最后，对于最后一个数据集，很难说一个样本比另一个样本更反常，因为它们是均匀分布在超立方体中。除了sklearn。svm。有一点过度拟合的支持向量机，所有的估计器都对这种情况给出了合适的解决方案。在这种情况下，明智的做法是更密切地观察样本的异常分数，因为一个好的估计器应该给所有样本分配相似的分数。</p>
<p><strong>一个新奇点检测例子</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib.font_manager</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm</span><br><span class="line">​</span><br><span class="line">xx, yy = np.meshgrid(np.linspace(-<span class="number">5</span>, <span class="number">5</span>, <span class="number">500</span>), np.linspace(-<span class="number">5</span>, <span class="number">5</span>, <span class="number">500</span>))</span><br><span class="line"><span class="comment"># Generate train data</span></span><br><span class="line">X = <span class="number">0.3</span> * np.random.randn(<span class="number">100</span>, <span class="number">2</span>)</span><br><span class="line">X_train = np.r_[X + <span class="number">2</span>, X - <span class="number">2</span>]</span><br><span class="line"><span class="comment"># Generate some regular novel observations</span></span><br><span class="line">X = <span class="number">0.3</span> * np.random.randn(<span class="number">20</span>, <span class="number">2</span>)</span><br><span class="line">X_test = np.r_[X + <span class="number">2</span>, X - <span class="number">2</span>]</span><br><span class="line"><span class="comment"># Generate some abnormal novel observations</span></span><br><span class="line">X_outliers = np.random.uniform(low=-<span class="number">4</span>, high=<span class="number">4</span>, size=(<span class="number">20</span>, <span class="number">2</span>))</span><br><span class="line">​</span><br><span class="line"><span class="comment"># fit the model</span></span><br><span class="line">clf = svm.OneClassSVM(nu=<span class="number">0.1</span>, kernel=<span class="string">&quot;rbf&quot;</span>, gamma=<span class="number">0.1</span>)</span><br><span class="line">clf.fit(X_train)</span><br><span class="line">y_pred_train = clf.predict(X_train)</span><br><span class="line">y_pred_test = clf.predict(X_test)</span><br><span class="line">y_pred_outliers = clf.predict(X_outliers)</span><br><span class="line">n_error_train = y_pred_train[y_pred_train == -<span class="number">1</span>].size</span><br><span class="line">n_error_test = y_pred_test[y_pred_test == -<span class="number">1</span>].size</span><br><span class="line">n_error_outliers = y_pred_outliers[y_pred_outliers == <span class="number">1</span>].size</span><br><span class="line">​</span><br><span class="line"><span class="comment"># plot the line, the points, and the nearest vectors to the plane</span></span><br><span class="line">Z = clf.decision_function(np.c_[xx.ravel(), yy.ravel()])</span><br><span class="line">Z = Z.reshape(xx.shape)</span><br><span class="line">​</span><br><span class="line">plt.title(<span class="string">&quot;Novelty Detection&quot;</span>)</span><br><span class="line">plt.contourf(xx, yy, Z, levels=np.linspace(Z.<span class="built_in">min</span>(), <span class="number">0</span>, <span class="number">7</span>), cmap=plt.cm.PuBu)</span><br><span class="line">a = plt.contour(xx, yy, Z, levels=[<span class="number">0</span>], linewidths=<span class="number">2</span>, colors=<span class="string">&#x27;darkred&#x27;</span>)</span><br><span class="line">plt.contourf(xx, yy, Z, levels=[<span class="number">0</span>, Z.<span class="built_in">max</span>()], colors=<span class="string">&#x27;palevioletred&#x27;</span>)</span><br><span class="line">​</span><br><span class="line">s = <span class="number">40</span></span><br><span class="line">b1 = plt.scatter(X_train[:, <span class="number">0</span>], X_train[:, <span class="number">1</span>], c=<span class="string">&#x27;white&#x27;</span>, s=s, edgecolors=<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">b2 = plt.scatter(X_test[:, <span class="number">0</span>], X_test[:, <span class="number">1</span>], c=<span class="string">&#x27;blueviolet&#x27;</span>, s=s,</span><br><span class="line">                 edgecolors=<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">c = plt.scatter(X_outliers[:, <span class="number">0</span>], X_outliers[:, <span class="number">1</span>], c=<span class="string">&#x27;gold&#x27;</span>, s=s,</span><br><span class="line">                edgecolors=<span class="string">&#x27;k&#x27;</span>)</span><br><span class="line">plt.axis(<span class="string">&#x27;tight&#x27;</span>)</span><br><span class="line">plt.xlim((-<span class="number">5</span>, <span class="number">5</span>))</span><br><span class="line">plt.ylim((-<span class="number">5</span>, <span class="number">5</span>))</span><br><span class="line">plt.legend([a.collections[<span class="number">0</span>], b1, b2, c],</span><br><span class="line">           [<span class="string">&quot;learned frontier&quot;</span>, <span class="string">&quot;training observations&quot;</span>,</span><br><span class="line">            <span class="string">&quot;new regular observations&quot;</span>, <span class="string">&quot;new abnormal observations&quot;</span>],</span><br><span class="line">           loc=<span class="string">&quot;upper left&quot;</span>,</span><br><span class="line">           prop=matplotlib.font_manager.FontProperties(size=<span class="number">11</span>))</span><br><span class="line">plt.xlabel(</span><br><span class="line">    <span class="string">&quot;error train: %d/200 ; errors novel regular: %d/40 ; &quot;</span></span><br><span class="line">    <span class="string">&quot;errors novel abnormal: %d/40&quot;</span></span><br><span class="line">    % (n_error_train, n_error_test, n_error_outliers))</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>效果</p>
<p>1、考虑异常检测模型和分类模型，结果是<strong>分类模型比异常检测模型效果好</strong>；</p>
<p>2、分类模型中的<strong>层次聚类效果又比k-means聚类效果好</strong></p>
]]></content>
      <tags>
        <tag>Modeling</tag>
      </tags>
  </entry>
  <entry>
    <title>ggplot_picture_bioinformation</title>
    <url>/2023/10/31/ggplot-picture/</url>
    <content><![CDATA[<p>[TOC]</p>
<h2 id="none"></h2>
<p>代码参考【来源于ocima公众号】</p>
<h3 id="两组显著性差异图">两组显著性差异图**</h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">##显著性差异图</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">Normal <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.83</span><span class="punctuation">,</span> <span class="number">0.79</span><span class="punctuation">,</span> <span class="number">0.99</span><span class="punctuation">,</span> <span class="number">0.69</span><span class="punctuation">)</span></span><br><span class="line">Cancer <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.56</span><span class="punctuation">,</span> <span class="number">0.56</span><span class="punctuation">,</span> <span class="number">0.64</span><span class="punctuation">,</span> <span class="number">0.52</span><span class="punctuation">)</span> </span><br><span class="line">m <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>mean<span class="punctuation">(</span>Normal<span class="punctuation">)</span><span class="punctuation">,</span> mean<span class="punctuation">(</span>Cancer<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">s <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>sd<span class="punctuation">(</span>Normal<span class="punctuation">)</span><span class="punctuation">,</span> sd<span class="punctuation">(</span>Cancer<span class="punctuation">)</span><span class="punctuation">)</span> </span><br><span class="line">d <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>V<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Normal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Cancer&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> mean<span class="operator">=</span>m<span class="punctuation">,</span> sd<span class="operator">=</span>s<span class="punctuation">)</span> </span><br><span class="line">d<span class="operator">$</span>V <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>d<span class="operator">$</span>V<span class="punctuation">,</span> levels<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Normal&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Cancer&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> </span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>d<span class="punctuation">,</span> aes<span class="punctuation">(</span>V<span class="punctuation">,</span> mean<span class="punctuation">,</span> fill<span class="operator">=</span>V<span class="punctuation">,</span> width<span class="operator">=</span><span class="number">.5</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span> </span><br><span class="line">   geom_errorbar<span class="punctuation">(</span>aes<span class="punctuation">(</span>ymin<span class="operator">=</span>mean<span class="operator">-</span>sd<span class="punctuation">,</span> ymax<span class="operator">=</span>mean<span class="operator">+</span>sd<span class="punctuation">,</span> width<span class="operator">=</span><span class="number">.2</span><span class="punctuation">)</span><span class="punctuation">,</span>position<span class="operator">=</span>position_dodge<span class="punctuation">(</span>width<span class="operator">=</span><span class="number">.8</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   geom_bar<span class="punctuation">(</span>stat<span class="operator">=</span><span class="string">&quot;identity&quot;</span><span class="punctuation">,</span> position<span class="operator">=</span>position_dodge<span class="punctuation">(</span>width<span class="operator">=</span><span class="number">.8</span><span class="punctuation">)</span><span class="punctuation">,</span> colour<span class="operator">=</span><span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line"> scale_fill_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;grey80&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;white&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>theme_bw<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span>theme<span class="punctuation">(</span>legend.position<span class="operator">=</span><span class="string">&quot;none&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> xlab<span class="punctuation">(</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> ylab<span class="punctuation">(</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line"> theme<span class="punctuation">(</span>axis.text.x <span class="operator">=</span> element_text<span class="punctuation">(</span>face<span class="operator">=</span><span class="string">&quot;bold&quot;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span>axis.text.y <span class="operator">=</span> element_text<span class="punctuation">(</span>face<span class="operator">=</span><span class="string">&quot;bold&quot;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">12</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line"> scale_y_continuous<span class="punctuation">(</span>expand<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> limits<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">1.2</span><span class="punctuation">)</span><span class="punctuation">,</span> breaks<span class="operator">=</span>seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">1.2</span><span class="punctuation">,</span> by<span class="operator">=</span><span class="number">.2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">p <span class="operator">&lt;-</span> p<span class="operator">+</span>geom_segment<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span> y<span class="operator">=</span><span class="number">.98</span><span class="punctuation">,</span> xend<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span> yend<span class="operator">=</span><span class="number">1.1</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_segment<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span> y<span class="operator">=</span><span class="number">.65</span><span class="punctuation">,</span> xend<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span> yend<span class="operator">=</span><span class="number">1.1</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line"> geom_segment<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span> y<span class="operator">=</span><span class="number">1.1</span><span class="punctuation">,</span> xend<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span> yend<span class="operator">=</span><span class="number">1.1</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>annotate<span class="punctuation">(</span><span class="string">&quot;text&quot;</span><span class="punctuation">,</span> x<span class="operator">=</span><span class="number">1.5</span><span class="punctuation">,</span> y<span class="operator">=</span><span class="number">1.08</span><span class="punctuation">,</span> label<span class="operator">=</span><span class="string">&quot;*&quot;</span><span class="punctuation">)</span> </span><br><span class="line">p     </span><br><span class="line"><span class="comment">#带误差棒的线图</span></span><br><span class="line">geom<span class="operator">+</span>line<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span>geom<span class="operator">+</span>point<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span>geom_errorbar</span><br><span class="line"><span class="comment">#也可使用函数 geom_pointrange() 或 geom_linerange() 替换 geom_errorbar()</span></span><br></pre></td></tr></table></figure>
<p><strong>barplot和ggplot2绘制柱状图</strong></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  specie<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;sorgho&quot;</span> <span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span> <span class="punctuation">,</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;poacee&quot;</span> <span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span> <span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  cond_A<span class="operator">=</span>rnorm<span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  cond_B<span class="operator">=</span>rnorm<span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">8</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  cond_C<span class="operator">=</span>rnorm<span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Let&#x27;s calculate the average value for each condition and each specie with the *aggregate* function</span></span><br><span class="line">bilan <span class="operator">&lt;-</span> aggregate<span class="punctuation">(</span>cbind<span class="punctuation">(</span>cond_A<span class="punctuation">,</span>cond_B<span class="punctuation">,</span>cond_C<span class="punctuation">)</span><span class="operator">~</span>specie <span class="punctuation">,</span> data<span class="operator">=</span>data <span class="punctuation">,</span> mean<span class="punctuation">)</span></span><br><span class="line">rownames<span class="punctuation">(</span>bilan<span class="punctuation">)</span> <span class="operator">&lt;-</span> bilan<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">bilan <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>bilan<span class="punctuation">[</span><span class="punctuation">,</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Plot boundaries</span></span><br><span class="line">lim <span class="operator">&lt;-</span> 1.2<span class="operator">*</span><span class="built_in">max</span><span class="punctuation">(</span>bilan<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#A function to add arrows on the chart</span></span><br><span class="line">error.bar <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">,</span> y<span class="punctuation">,</span> upper<span class="punctuation">,</span> lower<span class="operator">=</span>upper<span class="punctuation">,</span> <span class="built_in">length</span><span class="operator">=</span><span class="number">0.1</span><span class="punctuation">,</span>...<span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">  arrows<span class="punctuation">(</span>x<span class="punctuation">,</span>y<span class="operator">+</span>upper<span class="punctuation">,</span> x<span class="punctuation">,</span> y<span class="operator">-</span>lower<span class="punctuation">,</span> angle<span class="operator">=</span><span class="number">90</span><span class="punctuation">,</span> code<span class="operator">=</span><span class="number">3</span><span class="punctuation">,</span> <span class="built_in">length</span><span class="operator">=</span><span class="built_in">length</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Then I calculate the standard deviation for each specie and condition :</span></span><br><span class="line">stdev <span class="operator">&lt;-</span> aggregate<span class="punctuation">(</span>cbind<span class="punctuation">(</span>cond_A<span class="punctuation">,</span>cond_B<span class="punctuation">,</span>cond_C<span class="punctuation">)</span><span class="operator">~</span>specie <span class="punctuation">,</span> data<span class="operator">=</span>data <span class="punctuation">,</span> sd<span class="punctuation">)</span></span><br><span class="line">rownames<span class="punctuation">(</span>stdev<span class="punctuation">)</span> <span class="operator">&lt;-</span> stdev<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">stdev <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>stdev<span class="punctuation">[</span><span class="punctuation">,</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">*</span> <span class="number">1.96</span> <span class="operator">/</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#I am ready to add the error bar on the plot using my &quot;error bar&quot; function !</span></span><br><span class="line">ze_barplot <span class="operator">&lt;-</span> barplot<span class="punctuation">(</span>bilan <span class="punctuation">,</span> beside<span class="operator">=</span><span class="built_in">T</span> <span class="punctuation">,</span> legend.text<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span>col<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;blue&quot;</span> <span class="punctuation">,</span> <span class="string">&quot;skyblue&quot;</span><span class="punctuation">)</span> <span class="punctuation">,</span> ylim<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span>lim<span class="punctuation">)</span> <span class="punctuation">,</span> ylab<span class="operator">=</span><span class="string">&quot;height&quot;</span><span class="punctuation">,</span>las <span class="operator">=</span><span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">error.bar<span class="punctuation">(</span>ze_barplot<span class="punctuation">,</span>bilan<span class="punctuation">,</span> stdev<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##用ggplot作图</span></span><br><span class="line">library<span class="punctuation">(</span>doBy<span class="punctuation">)</span></span><br><span class="line">data1 <span class="operator">&lt;-</span> melt<span class="punctuation">(</span>data<span class="punctuation">,</span>id.vars <span class="operator">=</span> <span class="string">&#x27;specie&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">data_stat <span class="operator">&lt;-</span> summaryBy<span class="punctuation">(</span>value<span class="operator">~</span>specie<span class="operator">+</span>variable<span class="punctuation">,</span> data1<span class="punctuation">,</span> FUN <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>mean<span class="punctuation">,</span> sd<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#同样我们也设置一下均值和方差的阈值</span></span><br><span class="line">height <span class="operator">&lt;-</span> <span class="built_in">max</span><span class="punctuation">(</span>data_stat<span class="operator">$</span>value.mean<span class="punctuation">)</span><span class="operator">*</span><span class="number">1.2</span></span><br><span class="line">data_stat<span class="operator">$</span>value.sd <span class="operator">&lt;-</span> data_stat<span class="operator">$</span>value.sd<span class="operator">*</span><span class="number">1.96</span><span class="operator">/</span><span class="number">10</span></span><br><span class="line"><span class="comment">#作图</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data_stat<span class="punctuation">,</span> aes<span class="punctuation">(</span>variable<span class="punctuation">,</span> value.mean<span class="punctuation">,</span> fill <span class="operator">=</span> specie<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_col<span class="punctuation">(</span>position <span class="operator">=</span> position_dodge<span class="punctuation">(</span>width <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#柱形图绘制</span></span><br><span class="line">  geom_errorbar<span class="punctuation">(</span>aes<span class="punctuation">(</span>ymin <span class="operator">=</span> value.mean <span class="operator">-</span> value.sd<span class="punctuation">,</span> ymax <span class="operator">=</span> value.mean <span class="operator">+</span> value.sd<span class="punctuation">)</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> position <span class="operator">=</span> position_dodge<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#误差线绘制</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> 	<span class="comment">#调整背景</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span>height<span class="punctuation">)</span><span class="punctuation">,</span>expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">                      </span><br></pre></td></tr></table></figure>
<h3 id="华夫pie图"><strong>华夫pie图</strong></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>dplyr<span class="punctuation">)</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">d <span class="operator">&lt;-</span> data_frame<span class="punctuation">(</span></span><br><span class="line">  date <span class="operator">=</span> as.Date<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">813</span><span class="punctuation">,</span> origin <span class="operator">=</span> <span class="string">&quot;2018-01-01&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  year <span class="operator">=</span> format<span class="punctuation">(</span>date<span class="punctuation">,</span> <span class="string">&quot;%Y&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  week <span class="operator">=</span> <span class="built_in">as.integer</span><span class="punctuation">(</span>format<span class="punctuation">(</span>date<span class="punctuation">,</span> <span class="string">&quot;%W&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span>  <span class="comment"># Week starts at 1</span></span><br><span class="line">  day <span class="operator">=</span> factor<span class="punctuation">(</span>weekdays<span class="punctuation">(</span>date<span class="punctuation">,</span> <span class="literal">TRUE</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">               levels <span class="operator">=</span> rev<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;周一&quot;</span><span class="punctuation">,</span><span class="string">&quot;周二&quot;</span><span class="punctuation">,</span><span class="string">&quot;周三&quot;</span><span class="punctuation">,</span><span class="string">&quot;周四&quot;</span><span class="punctuation">,</span><span class="string">&quot;周五&quot;</span><span class="punctuation">,</span><span class="string">&quot;周六&quot;</span><span class="punctuation">,</span><span class="string">&quot;周日&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  hours <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line">d</span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Simulate weekends</span></span><br><span class="line">weekends <span class="operator">&lt;-</span> dplyr<span class="operator">::</span>filter<span class="punctuation">(</span>d<span class="punctuation">,</span> grepl<span class="punctuation">(</span><span class="string">&quot;S(at|un)&quot;</span><span class="punctuation">,</span> day<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Hours worked are (might be) poisson distributed</span></span><br><span class="line">weekends<span class="operator">$</span>hours <span class="operator">&lt;-</span> rpois<span class="punctuation">(</span>nrow<span class="punctuation">(</span>weekends<span class="punctuation">)</span><span class="punctuation">,</span> lambda <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Simulate missing days with probability .7</span></span><br><span class="line">weekends<span class="operator">$</span>na <span class="operator">&lt;-</span> rbinom<span class="punctuation">(</span>nrow<span class="punctuation">(</span>weekends<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">0.7</span><span class="punctuation">)</span></span><br><span class="line">weekends<span class="operator">$</span>hours <span class="operator">&lt;-</span> ifelse<span class="punctuation">(</span>weekends<span class="operator">$</span>na<span class="punctuation">,</span> <span class="literal">NA</span><span class="punctuation">,</span> weekends<span class="operator">$</span>hours<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Simulate weekdays</span></span><br><span class="line">weekdays <span class="operator">&lt;-</span> filter<span class="punctuation">(</span>d<span class="punctuation">,</span> <span class="operator">!</span>grepl<span class="punctuation">(</span><span class="string">&quot;S(at|un)&quot;</span><span class="punctuation">,</span> day<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">weekdays<span class="operator">$</span>hours <span class="operator">&lt;-</span> rpois<span class="punctuation">(</span>nrow<span class="punctuation">(</span>weekdays<span class="punctuation">)</span><span class="punctuation">,</span> lambda <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span>  <span class="comment"># Greater lambda</span></span><br><span class="line">weekdays<span class="operator">$</span>na <span class="operator">&lt;-</span> rbinom<span class="punctuation">(</span>nrow<span class="punctuation">(</span>weekdays<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">0.1</span><span class="punctuation">)</span>  <span class="comment"># Smaller p(missing)</span></span><br><span class="line">weekdays<span class="operator">$</span>hours <span class="operator">&lt;-</span> ifelse<span class="punctuation">(</span>weekdays<span class="operator">$</span>na<span class="punctuation">,</span> <span class="literal">NA</span><span class="punctuation">,</span> weekdays<span class="operator">$</span>hours<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Concatenate weekends and weekdays and arrange by date</span></span><br><span class="line">d <span class="operator">&lt;-</span> bind_rows<span class="punctuation">(</span>weekends<span class="punctuation">,</span> weekdays<span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  arrange<span class="punctuation">(</span>date<span class="punctuation">)</span> <span class="operator">%&gt;%</span>  <span class="comment"># Arrange by date</span></span><br><span class="line">  select<span class="punctuation">(</span><span class="operator">-</span>na<span class="punctuation">)</span>  <span class="comment"># Remove na column</span></span><br><span class="line">d</span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>viridis<span class="punctuation">)</span>  <span class="comment"># Color palette</span></span><br><span class="line">library<span class="punctuation">(</span>ggthemes<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggcor<span class="punctuation">)</span></span><br><span class="line">gh_waffle <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>data<span class="punctuation">,</span> pal <span class="operator">=</span> <span class="string">&quot;D&quot;</span><span class="punctuation">,</span> dir <span class="operator">=</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span>type <span class="operator">=</span> <span class="number">21</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">  </span><br><span class="line">  p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>data<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> week<span class="punctuation">,</span> y <span class="operator">=</span> day<span class="punctuation">,</span> fill <span class="operator">=</span> hours<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    scale_fill_viridis<span class="punctuation">(</span>name<span class="operator">=</span><span class="string">&quot;Hours&quot;</span><span class="punctuation">,</span></span><br><span class="line">                       option <span class="operator">=</span> pal<span class="punctuation">,</span>  <span class="comment"># Variable color palette</span></span><br><span class="line">                       direction <span class="operator">=</span> dir<span class="punctuation">,</span>  <span class="comment"># Variable color direction</span></span><br><span class="line">                       na.value <span class="operator">=</span> <span class="string">&quot;grey93&quot;</span><span class="punctuation">,</span></span><br><span class="line">                       limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="built_in">max</span><span class="punctuation">(</span>data<span class="operator">$</span>hours<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    <span class="comment"># geom_tile(color = &quot;white&quot;, size = 0.4) +</span></span><br><span class="line">    facet_wrap<span class="punctuation">(</span><span class="string">&quot;year&quot;</span><span class="punctuation">,</span> ncol <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    scale_x_continuous<span class="punctuation">(</span></span><br><span class="line">      expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      breaks <span class="operator">=</span> seq<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">52</span><span class="punctuation">,</span> <span class="built_in">length</span> <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Jan&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Feb&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Mar&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Apr&quot;</span><span class="punctuation">,</span> <span class="string">&quot;May&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Jun&quot;</span><span class="punctuation">,</span></span><br><span class="line">                 <span class="string">&quot;Jul&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Aug&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Sep&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Oct&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Nov&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Dec&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    theme_tufte<span class="punctuation">(</span>base_family <span class="operator">=</span> <span class="string">&quot;Helvetica&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">    theme<span class="punctuation">(</span>axis.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">          axis.ticks <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">          legend.position <span class="operator">=</span> <span class="string">&quot;bottom&quot;</span><span class="punctuation">,</span></span><br><span class="line">          legend.key.width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">          strip.text <span class="operator">=</span> element_text<span class="punctuation">(</span>hjust <span class="operator">=</span> <span class="number">0.01</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">#圆形</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span>type <span class="operator">==</span> <span class="number">21</span><span class="punctuation">)</span><span class="punctuation">&#123;</span>p <span class="operator">=</span> p <span class="operator">+</span>geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span>pch <span class="operator">=</span> <span class="number">21</span><span class="punctuation">)</span> <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="comment">#方形</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span>type <span class="operator">==</span> <span class="number">22</span><span class="punctuation">)</span><span class="punctuation">&#123;</span>p <span class="operator">=</span> p <span class="operator">+</span>geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span>pch <span class="operator">=</span> <span class="number">22</span><span class="punctuation">)</span><span class="punctuation">&#125;</span></span><br><span class="line">  <span class="comment">#菱方形</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span>type <span class="operator">==</span> <span class="number">23</span><span class="punctuation">)</span><span class="punctuation">&#123;</span>p <span class="operator">=</span> p <span class="operator">+</span>geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span>pch <span class="operator">=</span> <span class="number">23</span><span class="punctuation">)</span> <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="comment">#上三角</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span>type <span class="operator">==</span> <span class="number">24</span><span class="punctuation">)</span><span class="punctuation">&#123;</span>p <span class="operator">=</span> p <span class="operator">+</span>geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span>pch <span class="operator">=</span> <span class="number">24</span><span class="punctuation">)</span> <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="comment">#下三角</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span>type <span class="operator">==</span> <span class="number">25</span><span class="punctuation">)</span><span class="punctuation">&#123;</span>p <span class="operator">=</span> p <span class="operator">+</span>geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span>pch <span class="operator">=</span> <span class="number">25</span><span class="punctuation">)</span> <span class="punctuation">&#125;</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment">#星形状图</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span>type <span class="operator">==</span> <span class="string">&quot;star&quot;</span><span class="punctuation">)</span><span class="punctuation">&#123;</span>p <span class="operator">=</span> p <span class="operator">+</span>geom_star<span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="comment">#饼图</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span>type <span class="operator">==</span> <span class="string">&quot;pie2&quot;</span><span class="punctuation">)</span><span class="punctuation">&#123;</span>p <span class="operator">=</span> p <span class="operator">+</span> geom_pie2<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="punctuation">&#125;</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  print<span class="punctuation">(</span>p<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">gh_waffle<span class="punctuation">(</span>d<span class="punctuation">,</span>pal <span class="operator">=</span> <span class="string">&quot;D&quot;</span><span class="punctuation">,</span> dir <span class="operator">=</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span>type <span class="operator">=</span> <span class="number">21</span><span class="punctuation">)</span></span><br><span class="line">gh_waffle<span class="punctuation">(</span>d<span class="punctuation">,</span>pal <span class="operator">=</span> <span class="string">&quot;D&quot;</span><span class="punctuation">,</span> dir <span class="operator">=</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span>type <span class="operator">=</span> <span class="string">&quot;pie2&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>pal <span class="keyword">in</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;A&quot;</span><span class="punctuation">,</span> <span class="string">&quot;B&quot;</span><span class="punctuation">,</span> <span class="string">&quot;C&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  gh_waffle<span class="punctuation">(</span>d<span class="punctuation">,</span>pal<span class="punctuation">,</span> dir <span class="operator">=</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span>type <span class="operator">=</span> <span class="string">&quot;star&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="none"></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#绘制单线条</span></span><br><span class="line">df <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>dose <span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;A&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;B&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;C&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span>len<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">5.16</span><span class="punctuation">,</span><span class="number">10.10</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>df<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#因为横坐标的属性为因子（离散型的字符转换为因子），所以需要添加‘group = 1’的设置。</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data<span class="operator">=</span>df<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>dose<span class="punctuation">,</span>y<span class="operator">=</span>len<span class="punctuation">,</span>group<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_line<span class="punctuation">(</span>linetype <span class="operator">=</span> <span class="string">&quot;dashed&quot;</span><span class="punctuation">,</span>color<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="operator">+</span>geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#添加箭头</span></span><br><span class="line">library<span class="punctuation">(</span>grid<span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data<span class="operator">=</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>dose<span class="punctuation">,</span> y<span class="operator">=</span>len<span class="punctuation">,</span> group<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_line<span class="punctuation">(</span>arrow <span class="operator">=</span> arrow<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#自定义箭头类型</span></span><br><span class="line">myarrow<span class="operator">=</span>arrow<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="number">15</span><span class="punctuation">,</span> ends <span class="operator">=</span> <span class="string">&quot;both&quot;</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&quot;closed&quot;</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data<span class="operator">=</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>dose<span class="punctuation">,</span> y<span class="operator">=</span>len<span class="punctuation">,</span> group<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>geom_line<span class="punctuation">(</span>arrow<span class="operator">=</span>myarrow<span class="punctuation">)</span><span class="operator">+</span>geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#附赠</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data<span class="operator">=</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>dose<span class="punctuation">,</span> y<span class="operator">=</span>len<span class="punctuation">,</span> group<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> geom_step<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span> geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#绘制多线条</span></span><br><span class="line">df2 <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>supp<span class="operator">=</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Case&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Control&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>each<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">,</span> dose<span class="operator">=</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;A&quot;</span><span class="punctuation">,</span> <span class="string">&quot;B&quot;</span><span class="punctuation">,</span> <span class="string">&quot;C&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span>len<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">6.8</span><span class="punctuation">,</span> <span class="number">15</span><span class="punctuation">,</span> <span class="number">38</span><span class="punctuation">,</span> <span class="number">5.16</span><span class="punctuation">,</span> <span class="number">10.10</span><span class="punctuation">,</span> <span class="number">30</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>df2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>data<span class="operator">=</span>df2<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>dose<span class="punctuation">,</span> y<span class="operator">=</span>len<span class="punctuation">,</span> group<span class="operator">=</span>supp<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_line<span class="punctuation">(</span>linetype<span class="operator">=</span><span class="string">&quot;dashed&quot;</span><span class="punctuation">,</span> color<span class="operator">=</span><span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">1.2</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#改变线形</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df2<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>dose<span class="punctuation">,</span> y<span class="operator">=</span>len<span class="punctuation">,</span> group<span class="operator">=</span>supp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_line<span class="punctuation">(</span>aes<span class="punctuation">(</span>linetype<span class="operator">=</span>supp<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>shape<span class="operator">=</span>supp<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#自定义线性</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df2<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>dose<span class="punctuation">,</span> y<span class="operator">=</span>len<span class="punctuation">,</span> group<span class="operator">=</span>supp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_line<span class="punctuation">(</span>aes<span class="punctuation">(</span>linetype<span class="operator">=</span>supp<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_linetype_manual<span class="punctuation">(</span>values<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;twodash&quot;</span><span class="punctuation">,</span> <span class="string">&quot;dotted&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#更改颜色</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>df2<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>dose<span class="punctuation">,</span> y<span class="operator">=</span>len<span class="punctuation">,</span> group<span class="operator">=</span>supp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_line<span class="punctuation">(</span>aes<span class="punctuation">(</span>color<span class="operator">=</span>supp<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color<span class="operator">=</span>supp<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line"><span class="comment"># Use custom color palettes</span></span><br><span class="line">p<span class="operator">+</span>scale_color_manual<span class="punctuation">(</span>values<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#E69F00&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#56B4E9&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Use brewer color palettes</span></span><br><span class="line">p<span class="operator">+</span>scale_color_brewer<span class="punctuation">(</span>palette<span class="operator">=</span><span class="string">&quot;Dark2&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Use grey scale</span></span><br><span class="line">p <span class="operator">+</span>scale_color_grey<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> theme_classic<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#绘制添加误差棒的折线图 可以使用position_dodge 参数，防止errorbars重叠</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df3<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>dose<span class="punctuation">,</span> y<span class="operator">=</span>len<span class="punctuation">,</span> group <span class="operator">=</span> supp<span class="punctuation">,</span> color<span class="operator">=</span>supp<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span> </span><br><span class="line">  geom_errorbar<span class="punctuation">(</span>aes<span class="punctuation">(</span>ymin<span class="operator">=</span>len<span class="operator">-</span>sd<span class="punctuation">,</span> ymax<span class="operator">=</span>len<span class="operator">+</span>sd<span class="punctuation">)</span><span class="punctuation">,</span> width<span class="operator">=</span><span class="number">.1</span><span class="punctuation">,</span> </span><br><span class="line">                position<span class="operator">=</span>position_dodge<span class="punctuation">(</span><span class="number">0.05</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_line<span class="punctuation">(</span>aes<span class="punctuation">(</span>linetype<span class="operator">=</span>supp<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>shape<span class="operator">=</span>supp<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>title<span class="operator">=</span><span class="string">&quot;Plot of lengthby dose&quot;</span><span class="punctuation">,</span>x<span class="operator">=</span><span class="string">&quot;Dose (mg)&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Length&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme_classic<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_color_manual<span class="punctuation">(</span>values<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#999999&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#E69F00&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 我们的另一个备选方案，拆线图也很好看</span></span><br><span class="line">library<span class="punctuation">(</span>ggpubr<span class="punctuation">)</span></span><br><span class="line">p<span class="operator">=</span>ggline<span class="punctuation">(</span><span class="built_in">all</span><span class="punctuation">,</span> x<span class="operator">=</span><span class="string">&quot;group&quot;</span><span class="punctuation">,</span> y<span class="operator">=</span><span class="string">&quot;distance&quot;</span><span class="punctuation">,</span> add <span class="operator">=</span> <span class="string">&quot;mean_se&quot;</span><span class="punctuation">,</span>  color <span class="operator">=</span> <span class="string">&quot;type&quot;</span><span class="punctuation">,</span></span><br><span class="line">       palette <span class="operator">=</span> <span class="string">&quot;jco&quot;</span><span class="punctuation">,</span>legend <span class="operator">=</span> <span class="string">&quot;right&quot;</span><span class="punctuation">)</span> <span class="operator">+</span>main_theme</span><br><span class="line">p</span><br><span class="line">ggsave<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;e.line&quot;</span><span class="punctuation">,</span><span class="string">&quot;.pdf&quot;</span><span class="punctuation">,</span> sep<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> p<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="雷达图"><strong>雷达图</strong></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">setwd<span class="punctuation">(</span><span class="string">&#x27;./Script/雷达图/&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#ggradar包需要通过 github 来安装，安装方法如下：</span></span><br><span class="line">devtools<span class="operator">::</span>install_github<span class="punctuation">(</span><span class="string">&quot;ricardo-bion/ggradar&quot;</span><span class="punctuation">,</span> dependencies<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggradar<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 或者手动下载下来</span></span><br><span class="line"><span class="comment">#install.packages(&quot;E:/R/R-3.5.2/library/ggradar-master/&quot;, repos = NULL, type = &quot;source&quot;) </span></span><br><span class="line"></span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">123</span><span class="punctuation">)</span></span><br><span class="line">mydata<span class="operator">&lt;-</span>matrix<span class="punctuation">(</span>runif<span class="punctuation">(</span><span class="number">24</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span></span><br><span class="line">rownames<span class="punctuation">(</span>mydata<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">LETTERS</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">]</span></span><br><span class="line">colnames<span class="punctuation">(</span>mydata<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Apple&quot;</span><span class="punctuation">,</span><span class="string">&quot;Google&quot;</span><span class="punctuation">,</span><span class="string">&quot;Amozon&quot;</span><span class="punctuation">,</span><span class="string">&quot;Tencent&quot;</span><span class="punctuation">,</span><span class="string">&quot;Alibaba&quot;</span><span class="punctuation">,</span><span class="string">&quot;Baidu&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#使用以上文本向量为矩阵列命名，方便展示</span></span><br><span class="line">mynewdata<span class="operator">&lt;-</span>data.frame<span class="punctuation">(</span>mydata<span class="punctuation">)</span></span><br><span class="line">Name<span class="operator">&lt;-</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;USA&quot;</span><span class="punctuation">,</span><span class="string">&quot;CHN&quot;</span><span class="punctuation">,</span><span class="string">&quot;UK&quot;</span><span class="punctuation">,</span><span class="string">&quot;RUS&quot;</span><span class="punctuation">)</span></span><br><span class="line">mynewdata<span class="operator">&lt;-</span>data.frame<span class="punctuation">(</span>Name<span class="punctuation">,</span>mynewdata<span class="punctuation">)</span></span><br><span class="line">mynewdata</span><br><span class="line"></span><br><span class="line"><span class="comment">#绘制所有变量的雷达图</span></span><br><span class="line">ggradar<span class="punctuation">(</span>mynewdata<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>ggradar<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>scales<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>tibble<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>dplyr<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#利用内置car数据集进行雷达图绘制，主要是对数据进行scale，然后绘制</span></span><br><span class="line">mtcars <span class="operator">%&gt;%</span></span><br><span class="line">  rownames_to_column<span class="punctuation">(</span> var <span class="operator">=</span> <span class="string">&quot;group&quot;</span> <span class="punctuation">)</span> <span class="operator">%&gt;%</span> <span class="comment">#保留行名称</span></span><br><span class="line">  mutate_at<span class="punctuation">(</span>vars<span class="punctuation">(</span><span class="operator">-</span>group<span class="punctuation">)</span><span class="punctuation">,</span>funs<span class="punctuation">(</span>rescale<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  tail<span class="punctuation">(</span><span class="number">4</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> select<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">6</span><span class="punctuation">)</span> <span class="operator">-&gt;</span> mtcars_radar</span><br><span class="line">ggradar<span class="punctuation">(</span>mtcars_radar<span class="punctuation">,</span> grid.line.width <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span>axis.label.size<span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span>group.line.width <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>group.point.size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#简单例子</span></span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">1234</span><span class="punctuation">)</span></span><br><span class="line">dat <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  obj <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;obj1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;obj2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;obj3&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  factor1 <span class="operator">=</span> runif<span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  factor2 <span class="operator">=</span> runif<span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  factor3 <span class="operator">=</span> runif<span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  factor4 <span class="operator">=</span> runif<span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  factor5 <span class="operator">=</span> runif<span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#查看数据集结构</span></span><br><span class="line">dat</span><br><span class="line">ggradar<span class="punctuation">(</span>dat<span class="punctuation">,</span> background.circle.transparency <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> group.colours <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green3&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="发散性正负图"><strong>发散性正负图</strong></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">setwd<span class="punctuation">(</span><span class="string">&#x27;../发散性正负图/&#x27;</span><span class="punctuation">)</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 使用mtcars数据集</span></span><br><span class="line">data<span class="punctuation">(</span><span class="string">&quot;mtcars&quot;</span><span class="punctuation">)</span>  </span><br><span class="line"><span class="comment"># 保留car name ，新建一列</span></span><br><span class="line">mtcars<span class="operator">$</span>car_name <span class="operator">&lt;-</span> rownames<span class="punctuation">(</span>mtcars<span class="punctuation">)</span> </span><br><span class="line"><span class="comment"># 对mpg进行标准化处理 </span></span><br><span class="line">mtcars<span class="operator">$</span>mpg_z <span class="operator">&lt;-</span> <span class="built_in">round</span><span class="punctuation">(</span><span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg <span class="operator">-</span> mean<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">/</span>sd<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span>  </span><br><span class="line"><span class="comment"># 按照0未阈值 ，分上 下</span></span><br><span class="line">mtcars<span class="operator">$</span>mpg_type <span class="operator">&lt;-</span> ifelse<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg_z <span class="operator">&lt;</span> <span class="number">0</span><span class="punctuation">,</span> <span class="string">&quot;below&quot;</span><span class="punctuation">,</span> <span class="string">&quot;above&quot;</span><span class="punctuation">)</span>  </span><br><span class="line"></span><br><span class="line">mtcars <span class="operator">&lt;-</span> mtcars<span class="punctuation">[</span>order<span class="punctuation">(</span>mtcars<span class="operator">$</span>mpg_z<span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span>  <span class="comment"># 为展示美观，数据排序</span></span><br><span class="line"><span class="comment"># 改为因子，能够保持原顺序 改为因子使图形按照原顺序输出，很常用</span></span><br><span class="line">mtcars<span class="operator">$</span>car_name <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>mtcars<span class="operator">$</span>car_name<span class="punctuation">,</span> levels <span class="operator">=</span> mtcars<span class="operator">$</span>car_name<span class="punctuation">)</span>  </span><br><span class="line"></span><br><span class="line"><span class="comment">#Diverging bars是一种可以同时处理负值和正值的条形图。注意为了使柱状图创建柱形图而不是直方图，需要确保：</span></span><br><span class="line"><span class="comment">#（1）设置stat=identity</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#（2）在aes()中同时提供x和y，其中x是字符或因子，y是数值。</span></span><br><span class="line">ggplot<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>car_name<span class="punctuation">,</span> y<span class="operator">=</span>mpg_z<span class="punctuation">,</span> label<span class="operator">=</span>mpg_z<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>   geom_bar<span class="punctuation">(</span>stat<span class="operator">=</span><span class="string">&#x27;identity&#x27;</span><span class="punctuation">,</span> aes<span class="punctuation">(</span>fill<span class="operator">=</span>mpg_type<span class="punctuation">)</span><span class="punctuation">,</span> width<span class="operator">=</span><span class="number">.5</span><span class="punctuation">)</span>  <span class="operator">+</span> </span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span>name<span class="operator">=</span><span class="string">&quot;Mileage&quot;</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Above Average&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Below Average&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;above&quot;</span><span class="operator">=</span><span class="string">&quot;#00ba38&quot;</span><span class="punctuation">,</span> <span class="string">&quot;below&quot;</span><span class="operator">=</span><span class="string">&quot;#f8766d&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>  </span><br><span class="line">  labs<span class="punctuation">(</span>subtitle<span class="operator">=</span><span class="string">&quot;Normalised mileage from &#x27;mtcars&#x27;&quot;</span><span class="punctuation">,</span> title<span class="operator">=</span> <span class="string">&quot;Diverging Bars&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> coord_flip<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> theme_bw<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#Diverging Lollipop Chart</span></span><br><span class="line">ggplot<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>car_name<span class="punctuation">,</span> y<span class="operator">=</span>mpg_z<span class="punctuation">,</span> label<span class="operator">=</span>mpg_z<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>   geom_point<span class="punctuation">(</span>stat<span class="operator">=</span><span class="string">&#x27;identity&#x27;</span><span class="punctuation">,</span> color<span class="operator">=</span><span class="string">&quot;orange&quot;</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">4</span><span class="punctuation">)</span>  <span class="operator">+</span>  geom_segment<span class="punctuation">(</span>aes<span class="punctuation">(</span>y <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> </span><br><span class="line">                                                                                                                                  x <span class="operator">=</span>car_name<span class="punctuation">,</span> </span><br><span class="line">                                                                                                                                  yend <span class="operator">=</span> mpg_z<span class="punctuation">,</span> </span><br><span class="line">                                                                                                                                  xend <span class="operator">=</span>car_name<span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">                                                                                                                              color <span class="operator">=</span> <span class="string">&quot;grey&quot;</span><span class="punctuation">)</span>  <span class="operator">+</span>  labs<span class="punctuation">(</span>title<span class="operator">=</span><span class="string">&quot;Diverging Lollipop Chart&quot;</span><span class="punctuation">)</span> <span class="operator">+</span>   ylim<span class="punctuation">(</span><span class="operator">-</span><span class="number">2.5</span><span class="punctuation">,</span> <span class="number">2.5</span><span class="punctuation">)</span> <span class="operator">+</span>  coord_flip<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> theme_bw<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#点图</span></span><br><span class="line">ggplot<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>car_name<span class="punctuation">,</span> y<span class="operator">=</span>mpg_z<span class="punctuation">,</span> label<span class="operator">=</span>mpg_z<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>   geom_point<span class="punctuation">(</span>stat<span class="operator">=</span><span class="string">&#x27;identity&#x27;</span><span class="punctuation">,</span> aes<span class="punctuation">(</span>col<span class="operator">=</span>mpg_type<span class="punctuation">)</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">6</span><span class="punctuation">)</span>  <span class="operator">+</span>  scale_color_manual<span class="punctuation">(</span>name<span class="operator">=</span><span class="string">&quot;Mileage&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                                                                                                                        labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Above Average&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Below Average&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                                                                                                                                        values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;above&quot;</span><span class="operator">=</span><span class="string">&quot;#00ba38&quot;</span><span class="punctuation">,</span> <span class="string">&quot;below&quot;</span><span class="operator">=</span><span class="string">&quot;#f8766d&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>   geom_text<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&quot;white&quot;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span>  labs<span class="punctuation">(</span>title<span class="operator">=</span><span class="string">&quot;Diverging Dot Plot&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                                                                                                                                                                                                                       subtitle<span class="operator">=</span><span class="string">&quot;Normalized mileage from &#x27;mtcars&#x27;: Dotplot&quot;</span><span class="punctuation">)</span> <span class="operator">+</span>   ylim<span class="punctuation">(</span><span class="operator">-</span><span class="number">2.5</span><span class="punctuation">,</span> <span class="number">2.5</span><span class="punctuation">)</span> <span class="operator">+</span>  coord_flip<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> theme_bw<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h3 id="bee蜜蜂图"><strong>bee蜜蜂图</strong></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">setwd<span class="punctuation">(</span><span class="string">&#x27;./蜜蜂图/&#x27;</span><span class="punctuation">)</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#install.packages(&quot;beeswarm&quot;)</span></span><br><span class="line">library<span class="punctuation">(</span><span class="string">&#x27;beeswarm&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">其中主要的参数：</span></span><br><span class="line"><span class="string">Method 主要是指的散点图的样式。Center对称群；另外还有swarm（成群的），hex，square。</span></span><br><span class="line"><span class="string">spacing 各点之间距离。</span></span><br><span class="line"><span class="string">Cex 各点的大小。</span></span><br><span class="line"><span class="string">corral 控制点不超过坐标点的区域，可以结合corralWidth设置坐标位置宽度。超出的部分如果设置omit则会忽略；设置random会随机显示在覆盖的区域。</span></span><br><span class="line"><span class="string">Priority 点的排布，但是只在method=swarm时可用。其可选的参数包括：ascending（升序），descending（降序），density， random（随机显示） ，none。</span></span><br><span class="line"><span class="string">Add 是否加在其它绘图之上，比如箱线图上加这个图则设置为TRUE。</span></span><br><span class="line"><span class="string">Pwcol 设置分组，可以给与不同的颜色显示不同的点。当然，可以支持list设置多个组的不同样本颜色。</span></span><br><span class="line"><span class="string">Pch 点的形状，可以参考plot对点的设置。&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment">#单组数据</span></span><br><span class="line">distributions <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>runif <span class="operator">=</span> runif<span class="punctuation">(</span><span class="number">200</span><span class="punctuation">,</span><span class="built_in">min</span> <span class="operator">=</span> <span class="operator">-</span><span class="number">3</span><span class="punctuation">,</span> <span class="built_in">max</span> <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span><span class="punctuation">,</span> rnorm <span class="operator">=</span> rnorm<span class="punctuation">(</span><span class="number">200</span><span class="punctuation">)</span><span class="punctuation">,</span>rlnorm <span class="operator">=</span> rlnorm<span class="punctuation">(</span><span class="number">200</span><span class="punctuation">,</span> sdlog <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">beeswarm<span class="punctuation">(</span>distributions<span class="punctuation">,</span> col <span class="operator">=</span> <span class="number">2</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">,</span> pch<span class="operator">=</span><span class="number">16</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">###多组数据</span></span><br><span class="line"></span><br><span class="line">data<span class="punctuation">(</span>breast<span class="punctuation">)</span></span><br><span class="line">beeswarm<span class="punctuation">(</span>time_survival <span class="operator">~</span> ER<span class="punctuation">,</span> data <span class="operator">=</span> breast<span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">16</span><span class="punctuation">,</span> pwcol <span class="operator">=</span> <span class="number">1</span> <span class="operator">+</span><span class="built_in">as.numeric</span><span class="punctuation">(</span>event_survival<span class="punctuation">)</span><span class="punctuation">,</span>xlab <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&quot;Follow-up time(months)&quot;</span><span class="punctuation">,</span>labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;ER neg&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ER pos&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> </span><br><span class="line">legend<span class="punctuation">(</span><span class="string">&quot;topright&quot;</span><span class="punctuation">,</span> legend <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Yes&quot;</span><span class="punctuation">,</span><span class="string">&quot;No&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&quot;Censored&quot;</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">16</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##每个组独立设置颜色</span></span><br><span class="line">Dd<span class="operator">=</span><span class="number">1</span> <span class="operator">+</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>breast <span class="operator">$</span>event_survival<span class="punctuation">)</span></span><br><span class="line">mycol<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span><span class="punctuation">)</span> </span><br><span class="line">neg<span class="operator">=</span>which<span class="punctuation">(</span>Dd<span class="operator">==</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">pos<span class="operator">=</span>which<span class="punctuation">(</span>Dd<span class="operator">==</span><span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">mycol<span class="operator">$</span>neg<span class="operator">=</span>Dd<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="built_in">length</span><span class="punctuation">(</span>neg<span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">mycol<span class="operator">$</span>pos<span class="operator">=</span>Dd<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="built_in">length</span><span class="punctuation">(</span>pos<span class="punctuation">)</span><span class="punctuation">]</span><span class="operator">+</span><span class="number">1</span></span><br><span class="line">data<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span><span class="punctuation">)</span> </span><br><span class="line">data<span class="operator">$</span>neg<span class="operator">=</span>breast<span class="operator">$</span>time_survival<span class="punctuation">[</span>neg<span class="punctuation">]</span></span><br><span class="line">data<span class="operator">$</span>pos<span class="operator">=</span>breast<span class="operator">$</span>time_survival<span class="punctuation">[</span>pos<span class="punctuation">]</span></span><br><span class="line">beeswarm<span class="punctuation">(</span>data<span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">16</span><span class="punctuation">,</span> pwcol <span class="operator">=</span> mycol<span class="punctuation">,</span>xlab<span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&quot;Follow-up time (months)&quot;</span><span class="punctuation">,</span>labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;ERneg&quot;</span><span class="punctuation">,</span> <span class="string">&quot;ER pos&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">legend<span class="punctuation">(</span><span class="string">&quot;topright&quot;</span><span class="punctuation">,</span> legend <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">,</span>title <span class="operator">=</span> <span class="string">&quot;Censored&quot;</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">16</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#另外此包还内置了自己的一个箱线图的绘制函数，和R语言基础的函数名称是一样的boxplot：</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##基础箱线图 </span></span><br><span class="line">beeswarm<span class="punctuation">(</span>len <span class="operator">~</span> dose<span class="punctuation">,</span> data <span class="operator">=</span> ToothGrowth<span class="punctuation">)</span> </span><br><span class="line">bxplot<span class="punctuation">(</span>len <span class="operator">~</span> dose<span class="punctuation">,</span> data <span class="operator">=</span> ToothGrowth<span class="punctuation">,</span> add <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###负责箱线图绘制</span></span><br><span class="line">data<span class="punctuation">(</span>breast<span class="punctuation">)</span> </span><br><span class="line">bxplot<span class="punctuation">(</span>time_survival <span class="operator">~</span> event_survival<span class="punctuation">,</span> data <span class="operator">=</span> breast<span class="punctuation">,</span> probs <span class="operator">=</span> seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span>by <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> rainbow<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">beeswarm<span class="punctuation">(</span>time_survival <span class="operator">~</span> event_survival<span class="punctuation">,</span> data <span class="operator">=</span> breast<span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">21</span><span class="punctuation">,</span> bg <span class="operator">=</span><span class="string">&quot;green&quot;</span><span class="punctuation">,</span> add <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="beanplot-豆荚图">BeanPlot(豆荚图)</h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>beanplot<span class="punctuation">)</span></span><br><span class="line">par<span class="punctuation">(</span>mfrow <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">boxplot<span class="punctuation">(</span>len <span class="operator">~</span> dose<span class="punctuation">,</span> data <span class="operator">=</span> ToothGrowth<span class="punctuation">,</span></span><br><span class="line">        boxwex <span class="operator">=</span> <span class="number">0.25</span><span class="punctuation">,</span> at <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">3</span> <span class="operator">-</span> <span class="number">0.2</span><span class="punctuation">,</span></span><br><span class="line">        subset <span class="operator">=</span> supp <span class="operator">==</span> <span class="string">&quot;VC&quot;</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&quot;yellow&quot;</span><span class="punctuation">,</span></span><br><span class="line">        main <span class="operator">=</span> <span class="string">&quot;Guinea Pigs&#x27; Tooth Growth&quot;</span><span class="punctuation">,</span></span><br><span class="line">        xlab <span class="operator">=</span> <span class="string">&quot;Vitamin C dose mg&quot;</span><span class="punctuation">,</span></span><br><span class="line">        ylab <span class="operator">=</span> <span class="string">&quot;tooth length&quot;</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">40</span><span class="punctuation">)</span><span class="punctuation">,</span> yaxs <span class="operator">=</span> <span class="string">&quot;i&quot;</span><span class="punctuation">)</span></span><br><span class="line">boxplot<span class="punctuation">(</span>len <span class="operator">~</span> dose<span class="punctuation">,</span> data <span class="operator">=</span> ToothGrowth<span class="punctuation">,</span> add<span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span></span><br><span class="line">        boxwex <span class="operator">=</span> <span class="number">0.25</span><span class="punctuation">,</span> at <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">3</span> <span class="operator">+</span> <span class="number">0.2</span><span class="punctuation">,</span></span><br><span class="line">        subset <span class="operator">=</span> supp <span class="operator">==</span> <span class="string">&quot;OJ&quot;</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&quot;orange&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">legend<span class="punctuation">(</span><span class="string">&quot;bottomright&quot;</span><span class="punctuation">,</span>bty<span class="operator">=</span><span class="string">&quot;n&quot;</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Ascorbic acid&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Orange juice&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">       fill <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;yellow&quot;</span><span class="punctuation">,</span> <span class="string">&quot;orange&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">beanplot<span class="punctuation">(</span>len <span class="operator">~</span> reorder<span class="punctuation">(</span>supp<span class="punctuation">,</span> len<span class="punctuation">,</span> mean<span class="punctuation">)</span> <span class="operator">*</span>dose<span class="punctuation">,</span> ToothGrowth<span class="punctuation">,</span></span><br><span class="line">         side <span class="operator">=</span> <span class="string">&quot;b&quot;</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="string">&quot;yellow&quot;</span><span class="punctuation">,</span><span class="string">&quot;orange&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;yellow2&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                                               <span class="string">&quot;darkorange&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&quot;Guinea Pigs&#x27; Tooth Growth&quot;</span><span class="punctuation">,</span></span><br><span class="line">         xlab <span class="operator">=</span> <span class="string">&quot;Vitamin C dose mg&quot;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&quot;tooth length&quot;</span><span class="punctuation">,</span>ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">                                                                    <span class="number">40</span><span class="punctuation">)</span><span class="punctuation">,</span> yaxs <span class="operator">=</span> <span class="string">&quot;i&quot;</span><span class="punctuation">)</span></span><br><span class="line">legend<span class="punctuation">(</span><span class="string">&quot;bottomright&quot;</span><span class="punctuation">,</span>bty<span class="operator">=</span><span class="string">&quot;n&quot;</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Ascorbic acid&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Orange juice&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">       fill <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;yellow&quot;</span><span class="punctuation">,</span> <span class="string">&quot;orange&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="none"></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggsci<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggalluvial<span class="punctuation">)</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">pdf<span class="punctuation">(</span><span class="string">&#x27;./phylum.pdf&#x27;</span><span class="punctuation">)</span></span><br><span class="line">phylum <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&quot;1.txt&quot;</span><span class="punctuation">,</span>check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span>stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>data <span class="operator">=</span> phylum<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>variable<span class="punctuation">,</span>y<span class="operator">=</span>value<span class="punctuation">,</span>alluvium<span class="operator">=</span>Phylum<span class="punctuation">,</span>stratum<span class="operator">=</span>Phylum<span class="punctuation">,</span>fill<span class="operator">=</span>Phylum<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_alluvium<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill<span class="operator">=</span>Phylum<span class="punctuation">,</span>colour <span class="operator">=</span> Phylum<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_stratum<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">p<span class="operator">+</span>scale_color_npg<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span>scale_fill_npg<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span>theme<span class="punctuation">(</span>axis.text.x<span class="operator">=</span>element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span>axis.text.y<span class="operator">=</span>element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                                           legend.text<span class="operator">=</span>element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span>legend.title<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                                           legend.position <span class="operator">=</span> <span class="string">&#x27;bottom&#x27;</span><span class="punctuation">)</span><span class="operator">+</span>xlab<span class="punctuation">(</span><span class="string">&#x27;&#x27;</span><span class="punctuation">)</span><span class="operator">+</span>ylab<span class="punctuation">(</span><span class="string">&#x27;&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>饼图</p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzA3MzcwNDMyNA==&amp;mid=2247485098&amp;idx=2&amp;sn=4adcf3c4aca5d9c03208aec5e4c2f518&amp;chksm=9f0bb041a87c39571e5e0a40af63163d0e1d50519de3ccf0a4eb2a39085d058fd53cb770a233&amp;mpshare=1&amp;scene=1&amp;srcid=&amp;sharer_sharetime=1592181290604&amp;sharer_shareid=a9c678b9d5b98f3f89a861807cb45f79&amp;key=15fd7ea6eecdea226a0c8d700a877f32f4cc6f881ba1899577fd51be3fd12a1b6786d85702fda9dd1b3ae38d5e9191d24d627e02150f230a186dbf45b6747e6be38f080f5b8f93564eb463ac6a0911c3&amp;ascene=1&amp;uin=Mjc2NjUwNjgzOA%3D%3D&amp;devicetype=Windows+10+x64&amp;version=62090070&amp;lang=zh_CN&amp;exportkey=AzadIfn6%2BwTEjW2SziDxCMM%3D&amp;pass_ticket=u7NR5bYzf02sDg1rcV%2FEKVKBwY5earOnuUBXjo84nhp6rauQdjFylEmD7mJC851l">【R与Excel】满足需求：多层饼图 </a></p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment">#The slices will be ordered and plotted counter-clockwise.</span></span><br><span class="line">labels =<span class="string">&#x27;Frogs&#x27;</span>,<span class="string">&#x27;Hogs&#x27;</span>,<span class="string">&#x27;Dogs&#x27;</span>,<span class="string">&#x27;Logs&#x27;</span><span class="comment">#定义标签</span></span><br><span class="line">sizes=[<span class="number">15</span>,<span class="number">30</span>,<span class="number">45</span>,<span class="number">10</span>]<span class="comment">#每一块的比例</span></span><br><span class="line">colors=[<span class="string">&#x27;yellowgreen&#x27;</span>,<span class="string">&#x27;gold&#x27;</span>,<span class="string">&#x27;lightskyblue&#x27;</span>,<span class="string">&#x27;lightcoral&#x27;</span>]<span class="comment">#每一块的颜色</span></span><br><span class="line">explode=(<span class="number">0</span>, <span class="number">0.1</span>, <span class="number">0.1</span>, <span class="number">0</span>)<span class="comment">#突出显示，这里仅仅突出显示第二块（即Hogs&#x27;）</span></span><br><span class="line">plt.pie(sizes,explode=explode,labels=labels,colors=colors,autopct=<span class="string">&#x27;%1.1f%%&#x27;</span>,shadow=<span class="literal">True</span>,startangle=<span class="number">90</span>)</span><br><span class="line">plt.axis (<span class="string">&#x27;equal&#x27;</span>)<span class="comment">#显示为圆（避免比例压缩为椭圆）</span></span><br><span class="line">plt.show ()</span><br><span class="line">plt.savefig(<span class="string">&#x27;piechart.png&#x27;</span> , dpi=<span class="number">300</span>)</span><br><span class="line"></span><br><span class="line">***************R中方法******************</span><br><span class="line">a &lt;- c(<span class="string">&quot;A&quot;</span>,<span class="string">&quot;B&quot;</span>,<span class="string">&quot;C&quot;</span>,<span class="string">&quot;D&quot;</span>,<span class="string">&quot;E&quot;</span>,<span class="string">&quot;F&quot;</span>,<span class="string">&quot;G&quot;</span>)</span><br><span class="line">b &lt;- c(<span class="number">17</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">9</span>)</span><br><span class="line">pct &lt;- <span class="built_in">round</span>(b/<span class="built_in">sum</span>(b)*<span class="number">100</span>)</span><br><span class="line">lab &lt;- paste(a,<span class="string">&#x27; &#x27;</span>,pct,<span class="string">&quot;%&quot;</span>,sep = <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">d &lt;- data.frame(a,b,lab)</span><br><span class="line">d &lt;- d[order(d[,<span class="string">&quot;b&quot;</span>]),]</span><br><span class="line">library(RColorBrewer)</span><br><span class="line">pie(d[,<span class="string">&quot;b&quot;</span>],labels=NA,clockwise=T,col=brewer.pal(<span class="number">7</span>,<span class="string">&quot;Set1&quot;</span>),</span><br><span class="line">    border=<span class="string">&quot;white&quot;</span>,radius=<span class="number">0.9</span>,cex=<span class="number">0.5</span>,main=<span class="string">&quot;Pie chart&quot;</span>)</span><br><span class="line"><span class="comment">#添加图例</span></span><br><span class="line">legend(<span class="string">&quot;right&quot;</span>,legend = lab,bty = <span class="string">&quot;n&quot;</span>,inset = c(-<span class="number">0.7</span>,<span class="number">0</span>),</span><br><span class="line">       xpd = T,fill = brewer.pal(<span class="number">7</span>,<span class="string">&quot;Set1&quot;</span>))</span><br><span class="line"><span class="comment">#还有一种方式是在扇形的附近进行文字标注</span></span><br><span class="line">pie(d$b,labels=d$lab,col=rainbow(length(d$lab)),</span><br><span class="line">    main=<span class="string">&quot;Pie Chart with Percentage&quot;</span>)</span><br><span class="line"><span class="comment">#3D饼图</span></span><br><span class="line">library(plotrix)</span><br><span class="line">pie3D(d$b, labels=d$lab, explode=<span class="number">0.1</span>, height = <span class="number">0.2</span>,</span><br><span class="line">      radius = <span class="number">0.8</span>, main=<span class="string">&quot;3D Pie Chart&quot;</span>,col =  brewer.pal(<span class="number">7</span>,<span class="string">&quot;Set1&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#ggplot2画法</span></span><br><span class="line">color &lt;- c(<span class="string">&#x27;#FF7F00&#x27;</span>, <span class="string">&#x27;#FFFF33&#x27;</span>, <span class="string">&#x27;#984EA3&#x27;</span>, <span class="string">&#x27;#4DAF4A&#x27;</span>, <span class="string">&#x27;#377EB8&#x27;</span>, <span class="string">&#x27;#E41A1C&#x27;</span>,</span><br><span class="line">           <span class="string">&#x27;#FFED6F&#x27;</span>, <span class="string">&#x27;#CCEBC5&#x27;</span>, <span class="string">&#x27;#BC80BD&#x27;</span>, <span class="string">&#x27;#FCCDE5&#x27;</span>, <span class="string">&#x27;#B3DE69&#x27;</span>, <span class="string">&#x27;#FDB462&#x27;</span>)</span><br><span class="line">names(color) &lt;- names(phylum)</span><br><span class="line">library(ggplot2)</span><br><span class="line"></span><br><span class="line"><span class="built_in">dir</span>.create(<span class="string">&#x27;plot&#x27;</span>, recursive = TRUE)  <span class="comment">#创建目录“plot”用于存放图片</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (module <span class="keyword">in</span> unique(node$modularity_class)) &#123;</span><br><span class="line">  node_module &lt;- subset(node, modularity_class == module)</span><br><span class="line">  node_phylum &lt;- data.frame(table(node_module$phylum))</span><br><span class="line">  </span><br><span class="line">  p &lt;- ggplot(node_phylum, aes(x = <span class="string">&#x27;&#x27;</span>, y = Freq, fill = Var1)) + </span><br><span class="line">    geom_bar(stat = <span class="string">&#x27;identity&#x27;</span>, width = <span class="number">1</span>) +</span><br><span class="line">    coord_polar(theta = <span class="string">&#x27;y&#x27;</span>) +</span><br><span class="line">    scale_fill_manual(limits = names(color), values = color) + </span><br><span class="line">    theme(panel.grid = element_blank(), panel.background = element_blank(), </span><br><span class="line">          axis.text.x = element_blank()) +</span><br><span class="line">    labs(x = <span class="string">&#x27;&#x27;</span>, y = <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">  ggsave(paste(<span class="string">&#x27;plot/&#x27;</span>, module,<span class="string">&#x27;.pdf&#x27;</span>, sep = <span class="string">&#x27;&#x27;</span>), p)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="直方图"><strong>直方图</strong></h3>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">barplot(data3, xlab=&quot;x-axis&quot;, ylab=&quot;y-axis&quot;, main=&quot;bar chart 1&quot;,</span><br><span class="line">col=c(&quot;grey&quot;, &quot;blue&quot;, &quot;yellow&quot;), beside=TRUE);#不加beside就位填充图</span><br></pre></td></tr></table></figure>
<p><strong>base包画直方图</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&gt; set.seed(123);</span><br><span class="line">&gt; data1 &lt;- rnorm(100, mean=5, sd=3);</span><br><span class="line">&gt; hist(data1, main=&quot;histogram&quot;, xlab=&quot;x-axis&quot;, col=&quot;green&quot;,</span><br><span class="line">border=&quot;blue&quot;, breaks=10, freq=FALSE);</span><br><span class="line">&gt; lines(density(data1), col=&quot;red&quot;);</span><br><span class="line"></span><br><span class="line">hist(x,breaks=20,ylim=c(0,220))</span><br><span class="line">text(res$mids,res$counts+10,labels=res$counts)</span><br><span class="line">#ggplot格式</span><br><span class="line">ggplot(data,aes(x=mids,y=counts)) + geom_bar(stat=&quot;identity&quot;) + geom_text(aes(label=counts),vjust=-1) + ylim(0,220)</span><br></pre></td></tr></table></figure>
<p><strong>填充形状不同的直方图</strong></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># create dummy data</span></span><br><span class="line">data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  name<span class="operator">=</span><span class="built_in">letters</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  value<span class="operator">=</span>sample<span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span><span class="number">15</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># barplot</span></span><br><span class="line">barplot<span class="punctuation">(</span> height<span class="operator">=</span>data<span class="operator">$</span>value<span class="punctuation">,</span> <span class="built_in">names</span><span class="operator">=</span>data<span class="operator">$</span>name <span class="punctuation">,</span> density<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">,</span><span class="number">30</span><span class="punctuation">,</span><span class="number">7</span><span class="punctuation">)</span> <span class="punctuation">,</span> angle<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">45</span><span class="punctuation">,</span><span class="number">90</span><span class="punctuation">,</span><span class="number">11</span><span class="punctuation">,</span><span class="number">36</span><span class="punctuation">)</span> <span class="punctuation">,</span> col<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span><span class="string">&quot;grey&quot;</span><span class="punctuation">,</span><span class="string">&quot;black&quot;</span><span class="punctuation">,</span><span class="string">&quot;#EA1D4B&quot;</span><span class="punctuation">,</span><span class="string">&quot;yellow&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#density可以通过调控线的密度，angle通过调控线的方向来做出不同样式的填充线。这两种参数一起调控，可实现相当多的类型。</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">setwd<span class="punctuation">(</span><span class="string">&#x27;../直方图/&#x27;</span><span class="punctuation">)</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">1234</span><span class="punctuation">)</span></span><br><span class="line">df <span class="operator">&lt;-</span>  data.frame<span class="punctuation">(</span>sex <span class="operator">=</span> factor<span class="punctuation">(</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;F&quot;</span><span class="punctuation">,</span><span class="string">&quot;M&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>each <span class="operator">=</span> <span class="number">200</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span>weight <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span>rnorm<span class="punctuation">(</span><span class="number">200</span><span class="punctuation">,</span>mean <span class="operator">=</span> <span class="number">55</span><span class="punctuation">,</span>sd <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span>rnorm<span class="punctuation">(</span><span class="number">200</span><span class="punctuation">,</span>mean <span class="operator">=</span> <span class="number">65</span><span class="punctuation">,</span>sd<span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>weight<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_histogram<span class="punctuation">(</span>binwidth <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>color <span class="operator">=</span> <span class="string">&quot; black&quot;</span><span class="punctuation">,</span>fill <span class="operator">=</span> <span class="string">&quot; white&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>weight<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_histogram<span class="punctuation">(</span>binwidth<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span>color<span class="operator">=</span><span class="string">&quot;black&quot;</span><span class="punctuation">,</span> fill<span class="operator">=</span><span class="string">&quot;lightblue&quot;</span><span class="punctuation">,</span>linetype<span class="operator">=</span><span class="string">&quot;dashed&quot;</span><span class="punctuation">)</span><span class="operator">+</span> <span class="comment">#设置框线类型，颜色和fill的颜色</span></span><br><span class="line">  geom_vline<span class="punctuation">(</span>aes<span class="punctuation">(</span>xintercept<span class="operator">=</span>mean<span class="punctuation">(</span>weight<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> color<span class="operator">=</span><span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> linetype<span class="operator">=</span><span class="string">&quot;dashed&quot;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span> <span class="comment">#添加均值线，设置线型，颜色等</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>weight<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_histogram<span class="punctuation">(</span>aes<span class="punctuation">(</span>y<span class="operator">=</span>..density..<span class="punctuation">)</span><span class="punctuation">,</span> colour<span class="operator">=</span><span class="string">&quot;black&quot;</span><span class="punctuation">,</span> fill<span class="operator">=</span><span class="string">&quot;white&quot;</span><span class="punctuation">)</span><span class="operator">+</span> <span class="comment"># 需要密度形式 </span></span><br><span class="line">  geom_density<span class="punctuation">(</span>alpha<span class="operator">=</span><span class="number">.2</span><span class="punctuation">,</span> fill<span class="operator">=</span><span class="string">&quot;#FF6666&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>weight<span class="punctuation">,</span> color<span class="operator">=</span>sex<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_histogram<span class="punctuation">(</span>fill<span class="operator">=</span><span class="string">&quot;white&quot;</span><span class="punctuation">,</span> alpha<span class="operator">=</span><span class="number">0.5</span><span class="punctuation">,</span> position<span class="operator">=</span><span class="string">&quot;identity&quot;</span><span class="punctuation">)</span> <span class="comment">#分组设置 其中position可选 “identity”, “stack”, “dodge”. 默认值是 “stack”.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#分组添加均值线</span></span><br><span class="line">library<span class="punctuation">(</span>plyr<span class="punctuation">)</span></span><br><span class="line">mu <span class="operator">&lt;-</span> ddply<span class="punctuation">(</span>df<span class="punctuation">,</span> <span class="string">&quot;sex&quot;</span><span class="punctuation">,</span> summarise<span class="punctuation">,</span> grp.mean<span class="operator">=</span>mean<span class="punctuation">(</span>weight<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">p<span class="operator">&lt;-</span>ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>weight<span class="punctuation">,</span> color<span class="operator">=</span>sex<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_histogram<span class="punctuation">(</span>fill<span class="operator">=</span><span class="string">&quot;white&quot;</span><span class="punctuation">,</span> position<span class="operator">=</span><span class="string">&quot;dodge&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_vline<span class="punctuation">(</span>data<span class="operator">=</span>mu<span class="punctuation">,</span> aes<span class="punctuation">(</span>xintercept<span class="operator">=</span>grp.mean<span class="punctuation">,</span> color<span class="operator">=</span>sex<span class="punctuation">)</span><span class="punctuation">,</span>linetype<span class="operator">=</span><span class="string">&quot;dashed&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position<span class="operator">=</span><span class="string">&quot;top&quot;</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use custom color palettes  自定义颜色</span></span><br><span class="line">p<span class="operator">+</span>scale_color_manual<span class="punctuation">(</span>values<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#999999&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#E69F00&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#56B4E9&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Use brewer color palettes</span></span><br><span class="line">p<span class="operator">+</span>scale_color_brewer<span class="punctuation">(</span>palette<span class="operator">=</span><span class="string">&quot;Dark2&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Use grey scale</span></span><br><span class="line">p <span class="operator">+</span> scale_color_grey<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> theme_classic<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> theme<span class="punctuation">(</span>legend.position<span class="operator">=</span><span class="string">&quot;top&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#分组更改fill设置</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>weight<span class="punctuation">,</span> fill<span class="operator">=</span>sex<span class="punctuation">,</span> color<span class="operator">=</span>sex<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>  geom_histogram<span class="punctuation">(</span>binwidth<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span>position<span class="operator">=</span><span class="string">&quot;identity&quot;</span><span class="punctuation">,</span> alpha<span class="operator">=</span><span class="number">0.5</span><span class="punctuation">)</span><span class="operator">+</span> geom_vline<span class="punctuation">(</span>data<span class="operator">=</span>mu<span class="punctuation">,</span> aes<span class="punctuation">(</span>xintercept<span class="operator">=</span>grp.mean<span class="punctuation">)</span><span class="punctuation">,</span>linetype<span class="operator">=</span><span class="string">&quot;dashed&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#depth 深度、GC 含量散点密度图</span></span><br><span class="line">depth_GC <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>depth_base<span class="punctuation">,</span> aes<span class="punctuation">(</span>GC<span class="punctuation">,</span> depth<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	geom_point<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">19</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	geom_vline<span class="punctuation">(</span>xintercept <span class="operator">=</span> GC_mean<span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> lty <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">	geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> depth_mean<span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> lty <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	stat_density2d<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> ..density..<span class="punctuation">,</span> alpha <span class="operator">=</span> ..density..<span class="punctuation">)</span><span class="punctuation">,</span> geom <span class="operator">=</span> <span class="string">&#x27;tile&#x27;</span><span class="punctuation">,</span> contour <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> n <span class="operator">=</span> <span class="number">500</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	scale_fill_gradientn<span class="punctuation">(</span>colors <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;transparent&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;yellow&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	theme<span class="punctuation">(</span>panel.grid.major <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.25</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	labs<span class="punctuation">(</span>x <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&#x27;GC % (Average :&#x27;</span><span class="punctuation">,</span> GC_mean<span class="punctuation">,</span> <span class="string">&#x27;%)&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> y <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&#x27;Depth (Average :&#x27;</span><span class="punctuation">,</span> depth_mean<span class="punctuation">,</span> <span class="string">&#x27;X)&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	theme<span class="punctuation">(</span>axis.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	theme<span class="punctuation">(</span>axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&#x27;none&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#depth 深度直方密度图</span></span><br><span class="line">depth_hist <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>depth_base<span class="punctuation">,</span> aes<span class="punctuation">(</span>depth<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	geom_histogram<span class="punctuation">(</span>binwidth <span class="operator">=</span> <span class="punctuation">(</span><span class="built_in">max</span><span class="punctuation">(</span>depth_base<span class="operator">$</span>depth<span class="punctuation">)</span> <span class="operator">-</span> <span class="built_in">min</span><span class="punctuation">(</span>depth_base<span class="operator">$</span>depth<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">/</span><span class="number">100</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;gray40&#x27;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	geom_rug<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	theme<span class="punctuation">(</span>panel.grid.major <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.25</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	theme<span class="punctuation">(</span>axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;Numbers&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	coord_flip<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	geom_vline<span class="punctuation">(</span>xintercept <span class="operator">=</span> depth_mean<span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> lty <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#GC 含量直方密度图</span></span><br><span class="line">GC_hist <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>depth_base<span class="punctuation">,</span> aes<span class="punctuation">(</span>GC<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	geom_histogram<span class="punctuation">(</span>binwidth <span class="operator">=</span> <span class="punctuation">(</span><span class="built_in">max</span><span class="punctuation">(</span>depth_base<span class="operator">$</span>GC<span class="punctuation">)</span> <span class="operator">-</span> <span class="built_in">min</span><span class="punctuation">(</span>depth_base<span class="operator">$</span>GC<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">/</span><span class="number">100</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;gray40&#x27;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	geom_rug<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	theme<span class="punctuation">(</span>panel.grid.major <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.25</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	theme<span class="punctuation">(</span>axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;Numbers&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">	geom_vline<span class="punctuation">(</span>xintercept <span class="operator">=</span> GC_mean<span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> lty <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#组合图片并输出</span></span><br><span class="line"><span class="comment">#pdf(paste(opt$output, &#x27;.pdf&#x27;, sep = &#x27;.&#x27;), width = 8, height = 8)</span></span><br><span class="line"><span class="comment">#	grid.newpage()</span></span><br><span class="line"><span class="comment">#	pushViewport(viewport(layout = grid.layout(3, 3)))</span></span><br><span class="line"><span class="comment">#	print(depth_GC, vp = viewport(layout.pos.row = 2:3, layout.pos.col = 1:2))</span></span><br><span class="line"><span class="comment">#	print(GC_hist, vp = viewport(layout.pos.row = 1, layout.pos.col = 1:2))</span></span><br><span class="line"><span class="comment">#	print(depth_hist, vp = viewport(layout.pos.row = 2:3, layout.pos.col = 3))</span></span><br><span class="line"><span class="comment">#dev.off()</span></span><br></pre></td></tr></table></figure>
<h3 id="热图">热图</h3>
<h4 id="对角线热图">对角线热图</h4>
<p><a href="https://blog.csdn.net/zhouhucheng00/article/details/86143828">ggplot绘制热图</a></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span><span class="string">&#x27;ggmatrix&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># install.packages(&quot;devtools&quot;)</span></span><br><span class="line">devtools<span class="operator">::</span>install_github<span class="punctuation">(</span><span class="string">&quot;houyunhuang/ggmatrix&quot;</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggmatrix<span class="punctuation">)</span> <span class="comment">## 0.1.2版本</span></span><br><span class="line">library<span class="punctuation">(</span>RColorBrewer<span class="punctuation">)</span></span><br><span class="line">df <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>x <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">11</span><span class="punctuation">,</span> <span class="number">14</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                 y <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">14</span><span class="punctuation">,</span> each <span class="operator">=</span> <span class="number">11</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                 group <span class="operator">=</span> sample<span class="punctuation">(</span><span class="built_in">LETTERS</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">154</span><span class="punctuation">,</span> replace <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                 values1 <span class="operator">=</span> rnorm<span class="punctuation">(</span><span class="number">154</span><span class="punctuation">,</span> mean <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> sd <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                 values2 <span class="operator">=</span> rnorm<span class="punctuation">(</span><span class="number">154</span><span class="punctuation">,</span> mean <span class="operator">=</span> <span class="operator">-</span><span class="number">10</span><span class="punctuation">,</span> sd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                 stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> x<span class="punctuation">,</span> y <span class="operator">=</span> y<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> geom_triangle<span class="punctuation">(</span><span class="punctuation">)</span> <span class="comment">#默认填充色（fill）为空，只画出上下三角形</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> x<span class="punctuation">,</span> y <span class="operator">=</span> y<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> geom_triangle<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;lightblue&quot;</span><span class="punctuation">)</span> <span class="comment">#当设置fill参数时，表明把上下三角形当成一个整体来处理，映射颜色也完全相同</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> x<span class="punctuation">,</span> y <span class="operator">=</span> y<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> geom_triangle<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> values1<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">## 设置上三角颜色为浅蓝色</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> x<span class="punctuation">,</span> y <span class="operator">=</span> y<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> geom_triangle<span class="punctuation">(</span>fill.upper <span class="operator">=</span> <span class="string">&quot;lightblue&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">## 设置上三角颜色为浅蓝色，且设置下三角颜色为橙色</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> x<span class="punctuation">,</span> y <span class="operator">=</span> y<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_triangle<span class="punctuation">(</span>fill.upper <span class="operator">=</span> <span class="string">&quot;lightblue&quot;</span><span class="punctuation">,</span> fill.lower <span class="operator">=</span> <span class="string">&quot;orange&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#采用映射</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> x<span class="punctuation">,</span> y <span class="operator">=</span> y<span class="punctuation">,</span> fill.upper <span class="operator">=</span> values1<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_triangle<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_upper_gradientn<span class="punctuation">(</span>colours <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#同时映射上下三角，是不是感觉不用ggnewscale或者relayer包的黑科技了，会爽很多。</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> x<span class="punctuation">,</span> y <span class="operator">=</span> y<span class="punctuation">,</span> fill.upper <span class="operator">=</span> values1<span class="punctuation">,</span> fill.lower <span class="operator">=</span> values2<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_triangle<span class="punctuation">(</span>mode <span class="operator">=</span> <span class="string">&quot;lb-rt&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_upper_gradientn<span class="punctuation">(</span>colours <span class="operator">=</span> brewer.pal<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="string">&quot;Greys&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_lower_gradientn<span class="punctuation">(</span>colours <span class="operator">=</span> brewer.pal<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="string">&quot;YlGnBu&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#也可以映射离散变量。</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> x<span class="punctuation">,</span> y <span class="operator">=</span> y<span class="punctuation">,</span> fill.upper <span class="operator">=</span> group<span class="punctuation">,</span> fill.lower <span class="operator">=</span> values2<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_triangle<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_upper_manual<span class="punctuation">(</span>values <span class="operator">=</span> brewer.pal<span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="string">&quot;Set1&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_lower_gradientn<span class="punctuation">(</span>colours <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#E9A3C9&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#F7F7F7&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#A1D76A&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                             guide <span class="operator">=</span> guide_legend<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#ggmatrix提供了五种颜色映射函数，每个函数的用法均和对应的原ggplot2中的函数相同。</span></span><br><span class="line"><span class="comment">#scale_fill_lower/upper_gradient()——ggplot2中scale_fill_gradient()。</span></span><br><span class="line"><span class="comment">#scale_fill_lower/upper_gradient2()——ggplot2中scale_fill_gradient2()。</span></span><br><span class="line"><span class="comment">#scale_fill_lower/upper_gradientn()——ggplot2中scale_fill_gradientn()。</span></span><br><span class="line"><span class="comment">#scale_fill_lower/upper_identity()——ggplot2中scale_fill_identity()。</span></span><br><span class="line"><span class="comment">#scale_fill_lower/upper_manual()——ggplot2中scale_fill_manual()</span></span><br></pre></td></tr></table></figure>
<h4 id="环状热图">环状热图</h4>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggforce<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#加上force=TRUE升级</span></span><br><span class="line">devtools<span class="operator">::</span>install_github<span class="punctuation">(</span><span class="punctuation">(</span><span class="string">&quot;houyunhuang/ggcor&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>force <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggcor<span class="punctuation">)</span></span><br><span class="line">correlate<span class="punctuation">(</span>mtcars<span class="punctuation">,</span>method <span class="operator">=</span> <span class="string">&#x27;spearman&#x27;</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> trans_polar<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#trans_polar()是在ggcor的总体框架下设计的，所以对于输入数据也要求是cor_tbl对象，</span></span><br><span class="line"><span class="comment">#当输入不是cor_tbl对象时，调用fortify_cor()函数转化。</span></span><br><span class="line">correlate<span class="punctuation">(</span>mtcars<span class="punctuation">)</span> <span class="operator">%&gt;%</span>polarcor<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#对称矩阵</span></span><br><span class="line">correlate<span class="punctuation">(</span>mtcars<span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  polarcor<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> geom_arc_colour<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> r<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">## 非对称的情况</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">(</span><span class="string">&quot;varespec&quot;</span><span class="punctuation">,</span> package <span class="operator">=</span> <span class="string">&quot;vegan&quot;</span><span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">(</span><span class="string">&quot;varechem&quot;</span><span class="punctuation">,</span> package <span class="operator">=</span> <span class="string">&quot;vegan&quot;</span><span class="punctuation">)</span></span><br><span class="line">correlate<span class="punctuation">(</span>varechem<span class="punctuation">,</span> varespec<span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  polarcor<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_arc_colour<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> r<span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.25</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_fixed<span class="punctuation">(</span>xlim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1.2</span><span class="punctuation">,</span> <span class="number">1.2</span><span class="punctuation">)</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1.2</span><span class="punctuation">,</span> <span class="number">1.2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#通过`set_arc_axis_x()`、`set_arc_axis_y()`函数来设置尺寸</span></span><br><span class="line">correlate<span class="punctuation">(</span>varechem<span class="punctuation">,</span> varespec<span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  polarcor<span class="punctuation">(</span>no.axis <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_arc_colour<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> r<span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.25</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  set_arc_axis_x<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  set_arc_axis_y<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">2.8</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_fixed<span class="punctuation">(</span>xlim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1.2</span><span class="punctuation">,</span> <span class="number">1.2</span><span class="punctuation">)</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1.2</span><span class="punctuation">,</span> <span class="number">1.2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#分组的极坐标</span></span><br><span class="line">set.seed<span class="punctuation">(</span><span class="number">20200328</span><span class="punctuation">)</span></span><br><span class="line">grp <span class="operator">&lt;-</span> sample<span class="punctuation">(</span><span class="built_in">LETTERS</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">24</span><span class="punctuation">,</span> replace <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">grp</span><br><span class="line">fortify_cor<span class="punctuation">(</span>varechem<span class="punctuation">,</span> varespec<span class="punctuation">,</span> group <span class="operator">=</span> grp<span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  polarcor<span class="punctuation">(</span>no.axis <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> split.by.group <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> group.space <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_arc_colour<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> r<span class="punctuation">)</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&quot;grey90&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  set_arc_axis_x<span class="punctuation">(</span>mapping <span class="operator">=</span> aes<span class="punctuation">(</span>colour <span class="operator">=</span> .group<span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">2.8</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  set_arc_axis_y<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">2.8</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_fixed<span class="punctuation">(</span>xlim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1.2</span><span class="punctuation">,</span> <span class="number">1.2</span><span class="punctuation">)</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1.2</span><span class="punctuation">,</span> <span class="number">1.2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#对于变量少的加上标签</span></span><br><span class="line">correlate<span class="punctuation">(</span>varechem<span class="punctuation">,</span> varespec<span class="punctuation">,</span> cor.test <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  polarcor<span class="punctuation">(</span>no.axis <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_arc_colour<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> r<span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.25</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>mapping <span class="operator">=</span> aes<span class="punctuation">(</span>x<span class="punctuation">,</span> y<span class="punctuation">)</span><span class="punctuation">,</span> shape <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line">             data <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>data<span class="punctuation">)</span> filter<span class="punctuation">(</span>data<span class="punctuation">,</span> p.value <span class="operator">&gt;</span> <span class="number">0.05</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  set_arc_axis_x<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  set_arc_axis_y<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">2.8</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_gradient2n<span class="punctuation">(</span>colours <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> <span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_fixed<span class="punctuation">(</span>xlim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1.2</span><span class="punctuation">,</span> <span class="number">1.2</span><span class="punctuation">)</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1.2</span><span class="punctuation">,</span> <span class="number">1.2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#对于变量更少的，我们完全可以加个系数和显著性标记。</span></span><br><span class="line">correlate<span class="punctuation">(</span>mtcars<span class="punctuation">,</span> cor.test <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  polarcor<span class="punctuation">(</span>cluster <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_arc_colour<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> r<span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.25</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_mark<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="punctuation">,</span> y<span class="punctuation">,</span> r <span class="operator">=</span> r<span class="punctuation">,</span> p.value <span class="operator">=</span> p.value<span class="punctuation">,</span> angle <span class="operator">=</span> angle<span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">            size <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_gradient2n<span class="punctuation">(</span>colours <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> <span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_fixed<span class="punctuation">(</span>xlim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1.05</span><span class="punctuation">,</span> <span class="number">1.05</span><span class="punctuation">)</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1.05</span><span class="punctuation">,</span> <span class="number">1.05</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#一般性的热图</span></span><br><span class="line">a <span class="operator">&lt;-</span> cor_tbl<span class="punctuation">(</span>extra.mat <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>mat <span class="operator">=</span> varespec<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  polarcor<span class="punctuation">(</span>no.axis <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_arc_colour<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> mat<span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  set_arc_axis_x<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">2.8</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  set_arc_axis_y<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_gradientn<span class="punctuation">(</span>colours <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;green&quot;</span><span class="punctuation">,</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> <span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  coord_fixed<span class="punctuation">(</span>xlim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1.15</span><span class="punctuation">,</span> <span class="number">1.15</span><span class="punctuation">)</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1.1</span><span class="punctuation">,</span> <span class="number">1.15</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="heatmap-pheatmap热图">heatmap&amp;pheatmap热图</h4>
<hr>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">##heatmap.2画热图</span></span><br><span class="line">data<span class="punctuation">(</span><span class="string">&quot;attitude&quot;</span><span class="punctuation">)</span></span><br><span class="line">Ca <span class="operator">&lt;-</span> cor<span class="punctuation">(</span>attitude<span class="punctuation">)</span><span class="comment">#cor的结果就是矩阵</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>gplots<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>RColorBrewer<span class="punctuation">)</span></span><br><span class="line">coul <span class="operator">&lt;-</span> colorRampPalette<span class="punctuation">(</span>brewer.pal<span class="punctuation">(</span><span class="number">8</span><span class="punctuation">,</span> <span class="string">&quot;PiYG&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">(</span><span class="number">25</span><span class="punctuation">)</span><span class="comment">#换个好看的颜色</span></span><br><span class="line">hM <span class="operator">&lt;-</span> format<span class="punctuation">(</span><span class="built_in">round</span><span class="punctuation">(</span>Ca<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="comment">#对数据保留2位小数</span></span><br><span class="line"></span><br><span class="line">heatmap.2<span class="punctuation">(</span>Ca<span class="punctuation">,</span></span><br><span class="line">trace<span class="operator">=</span><span class="string">&quot;none&quot;</span><span class="punctuation">,</span><span class="comment">#不显示trace</span></span><br><span class="line">col<span class="operator">=</span>coul<span class="punctuation">,</span><span class="comment">#修改热图颜色</span></span><br><span class="line">density.info <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">,</span><span class="comment">#图例取消density</span></span><br><span class="line">key.xlab <span class="operator">=</span><span class="string">&#x27;Correlation&#x27;</span><span class="punctuation">,</span></span><br><span class="line">key.title <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">cexRow <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>cexCol <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span><span class="comment">#修改横纵坐标字体</span></span><br><span class="line">Rowv <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span>Colv <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> <span class="comment">#去除聚类</span></span><br><span class="line">margins <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">6</span><span class="punctuation">,</span> <span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">cellnote <span class="operator">=</span> hM<span class="punctuation">,</span>notecol<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="comment">#添加相关系数的值及修改字体颜色</span></span><br><span class="line">            <span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">###### pheatmap画图</span></span><br><span class="line">library<span class="punctuation">(</span>pheatmap<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>rmarkdown<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#将Rmd文件转换为html</span></span><br><span class="line">render<span class="punctuation">(</span><span class="string">&quot;./pheatmap.Rmd&quot;</span><span class="punctuation">,</span><span class="string">&quot;html_document&quot;</span><span class="punctuation">)</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span><span class="operator">=</span>ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">test <span class="operator">=</span> matrix<span class="punctuation">(</span>rnorm<span class="punctuation">(</span><span class="number">200</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">test<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> seq<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">=</span> test<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> seq<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">+</span> <span class="number">3</span> </span><br><span class="line">test<span class="punctuation">[</span><span class="number">11</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> seq<span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">=</span> test<span class="punctuation">[</span><span class="number">11</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> seq<span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">+</span> <span class="number">2</span> </span><br><span class="line">test<span class="punctuation">[</span><span class="number">15</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> seq<span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">=</span> test<span class="punctuation">[</span><span class="number">15</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> seq<span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">+</span> <span class="number">4</span> </span><br><span class="line">colnames<span class="punctuation">(</span>test<span class="punctuation">)</span> <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&quot;Test&quot;</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span> </span><br><span class="line">rownames<span class="punctuation">(</span>test<span class="punctuation">)</span> <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&quot;Gene&quot;</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">20</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>test<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span><span class="number">6</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>test<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># scale = &quot;row&quot;参数对行进行归一化</span></span><br><span class="line"><span class="comment"># clustering_method参数设定不同聚类方法，默认为&quot;complete&quot;,可以设定为&#x27;ward&#x27;, &#x27;ward.D&#x27;, &#x27;ward.D2&#x27;, &#x27;single&#x27;, &#x27;complete&#x27;, &#x27;average&#x27;, &#x27;mcquitty&#x27;, &#x27;median&#x27; or &#x27;centroid&#x27;</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>test<span class="punctuation">,</span>scale <span class="operator">=</span> <span class="string">&quot;row&quot;</span><span class="punctuation">,</span> clustering_method <span class="operator">=</span> <span class="string">&quot;average&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#表示行聚类使用皮尔森相关系数聚类，默认为欧氏距离&quot;euclidean&quot;</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>test<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="string">&quot;row&quot;</span><span class="punctuation">,</span> clustering_distance_rows <span class="operator">=</span> <span class="string">&quot;correlation&quot;</span><span class="punctuation">)</span> </span><br><span class="line"></span><br><span class="line">pheatmap<span class="punctuation">(</span>test<span class="punctuation">,</span> display_numbers <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>test<span class="punctuation">,</span> display_numbers <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> number_format <span class="operator">=</span> <span class="string">&quot;\%.1e&quot;</span><span class="punctuation">)</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>test<span class="punctuation">,</span> display_numbers <span class="operator">=</span> matrix<span class="punctuation">(</span>ifelse<span class="punctuation">(</span>res<span class="operator">$</span>p <span class="operator">&lt;=</span> <span class="number">0.01</span><span class="punctuation">,</span><span class="string">&quot;**&quot;</span><span class="punctuation">,</span></span><br><span class="line">    ifelse<span class="punctuation">(</span>res<span class="operator">$</span>p <span class="operator">&lt;=</span> <span class="number">0.05</span><span class="punctuation">,</span> <span class="string">&quot;*&quot;</span><span class="punctuation">,</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> nrow<span class="punctuation">(</span>res<span class="operator">$</span>p<span class="punctuation">)</span><span class="punctuation">)</span><span class="comment">#还可以自己设定要显示的内容；</span></span><br><span class="line"> display_numbers<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span>number_format<span class="operator">=</span><span class="string">&quot;%.3f&quot;</span><span class="punctuation">,</span></span><br><span class="line"><span class="comment">#自定义颜色</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>test<span class="punctuation">,</span> color <span class="operator">=</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;navy&quot;</span><span class="punctuation">,</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> <span class="string">&quot;firebrick3&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">(</span><span class="number">50</span><span class="punctuation">)</span><span class="punctuation">)</span> </span><br><span class="line"><span class="comment">#颜色赋予变量 </span></span><br><span class="line">hmcol <span class="operator">&lt;-</span> rev<span class="punctuation">(</span>colorRampPalette<span class="punctuation">(</span>RColorBrewer<span class="operator">::</span>brewer.pal<span class="punctuation">(</span><span class="number">9</span><span class="punctuation">,</span> <span class="string">&quot;YlOrRd&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">(</span><span class="number">255</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 设置对角距离为NA，增强颜色的展示力  适用于相关性热图</span></span><br><span class="line">diag<span class="punctuation">(</span>dists<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="literal">NA</span></span><br><span class="line"><span class="comment">#行 列是否聚类，cluster_row ,cluster_col </span></span><br><span class="line">pheatmap<span class="punctuation">(</span>test<span class="punctuation">,</span> cluster_row <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span>cluster_col <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> </span><br><span class="line"><span class="comment"># Show text within cells pheatmap(test, display_numbers = TRUE) </span></span><br><span class="line"><span class="comment">#pheatmap(test, display_numbers = TRUE, number_format = &quot;%.1e&quot;) # number_format = &quot;%.1e&quot;参数设定数值的显示格式</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>test<span class="punctuation">,</span> display_numbers <span class="operator">=</span> matrix<span class="punctuation">(</span>ifelse<span class="punctuation">(</span>test <span class="operator">&gt;</span> <span class="number">5</span><span class="punctuation">,</span> <span class="string">&quot;*&quot;</span><span class="punctuation">,</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> nrow<span class="punctuation">(</span>test<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> </span><br><span class="line"><span class="comment">#设定legend展示的值</span></span><br><span class="line"><span class="comment">#legend_breaks参数设定图例显示范围，legend_labels参数添加图例标签</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>test<span class="punctuation">,</span> cluster_row <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> legend_breaks <span class="operator">=</span> <span class="operator">-</span><span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">,</span> legend_labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;0&quot;</span><span class="punctuation">,</span> <span class="string">&quot;1e-4&quot;</span><span class="punctuation">,</span> <span class="string">&quot;1e-3&quot;</span><span class="punctuation">,</span> <span class="string">&quot;1e-2&quot;</span><span class="punctuation">,</span> <span class="string">&quot;1e-1&quot;</span><span class="punctuation">,</span> <span class="string">&quot;1&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#去掉legend</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>test<span class="punctuation">,</span> legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">         angle_col <span class="operator">=</span> <span class="number">45</span><span class="comment">#调角度</span></span><br><span class="line"><span class="comment"># border=FALSE参数去掉边框线</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>test<span class="punctuation">,</span> border<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># border_color参数设定每个热图格子的边框色</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>test<span class="punctuation">,</span> border_color <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># treeheight_row和treeheight_col参数设定行和列聚类树的高度，默认为50</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>test<span class="punctuation">,</span> treeheight_row <span class="operator">=</span> <span class="number">30</span><span class="punctuation">,</span> treeheight_col <span class="operator">=</span> <span class="number">50</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># Fix cell sizes and save to file with correct size </span></span><br><span class="line">pheatmap<span class="punctuation">(</span>test<span class="punctuation">,</span> cellwidth <span class="operator">=</span> <span class="number">15</span><span class="punctuation">,</span> cellheight <span class="operator">=</span> <span class="number">12</span><span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&quot;Example heatmap&quot;</span><span class="punctuation">)</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">#设置字体大小，设置行、列的聚类方法()</span></span><br><span class="line">drows<span class="operator">&lt;-</span>vegdist<span class="punctuation">(</span>data<span class="punctuation">,</span>method<span class="operator">=</span><span class="string">&quot;bray&quot;</span><span class="punctuation">)</span></span><br><span class="line">dcols<span class="operator">&lt;-</span>vegdist<span class="punctuation">(</span>t<span class="punctuation">(</span>data<span class="punctuation">)</span><span class="punctuation">,</span>method<span class="operator">=</span><span class="string">&quot;bray&quot;</span><span class="punctuation">)</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>data<span class="punctuation">,</span>cellwidth <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> cellheight <span class="operator">=</span><span class="literal">NA</span><span class="punctuation">,</span> treeheight_row <span class="operator">=</span> <span class="number">50</span><span class="punctuation">,</span> treeheight_col <span class="operator">=</span> <span class="number">50</span> <span class="punctuation">,</span>color <span class="operator">=</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;green&quot;</span><span class="punctuation">,</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span><span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">(</span><span class="number">100</span><span class="punctuation">)</span><span class="punctuation">,</span> scale<span class="operator">=</span><span class="string">&quot;row&quot;</span><span class="punctuation">,</span> legend<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span>border_color<span class="operator">=</span><span class="literal">NA</span><span class="punctuation">,</span> fontsize_row<span class="operator">=</span><span class="number">8</span><span class="punctuation">,</span> fontsize_col<span class="operator">=</span><span class="number">10</span><span class="punctuation">,</span>clustering_distance_rows <span class="operator">=</span>drows<span class="punctuation">,</span> clustering_distance_cols <span class="operator">=</span> dcols<span class="punctuation">,</span> clustering_method<span class="operator">=</span><span class="string">&quot;average&quot;</span><span class="punctuation">,</span>main<span class="operator">=</span><span class="string">&quot;Heatmap&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>控制图例范围<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">data1<span class="operator">&lt;-</span><span class="built_in">c</span><span class="punctuation">(</span>runif<span class="punctuation">(</span><span class="number">20</span><span class="punctuation">,</span><span class="built_in">min</span><span class="operator">=</span><span class="operator">-</span><span class="number">2</span><span class="punctuation">,</span><span class="built_in">max</span><span class="operator">=</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span>rnorm<span class="punctuation">(</span><span class="number">380</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">data1<span class="operator">&lt;-</span>matrix<span class="punctuation">(</span>sample<span class="punctuation">(</span>data1<span class="punctuation">,</span><span class="number">400</span><span class="punctuation">,</span>replace <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span><span class="punctuation">,</span>nrow<span class="operator">=</span><span class="number">20</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">range</span><span class="punctuation">(</span>data1<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#breaks</span></span><br><span class="line">bk <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="operator">-</span><span class="number">3</span><span class="punctuation">,</span><span class="operator">-</span><span class="number">0.1</span><span class="punctuation">,</span>by<span class="operator">=</span><span class="number">0.01</span><span class="punctuation">)</span><span class="punctuation">,</span>seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span>by<span class="operator">=</span><span class="number">0.01</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 做热图：</span></span><br><span class="line">pheatmap<span class="operator">::</span>pheatmap<span class="punctuation">(</span>data1<span class="punctuation">,</span></span><br><span class="line">         scale <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">,</span></span><br><span class="line">         color <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>colorRampPalette<span class="punctuation">(</span>colors <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;blue&quot;</span><span class="punctuation">,</span><span class="string">&quot;white&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">(</span><span class="built_in">length</span><span class="punctuation">(</span>bk<span class="punctuation">)</span><span class="operator">/</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span>colorRampPalette<span class="punctuation">(</span>colors <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;white&quot;</span><span class="punctuation">,</span><span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">(</span><span class="built_in">length</span><span class="punctuation">(</span>bk<span class="punctuation">)</span><span class="operator">/</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         legend_breaks<span class="operator">=</span>seq<span class="punctuation">(</span><span class="operator">-</span><span class="number">3</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         breaks <span class="operator">=</span> bk<span class="punctuation">)</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#设置颜色</span></span><br><span class="line">col <span class="operator">=</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;lightblue&quot;</span><span class="punctuation">,</span><span class="string">&quot;yellow&quot;</span><span class="punctuation">,</span><span class="string">&quot;orange&quot;</span><span class="punctuation">,</span><span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>bias<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">(</span><span class="number">300</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#设置注释信息 自定义图例颜色</span></span><br><span class="line">ann_colors<span class="operator">=</span><span class="built_in">list</span><span class="punctuation">(</span>Group<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span>H<span class="operator">=</span><span class="string">&quot;blue&quot;</span><span class="punctuation">,</span>D<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>Class<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span>Bacteroidetes<span class="operator">=</span><span class="string">&quot;#EE7AE9&quot;</span><span class="punctuation">,</span>Firmicutes<span class="operator">=</span><span class="string">&quot;#795EA2&quot;</span><span class="punctuation">,</span>Proteobacteria<span class="operator">=</span><span class="string">&quot;#3370CC&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#gaps_col =  3 第几列断开 cut_tree = 2#分几分</span></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line"><span class="comment"># gaps_row = c(10, 14)参数在第10和14行处添加gap, 要求对行不进行聚类</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>genu<span class="punctuation">,</span>display_numbers <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span>number_color <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span>scale <span class="operator">=</span> <span class="string">&quot;row&quot;</span><span class="punctuation">,</span></span><br><span class="line">         cellwidth <span class="operator">=</span> <span class="literal">NA</span> <span class="punctuation">,</span> cellheight <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span></span><br><span class="line">         cluster_rows<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">,</span>treeheight_row <span class="operator">=</span> <span class="number">50</span><span class="punctuation">,</span> treeheight_col <span class="operator">=</span> <span class="number">50</span><span class="punctuation">,</span> </span><br><span class="line">         cluster_cols<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span>color <span class="operator">=</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;green&quot;</span><span class="punctuation">,</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span><span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">(</span><span class="number">100</span><span class="punctuation">)</span><span class="punctuation">,</span>border_color <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span>cutree_cols <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span>legend <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">min</span><span class="punctuation">(</span>genu<span class="punctuation">)</span></span><br><span class="line">drows <span class="operator">&lt;-</span> vegdist<span class="punctuation">(</span>genu<span class="punctuation">,</span>method <span class="operator">=</span> <span class="string">&quot;bray&quot;</span><span class="punctuation">)</span></span><br><span class="line">dcols <span class="operator">&lt;-</span> vegdist<span class="punctuation">(</span>t<span class="punctuation">(</span>genu<span class="punctuation">)</span><span class="punctuation">,</span>method <span class="operator">=</span> <span class="string">&quot;bray&quot;</span><span class="punctuation">)</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>genu<span class="punctuation">,</span>cellwidth <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> cellheight <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> treeheight_row <span class="operator">=</span> <span class="number">50</span><span class="punctuation">,</span> treeheight_col <span class="operator">=</span> <span class="number">50</span> </span><br><span class="line">         <span class="punctuation">,</span>color <span class="operator">=</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;green&quot;</span><span class="punctuation">,</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span><span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">(</span><span class="number">100</span><span class="punctuation">)</span><span class="punctuation">,</span> legend_breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span> legend_labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;1.0&quot;</span><span class="punctuation">,</span><span class="string">&quot;2.0&quot;</span><span class="punctuation">,</span><span class="string">&quot;3.0&quot;</span><span class="punctuation">,</span><span class="string">&quot;4.0&quot;</span><span class="punctuation">,</span><span class="string">&quot;5.0&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">         scale <span class="operator">=</span><span class="string">&quot;row&quot;</span><span class="punctuation">,</span> legend <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span>border_color <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> cutree_rows <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span>cutree_cols <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">         fontsize_row <span class="operator">=</span> <span class="number">8</span><span class="punctuation">,</span> fontsize_col <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span>clustering_distance_rows <span class="operator">=</span> drows<span class="punctuation">,</span> </span><br><span class="line">         clustering_distance_cols <span class="operator">=</span> dcols<span class="punctuation">,</span> clustering_method <span class="operator">=</span><span class="string">&quot;average&quot;</span><span class="punctuation">,</span>main <span class="operator">=</span><span class="string">&quot;Heatmap&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##针对聚类树添加与否 会改变相应的位置问题</span></span><br><span class="line">p <span class="operator">&lt;-</span> pheatmap<span class="punctuation">(</span>test<span class="punctuation">)</span> <span class="comment">#默认加聚类树</span></span><br><span class="line">r <span class="operator">=</span> rownames<span class="punctuation">(</span>test<span class="punctuation">)</span><span class="punctuation">[</span>p<span class="operator">$</span>tree_row<span class="punctuation">[[</span><span class="string">&quot;order&quot;</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="comment">#提取出来</span></span><br><span class="line"><span class="built_in">c</span> <span class="operator">=</span> colnames<span class="punctuation">(</span>test<span class="punctuation">)</span><span class="punctuation">[</span>p<span class="operator">$</span>tree_col<span class="punctuation">[[</span><span class="string">&quot;order&quot;</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">]</span> </span><br><span class="line">new_test <span class="operator">=</span> test<span class="punctuation">[</span>r<span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">]</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>new_test<span class="punctuation">,</span>cluster_rows <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span>cluster_cols <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#当然另一种简单方法直接设置树高：很巧妙，设置高度为0，就不显示了</span></span><br><span class="line">pheatmap<span class="punctuation">(</span>diy1<span class="punctuation">,</span>treeheight_row <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span>treeheight_col <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h4 id="相关性热图-ggcor包"><strong>相关性热图 (ggcor包)</strong></h4>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">####计算相关性时候的技巧</span></span><br><span class="line"><span class="comment">#将 spearman 相关系数低于 0.7 的关系剔除，即 r&gt;=0.7</span></span><br><span class="line">library<span class="punctuation">(</span>Hmisc<span class="punctuation">)</span></span><br><span class="line">r <span class="operator">&lt;-</span> genus_corr<span class="operator">$</span>r  </span><br><span class="line">r<span class="punctuation">[</span><span class="built_in">abs</span><span class="punctuation">(</span>r<span class="punctuation">)</span> <span class="operator">&lt;</span> <span class="number">0.7</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">0</span></span><br><span class="line">p <span class="operator">&lt;-</span> genus_corr<span class="operator">$</span>P</span><br><span class="line">p <span class="operator">&lt;-</span> p.adjust<span class="punctuation">(</span>p<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;BH&#x27;</span><span class="punctuation">)</span>    <span class="comment">#可选 p 值校正，这里使用 BH 法校正 p 值</span></span><br><span class="line">p<span class="punctuation">[</span>p<span class="operator">&gt;=</span><span class="number">0.05</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="operator">-</span><span class="number">1</span></span><br><span class="line">p<span class="punctuation">[</span>p<span class="operator">&lt;</span><span class="number">0.05</span> <span class="operator">&amp;</span> p<span class="operator">&gt;=</span><span class="number">0</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">1</span></span><br><span class="line">p<span class="punctuation">[</span>p<span class="operator">==</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">0</span></span><br><span class="line"><span class="comment">#根据上述筛选的 r 值和 p 值保留数据</span></span><br><span class="line">z <span class="operator">&lt;-</span> r <span class="operator">*</span> p</span><br><span class="line">diag<span class="punctuation">(</span>z<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="number">0</span>    <span class="comment">#将相关矩阵中对角线中的值（代表了自相关）转为 0</span></span><br><span class="line"></span><br><span class="line">Spearman秩相关系数，Pearson线性相关系数要求连续变量的取值服从正态分布，不服从正态分布的变量、分类或等级变量之间的关联性可采用Spearman秩相关系数，也称等级相关系数来描述。Pearson要求两个变量均符合正态分布，而当其中一个变量不符合正态分布时，就需要使用Spearman。</span><br><span class="line"></span><br><span class="line"> <span class="comment"># 使用shapiro.test函数检验每个变量是否与正太分布具有显著性差异</span></span><br><span class="line"><span class="keyword">for</span><span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span>ncol<span class="punctuation">(</span>attitude<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">  p_value <span class="operator">&lt;-</span> apply<span class="punctuation">(</span>attitude<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span>shapiro.test<span class="punctuation">)</span><span class="punctuation">[[</span>i<span class="punctuation">]</span><span class="punctuation">]</span><span class="operator">$</span>p.value</span><br><span class="line">  <span class="comment"># 输出结果变量名和p值。</span></span><br><span class="line">  print<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="built_in">names</span><span class="punctuation">(</span>attitude<span class="punctuation">)</span><span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">,</span>p_value<span class="punctuation">,</span>sep<span class="operator">=</span><span class="string">&quot;    &quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span> <span class="comment">#判断下变量是否符合正太分布</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#箱线图查看下分布情况</span></span><br><span class="line">library<span class="punctuation">(</span>reshape<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 宽格式变为长格式：</span></span><br><span class="line">attitude_melt <span class="operator">&lt;-</span> melt<span class="punctuation">(</span>attitude<span class="punctuation">)</span>  </span><br><span class="line"><span class="comment"># 作图查看每个变量的离群值：</span></span><br><span class="line">ggplot<span class="punctuation">(</span>attitude_melt<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_boxplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>variable<span class="punctuation">,</span>y<span class="operator">=</span>value<span class="punctuation">,</span>fill<span class="operator">=</span>variable<span class="punctuation">)</span><span class="punctuation">,</span>outlier.colour <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span>outlier.size <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme_bw<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    axis.text.x <span class="operator">=</span> element_text<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="number">30</span><span class="punctuation">,</span>hjust<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span>vjust<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">dat <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&#x27;data.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">dat_env <span class="operator">&lt;-</span> dat<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">6</span><span class="punctuation">]</span>	<span class="comment">#只包含环境因子数据</span></span><br><span class="line">dat_phylum <span class="operator">&lt;-</span> dat<span class="punctuation">[</span><span class="number">8</span><span class="operator">:</span><span class="number">17</span><span class="punctuation">]</span>	<span class="comment">#只包含细菌类群丰度数据</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##协方差和常见的相关系数</span></span><br><span class="line"><span class="comment">#协方差计算，cov()</span></span><br><span class="line">cov_pearson <span class="operator">&lt;-</span> cov<span class="punctuation">(</span>dat<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;pearson&#x27;</span><span class="punctuation">)</span></span><br><span class="line">cov_spearman <span class="operator">&lt;-</span> cov<span class="punctuation">(</span>dat<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;spearman&#x27;</span><span class="punctuation">)</span></span><br><span class="line">cov_kendall <span class="operator">&lt;-</span> cov<span class="punctuation">(</span>dat<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;kendall&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#相关系数计算，cor()</span></span><br><span class="line">cor_pearson <span class="operator">&lt;-</span> cor<span class="punctuation">(</span>dat<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;pearson&#x27;</span><span class="punctuation">)</span></span><br><span class="line">cor_spearman <span class="operator">&lt;-</span> cor<span class="punctuation">(</span>dat<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;spearman&#x27;</span><span class="punctuation">)</span></span><br><span class="line">cor_kendall <span class="operator">&lt;-</span> cor<span class="punctuation">(</span>dat<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;kendall&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#输出，例如</span></span><br><span class="line"><span class="comment">#提取“cor_pearson”中相关系数 &gt;0.5 或 &lt;-0.5 的结果输出为 csv 样式</span></span><br><span class="line">cor_pearson<span class="punctuation">[</span><span class="built_in">abs</span><span class="punctuation">(</span>cor_pearson<span class="punctuation">)</span> <span class="operator">&lt;=</span> <span class="number">0.5</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">0</span></span><br><span class="line">write.csv<span class="punctuation">(</span>cor_pearson<span class="punctuation">,</span> <span class="string">&#x27;cor_pearson.csv&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">write.table<span class="punctuation">(</span>genu_fun_corr_final<span class="punctuation">,</span> <span class="string">&#x27;lia_cor.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#指定分组的相关性分析，cor()</span></span><br><span class="line"><span class="comment">#此处计算“dat_phylum”和“dat_env”中数据的相关性，即只关注细菌类群丰度与环境因子之间的相关性</span></span><br><span class="line">phylum_env_spearman <span class="operator">&lt;-</span> cor<span class="punctuation">(</span>dat_phylum<span class="punctuation">,</span> dat_env<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;spearman&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#hetcor()，以计算“dat_phylum”中两两细菌类群间多分格相关系数为例</span></span><br><span class="line">library<span class="punctuation">(</span>polycor<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">cor_polychoric <span class="operator">&lt;-</span> hetcor<span class="punctuation">(</span>dat_phylum<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;Polychoric&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#偏相关，pcor()</span></span><br><span class="line"><span class="comment">#此处计算“dat_phylum”中，Proteobacteria 和 Acidobacteria 的偏相关系数</span></span><br><span class="line">library<span class="punctuation">(</span>ggm<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">select <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;Proteobacteria&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Acidobacteria&#x27;</span><span class="punctuation">)</span></span><br><span class="line">delet <span class="operator">&lt;-</span>  <span class="built_in">names</span><span class="punctuation">(</span>dat_phylum<span class="punctuation">)</span><span class="punctuation">[</span><span class="operator">-</span>which<span class="punctuation">(</span><span class="built_in">names</span><span class="punctuation">(</span>dat_phylum<span class="punctuation">)</span> <span class="operator">%in%</span> select<span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">pcor<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span>select<span class="punctuation">,</span> delet<span class="punctuation">)</span><span class="punctuation">,</span> cov<span class="punctuation">(</span>dat_phylum<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;spearman&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##相关性的显著性检验</span></span><br><span class="line"><span class="comment">#cor.test()，此处使用“dat”中 Proteobacteria 和 Acidobacteria 列的数据</span></span><br><span class="line"><span class="comment">#意在判断“cor_pearson”中 Proteobacteria 和 Acidobacteria 的相关系数是否显著</span></span><br><span class="line">cor.test<span class="punctuation">(</span>dat<span class="punctuation">[</span><span class="punctuation">,</span><span class="string">&#x27;Proteobacteria&#x27;</span><span class="punctuation">]</span><span class="punctuation">,</span> dat<span class="punctuation">[</span><span class="punctuation">,</span><span class="string">&#x27;Acidobacteria&#x27;</span><span class="punctuation">]</span><span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;pearson&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#corr.test()  </span></span><br><span class="line">library<span class="punctuation">(</span>psych<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">phylum_corr <span class="operator">&lt;-</span> corr.test<span class="punctuation">(</span>dat_phylum<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;spearman&#x27;</span><span class="punctuation">)</span></span><br><span class="line">phylum_env_corr <span class="operator">&lt;-</span> corr.test<span class="punctuation">(</span>dat_phylum<span class="punctuation">,</span> dat_env<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;spearman&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#以“phylum_corr”为例，查看数据</span></span><br><span class="line">phylum_corr<span class="operator">$</span>r	<span class="comment">#相关系数值</span></span><br><span class="line">phylum_corr<span class="operator">$</span>p	<span class="comment">#显著性 p 值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#筛选，例如</span></span><br><span class="line"><span class="comment">#“phylum_corr”中，根据 p(&lt;0.05) 值和 r(&gt;=0.3 or &lt;=-0.3) 值做保留</span></span><br><span class="line">phylum_corr<span class="operator">$</span>p<span class="punctuation">[</span>phylum_corr<span class="operator">$</span>p <span class="operator">&gt;=</span> <span class="number">0.05</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="operator">-</span><span class="number">1</span></span><br><span class="line">phylum_corr<span class="operator">$</span>p<span class="punctuation">[</span>phylum_corr<span class="operator">$</span>p <span class="operator">&lt;</span> <span class="number">0.05</span> <span class="operator">&amp;</span> phylum_corr<span class="operator">$</span>p <span class="operator">&gt;=</span> <span class="number">0</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">1</span></span><br><span class="line">phylum_corr<span class="operator">$</span>p<span class="punctuation">[</span>phylum_corr<span class="operator">$</span>p <span class="operator">==</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">0</span></span><br><span class="line">phylum_corr<span class="operator">$</span>r<span class="punctuation">[</span><span class="built_in">abs</span><span class="punctuation">(</span>phylum_corr<span class="operator">$</span>r<span class="punctuation">)</span> <span class="operator">&lt;</span> <span class="number">0.3</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">0</span></span><br><span class="line">phylum_corr_final <span class="operator">&lt;-</span> phylum_corr<span class="operator">$</span>r <span class="operator">*</span> phylum_corr<span class="operator">$</span>p</span><br><span class="line"><span class="comment">#或者occor.r[occor.p&gt;0.05|abs(occor.r)&lt;0.6] = 0</span></span><br><span class="line">write.csv<span class="punctuation">(</span>phylum_corr_final<span class="punctuation">,</span> <span class="string">&#x27;phylum_corr_final.csv&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据量小时可以用psych包corr.test求相关性矩阵，数据量大时，可应用WGCNA中corAndPvalue, 但p值需要借助其他函数矫正</span></span><br><span class="line">occor <span class="operator">=</span> corr.test<span class="punctuation">(</span>otu<span class="punctuation">,</span>use<span class="operator">=</span><span class="string">&quot;pairwise&quot;</span><span class="punctuation">,</span>method<span class="operator">=</span><span class="string">&quot;spearman&quot;</span><span class="punctuation">,</span>adjust<span class="operator">=</span><span class="string">&quot;fdr&quot;</span><span class="punctuation">,</span>alpha<span class="operator">=</span><span class="number">0.05</span><span class="punctuation">)</span></span><br><span class="line">occor.r <span class="operator">=</span> occor<span class="operator">$</span>r <span class="comment"># 取相关性矩阵R值</span></span><br><span class="line">occor.p <span class="operator">=</span> occor<span class="operator">$</span>p <span class="comment"># 取相关性矩阵p值</span></span><br><span class="line"><span class="comment"># 确定物种间存在相互作用关系的阈值，将相关性R矩阵内不符合的数据转换为0</span></span><br><span class="line">occor.r<span class="punctuation">[</span>occor.p<span class="operator">&gt;</span><span class="number">0.05</span><span class="operator">|</span><span class="built_in">abs</span><span class="punctuation">(</span>occor.r<span class="punctuation">)</span><span class="operator">&lt;</span><span class="number">0.6</span><span class="punctuation">]</span> <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#计算相关矩阵及显著性水平。</span></span><br><span class="line">library<span class="punctuation">(</span>Hmisc<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#所有变量间相关系数的对称矩阵</span></span><br><span class="line">rcorr_matrix <span class="operator">&lt;-</span> rcorr<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>mtcars<span class="punctuation">)</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;pearson&#x27;</span><span class="punctuation">)</span></span><br><span class="line">rcorr_matrix<span class="operator">$</span>r    <span class="comment">#相关矩阵</span></span><br><span class="line">rcorr_matrix<span class="operator">$</span>P    <span class="comment">#p 值矩阵</span></span><br><span class="line"><span class="comment">#给定两组变量间相关系数的非对称矩阵</span></span><br><span class="line">x <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>mtcars<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;mpg&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyl&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;disp&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;hp&#x27;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">y <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span><span class="punctuation">(</span>mtcars<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;drat&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;wt&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;qsec&#x27;</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">rcorr_matrix <span class="operator">&lt;-</span> rcorr<span class="punctuation">(</span>x<span class="punctuation">,</span> y<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;pearson&#x27;</span><span class="punctuation">)</span></span><br><span class="line">rcorr_matrix<span class="operator">$</span>r    <span class="comment">#相关矩阵</span></span><br><span class="line">rcorr_matrix<span class="operator">$</span>P    <span class="comment">#p 值矩阵</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">##相关图绘制示例，corrplot 包</span></span><br><span class="line">library<span class="punctuation">(</span>corrplot<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#第一个示例，根据筛选后的数据“phylum_corr_final”作图</span></span><br><span class="line">corrplot<span class="punctuation">(</span>phylum_corr_final<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;number&#x27;</span><span class="punctuation">,</span> number.cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">,</span> diag <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> tl.cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span></span><br><span class="line">corrplot<span class="punctuation">(</span>phylum_corr_final<span class="punctuation">,</span> add <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;upper&#x27;</span><span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;pie&#x27;</span><span class="punctuation">,</span> diag <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> tl.pos <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> cl.pos <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#第二个示例，在作图时，通过指定过滤参数（p&lt;0.05），作图时自动屏蔽不显著的值</span></span><br><span class="line">corrplot<span class="punctuation">(</span>phylum_env_corr<span class="operator">$</span>r<span class="punctuation">,</span> p.mat <span class="operator">=</span> phylum_env_corr<span class="operator">$</span>p<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;number&#x27;</span><span class="punctuation">,</span> insig <span class="operator">=</span> <span class="string">&#x27;blank&#x27;</span><span class="punctuation">,</span> sig.level <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span> addCoef.col <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span>  number.cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">,</span> tl.cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#读取相关性数据（已经计算好的相关性结果数据）</span></span><br><span class="line">pearson1 <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>read.table<span class="punctuation">(</span><span class="string">&#x27;pearson1.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">pearson2 <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>read.table<span class="punctuation">(</span><span class="string">&#x27;pearson2.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##############################</span></span><br><span class="line"><span class="comment">####corrplot 包相关图示例</span></span><br><span class="line">library<span class="punctuation">(</span>corrplot<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#默认</span></span><br><span class="line">corrplot<span class="punctuation">(</span>pearson1<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#method 参数，调整相关系数的展示方式</span></span><br><span class="line">corrplot<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;color&#x27;</span><span class="punctuation">)</span></span><br><span class="line">corrplot<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;number&#x27;</span><span class="punctuation">)</span></span><br><span class="line">corrplot<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;pie&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#diag = FALSE，隐藏对角线值</span></span><br><span class="line">corrplot<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;square&#x27;</span><span class="punctuation">,</span> diag <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#tl.pos、tl.cex、tl.col、tl.offset、tl.srt 等参数，调整变量标签字体属性</span></span><br><span class="line"><span class="comment">#例如调整大小及颜色</span></span><br><span class="line">corrplot<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;pie&#x27;</span><span class="punctuation">,</span> diag <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> tl.cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">,</span> tl.col <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#cl.pos、cl.lim、cl.length、cl.cex、cl.ratio、cl.align.text、cl.offset 等参数，调整相关性标尺属性</span></span><br><span class="line"><span class="comment">#例如将标尺调整至图的下方，并调整刻度值的间隔</span></span><br><span class="line">corrplot<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;pie&#x27;</span><span class="punctuation">,</span> diag <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> cl.pos <span class="operator">=</span> <span class="string">&#x27;b&#x27;</span><span class="punctuation">,</span> cl.length <span class="operator">=</span> <span class="number">9</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#number.cex、number.font、number.digits 等参数，调整相关性数字属性（当 method = &#x27;number&#x27; 时可调整）</span></span><br><span class="line"><span class="comment">#例如调整展示数值的尺寸</span></span><br><span class="line">corrplot<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;number&#x27;</span><span class="punctuation">,</span> diag <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> number.cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#order、hclust.method（当 order = &#x27;hclust&#x27; 时可调整）等参数，可根据相关性强度对变量的展示顺序重新排列</span></span><br><span class="line"><span class="comment">#例如将变量根据 ward 最小方差聚类排序，并将变量聚为 3 类</span></span><br><span class="line">corrplot<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;color&#x27;</span><span class="punctuation">,</span> order <span class="operator">=</span> <span class="string">&#x27;hclust&#x27;</span><span class="punctuation">,</span> hclust.method <span class="operator">=</span> <span class="string">&#x27;ward.D&#x27;</span><span class="punctuation">,</span> addrect <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#type 可设置相关图的展示形式，默认展示全部</span></span><br><span class="line"><span class="comment">#例如仅展示对称矩阵的上三角部分</span></span><br><span class="line">corrplot<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;color&#x27;</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;upper&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#添加 add = TRUE 时（默认 FALSE），可将新图叠加在原图上方</span></span><br><span class="line"><span class="comment">#例如一个组合样式的相关图</span></span><br><span class="line">corrplot<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;number&#x27;</span><span class="punctuation">,</span> number.cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">,</span> diag <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> tl.cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span></span><br><span class="line">corrplot<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> add <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;upper&#x27;</span><span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;pie&#x27;</span><span class="punctuation">,</span> diag <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> tl.pos <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> cl.pos <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#col 属性自定义相关性的颜色设置，bg 可设置背景色</span></span><br><span class="line"><span class="comment">#例如自定义相关系数的颜色范围</span></span><br><span class="line">col1 <span class="operator">&lt;-</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;red3&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;white&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue4&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">corrplot<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;number&#x27;</span><span class="punctuation">,</span> diag <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> col <span class="operator">=</span> col1<span class="punctuation">(</span><span class="number">21</span><span class="punctuation">)</span><span class="punctuation">,</span> tl.cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span></span><br><span class="line">corrplot<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> add <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;upper&#x27;</span><span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;circle&#x27;</span><span class="punctuation">,</span> diag <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> col <span class="operator">=</span> col1<span class="punctuation">(</span><span class="number">21</span><span class="punctuation">)</span><span class="punctuation">,</span> tl.pos <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> cl.pos <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#当 method 不为 “number”时，可使用 addgrid.col 设置颜色显示相关系数，同时配合 number.font 等参数使用</span></span><br><span class="line"><span class="comment">#例如当 method = &#x27;color&#x27; 时，在图中显示相关系数数值，并 number.cex 调整字体大小</span></span><br><span class="line">corrplot<span class="punctuation">(</span>pearson2<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;color&#x27;</span><span class="punctuation">,</span> addCoef.col <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> number.cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#当存在显著性检验结果时，可使用 sig.level、insig 等参数根据显著性 p 值屏蔽不显著的相关系数</span></span><br><span class="line"><span class="comment">#通常与 pch、pch.col、pch.cex 等参数来使用，这些参数设置屏蔽区的展示方式</span></span><br><span class="line"><span class="comment">#此处借用 psych 包中的 corr.test()，基于原始数据计算相关性，并执行显著性检验，之后根据结果绘制相关图</span></span><br><span class="line">library<span class="punctuation">(</span>psych<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">top10_phylum <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;top10_phylum.csv&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">spearman1 <span class="operator">&lt;-</span> corr.test<span class="punctuation">(</span>top10_phylum<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;spearman&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">corrplot<span class="punctuation">(</span>spearman1<span class="operator">$</span>r<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;square&#x27;</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;lower&#x27;</span><span class="punctuation">,</span> p.mat <span class="operator">=</span> spearman1<span class="operator">$</span>p<span class="punctuation">,</span> sig.level <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span> insig <span class="operator">=</span> <span class="string">&#x27;blank&#x27;</span><span class="punctuation">,</span> addCoef.col <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> diag <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> number.cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">,</span> tl.cex <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##############################</span></span><br><span class="line"><span class="comment">####corrgram 包相关图示例</span></span><br><span class="line">library<span class="punctuation">(</span>corrgram<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#默认</span></span><br><span class="line">corrgram<span class="punctuation">(</span>pearson1<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#order = TRUE 时，可根据相关性强度对变量的展示顺序重新排列</span></span><br><span class="line">corrgram<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> order <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#lower.panel、upper.panel 等参数可以设置相关系数的展示方式</span></span><br><span class="line"><span class="comment">#例如设置下三角区域填充图样式，上三角区域饼图样式</span></span><br><span class="line">corrgram<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> lower.panel <span class="operator">=</span> panel.fill<span class="punctuation">,</span> upper.panel <span class="operator">=</span> panel.pie<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#text.panel、label.pos 、label.srt、cex.labels、font.labels 等参数可用于调整面板的外观显示样式</span></span><br><span class="line"><span class="comment">#例如调整变量标签的字体大小</span></span><br><span class="line">corrgram<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> lower.panel <span class="operator">=</span> panel.shade<span class="punctuation">,</span> upper.panel <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> cex.labels <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#col.regions 可用于自定义颜色范围，例如</span></span><br><span class="line">col1 <span class="operator">&lt;-</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;red3&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;white&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue4&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">corrgram<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> lower.panel <span class="operator">=</span> panel.shade<span class="punctuation">,</span> upper.panel <span class="operator">=</span> panel.pie<span class="punctuation">,</span> col.regions <span class="operator">=</span> col1<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#可以直接读取原始数据，通过指定相关系数类型，作图展示</span></span><br><span class="line"><span class="comment">#相较于直接读取相关矩阵，此时可以添加散点图或拟合线图类型展示变量间的相关性</span></span><br><span class="line">top10_phylum <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;top10_phylum.csv&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">corrgram<span class="punctuation">(</span>top10_phylum<span class="punctuation">,</span> cor.method <span class="operator">=</span> <span class="string">&#x27;pearson&#x27;</span><span class="punctuation">,</span> lower.panel <span class="operator">=</span> panel.pts<span class="punctuation">,</span> upper.panel <span class="operator">=</span> panel.ellipse<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##############################</span></span><br><span class="line"><span class="comment">####pairs()，绘制变量间两两相关性散点图矩阵</span></span><br><span class="line">top10_phylum <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>read.csv<span class="punctuation">(</span><span class="string">&#x27;top10_phylum.csv&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">panel.hist <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    usr <span class="operator">&lt;-</span> par<span class="punctuation">(</span><span class="string">&#x27;usr&#x27;</span><span class="punctuation">)</span>; <span class="built_in">on.exit</span><span class="punctuation">(</span>par<span class="punctuation">(</span>usr<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">    par<span class="punctuation">(</span>usr <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>usr<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">1.5</span><span class="punctuation">)</span> <span class="punctuation">)</span></span><br><span class="line">    h <span class="operator">&lt;-</span> hist<span class="punctuation">(</span>x<span class="punctuation">,</span> plot <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">    breaks <span class="operator">&lt;-</span> h<span class="operator">$</span>breaks; nB <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>breaks<span class="punctuation">)</span></span><br><span class="line">    y <span class="operator">&lt;-</span> h<span class="operator">$</span>counts; y <span class="operator">&lt;-</span> y<span class="operator">/</span><span class="built_in">max</span><span class="punctuation">(</span>y<span class="punctuation">)</span></span><br><span class="line">    rect<span class="punctuation">(</span>breaks<span class="punctuation">[</span><span class="operator">-</span>nB<span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> breaks<span class="punctuation">[</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> y<span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">pairs<span class="punctuation">(</span>top10_phylum<span class="punctuation">,</span> panel <span class="operator">=</span> panel.smooth<span class="punctuation">,</span> diag.panel <span class="operator">=</span> panel.hist<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##############################</span></span><br><span class="line"><span class="comment">####GGally 包相关图示例</span></span><br><span class="line">library<span class="punctuation">(</span>GGally<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#默认</span></span><br><span class="line">ggcorr<span class="punctuation">(</span>pearson1<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#label = TRUE 时，在图中展示相关系数数值，此时可使用 label_alpha、label_color、label_round、label_size 等参数设置字体属性</span></span><br><span class="line">ggcorr<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> label <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> label_alpha <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#low、mid、high 等参数可自定义颜色范围，例如</span></span><br><span class="line">ggcorr<span class="punctuation">(</span>pearson1<span class="punctuation">,</span> low <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> mid <span class="operator">=</span> <span class="string">&#x27;white&#x27;</span><span class="punctuation">,</span> high <span class="operator">=</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#读取原始数据，指定所需计算的相关系数类型，自定义作图样式</span></span><br><span class="line">top10_phylum <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;top10_phylum.csv&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggcorr<span class="punctuation">(</span></span><br><span class="line">	top10_phylum<span class="punctuation">,</span> </span><br><span class="line">	method <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;pairwise&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;pearson&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">	name <span class="operator">=</span> <span class="built_in">expression</span><span class="punctuation">(</span>rho<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">	geom <span class="operator">=</span> <span class="string">&#x27;circle&#x27;</span><span class="punctuation">,</span></span><br><span class="line">	max_size <span class="operator">=</span> <span class="number">15</span><span class="punctuation">,</span></span><br><span class="line">	min_size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">	size <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">	hjust <span class="operator">=</span> <span class="number">0.75</span><span class="punctuation">,</span></span><br><span class="line">	nbreaks <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line">	palette <span class="operator">=</span> <span class="string">&#x27;PuOr&#x27;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggpairs() 绘制变量间两两相关性散点图矩阵</span></span><br><span class="line">top10_phylum <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;top10_phylum.csv&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">ggpairs<span class="punctuation">(</span>top10_phylum<span class="punctuation">,</span> columns <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">6</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="ggcor包组合相关矩阵和mantel相">ggcor包组合相关矩阵和Mantel相</h4>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>ggcor包组合相关矩阵和Mantel相<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>vegan<span class="punctuation">)</span> <span class="comment">## 获取数据</span></span><br><span class="line">library<span class="punctuation">(</span>ggcor<span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">(</span><span class="string">&quot;varespec&quot;</span><span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">(</span><span class="string">&quot;varechem&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">mantel <span class="operator">&lt;-</span> mantel_test<span class="punctuation">(</span>varespec<span class="punctuation">,</span> varechem<span class="punctuation">)</span></span><br><span class="line">combination_layout<span class="punctuation">(</span>mantel<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&quot;upper&quot;</span><span class="punctuation">,</span> show.diag <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span></span><br><span class="line">                   col.names <span class="operator">=</span> <span class="built_in">names</span><span class="punctuation">(</span>varechem<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">type、show.diag、row.names、col.names都是相关系数矩阵相关的参数，</span></span><br><span class="line"><span class="string">若觉得这些有点多难得处理，完全可以传递一个cor_tbl对象给cor_tbl参数，这样所有的问题完美解决。如下：</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line">corr <span class="operator">&lt;-</span> correlate<span class="punctuation">(</span>varechem<span class="punctuation">,</span> cor.test <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  as_cor_tbl<span class="punctuation">(</span>type <span class="operator">=</span> <span class="string">&quot;upper&quot;</span><span class="punctuation">,</span> show.diag <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">combination_layout<span class="punctuation">(</span>mantel<span class="punctuation">,</span> cor_tbl <span class="operator">=</span> corr<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">combination_layout<span class="punctuation">(</span>mantel<span class="punctuation">,</span> cor_tbl <span class="operator">=</span> corr<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  ggplot<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_link<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> r<span class="punctuation">)</span><span class="punctuation">,</span> curvature <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_start_point<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span> shape <span class="operator">=</span> <span class="number">23</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_end_point<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> shape <span class="operator">=</span> <span class="number">21</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_start_label<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> x <span class="operator">-</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_end_label<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> xend <span class="operator">+</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line"><span class="comment">#  scale_fill_gradient2(midpoint = 0, low = &#x27;blue&#x27;, mid = &#x27;white&#x27;, high = &#x27;red&#x27;, space = &#x27;Lab&#x27;) +#环境变量相关系数颜色赋值</span></span><br><span class="line"><span class="comment">#  scale_size(range = c(0, 1)) +  #根据 Mantel 相关指定线条粗细</span></span><br><span class="line">  remove_axis<span class="punctuation">(</span><span class="string">&#x27;all&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment">#去除原 x、y 轴上的环境变量标签</span></span><br><span class="line">  scale_color_gradient<span class="punctuation">(</span>low <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> high <span class="operator">=</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment">#根据 Mantel 相关 r 值指定线条颜色</span></span><br><span class="line">  coord_cartesian<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_void<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###多组的情况下</span></span><br><span class="line">mantel2 <span class="operator">&lt;-</span> mantel_test<span class="punctuation">(</span>varespec<span class="punctuation">,</span> varechem<span class="punctuation">,</span> mantel.fun <span class="operator">=</span> <span class="string">&#x27;mantel.randtest&#x27;</span><span class="punctuation">,</span>spec.dist.method <span class="operator">=</span> <span class="string">&#x27;bray&#x27;</span><span class="punctuation">,</span> env.dist.method <span class="operator">=</span> <span class="string">&#x27;euclidean&#x27;</span><span class="punctuation">,</span> </span><br><span class="line">                       spec.select <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>Spec01 <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">7</span><span class="punctuation">,</span></span><br><span class="line">                                          Spec02 <span class="operator">=</span> <span class="number">8</span><span class="operator">:</span><span class="number">18</span><span class="punctuation">,</span></span><br><span class="line">                                          Spec03 <span class="operator">=</span> <span class="number">19</span><span class="operator">:</span><span class="number">24</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">有个细节需要注意，对于这个图，默认的起点都是群落，终点是环境，当然完全可以通过start.var、end.var参数来改变默认设置。</span></span><br><span class="line"><span class="string">&#x27;</span><span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="comment">##过程中，各样本基于物种丰度转化为 Bray-curtis 距离，基于环境变量使用欧式距离 ,mantel.fun可选择不同包中的mantel检验</span></span><br><span class="line">combination_layout<span class="punctuation">(</span>mantel2<span class="punctuation">,</span> cor_tbl <span class="operator">=</span> corr<span class="punctuation">)</span> <span class="operator">%&gt;%</span> <span class="comment">#设置参数start.var = env2 type = &quot;upper&quot; 可调整线条方向 lower朝下</span></span><br><span class="line">  ggplot<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_link<span class="punctuation">(</span>aes<span class="punctuation">(</span>colour <span class="operator">=</span> r<span class="punctuation">,</span>size <span class="operator">=</span> r<span class="punctuation">)</span><span class="punctuation">,</span>curvature <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_start_point<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span> shape <span class="operator">=</span> <span class="number">23</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_end_point<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> shape <span class="operator">=</span> <span class="number">21</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_start_label<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> x <span class="operator">-</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_end_label<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> xend <span class="operator">+</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_gradient<span class="punctuation">(</span>low <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> high <span class="operator">=</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_size<span class="punctuation">(</span><span class="built_in">range</span> <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  coord_cartesian<span class="punctuation">(</span>xlim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">14</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_void<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#组合图</span></span><br><span class="line"><span class="comment">#第一种</span></span><br><span class="line">mantel2 <span class="operator">&lt;-</span> mantel_test<span class="punctuation">(</span>varespec<span class="punctuation">,</span> varechem<span class="punctuation">,</span> mantel.fun <span class="operator">=</span> <span class="string">&#x27;mantel.randtest&#x27;</span><span class="punctuation">,</span>spec.dist.method <span class="operator">=</span> <span class="string">&#x27;bray&#x27;</span><span class="punctuation">,</span> env.dist.method <span class="operator">=</span> <span class="string">&#x27;euclidean&#x27;</span><span class="punctuation">,</span> </span><br><span class="line">                       spec.select <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>Spec01 <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">7</span><span class="punctuation">,</span></span><br><span class="line">                                          Spec02 <span class="operator">=</span> <span class="number">8</span><span class="operator">:</span><span class="number">18</span><span class="punctuation">,</span></span><br><span class="line">                                          Spec03 <span class="operator">=</span> <span class="number">19</span><span class="operator">:</span><span class="number">24</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">mantel4 <span class="operator">&lt;-</span> mantel2<span class="punctuation">[</span><span class="operator">-</span>which<span class="punctuation">(</span>mantel2<span class="operator">$</span>p.value<span class="operator">&gt;</span><span class="number">0.05</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span> <span class="comment">#可以做一定得筛选</span></span><br><span class="line"><span class="comment">##划定p值r值范围 变为离散型</span></span><br><span class="line"><span class="comment">#作图根据定义的区间设置连线风格，区分显著的相关系数和不显著的 Mantel 相关</span></span><br><span class="line">mantel2 <span class="operator">&lt;-</span> mutate<span class="punctuation">(</span>mantel2<span class="punctuation">,</span> </span><br><span class="line">                  r <span class="operator">=</span> cut<span class="punctuation">(</span>r<span class="punctuation">,</span> breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="literal">Inf</span><span class="punctuation">,</span> <span class="number">0.25</span><span class="punctuation">,</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="literal">Inf</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">                          labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;&lt;0.25&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;0.25-0.5&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;&gt;=0.5&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> right <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                  p.value <span class="operator">=</span> cut<span class="punctuation">(</span>p.value<span class="punctuation">,</span> breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="literal">Inf</span><span class="punctuation">,</span> <span class="number">0.001</span><span class="punctuation">,</span> <span class="number">0.01</span><span class="punctuation">,</span> <span class="number">0.05</span><span class="punctuation">,</span> <span class="literal">Inf</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">                                labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;&lt;0.001&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;0.001-0.01&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;0.01-0.05&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;&gt;=0.05&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> right <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#对于重要的相关系数的取舍，除了选择了直接剔除或者不在图中展示。此外，也可以选择将它们保留在图中，使用其它颜色区分即可。</span></span><br><span class="line">df <span class="operator">&lt;-</span> combination_layout<span class="punctuation">(</span>mantel2<span class="punctuation">,</span> cor_tbl <span class="operator">=</span> corr<span class="punctuation">)</span> <span class="comment">## 这里需要存储下结果</span></span><br><span class="line">options<span class="punctuation">(</span>ggcor.link.inherit.aes <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="comment">#我们可以通过全局变量ggcor.link.inherit.aes来改变link相关的图层映射参数继承。</span></span><br><span class="line">quickcor<span class="punctuation">(</span>corr<span class="punctuation">)</span> <span class="operator">+</span> geom_square<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment">#还有更多样式，和 corrplot 包中的风格是一致的</span></span><br><span class="line">  geom_link<span class="punctuation">(</span>aes<span class="punctuation">(</span>colour <span class="operator">=</span> p.value<span class="punctuation">,</span>size <span class="operator">=</span> r<span class="punctuation">)</span><span class="punctuation">,</span> data <span class="operator">=</span> df<span class="punctuation">)</span> <span class="operator">+</span> <span class="comment"># 添加连接线</span></span><br><span class="line">  geom_start_point<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;red&quot;</span><span class="punctuation">,</span> shape <span class="operator">=</span> <span class="number">23</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span> data <span class="operator">=</span> df<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_end_point<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> shape <span class="operator">=</span> <span class="number">21</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span> data <span class="operator">=</span> df<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_start_label<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> x <span class="operator">-</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> data <span class="operator">=</span> df<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  <span class="comment">#scale_fill_gradient2(midpoint = 0, low = &#x27;blue&#x27;, mid = &#x27;white&#x27;, high = &#x27;red&#x27;, space = &#x27;Lab&#x27;)+</span></span><br><span class="line">  scale_fill_gradient2<span class="punctuation">(</span>midpoint <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> low <span class="operator">=</span> <span class="string">&quot;#56B4E9&quot;</span><span class="punctuation">,</span> mid <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span>high <span class="operator">=</span> <span class="string">&quot;#E69F00&quot;</span><span class="punctuation">,</span> space <span class="operator">=</span> <span class="string">&quot;Lab&quot;</span> <span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  <span class="comment">#scale_color_gradient(low = &#x27;red&#x27;, high = &#x27;blue&#x27;) +</span></span><br><span class="line">  scale_color_manual<span class="punctuation">(</span>values<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#56B4E9&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#E69F00&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#999999&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_size_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.1</span><span class="punctuation">,</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span>  <span class="operator">+</span></span><br><span class="line">  geom_end_label<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> xend <span class="operator">+</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">3.8</span><span class="punctuation">,</span> data <span class="operator">=</span> df<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  expand_axis<span class="punctuation">(</span>x <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">6</span><span class="punctuation">,</span> <span class="number">14.5</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  remove_y_axis<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="计算alpha多样性指数"><strong>计算Alpha多样性指数</strong></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#更多参数见2018_Book_StatisticalAnalysisOfMicrobiom书第6章</span></span><br><span class="line">library<span class="punctuation">(</span>vegan<span class="punctuation">)</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##物种丰富度 Richness 指数</span></span><br><span class="line">richness <span class="operator">&lt;-</span> rowSums<span class="punctuation">(</span>otu <span class="operator">&gt;</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#或</span></span><br><span class="line">richness <span class="operator">&lt;-</span> estimateR<span class="punctuation">(</span>otu<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##Shannon（以下 Shannon 公式的对数底数均设使用 e，在 R 中即表示为 exp(1)）</span></span><br><span class="line"><span class="comment">#Shannon 指数</span></span><br><span class="line">shannon_index <span class="operator">&lt;-</span> diversity<span class="punctuation">(</span>otu<span class="punctuation">,</span> index <span class="operator">=</span> <span class="string">&#x27;shannon&#x27;</span><span class="punctuation">,</span> base <span class="operator">=</span> <span class="built_in">exp</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#Shannon 多样性</span></span><br><span class="line">shannon_diversity <span class="operator">&lt;-</span> <span class="built_in">exp</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="operator">^</span>shannon_index</span><br><span class="line"></span><br><span class="line"><span class="comment">#Shannon 均匀度（Pielou 均匀度）</span></span><br><span class="line">pielou <span class="operator">&lt;-</span> shannon_index <span class="operator">/</span> <span class="built_in">log</span><span class="punctuation">(</span>richness<span class="punctuation">,</span> <span class="built_in">exp</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##Simpson</span></span><br><span class="line"><span class="comment">#Gini-Simpson 指数（我们平时常用的 Simpson 指数即为 Gini-Simpson 指数）</span></span><br><span class="line">gini_simpson_index <span class="operator">&lt;-</span> diversity<span class="punctuation">(</span>otu<span class="punctuation">,</span> index <span class="operator">=</span> <span class="string">&#x27;simpson&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#经典 Simpson 指数（使用频率比较低）</span></span><br><span class="line">simpson_index <span class="operator">&lt;-</span> 1 <span class="operator">-</span> gini_simpson_index</span><br><span class="line"><span class="comment">#Invsimpson 指数（Gini-Simpson 的倒数）</span></span><br><span class="line">invsimpson_index <span class="operator">&lt;-</span> 1 <span class="operator">/</span> gini_simpson_index</span><br><span class="line"><span class="comment">#或</span></span><br><span class="line">invsimpson_index <span class="operator">&lt;-</span> diversity<span class="punctuation">(</span>otu<span class="punctuation">,</span> index <span class="operator">=</span> <span class="string">&#x27;invsimpson&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#Simpson 多样性</span></span><br><span class="line">simpson_diversity <span class="operator">&lt;-</span> 1 <span class="operator">/</span> <span class="punctuation">(</span><span class="number">1</span> <span class="operator">-</span> gini_simpson_index<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#Simpson 均匀度（equitability 均匀度）</span></span><br><span class="line">equitability <span class="operator">&lt;-</span> 1 <span class="operator">/</span> <span class="punctuation">(</span>richness <span class="operator">*</span> <span class="punctuation">(</span><span class="number">1</span> <span class="operator">-</span> gini_simpson_index<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">str<span class="punctuation">(</span>ace<span class="punctuation">)</span></span><br><span class="line"><span class="comment">##Chao1 &amp; ACE</span></span><br><span class="line"><span class="comment">#Chao1 指数</span></span><br><span class="line">chao1 <span class="operator">&lt;-</span> estimateR<span class="punctuation">(</span>otu<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"><span class="comment">#ACE 指数</span></span><br><span class="line">ace <span class="operator">&lt;-</span> estimateR<span class="punctuation">(</span>otu<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"><span class="comment">##goods_coverage 指数</span></span><br><span class="line">goods_coverage <span class="operator">&lt;-</span> 1 <span class="operator">-</span> rowSums<span class="punctuation">(</span>otu <span class="operator">==</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">/</span> rowSums<span class="punctuation">(</span>otu<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#定义函数，计算丰富度、Shannon 熵指数、Simpson 指数（Gini-Simpson 指数）、Pielou 均匀度、Chao1 指数、ACE 指数、goods_coverage、PD_whole_tree</span></span><br><span class="line">library<span class="punctuation">(</span>picante<span class="punctuation">)</span>	<span class="comment">#picante 包加载时默认同时加载 vegan</span></span><br><span class="line">alpha <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">,</span> tree <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> base <span class="operator">=</span> <span class="built_in">exp</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  est <span class="operator">&lt;-</span> estimateR<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">  Richness <span class="operator">&lt;-</span> est<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">  Chao1 <span class="operator">&lt;-</span> est<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">  ACE <span class="operator">&lt;-</span> est<span class="punctuation">[</span><span class="number">4</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">  Shannon <span class="operator">&lt;-</span> diversity<span class="punctuation">(</span>x<span class="punctuation">,</span> index <span class="operator">=</span> <span class="string">&#x27;shannon&#x27;</span><span class="punctuation">,</span> base <span class="operator">=</span> base<span class="punctuation">)</span></span><br><span class="line">  Simpson <span class="operator">&lt;-</span> diversity<span class="punctuation">(</span>x<span class="punctuation">,</span> index <span class="operator">=</span> <span class="string">&#x27;simpson&#x27;</span><span class="punctuation">)</span>	<span class="comment">#Gini-Simpson 指数</span></span><br><span class="line">  Pielou <span class="operator">&lt;-</span> Shannon <span class="operator">/</span> <span class="built_in">log</span><span class="punctuation">(</span>Richness<span class="punctuation">,</span> base<span class="punctuation">)</span></span><br><span class="line">  goods_coverage <span class="operator">&lt;-</span> 1 <span class="operator">-</span> rowSums<span class="punctuation">(</span>x <span class="operator">==</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">/</span> rowSums<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">  result <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>Richness<span class="punctuation">,</span> Shannon<span class="punctuation">,</span> Simpson<span class="punctuation">,</span> Pielou<span class="punctuation">,</span> Chao1<span class="punctuation">,</span> ACE<span class="punctuation">,</span> goods_coverage<span class="punctuation">)</span></span><br><span class="line">  <span class="keyword">if</span> <span class="punctuation">(</span><span class="operator">!</span><span class="built_in">is.null</span><span class="punctuation">(</span>tree<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    PD_whole_tree <span class="operator">&lt;-</span> pd<span class="punctuation">(</span>x<span class="punctuation">,</span> tree<span class="punctuation">,</span> include.root <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">    <span class="built_in">names</span><span class="punctuation">(</span>PD_whole_tree<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="string">&#x27;PD_whole_tree&#x27;</span></span><br><span class="line">    result <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span>result<span class="punctuation">,</span> PD_whole_tree<span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  result</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#加载 OTU 丰度表和进化树文件</span></span><br><span class="line">otu <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;OTU_table.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">otu <span class="operator">&lt;-</span> t<span class="punctuation">(</span>otu<span class="punctuation">)</span></span><br><span class="line">tree <span class="operator">&lt;-</span> read.tree<span class="punctuation">(</span><span class="string">&#x27;otu_phylo.tre&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#不包含谱系多样性，无需指定进化树；Shannon 公式的 log 底数我们使用 2</span></span><br><span class="line">alpha_all <span class="operator">&lt;-</span> alpha<span class="punctuation">(</span>otu<span class="punctuation">,</span> base <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#包含谱系多样性时，指定进化树文件；Shannon 公式的 log 底数我们使用 2</span></span><br><span class="line">alpha_all <span class="operator">&lt;-</span> alpha<span class="punctuation">(</span>otu<span class="punctuation">,</span> tree<span class="punctuation">,</span> base <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#输出，例如 csv 格式</span></span><br><span class="line">write.csv<span class="punctuation">(</span>alpha_all<span class="punctuation">,</span> <span class="string">&#x27;alpha.csv&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="go条形图-气泡图"><strong>Go条形图&amp;气泡图</strong></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span><span class="operator">=</span>ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>xlsx<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> read.xlsx<span class="punctuation">(</span><span class="string">&#x27;GO_bar.xlsx&#x27;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>sheetIndex <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>data<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>Go_term<span class="punctuation">,</span>y<span class="operator">=</span>Counts<span class="punctuation">,</span>fill <span class="operator">=</span> Go_category<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_bar<span class="punctuation">(</span>stat <span class="operator">=</span> <span class="string">&quot;identity&quot;</span><span class="punctuation">,</span>width <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line"><span class="comment">#将GO_term设定为factor即可按照顺序输出</span></span><br><span class="line">GO_term_order<span class="operator">=</span>factor<span class="punctuation">(</span><span class="built_in">as.integer</span><span class="punctuation">(</span>rownames<span class="punctuation">(</span>data<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span>labels<span class="operator">=</span>data<span class="operator">$</span>Go_term<span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>GO_term_order<span class="punctuation">,</span>y<span class="operator">=</span>Counts<span class="punctuation">,</span>fill <span class="operator">=</span> Go_category<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_bar<span class="punctuation">(</span>stat <span class="operator">=</span> <span class="string">&quot;identity&quot;</span><span class="punctuation">,</span>width <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">   coord_flip<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span>  xlab<span class="punctuation">(</span><span class="string">&quot;GO term&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> ylab<span class="punctuation">(</span><span class="string">&quot;Num of Genes&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> theme_bw<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#或者将坐标轴调整角度</span></span><br><span class="line">COLS <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#66C3A5&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#8DA1CB&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#FD8D62&quot;</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data<span class="operator">=</span>data<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>GO_term_order<span class="punctuation">,</span>y<span class="operator">=</span>Counts<span class="punctuation">,</span> fill<span class="operator">=</span>Go_category<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_bar<span class="punctuation">(</span>stat<span class="operator">=</span><span class="string">&quot;identity&quot;</span><span class="punctuation">,</span> width<span class="operator">=</span><span class="number">0.8</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span>values <span class="operator">=</span> COLS<span class="punctuation">)</span> <span class="operator">+</span> theme_bw<span class="punctuation">(</span><span class="punctuation">)</span>  <span class="operator">+</span></span><br><span class="line">  xlab<span class="punctuation">(</span><span class="string">&quot;GO term&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> ylab<span class="punctuation">(</span><span class="string">&quot;Num of Genes&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> labs<span class="punctuation">(</span>title <span class="operator">=</span> <span class="string">&quot;The Most Enriched GO Terms&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.text.x<span class="operator">=</span>element_text<span class="punctuation">(</span>face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span> color<span class="operator">=</span><span class="string">&quot;black&quot;</span><span class="punctuation">,</span>angle <span class="operator">=</span> <span class="number">70</span><span class="punctuation">,</span>vjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">1</span> <span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">170</span><span class="punctuation">)</span><span class="punctuation">,</span>expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>axis.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">13</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>legend.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">11</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##我们还可以将不同分组的Go_term的名字都映射颜色</span></span><br><span class="line">table<span class="punctuation">(</span>go_enrich_df<span class="operator">$</span>type<span class="punctuation">)</span> <span class="comment">## 使用table函数统计每一组中包含的个数，方便后面进行颜色的映射</span></span><br><span class="line"> theme<span class="punctuation">(</span>axis.text.y <span class="operator">=</span> element_text<span class="punctuation">(</span>angle<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>hjust<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span> vjust<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span> color  <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#FD8D62&quot;</span><span class="punctuation">,</span><span class="string">&quot;#8DA1CB&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#66C3A5&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">12</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="comment">#根据算出的数目映射</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">##GO气泡图</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>GOplot<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>RColorBrewer<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggrepel<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">data<span class="punctuation">(</span>EC<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>EC<span class="operator">$</span>david<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>EC<span class="operator">$</span>genelist<span class="punctuation">)</span></span><br><span class="line">circ <span class="operator">&lt;-</span> circle_dat<span class="punctuation">(</span>EC<span class="operator">$</span>david<span class="punctuation">,</span> EC<span class="operator">$</span>genelist<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#直接气泡图</span></span><br><span class="line">GOBubble<span class="punctuation">(</span>circ<span class="punctuation">,</span> labels <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#labels: Sets a threshold for the displayed labels. The threshold refers to the -log(adjusted p-value) (default=5)</span></span><br><span class="line"><span class="comment">#略调整参数之后可以对图的布局、颜色等进行调整</span></span><br><span class="line">GOBubble<span class="punctuation">(</span>circ<span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&#x27;Bubble plot&#x27;</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;darkred&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gold&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> display <span class="operator">=</span> <span class="string">&#x27;multiple&#x27;</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">circ2 <span class="operator">&lt;-</span> circ<span class="punctuation">[</span><span class="operator">!</span>duplicated<span class="punctuation">(</span>circ<span class="operator">$</span>ID<span class="punctuation">)</span><span class="punctuation">,</span><span class="operator">-</span><span class="number">5</span><span class="punctuation">]</span></span><br><span class="line">head<span class="punctuation">(</span>circ2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##ggplot画图</span></span><br><span class="line">ggplot<span class="punctuation">(</span>circ2<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>zscore<span class="punctuation">,</span>y<span class="operator">=</span><span class="operator">-</span>log10<span class="punctuation">(</span>adj_pval<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>size<span class="operator">=</span>count<span class="punctuation">,</span>color<span class="operator">=</span>category<span class="punctuation">)</span><span class="punctuation">,</span>alpha<span class="operator">=</span><span class="number">0.6</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_size<span class="punctuation">(</span><span class="built_in">range</span><span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">12</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_color_brewer<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;Accent&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme_bw<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    <span class="comment">#legend.position = c(&quot;none&quot;)</span></span><br><span class="line">  <span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_text_repel<span class="punctuation">(</span></span><br><span class="line">    data <span class="operator">=</span> circ2<span class="punctuation">[</span><span class="operator">-</span>log10<span class="punctuation">(</span>circ2<span class="operator">$</span>adj_pval<span class="punctuation">)</span><span class="operator">&gt;</span><span class="number">3</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    aes<span class="punctuation">(</span>label <span class="operator">=</span> ID<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    size <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">    segment.color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> show.legend <span class="operator">=</span> <span class="literal">FALSE</span> <span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  facet_grid<span class="punctuation">(</span>.<span class="operator">~</span>category<span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="富集气泡图"><strong>富集气泡图</strong></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">pathway <span class="operator">=</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;KEGG_pathwa.txt&#x27;</span><span class="punctuation">,</span>check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">)</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>pathway<span class="punctuation">,</span>aes<span class="punctuation">(</span>GeneRatio<span class="punctuation">,</span>Description<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>size <span class="operator">=</span> Count<span class="punctuation">,</span>color <span class="operator">=</span> <span class="operator">-</span><span class="number">1</span><span class="operator">*</span>log10<span class="punctuation">(</span>qvalue<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_color_gradient<span class="punctuation">(</span>low <span class="operator">=</span> <span class="string">&quot;green&quot;</span><span class="punctuation">,</span>high <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>color <span class="operator">=</span> <span class="built_in">expression</span><span class="punctuation">(</span><span class="operator">-</span><span class="built_in">log</span><span class="punctuation">[</span><span class="number">10</span><span class="punctuation">]</span><span class="punctuation">(</span>qvalue<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span>size <span class="operator">=</span> <span class="string">&#x27;Gene&#x27;</span><span class="punctuation">,</span></span><br><span class="line">       x <span class="operator">=</span> <span class="string">&#x27;GeneRatio&#x27;</span><span class="punctuation">,</span></span><br><span class="line">       y <span class="operator">=</span> <span class="string">&#x27;Go_term&#x27;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> strip.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">13</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">13</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">11</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p        </span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&quot;T01vsT07_up.pdf&quot;</span><span class="punctuation">,</span>p<span class="punctuation">,</span>width <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span>height <span class="operator">=</span> <span class="number">7</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="火山图"><strong>火山图</strong></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">setwd<span class="punctuation">(</span><span class="string">&#x27;../huoshantuGGplot/&#x27;</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">diff_stat <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;diff_stat.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##横轴 log2 Fold Change（log2FC），纵轴 -log10 FDR（-log10(FDR)）</span></span><br><span class="line"><span class="comment">#散点图轮廓</span></span><br><span class="line">p1 <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>diff_stat<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> log2FC<span class="punctuation">,</span> y <span class="operator">=</span> <span class="operator">-</span>log10<span class="punctuation">(</span>FDR<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;log2 Fold Change&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;-log10 FDR p-value&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p1</span><br><span class="line"></span><br><span class="line"><span class="comment">#根据差异水平赋值颜色，例如 |log2FC| &gt;= 1 &amp; FDR p-value &lt; 0.05</span></span><br><span class="line">diff_stat<span class="punctuation">[</span>which<span class="punctuation">(</span>diff_stat<span class="operator">$</span>FDR <span class="operator">&lt;</span> <span class="number">0.05</span> <span class="operator">&amp;</span> diff_stat<span class="operator">$</span>log2FC <span class="operator">&gt;=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;diff&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;up&#x27;</span></span><br><span class="line">diff_stat<span class="punctuation">[</span>which<span class="punctuation">(</span>diff_stat<span class="operator">$</span>FDR <span class="operator">&lt;</span> <span class="number">0.05</span> <span class="operator">&amp;</span> diff_stat<span class="operator">$</span>log2FC <span class="operator">&lt;=</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;diff&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;dowm&#x27;</span></span><br><span class="line">diff_stat<span class="punctuation">[</span><span class="operator">!</span><span class="punctuation">(</span>diff_stat<span class="operator">$</span>diff <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;up&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;dowm&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;diff&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;no&#x27;</span></span><br><span class="line"></span><br><span class="line">p1 <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>diff_stat<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> log2FC<span class="punctuation">,</span> y <span class="operator">=</span> <span class="operator">-</span>log10<span class="punctuation">(</span>FDR<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> diff<span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_colour_manual<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;up&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;dowm&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;no&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray40&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;Enriched OTUs&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Depleted OTUs&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;No diff OTUs&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;log2 Fold Change&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;-log10 FDR p-value&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p1</span><br><span class="line"></span><br><span class="line"><span class="comment">#背景外观，调整示例</span></span><br><span class="line">p1 <span class="operator">&lt;-</span> p1 <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid.major <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_vline<span class="punctuation">(</span>xintercept <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="operator">-</span>log10<span class="punctuation">(</span><span class="number">0.05</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p1</span><br><span class="line"></span><br><span class="line"><span class="comment">#图例，调整示例</span></span><br><span class="line">p1 <span class="operator">&lt;-</span> p1 <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.position <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.2</span><span class="punctuation">,</span> <span class="number">0.9</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p1</span><br><span class="line"></span><br><span class="line"><span class="comment">#输出图片至本地</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;volcano_plot1.pdf&#x27;</span><span class="punctuation">,</span> p1<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">3.5</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">4.5</span><span class="punctuation">)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;volcano_plot1.png&#x27;</span><span class="punctuation">,</span> p1<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">3.5</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">4.5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##横轴 log2 Fold Change（log2FC），纵轴 log10 baseMean（log10baseMean），示例</span></span><br><span class="line">p2 <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>diff_stat<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> log2FC<span class="punctuation">,</span> y <span class="operator">=</span> log10baseMean<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> diff<span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#绘制散点</span></span><br><span class="line">  scale_colour_manual<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;up&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;dowm&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;no&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray40&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;Enriched OTUs&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Depleted OTUs&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;No diff OTUs&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#赋值点的颜色，并设置图例展示标签</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;log2 Fold Change&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;log10 Average Abundance&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#设置坐标轴标题</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid.major <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span>	<span class="comment">#主体设置，包括背景、网格线、图例等的调整</span></span><br><span class="line"></span><br><span class="line">p2</span><br><span class="line"></span><br><span class="line"><span class="comment">#如需翻转 x、y 轴</span></span><br><span class="line">p2 <span class="operator">+</span> coord_flip<span class="punctuation">(</span><span class="punctuation">)</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">#带分面的火山图示例</span></span><br><span class="line"><span class="comment">#这里把上述数据框“diff_stat”重复上 3 次，且当作 3 个不同分组的比较结果吧，仅用于演示分面图</span></span><br><span class="line">dat1 <span class="operator">&lt;-</span> diff_stat</span><br><span class="line">dat1<span class="operator">$</span>group <span class="operator">&lt;-</span> <span class="string">&#x27;group1 vs 2&#x27;</span></span><br><span class="line">gene <span class="operator">&lt;-</span> diff_stat</span><br><span class="line">gene<span class="operator">$</span>group <span class="operator">&lt;-</span> <span class="string">&#x27;group2 vs 3&#x27;</span></span><br><span class="line">dat3 <span class="operator">&lt;-</span> diff_stat</span><br><span class="line">dat3<span class="operator">$</span>group <span class="operator">&lt;-</span> <span class="string">&#x27;group1 vs 3&#x27;</span></span><br><span class="line">dat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>dat1<span class="punctuation">,</span> gene<span class="punctuation">,</span> dat3<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p3 <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>dat<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> log2FC<span class="punctuation">,</span> y <span class="operator">=</span> log10baseMean<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> diff<span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#绘制散点（这里隐藏了图例）</span></span><br><span class="line">  scale_colour_manual<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;up&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;dowm&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;no&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray40&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;Enriched OTUs&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Depleted OTUs&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;No diff OTUs&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#赋值点的颜色，并设置图例展示标签</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;log2 Fold Change&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;log10 Average Abundance&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#设置坐标轴标题</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid.major <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#主体设置，包括背景、网格线、图例等的调整</span></span><br><span class="line">  coord_flip<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#翻转坐标轴</span></span><br><span class="line">  facet_wrap<span class="punctuation">(</span><span class="operator">~</span>group<span class="punctuation">,</span> ncol <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> scale <span class="operator">=</span> <span class="string">&#x27;free&#x27;</span><span class="punctuation">)</span>	<span class="comment">#添加分面，根据数据中 group 列的信息将图片划分为 3 列展示</span></span><br><span class="line"></span><br><span class="line">p3</span><br><span class="line"></span><br><span class="line"><span class="comment">#输出图片至本地</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;volcano_plot2.pdf&#x27;</span><span class="punctuation">,</span> p2<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">4.5</span><span class="punctuation">)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;volcano_plot2.png&#x27;</span><span class="punctuation">,</span> p2<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">4.5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##grid 多图组合示例</span></span><br><span class="line">library<span class="punctuation">(</span>grid<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">png<span class="punctuation">(</span><span class="string">&#x27;volcano_plot.png&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">2300</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">1500</span><span class="punctuation">,</span> res <span class="operator">=</span> <span class="number">300</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&#x27;px&#x27;</span><span class="punctuation">)</span></span><br><span class="line">grid.newpage<span class="punctuation">(</span><span class="punctuation">)</span>	<span class="comment">#新建画板</span></span><br><span class="line">pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>layout <span class="operator">=</span> grid.layout<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span>	<span class="comment">#分割画板为两片区域，分别放置 p1 和 p2</span></span><br><span class="line">print<span class="punctuation">(</span>p1<span class="punctuation">,</span> vp <span class="operator">=</span> viewport<span class="punctuation">(</span>layout.pos.row <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> layout.pos.col <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span>	<span class="comment">#放置 p1</span></span><br><span class="line">print<span class="punctuation">(</span>p2 <span class="operator">+</span> guides<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;none&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> vp <span class="operator">=</span> viewport<span class="punctuation">(</span>layout.pos.row <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> layout.pos.col <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span>	<span class="comment">#放置 p2，两张图共用一张图例即可，组合时顺便去掉 p2 的图例</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##带双 logFC 信息的二维散点图</span></span><br><span class="line"><span class="comment">#读取另一个作图数据</span></span><br><span class="line">gene <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;gene_two.csv&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#标记显著性（默认 p &lt; 0.05）</span></span><br><span class="line">gene<span class="punctuation">[</span>which<span class="punctuation">(</span>gene<span class="operator">$</span>FDR_A <span class="operator">&lt;</span> <span class="number">0.05</span> <span class="operator">&amp;</span> gene<span class="operator">$</span>FDR_B <span class="operator">&lt;</span> <span class="number">0.05</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;sign&#x27;</span></span><br><span class="line">gene<span class="punctuation">[</span>which<span class="punctuation">(</span>gene<span class="operator">$</span>FDR_A <span class="operator">&gt;=</span> <span class="number">0.05</span> <span class="operator">|</span> gene<span class="operator">$</span>FDR_B <span class="operator">&gt;=</span> <span class="number">0.05</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;no&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#标记差异倍数（默认 |log2FC| &gt;= 1）</span></span><br><span class="line">gene<span class="punctuation">[</span>which<span class="punctuation">(</span>gene<span class="operator">$</span>logFC_A <span class="operator">&lt;=</span> <span class="operator">-</span><span class="number">1</span> <span class="operator">&amp;</span> gene<span class="operator">$</span>logFC_B <span class="operator">&lt;=</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;a_down.b_down&#x27;</span></span><br><span class="line">gene<span class="punctuation">[</span>which<span class="punctuation">(</span>gene<span class="operator">$</span>logFC_A <span class="operator">&gt;=</span> <span class="number">1</span> <span class="operator">&amp;</span> gene<span class="operator">$</span>logFC_B <span class="operator">&lt;=</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;a_up.b_down&#x27;</span></span><br><span class="line">gene<span class="punctuation">[</span>which<span class="punctuation">(</span>gene<span class="operator">$</span>logFC_A <span class="operator">&lt;=</span> <span class="operator">-</span><span class="number">1</span> <span class="operator">&amp;</span> gene<span class="operator">$</span>logFC_B <span class="operator">&gt;=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;a_down.b_up&#x27;</span></span><br><span class="line">gene<span class="punctuation">[</span>which<span class="punctuation">(</span>gene<span class="operator">$</span>logFC_A <span class="operator">&gt;=</span> <span class="number">1</span> <span class="operator">&amp;</span> gene<span class="operator">$</span>logFC_B <span class="operator">&gt;=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;a_up_b_up&#x27;</span></span><br><span class="line">gene<span class="punctuation">[</span><span class="built_in">is.na</span><span class="punctuation">(</span>gene<span class="operator">$</span>type2<span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;no&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#合并显著性和差异倍数，用于标记差异基因</span></span><br><span class="line">gene<span class="operator">$</span>type3 <span class="operator">&lt;-</span> paste<span class="punctuation">(</span>gene<span class="operator">$</span>type1<span class="punctuation">,</span> gene<span class="operator">$</span>type2<span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;.&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#排序，为了使作图时显著的点绘制在前方（减少被遮盖）</span></span><br><span class="line">gene<span class="operator">$</span>type3 <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>gene<span class="operator">$</span>type3<span class="punctuation">,</span> levels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;sign.a_down.b_down&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;sign.a_up.b_down&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;sign.a_down.b_up&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;sign.a_up_b_up&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;no.a_down.b_down&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;no.a_up.b_down&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;no.a_down.b_up&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;no.a_up_b_up&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;sign.no&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;no.no&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">gene <span class="operator">&lt;-</span> gene<span class="punctuation">[</span>order<span class="punctuation">(</span>gene<span class="operator">$</span>type3<span class="punctuation">,</span> decreasing <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggplot2 作图</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>gene<span class="punctuation">,</span> aes<span class="punctuation">(</span>logFC_A<span class="punctuation">,</span> logFC_B<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> type3<span class="punctuation">,</span> size <span class="operator">=</span> logCPM<span class="punctuation">)</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">,</span> show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#设置点颜色（按基因差异类型）、大小（按基因表达量 CPM 值），透明度，并取消图例</span></span><br><span class="line">  scale_size<span class="punctuation">(</span><span class="built_in">range</span> <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#控制点大小的范围</span></span><br><span class="line">  scale_color_manual<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;sign.a_down.b_down&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;sign.a_up.b_down&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;sign.a_down.b_up&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;sign.a_up_b_up&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;no.a_down.b_down&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;no.a_up.b_down&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;no.a_down.b_up&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;no.a_up_b_up&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;sign.no&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;no.no&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;purple&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#根据不同类型赋值颜色</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#调整背景</span></span><br><span class="line">  geom_vline<span class="punctuation">(</span>xintercept <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> lty <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> lty <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;log2FC (group A vs C)&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;log2FC (group B vs C)&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p</span><br><span class="line"></span><br><span class="line">p <span class="operator">&lt;-</span> p <span class="operator">+</span>	<span class="comment">#在合适的位置添加文字标记（当然，选择 AI、PS 后续添加也很方便）</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span> label <span class="operator">=</span> <span class="string">&#x27;A Down\nB Down&#x27;</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">7</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">9</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span> label <span class="operator">=</span> <span class="string">&#x27;A Down\nB Up&#x27;</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">7</span><span class="punctuation">,</span> <span class="number">12</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span> label <span class="operator">=</span> <span class="string">&#x27;A Up\nB Down&#x27;</span><span class="punctuation">,</span> <span class="number">9</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">9</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span> label <span class="operator">=</span> <span class="string">&#x27;A Up\nB Up&#x27;</span><span class="punctuation">,</span> <span class="number">9</span><span class="punctuation">,</span> <span class="number">12</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="deseq2"><strong>Deseq2</strong></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#建立与 Bioconductor 连接</span></span><br><span class="line">source<span class="punctuation">(</span><span class="string">&#x27;https://bioconductor.org/biocLite.R&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#若连接失败可更换下面命令试下</span></span><br><span class="line">source<span class="punctuation">(</span><span class="string">&#x27;http://bioconductor.org/biocLite.R&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#安装 DESeq2</span></span><br><span class="line">biocLite<span class="punctuation">(</span><span class="string">&#x27;DESeq2&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">###############################################</span></span><br><span class="line">library<span class="punctuation">(</span>DESeq2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>grid<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##导入 OTU 丰度表和分组文件</span></span><br><span class="line">otu_file <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;otu_table.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">group_file <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;group.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##DESeq2 默认流程，可使用 ?DESeqDataSet 等查看更多内容</span></span><br><span class="line"><span class="comment">#第一步，构建 DESeqDataSet 对象</span></span><br><span class="line">dds <span class="operator">&lt;-</span> DESeqDataSetFromMatrix<span class="punctuation">(</span>countData <span class="operator">=</span> otu_file<span class="punctuation">,</span> colData <span class="operator">=</span> group_file<span class="punctuation">,</span> design <span class="operator">=</span> <span class="operator">~</span>group<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#第二步，差异分析</span></span><br><span class="line">dds <span class="operator">&lt;-</span> DESeq<span class="punctuation">(</span>dds<span class="punctuation">)</span></span><br><span class="line">suppressMessages<span class="punctuation">(</span>dds<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#第三步，提取结果</span></span><br><span class="line">res <span class="operator">&lt;-</span> results<span class="punctuation">(</span>dds<span class="punctuation">,</span> contrast<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;group&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;treat&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;control&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#简要查看结果</span></span><br><span class="line">res</span><br><span class="line"><span class="comment">#或</span></span><br><span class="line">summary<span class="punctuation">(</span>res<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##结果提取</span></span><br><span class="line">deseq_res <span class="operator">&lt;-</span> as.data.frame<span class="punctuation">(</span>res<span class="punctuation">[</span>order<span class="punctuation">(</span>res<span class="operator">$</span>padj<span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#可选使用下命令将“baseMean”这一列转化为相对丰度数值</span></span><br><span class="line"><span class="comment">#deseq_res$baseMean &lt;- deseq_res$baseMean / sum(deseq_res$baseMean)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line">deseq_res<span class="operator">$</span>otu_id <span class="operator">&lt;-</span> rownames<span class="punctuation">(</span>deseq_res<span class="punctuation">)</span></span><br><span class="line">write.table<span class="punctuation">(</span>deseq_res<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">7</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="string">&#x27;DESeq2.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##ggplot2 差异火山图</span></span><br><span class="line"><span class="comment">#统计类型归类（根据 |log2FC| &gt;= 1 &amp; FDR p-value &lt; 0.05 ）</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span>nrow<span class="punctuation">(</span>deseq_res<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	<span class="keyword">if</span> <span class="punctuation">(</span><span class="built_in">abs</span><span class="punctuation">(</span>deseq_res<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;log2FoldChange&#x27;</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">&gt;=</span> <span class="number">1</span><span class="punctuation">)</span> deseq_res<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;select_change&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;y&#x27;</span> <span class="keyword">else</span> deseq_res<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;select_change&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;n&#x27;</span></span><br><span class="line">	<span class="keyword">if</span> <span class="punctuation">(</span>deseq_res<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;padj&#x27;</span><span class="punctuation">]</span> <span class="operator">%in%</span> <span class="literal">NA</span> <span class="operator">|</span> <span class="built_in">abs</span><span class="punctuation">(</span>deseq_res<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;padj&#x27;</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">&gt;=</span> <span class="number">0.05</span><span class="punctuation">)</span> deseq_res<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;select_pvalue&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;n&#x27;</span> <span class="keyword">else</span> deseq_res<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;select_pvalue&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;y&#x27;</span></span><br><span class="line">	deseq_res<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;select&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> paste<span class="punctuation">(</span>deseq_res<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;select_change&#x27;</span><span class="punctuation">]</span><span class="punctuation">,</span> deseq_res<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;select_pvalue&#x27;</span><span class="punctuation">]</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">deseq_res<span class="operator">$</span>select <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>deseq_res<span class="operator">$</span>select<span class="punctuation">,</span> levels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;nn&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;ny&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;yn&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;yy&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;p &gt;= 0.05, FC &lt; 2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;p &lt; 0.05, FC &lt; 2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;p &gt;= 0.05, FC &gt;= 2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;p &lt; 0.05, FC &gt;= 2&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#纵轴为显著性 p 值</span></span><br><span class="line">volcano_plot_pvalue <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>deseq_res<span class="punctuation">,</span> aes<span class="punctuation">(</span>log2FoldChange<span class="punctuation">,</span> <span class="operator">-</span><span class="built_in">log</span><span class="punctuation">(</span>padj<span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> select<span class="punctuation">)</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">,</span> show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_color_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;gray30&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green4&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue2&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_vline<span class="punctuation">(</span>xintercept <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="operator">-</span><span class="built_in">log</span><span class="punctuation">(</span><span class="number">0.05</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;log2 Fold Change&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;-log10 p-value&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#纵轴为 OTU 丰度</span></span><br><span class="line">volcano_plot_abundance <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>deseq_res<span class="punctuation">,</span> aes<span class="punctuation">(</span>log2FoldChange<span class="punctuation">,</span> <span class="number">100</span> <span class="operator">*</span> baseMean <span class="operator">/</span> <span class="built_in">sum</span><span class="punctuation">(</span>deseq_res<span class="operator">$</span>baseMean<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> select<span class="punctuation">)</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_color_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;gray30&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green4&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue2&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_vline<span class="punctuation">(</span>xintercept <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;log2 Fold Change&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;Abundance (%)&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#输出单图</span></span><br><span class="line"><span class="comment">#ggsave(&#x27;volcano_plot_pvalue.pdf&#x27;, volcano_plot_pvalue, width = 5, height = 5)</span></span><br><span class="line"><span class="comment">#ggsave(&#x27;volcano_plot_abundance.png&#x27;, volcano_plot_abundance, width = 5, height = 5)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#组合并输出</span></span><br><span class="line">png<span class="punctuation">(</span><span class="string">&#x27;volcano_plot.png&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">3000</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">1600</span><span class="punctuation">,</span> res <span class="operator">=</span> <span class="number">300</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&#x27;px&#x27;</span><span class="punctuation">)</span></span><br><span class="line">	grid.newpage<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>layout <span class="operator">=</span> grid.layout<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">	print<span class="punctuation">(</span>volcano_plot_pvalue<span class="punctuation">,</span> vp <span class="operator">=</span> viewport<span class="punctuation">(</span>layout.pos.row <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> layout.pos.col <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">	print<span class="punctuation">(</span>volcano_plot_abundance<span class="punctuation">,</span> vp <span class="operator">=</span> viewport<span class="punctuation">(</span>layout.pos.row <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> layout.pos.col <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="镜面柱形图"><strong>镜面柱形图</strong></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>reshape2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>doBy<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#读入数据，合并数据</span></span><br><span class="line">plant30 <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;30days.csv&#x27;</span><span class="punctuation">)</span></span><br><span class="line">plant30<span class="operator">$</span>days <span class="operator">&lt;-</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&#x27;30&#x27;</span><span class="punctuation">,</span> nrow<span class="punctuation">(</span>plant30<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">plant45 <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;45days.csv&#x27;</span><span class="punctuation">)</span></span><br><span class="line">plant45<span class="operator">$</span>days <span class="operator">&lt;-</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&#x27;45&#x27;</span><span class="punctuation">,</span> nrow<span class="punctuation">(</span>plant45<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">plant60 <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;60days.csv&#x27;</span><span class="punctuation">)</span></span><br><span class="line">plant60<span class="operator">$</span>days <span class="operator">&lt;-</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&#x27;60&#x27;</span><span class="punctuation">,</span> nrow<span class="punctuation">(</span>plant60<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">plant75 <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;75days.csv&#x27;</span><span class="punctuation">)</span></span><br><span class="line">plant75<span class="operator">$</span>days <span class="operator">&lt;-</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&#x27;75&#x27;</span><span class="punctuation">,</span> nrow<span class="punctuation">(</span>plant75<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">plant90 <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;90days.csv&#x27;</span><span class="punctuation">)</span></span><br><span class="line">plant90<span class="operator">$</span>days <span class="operator">&lt;-</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&#x27;90&#x27;</span><span class="punctuation">,</span> nrow<span class="punctuation">(</span>plant90<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">plant_all <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>plant30<span class="punctuation">,</span> plant45<span class="punctuation">,</span> plant60<span class="punctuation">,</span> plant75<span class="punctuation">,</span> plant90<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#统计均值、标准差</span></span><br><span class="line">plant_all <span class="operator">&lt;-</span> melt<span class="punctuation">(</span>plant_all<span class="punctuation">,</span> id <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;plant&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;days&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">plant_all_stat <span class="operator">&lt;-</span> summaryBy<span class="punctuation">(</span>value<span class="operator">~</span>variable<span class="operator">+</span>plant<span class="operator">+</span>days<span class="punctuation">,</span> plant_all<span class="punctuation">,</span> FUN <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>mean<span class="punctuation">,</span> sd<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#作图</span></span><br><span class="line">plant_all_stat<span class="punctuation">[</span>which<span class="punctuation">(</span>plant_all_stat<span class="operator">$</span>variable <span class="operator">==</span> <span class="string">&#x27;root_length&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;value.mean&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;value.sd&#x27;</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> plant_all_stat<span class="punctuation">[</span>which<span class="punctuation">(</span>plant_all_stat<span class="operator">$</span>variable <span class="operator">==</span> <span class="string">&#x27;root_length&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;value.mean&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;value.sd&#x27;</span><span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">*</span> <span class="operator">-</span><span class="number">1</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>plant_all_stat<span class="punctuation">,</span> aes<span class="punctuation">(</span>days<span class="punctuation">,</span> value.mean<span class="punctuation">,</span> fill <span class="operator">=</span> plant<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_col<span class="punctuation">(</span>position <span class="operator">=</span> position_dodge<span class="punctuation">(</span>width <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#柱形图绘制</span></span><br><span class="line">  geom_errorbar<span class="punctuation">(</span>aes<span class="punctuation">(</span>ymin <span class="operator">=</span> value.mean <span class="operator">-</span> value.sd<span class="punctuation">,</span> ymax <span class="operator">=</span> value.mean <span class="operator">+</span> value.sd<span class="punctuation">)</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> position <span class="operator">=</span> position_dodge<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#误差线绘制</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> 	<span class="comment">#调整背景</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;Time (days)&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;Length (cm)&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#设置坐标轴标签</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#在 y = 0 处添加横线</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> seq<span class="punctuation">(</span><span class="operator">-</span><span class="number">45</span><span class="punctuation">,</span> <span class="number">45</span><span class="punctuation">,</span> <span class="number">15</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">as.character</span><span class="punctuation">(</span><span class="built_in">abs</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="operator">-</span><span class="number">45</span><span class="punctuation">,</span> <span class="number">45</span><span class="punctuation">,</span> <span class="number">15</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">45</span><span class="punctuation">,</span> <span class="number">45</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#调整纵轴刻度</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span>label <span class="operator">=</span> <span class="string">&#x27;Stem&#x27;</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">43</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#这两句添加“Stem”和“Root”标签</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span>label <span class="operator">=</span> <span class="string">&#x27;Root&#x27;</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">43</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;plant.pdf&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;plant.png&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##############################</span></span><br><span class="line"><span class="comment">#在统计均值、标准差之前，也可先将根长数据取负值</span></span><br><span class="line">plant_all <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>plant30<span class="punctuation">,</span> plant45<span class="punctuation">,</span> plant60<span class="punctuation">,</span> plant75<span class="punctuation">,</span> plant90<span class="punctuation">)</span></span><br><span class="line">plant_all<span class="operator">$</span>root_length <span class="operator">&lt;-</span> plant_all<span class="operator">$</span>root_length <span class="operator">*</span> <span class="operator">-</span><span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#统计均值、标准差</span></span><br><span class="line">plant_all <span class="operator">&lt;-</span> melt<span class="punctuation">(</span>plant_all<span class="punctuation">,</span> id <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;plant&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;days&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">plant_all_stat <span class="operator">&lt;-</span> summaryBy<span class="punctuation">(</span>value<span class="operator">~</span>variable<span class="operator">+</span>plant<span class="operator">+</span>days<span class="punctuation">,</span> plant_all<span class="punctuation">,</span> FUN <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>mean<span class="punctuation">,</span> sd<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#作图</span></span><br><span class="line">ggplot<span class="punctuation">(</span>plant_all_stat<span class="punctuation">,</span> aes<span class="punctuation">(</span>days<span class="punctuation">,</span> value.mean<span class="punctuation">,</span> fill <span class="operator">=</span> plant<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_col<span class="punctuation">(</span>position <span class="operator">=</span> position_dodge<span class="punctuation">(</span>width <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#柱形图绘制</span></span><br><span class="line">  geom_errorbar<span class="punctuation">(</span>aes<span class="punctuation">(</span>ymin <span class="operator">=</span> value.mean <span class="operator">-</span> value.sd<span class="punctuation">,</span> ymax <span class="operator">=</span> value.mean <span class="operator">+</span> value.sd<span class="punctuation">)</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> position <span class="operator">=</span> position_dodge<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#误差线绘制</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> 	<span class="comment">#调整背景</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;Time (days)&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;Length (cm)&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#设置坐标轴标签</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#在 y = 0 处添加横线</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> seq<span class="punctuation">(</span><span class="operator">-</span><span class="number">45</span><span class="punctuation">,</span> <span class="number">45</span><span class="punctuation">,</span> <span class="number">15</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">as.character</span><span class="punctuation">(</span><span class="built_in">abs</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="operator">-</span><span class="number">45</span><span class="punctuation">,</span> <span class="number">45</span><span class="punctuation">,</span> <span class="number">15</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">45</span><span class="punctuation">,</span> <span class="number">45</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#调整纵轴刻度</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span>label <span class="operator">=</span> <span class="string">&#x27;Stem&#x27;</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">43</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#这两句添加“Stem”和“Root”标签</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span>label <span class="operator">=</span> <span class="string">&#x27;Root&#x27;</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">43</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;plant.pdf&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;plant.png&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="丰度饼图">丰度饼图</h3>
<p><a href="https://mp.weixin.qq.com/s/s7umGxtvNhJljhTPXVafVQ">patternplot包：用ggplot解决你对线性填充，不！所有填充的全部幻想</a></p>
<img src="/2023/10/31/ggplot-picture/Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200610091212834.png" alt="image-20200610091212834" style="zoom:50%;">
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">############################################</span></span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">phylum <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;phylum.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##pie()</span></span><br><span class="line"><span class="comment">#pdf(&#x27;pie_plot.pdf&#x27;)</span></span><br><span class="line">png<span class="punctuation">(</span><span class="string">&#x27;pie_plot.png&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">2000</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">2000</span><span class="punctuation">,</span> res <span class="operator">=</span> <span class="number">300</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&#x27;px&#x27;</span><span class="punctuation">)</span></span><br><span class="line">par<span class="punctuation">(</span>mar <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">pie<span class="punctuation">(</span>phylum<span class="operator">$</span>a1<span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;purple&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> phylum<span class="operator">$</span>phylum<span class="punctuation">,</span> font <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;Sample: a1\nPhylum level&#x27;</span><span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##pie3D()</span></span><br><span class="line">library<span class="punctuation">(</span>plotrix<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pdf(&#x27;pie3D_plot.pdf&#x27;, width = 6.5, height = 6)</span></span><br><span class="line">png<span class="punctuation">(</span><span class="string">&#x27;pie3D_plot.png&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">2100</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">2000</span><span class="punctuation">,</span> res <span class="operator">=</span> <span class="number">300</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&#x27;px&#x27;</span><span class="punctuation">)</span></span><br><span class="line">pie3D<span class="punctuation">(</span>phylum<span class="operator">$</span>a1<span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;purple&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> explode <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">,</span> radius <span class="operator">=</span> <span class="number">0.85</span><span class="punctuation">,</span> labels <span class="operator">=</span> phylum<span class="operator">$</span>phylum<span class="punctuation">,</span> labelcex <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;Sample: a1\nPhylum level&#x27;</span><span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##fan.plot()</span></span><br><span class="line">library<span class="punctuation">(</span>plotrix<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pdf(&#x27;fan_plot.pdf&#x27;)</span></span><br><span class="line">png<span class="punctuation">(</span><span class="string">&#x27;fan_plot.png&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">2000</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">2000</span><span class="punctuation">,</span> res <span class="operator">=</span> <span class="number">300</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&#x27;px&#x27;</span><span class="punctuation">)</span></span><br><span class="line">fan.plot<span class="punctuation">(</span>phylum<span class="operator">$</span>a1<span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;purple&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> phylum<span class="operator">$</span>phylum<span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;Sample: a1\nPhylum level&#x27;</span><span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##ggplot2</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>phylum<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> a1<span class="punctuation">,</span> fill <span class="operator">=</span> phylum<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">geom_bar<span class="punctuation">(</span>stat <span class="operator">=</span> <span class="string">&#x27;identity&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">coord_polar<span class="punctuation">(</span>theta <span class="operator">=</span> <span class="string">&#x27;y&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_fill_manual<span class="punctuation">(</span>values <span class="operator">=</span> rev<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;purple&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.text.x <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>legend.text <span class="operator">=</span> element_text<span class="punctuation">(</span>face <span class="operator">=</span> <span class="string">&#x27;italic&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&#x27;Sample: a1&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;Phylum&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggsave(&#x27;ggplot2_plot.pdf&#x27;, p, width = 5, height = 5)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;ggplot2_plot.png&#x27;</span><span class="punctuation">,</span> p<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">############################################</span></span><br><span class="line"><span class="comment">#一个组合样式的 ggplot2 饼图示例</span></span><br><span class="line">library<span class="punctuation">(</span>doBy<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>grid<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##预处理</span></span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">abundance <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;abundance.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#按类群丰度排序</span></span><br><span class="line">abundance<span class="operator">$</span>abundance_sum <span class="operator">&lt;-</span> apply<span class="punctuation">(</span>abundance<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="built_in">sum</span><span class="punctuation">)</span></span><br><span class="line">stat <span class="operator">&lt;-</span> summaryBy<span class="punctuation">(</span>abundance_sum<span class="operator">~</span>phylum<span class="punctuation">,</span> abundance<span class="punctuation">,</span> FUN <span class="operator">=</span> <span class="built_in">sum</span><span class="punctuation">)</span></span><br><span class="line">abundance<span class="operator">$</span>phylum <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>abundance<span class="operator">$</span>phylum<span class="punctuation">,</span> levels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="punctuation">&#123;</span>stat<span class="punctuation">[</span>order<span class="punctuation">(</span>stat<span class="operator">$</span>abundance_sum.sum<span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span><span class="punctuation">&#125;</span><span class="operator">$</span>phylum<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">abundance <span class="operator">&lt;-</span> abundance<span class="punctuation">[</span>order<span class="punctuation">(</span>abundance<span class="operator">$</span>phylum<span class="punctuation">,</span> abundance<span class="operator">$</span>abundance_sum<span class="punctuation">,</span> decreasing <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#挑选 top10 属</span></span><br><span class="line">top10_genus <span class="operator">&lt;-</span> as.vector<span class="punctuation">(</span>abundance<span class="punctuation">[</span>order<span class="punctuation">(</span>abundance<span class="operator">$</span>abundance_sum<span class="punctuation">,</span> decreasing <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span><span class="operator">$</span>genus<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##ggplot2 饼图</span></span><br><span class="line">abundance<span class="operator">$</span>phylum <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>abundance<span class="operator">$</span>phylum<span class="punctuation">,</span> levels <span class="operator">=</span> rev<span class="punctuation">(</span>levels<span class="punctuation">(</span>abundance<span class="operator">$</span>phylum<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">abundance<span class="operator">$</span>genus <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>abundance<span class="operator">$</span>genus<span class="punctuation">,</span> levels <span class="operator">=</span> as.vector<span class="punctuation">(</span>abundance<span class="operator">$</span>genus<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#定义颜色</span></span><br><span class="line"><span class="comment">#length(unique(abundance$phylum))</span></span><br><span class="line"><span class="comment">#length(unique(abundance$genus))</span></span><br><span class="line">color_phylum <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;yellow2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;purple&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">)</span></span><br><span class="line">color_genus <span class="operator">&lt;-</span> sample<span class="punctuation">(</span>colors<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">50</span><span class="punctuation">,</span> replace <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span>	<span class="comment">#随机颜色</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#定义函数，#在 ggplot2 中提取图例，参考自</span></span><br><span class="line"><span class="comment">#https://stackoverflow.com/questions/13712574/how-to-change-position-of-grid-draw</span></span><br><span class="line">g_legend <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>gg_plot<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    tmp <span class="operator">&lt;-</span> ggplot_gtable<span class="punctuation">(</span>ggplot_build<span class="punctuation">(</span>gg_plot<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">    leg <span class="operator">&lt;-</span> which<span class="punctuation">(</span>sapply<span class="punctuation">(</span>tmp<span class="operator">$</span>grobs<span class="punctuation">,</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">)</span> x<span class="operator">$</span>name<span class="punctuation">)</span> <span class="operator">==</span> <span class="string">&#x27;guide-box&#x27;</span><span class="punctuation">)</span></span><br><span class="line">    leg <span class="operator">&lt;-</span> tmp<span class="operator">$</span>grobs<span class="punctuation">[[</span>leg<span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line">    leg</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#内饼（属）</span></span><br><span class="line">genus <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>abundance<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> a1<span class="punctuation">,</span> fill <span class="operator">=</span> genus<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">geom_bar<span class="punctuation">(</span>stat <span class="operator">=</span> <span class="string">&#x27;identity&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">coord_polar<span class="punctuation">(</span>theta <span class="operator">=</span> <span class="string">&#x27;y&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_fill_manual<span class="punctuation">(</span>values <span class="operator">=</span> color_genus<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.text.x <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> plot.background <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.text <span class="operator">=</span> element_text<span class="punctuation">(</span>face <span class="operator">=</span> <span class="string">&#x27;italic&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;top10 genus&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">genus_pie <span class="operator">&lt;-</span> genus <span class="operator">+</span> theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&#x27;none&#x27;</span><span class="punctuation">)</span></span><br><span class="line">genus_legend <span class="operator">&lt;-</span> g_legend<span class="punctuation">(</span>genus <span class="operator">+</span> scale_fill_manual<span class="punctuation">(</span>values <span class="operator">=</span> color_genus<span class="punctuation">[</span>which<span class="punctuation">(</span>abundance<span class="operator">$</span>genus <span class="operator">%in%</span> top10_genus<span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span> limits <span class="operator">=</span> top10_genus<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#外环（门）</span></span><br><span class="line">phylum <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>abundance<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> a1<span class="punctuation">,</span> fill <span class="operator">=</span> phylum<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">geom_bar<span class="punctuation">(</span>stat <span class="operator">=</span> <span class="string">&#x27;identity&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">coord_polar<span class="punctuation">(</span>theta <span class="operator">=</span> <span class="string">&#x27;y&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_fill_manual<span class="punctuation">(</span>values <span class="operator">=</span> color_phylum<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.text.x <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> plot.background <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.text <span class="operator">=</span> element_text<span class="punctuation">(</span>face <span class="operator">=</span> <span class="string">&#x27;italic&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">phylum_pie <span class="operator">&lt;-</span> phylum <span class="operator">+</span> theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&#x27;none&#x27;</span><span class="punctuation">)</span></span><br><span class="line">phylum_legend <span class="operator">&lt;-</span> g_legend<span class="punctuation">(</span>phylum<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##grid 组合</span></span><br><span class="line"><span class="comment">#pdf(&#x27;grid_plot.pdf&#x27;, width = 7, height = 5)</span></span><br><span class="line">png<span class="punctuation">(</span><span class="string">&#x27;grid_plot.png&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">2500</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">1500</span><span class="punctuation">,</span> res <span class="operator">=</span> <span class="number">300</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&#x27;px&#x27;</span><span class="punctuation">)</span></span><br><span class="line">grid.newpage<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">print<span class="punctuation">(</span>phylum_pie<span class="punctuation">,</span> vp <span class="operator">=</span> viewport<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">1.6</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">1.6</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">print<span class="punctuation">(</span>genus_pie<span class="punctuation">,</span> vp <span class="operator">=</span> viewport<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">0.7</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">0.7</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">phylum_legend<span class="operator">$</span>vp<span class="operator">$</span>x <span class="operator">&lt;-</span> unit<span class="punctuation">(</span><span class="number">0.7</span><span class="punctuation">,</span> <span class="string">&#x27;npc&#x27;</span><span class="punctuation">)</span></span><br><span class="line">phylum_legend<span class="operator">$</span>vp<span class="operator">$</span>y <span class="operator">&lt;-</span> unit<span class="punctuation">(</span><span class="number">0.57</span><span class="punctuation">,</span> <span class="string">&#x27;npc&#x27;</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>phylum_legend<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">genus_legend<span class="operator">$</span>vp<span class="operator">$</span>x <span class="operator">&lt;-</span> unit<span class="punctuation">(</span><span class="number">0.9</span><span class="punctuation">,</span> <span class="string">&#x27;npc&#x27;</span><span class="punctuation">)</span></span><br><span class="line">genus_legend<span class="operator">$</span>vp<span class="operator">$</span>y <span class="operator">&lt;-</span> unit<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="string">&#x27;npc&#x27;</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>genus_legend<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="venn图"><strong>Venn图</strong></h3>
<h4 id="先制作分组文件-输入otu表类型文件"><strong>先制作分组文件  输入OTU表类型文件</strong></h4>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># make_veen_flower.R</span></span><br><span class="line"><span class="comment">#!/usr/bin/env Rscript</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#用法参考</span></span><br><span class="line"><span class="comment">#Rscript make_venn_flower.r otu_table.txt group1.txt venn.txt</span></span><br><span class="line"><span class="comment">#Rscript make_venn_flower.r otu_table.txt group2.txt flower.txt</span></span><br><span class="line"><span class="comment">#flower.txt 为单样品的分组   </span></span><br><span class="line"><span class="comment">#venn.txt 为每组的样品</span></span><br><span class="line">args <span class="operator">&lt;-</span> commandArgs<span class="punctuation">(</span><span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">otu <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>args<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">group <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>args<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>group<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;sample&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;group&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">group_id <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>group<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">result <span class="operator">&lt;-</span> <span class="literal">NULL</span></span><br><span class="line">len <span class="operator">=</span> <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> group_id<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	group_i <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>group<span class="punctuation">,</span> group <span class="operator">==</span> i<span class="punctuation">)</span></span><br><span class="line">	otu_i <span class="operator">&lt;-</span> otu<span class="punctuation">[</span>group_i<span class="operator">$</span>sample<span class="punctuation">]</span></span><br><span class="line">	otu_i <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>otu_i<span class="punctuation">,</span> rowSums<span class="punctuation">(</span>otu_i<span class="punctuation">)</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line">	otu_select <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>i<span class="punctuation">,</span> rownames<span class="punctuation">(</span>otu_i<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">	<span class="keyword">if</span> <span class="punctuation">(</span><span class="built_in">length</span><span class="punctuation">(</span>otu_select<span class="punctuation">)</span> <span class="operator">&gt;</span> len<span class="punctuation">)</span> len <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>otu_select<span class="punctuation">)</span></span><br><span class="line">	<span class="built_in">length</span><span class="punctuation">(</span>otu_select<span class="punctuation">)</span> <span class="operator">=</span> nrow<span class="punctuation">(</span>otu<span class="punctuation">)</span></span><br><span class="line">	result <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span>result<span class="punctuation">,</span> otu_select<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">result <span class="operator">&lt;-</span> result<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span>len<span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">write.table<span class="punctuation">(</span>result<span class="punctuation">,</span> args<span class="punctuation">[</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> col.names <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> na <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="制作venn图"><strong>制作Venn图</strong></h4>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">####韦恩图（VennDiagram 包，适用样本数 2-5）</span></span><br><span class="line">library<span class="punctuation">(</span>VennDiagram<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#读入作图文件，预处理</span></span><br><span class="line">venn_dat <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;venn.txt&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">venn_list <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span>venn_dat<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> venn_dat<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>venn_list<span class="punctuation">)</span> <span class="operator">&lt;-</span> colnames<span class="punctuation">(</span>venn_dat<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#作图</span></span><br><span class="line">venn.diagram<span class="punctuation">(</span>venn_list<span class="punctuation">,</span> filename <span class="operator">=</span> <span class="string">&#x27;venn.png&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.50</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> fontfamily <span class="operator">=</span> <span class="string">&#x27;serif&#x27;</span><span class="punctuation">,</span> cat.col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> cat.cex <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> cat.fontfamily <span class="operator">=</span> <span class="string">&#x27;serif&#x27;</span><span class="punctuation">,</span> margin <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">####韦恩图（venn 包，适用样本数 2-7）</span></span><br><span class="line">library<span class="punctuation">(</span>venn<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#读入作图文件，预处理</span></span><br><span class="line">venn_dat <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;flower.txt&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">7</span><span class="punctuation">]</span></span><br><span class="line">venn_list <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span>venn_dat<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> venn_dat<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> venn_dat<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">,</span> venn_dat<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">,</span> venn_dat<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">,</span> venn_dat<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">]</span><span class="punctuation">,</span> venn_dat<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">7</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>venn_list<span class="punctuation">)</span> <span class="operator">&lt;-</span> colnames<span class="punctuation">(</span>venn_dat<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#作图</span></span><br><span class="line">png<span class="punctuation">(</span><span class="string">&#x27;venn_7.png&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">1500</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">1500</span><span class="punctuation">,</span> res <span class="operator">=</span> <span class="number">200</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&#x27;px&#x27;</span><span class="punctuation">)</span></span><br><span class="line">venn<span class="punctuation">(</span>venn_list<span class="punctuation">,</span>zcolor<span class="operator">=</span><span class="string">&#x27;style&#x27;</span><span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">####韦恩图（UpSetR 包，不受样本数限制）</span></span><br><span class="line">library<span class="punctuation">(</span>UpSetR<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#读入作图文件，预处理</span></span><br><span class="line">otu <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;otu_table.txt&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">]</span></span><br><span class="line">otu<span class="punctuation">[</span>otu <span class="operator">&gt;</span> <span class="number">0</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#作图</span></span><br><span class="line">png<span class="punctuation">(</span><span class="string">&#x27;venn_10.png&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">1500</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">1500</span><span class="punctuation">,</span> res <span class="operator">=</span> <span class="number">200</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&#x27;px&#x27;</span><span class="punctuation">)</span></span><br><span class="line">upset<span class="punctuation">(</span>otu<span class="punctuation">,</span> nsets <span class="operator">=</span> <span class="number">12</span><span class="punctuation">,</span> order.by <span class="operator">=</span> <span class="string">&quot;freq&quot;</span><span class="punctuation">,</span>mainbar.y.label <span class="operator">=</span> <span class="string">&quot;IntersectionSize&quot;</span><span class="punctuation">,</span>sets.x.label <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span>point.size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span>line.size <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">####花瓣图</span></span><br><span class="line">library<span class="punctuation">(</span>plotrix<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#读入做图文件，预处理</span></span><br><span class="line">flower_dat <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;flower.txt&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">sample_id <span class="operator">&lt;-</span> colnames<span class="punctuation">(</span>flower_dat<span class="punctuation">)</span></span><br><span class="line">otu_id <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>flower_dat<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">otu_id <span class="operator">&lt;-</span> otu_id<span class="punctuation">[</span>otu_id <span class="operator">!=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">]</span></span><br><span class="line">core_otu_id <span class="operator">&lt;-</span> otu_id</span><br><span class="line">otu_num <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>otu_id<span class="punctuation">)</span></span><br><span class="line">ellipse_col <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#6181BD4E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#F348004E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#64A10E4E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#9300264E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#464E044E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#049a0b4E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#4E0C664E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#D000004E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#FF6C004E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#FF00FF4E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#c7475b4E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#00F5FF4E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#BDA5004E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#A5CFED4E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#f0301c4E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#2B8BC34E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#FDA1004E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#54adf54E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#CDD7E24E&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#9295C14E&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">2</span><span class="operator">:</span>ncol<span class="punctuation">(</span>flower_dat<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	otu_id <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>flower_dat<span class="punctuation">[</span><span class="punctuation">,</span>i<span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">	otu_id <span class="operator">&lt;-</span> otu_id<span class="punctuation">[</span>otu_id <span class="operator">!=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">]</span></span><br><span class="line">	core_otu_id <span class="operator">&lt;-</span> intersect<span class="punctuation">(</span>core_otu_id<span class="punctuation">,</span> otu_id<span class="punctuation">)</span></span><br><span class="line">	otu_num <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>otu_num<span class="punctuation">,</span> <span class="built_in">length</span><span class="punctuation">(</span>otu_id<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">core_num <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>core_otu_id<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#构建作图函数（参考自 https://www.cnblogs.com/xudongliang/p/7884667.html）</span></span><br><span class="line">flower_plot <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>sample<span class="punctuation">,</span> otu_num<span class="punctuation">,</span> core_otu<span class="punctuation">,</span> start<span class="punctuation">,</span> a<span class="punctuation">,</span> b<span class="punctuation">,</span> r<span class="punctuation">,</span> ellipse_col<span class="punctuation">,</span> circle_col<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	par<span class="punctuation">(</span> bty <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> ann <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span> xaxt <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> yaxt <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> mar <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">	plot<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span>type<span class="operator">=</span><span class="string">&#x27;n&#x27;</span><span class="punctuation">)</span></span><br><span class="line">	n   <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>sample<span class="punctuation">)</span></span><br><span class="line">	deg <span class="operator">&lt;-</span> 360 <span class="operator">/</span> n</span><br><span class="line">	res <span class="operator">&lt;-</span> lapply<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span>n<span class="punctuation">,</span> <span class="keyword">function</span><span class="punctuation">(</span>t<span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">		draw.ellipse<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">5</span> <span class="operator">+</span> <span class="built_in">cos</span><span class="punctuation">(</span><span class="punctuation">(</span>start <span class="operator">+</span> deg <span class="operator">*</span> <span class="punctuation">(</span>t <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">*</span> <span class="built_in">pi</span> <span class="operator">/</span> <span class="number">180</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">			y <span class="operator">=</span> <span class="number">5</span> <span class="operator">+</span> <span class="built_in">sin</span><span class="punctuation">(</span><span class="punctuation">(</span>start <span class="operator">+</span> deg <span class="operator">*</span> <span class="punctuation">(</span>t <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">*</span> <span class="built_in">pi</span> <span class="operator">/</span> <span class="number">180</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">			col <span class="operator">=</span> ellipse_col<span class="punctuation">[</span>t<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">			border <span class="operator">=</span> ellipse_col<span class="punctuation">[</span>t<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">			a <span class="operator">=</span> a<span class="punctuation">,</span> b <span class="operator">=</span> b<span class="punctuation">,</span> angle <span class="operator">=</span> deg <span class="operator">*</span> <span class="punctuation">(</span>t <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">		text<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">5</span> <span class="operator">+</span> <span class="number">2.5</span> <span class="operator">*</span> <span class="built_in">cos</span><span class="punctuation">(</span><span class="punctuation">(</span>start <span class="operator">+</span> deg <span class="operator">*</span> <span class="punctuation">(</span>t <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">*</span> <span class="built_in">pi</span> <span class="operator">/</span> <span class="number">180</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">			y <span class="operator">=</span> <span class="number">5</span> <span class="operator">+</span> <span class="number">2.5</span> <span class="operator">*</span> <span class="built_in">sin</span><span class="punctuation">(</span><span class="punctuation">(</span>start <span class="operator">+</span> deg <span class="operator">*</span> <span class="punctuation">(</span>t <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">*</span> <span class="built_in">pi</span> <span class="operator">/</span> <span class="number">180</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">			otu_num<span class="punctuation">[</span>t<span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span> <span class="punctuation">(</span>deg <span class="operator">*</span> <span class="punctuation">(</span>t <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">&lt;</span> <span class="number">180</span> <span class="operator">&amp;&amp;</span> deg <span class="operator">*</span> <span class="punctuation">(</span>t <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">&gt;</span> <span class="number">0</span> <span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">			text<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">5</span> <span class="operator">+</span> <span class="number">3.3</span> <span class="operator">*</span> <span class="built_in">cos</span><span class="punctuation">(</span><span class="punctuation">(</span>start <span class="operator">+</span> deg <span class="operator">*</span> <span class="punctuation">(</span>t <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">*</span> <span class="built_in">pi</span> <span class="operator">/</span> <span class="number">180</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">				y <span class="operator">=</span> <span class="number">5</span> <span class="operator">+</span> <span class="number">3.3</span> <span class="operator">*</span> <span class="built_in">sin</span><span class="punctuation">(</span><span class="punctuation">(</span>start <span class="operator">+</span> deg <span class="operator">*</span> <span class="punctuation">(</span>t <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">*</span> <span class="built_in">pi</span> <span class="operator">/</span> <span class="number">180</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">				sample<span class="punctuation">[</span>t<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">				srt <span class="operator">=</span> deg <span class="operator">*</span> <span class="punctuation">(</span>t <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">-</span> start<span class="punctuation">,</span></span><br><span class="line">				adj <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">				cex <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">				<span class="punctuation">)</span></span><br><span class="line">		<span class="punctuation">&#125;</span> <span class="keyword">else</span> <span class="punctuation">&#123;</span></span><br><span class="line">			text<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">5</span> <span class="operator">+</span> <span class="number">3.3</span> <span class="operator">*</span> <span class="built_in">cos</span><span class="punctuation">(</span><span class="punctuation">(</span>start <span class="operator">+</span> deg <span class="operator">*</span> <span class="punctuation">(</span>t <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">*</span> <span class="built_in">pi</span> <span class="operator">/</span> <span class="number">180</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">				y <span class="operator">=</span> <span class="number">5</span> <span class="operator">+</span> <span class="number">3.3</span> <span class="operator">*</span> <span class="built_in">sin</span><span class="punctuation">(</span><span class="punctuation">(</span>start <span class="operator">+</span> deg <span class="operator">*</span> <span class="punctuation">(</span>t <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">*</span> <span class="built_in">pi</span> <span class="operator">/</span> <span class="number">180</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">				sample<span class="punctuation">[</span>t<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">				srt <span class="operator">=</span> deg <span class="operator">*</span> <span class="punctuation">(</span>t <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span> start<span class="punctuation">,</span></span><br><span class="line">				adj <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">				cex <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">				<span class="punctuation">)</span></span><br><span class="line">		<span class="punctuation">&#125;</span>			</span><br><span class="line">	<span class="punctuation">&#125;</span><span class="punctuation">)</span></span><br><span class="line">	draw.circle<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> r <span class="operator">=</span> r<span class="punctuation">,</span> col <span class="operator">=</span> circle_col<span class="punctuation">,</span> border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span></span><br><span class="line">	text<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> paste<span class="punctuation">(</span><span class="string">&#x27;Core:&#x27;</span><span class="punctuation">,</span> core_otu<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#作图</span></span><br><span class="line">png<span class="punctuation">(</span><span class="string">&#x27;flower.png&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">1500</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">1500</span><span class="punctuation">,</span> res <span class="operator">=</span> <span class="number">200</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&#x27;px&#x27;</span><span class="punctuation">)</span></span><br><span class="line">flower_plot<span class="punctuation">(</span>sample <span class="operator">=</span> sample_id<span class="punctuation">,</span> otu_num <span class="operator">=</span> otu_num<span class="punctuation">,</span> core_otu <span class="operator">=</span> core_num<span class="punctuation">,</span> </span><br><span class="line">	start <span class="operator">=</span> <span class="number">90</span><span class="punctuation">,</span> a <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> b <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> r <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> ellipse_col <span class="operator">=</span> ellipse_col<span class="punctuation">,</span> circle_col <span class="operator">=</span> <span class="string">&#x27;white&#x27;</span><span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#注：参数a和b用于设置花瓣椭圆的尺寸，ellipse_col用于设置花瓣椭圆的颜色；参数r用于设置中心圆圈尺寸，circle_col用于设置中心圆圈的颜色</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Upset也可以自自己</span></span><br><span class="line">library<span class="punctuation">(</span>UpSetR<span class="punctuation">)</span></span><br><span class="line">require<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span>;</span><br><span class="line">require<span class="punctuation">(</span>plyr<span class="punctuation">)</span>;</span><br><span class="line">require<span class="punctuation">(</span>gridExtra<span class="punctuation">)</span>; </span><br><span class="line">require<span class="punctuation">(</span>grid<span class="punctuation">)</span>;</span><br><span class="line">input <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span></span><br><span class="line">  <span class="string">&#x27;cancer1&#x27;</span><span class="operator">=</span>  <span class="number">1578</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&#x27;cancer2&#x27;</span> <span class="operator">=</span>  <span class="number">1284</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&#x27;cancer3&#x27;</span> <span class="operator">=</span> <span class="number">2488</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&#x27;cancer1&amp;cancer2&#x27;</span>  <span class="operator">=</span><span class="number">205</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&#x27;cancer1&amp;cancer3&#x27;</span>  <span class="operator">=</span> <span class="number">828</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&#x27;cancer2&amp;cancer3&#x27;</span>  <span class="operator">=</span><span class="number">589</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&#x27;cancer1&amp;cancer2&amp;cancer3&#x27;</span>   <span class="operator">=</span><span class="number">120</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">data <span class="operator">&lt;-</span> fromExpression<span class="punctuation">(</span>input<span class="punctuation">)</span></span><br><span class="line">p1 <span class="operator">&lt;-</span> upset<span class="punctuation">(</span>data<span class="punctuation">,</span> nsets <span class="operator">=</span> <span class="number">9</span><span class="punctuation">,</span> </span><br><span class="line">            sets <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;cancer1&#x27;</span><span class="punctuation">,</span></span><br><span class="line">                     <span class="string">&#x27;cancer2&#x27;</span> <span class="punctuation">,</span></span><br><span class="line">                     <span class="string">&#x27;cancer3&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">            keep.order <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span></span><br><span class="line">            <span class="comment"># number.angles = 30, </span></span><br><span class="line">            point.size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> </span><br><span class="line">            line.size <span class="operator">=</span> <span class="number">1.3</span><span class="punctuation">,</span> </span><br><span class="line">            mainbar.y.label <span class="operator">=</span> <span class="string">&quot;IntersectionSize&quot;</span><span class="punctuation">,</span> </span><br><span class="line">            sets.x.label <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            mb.ratio <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.60</span><span class="punctuation">,</span> <span class="number">0.40</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">            text.scale <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="number">0.5</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p1</span><br><span class="line"></span><br><span class="line"><span class="comment">#例如我们关注所有分组的交集、c1 分组的特有集，以及 Proteobacteria 在各交集中所含 OTUs 的种类数量</span></span><br><span class="line"><span class="comment">#默认最多展示 5 组数据（nset = 5）的 40 种交集（nintersects = 40）</span></span><br><span class="line">upset<span class="punctuation">(</span>phylum1<span class="punctuation">,</span> nset <span class="operator">=</span> <span class="number">8</span><span class="punctuation">,</span> nintersects <span class="operator">=</span> <span class="number">100</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#也可自定义指定数据集名称</span></span><br><span class="line">upset<span class="punctuation">(</span>phylum1<span class="punctuation">,</span> sets <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;B1&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;C1&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> nintersects <span class="operator">=</span> <span class="number">100</span><span class="punctuation">)</span></span><br><span class="line">upset<span class="punctuation">(</span>phylum1<span class="punctuation">,</span> nset <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> nintersects <span class="operator">=</span> <span class="number">100</span><span class="punctuation">,</span> order.by <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;freq&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;degree&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> decreasing <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="literal">TRUE</span><span class="punctuation">,</span> <span class="literal">TRUE</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">      queries <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="built_in">list</span><span class="punctuation">(</span>query <span class="operator">=</span> intersects<span class="punctuation">,</span> params <span class="operator">=</span> <span class="string">&#x27;H2&#x27;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                     <span class="built_in">list</span><span class="punctuation">(</span>query <span class="operator">=</span> intersects<span class="punctuation">,</span> params <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;H1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;H2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;H3&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;H4&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;H5&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;H6&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span></span><br><span class="line">                     <span class="punctuation">)</span><span class="punctuation">)</span><span class="comment">#list(query = elements, params = c(&#x27;taxonomy&#x27;, &#x27;Proteobacteria&#x27;), color = &#x27;orange&#x27;, active = TRUE) 增加一列分类</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="排序类型图"><strong>排序类型图</strong></h3>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzAwOTg5ODYyNQ==&amp;mid=2247484064&amp;idx=1&amp;sn=1ef21a14e077128c6b9d373a905ee99e&amp;chksm=9b59dd4eac2e5458871af146e9b5fe7c85947c0cf3ebb75880b18a897abf3dedcd1ab38141a3&amp;mpshare=1&amp;scene=1&amp;srcid=&amp;sharer_sharetime=1591547318282&amp;sharer_shareid=59b64c339c4e339bb243a53b299dcf8d&amp;key=983943efdc6388ddfc3c7ab4677aa5f8aca09b18bbe6c3eb13769eb1d5dd9d7fe3df7379cbb2d48564056b6e0cbb71bff8ff9b41309e35e5608bdcb97519dbb6f57a3781cd64c2fc4d4b0e064064ee7c&amp;ascene=1&amp;uin=Mjc2NjUwNjgzOA%3D%3D&amp;devicetype=Windows+10+x64&amp;version=62090070&amp;lang=zh_CN&amp;exportkey=Awbo2jQq6WoFdR7ln9U%2Bbu8%3D&amp;pass_ticket=OgFI03cbOodZF9BCd6N4rzrUDZTAvGjmnuNy2Ome2pNqRzYbuy8inleYEzRU7qCf">排序分析简介</a></p>
<p><a href="https://www.omicshare.com/forum/thread-6351-1-1.html">PCA、PCoA和NMDS有什么区别</a></p>
<ul>
<li>**在非限制性排序中，16S和宏基因组数据分析通常用到的是PCA分析和PCoA分析。两者的区别在于：****PCA分析是基于原始的物种组成矩阵所做的排序分析，而PCoA分析则是基于由物种组成计算得到的距离矩阵得出的。</li>
<li>如果大于4.0，就应该选单峰模型；</li>
<li>如果3.0-4.0之间，选线性模型或者单峰模型均可；</li>
<li>如果小于3.0, 线性模型的结果要好于单峰模型</li>
<li>查看结果中的“Axis lengths”的第一轴DCA1的值，根据该值判断该采用线性模型还是单峰模型：</li>
</ul>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#判断选择用单峰模型还是线性模型 decorana()</span></span><br><span class="line">install.packages<span class="punctuation">(</span><span class="string">&#x27;vegan&#x27;</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span><span class="string">&#x27;vegan&#x27;</span><span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">(</span>varespec<span class="punctuation">)</span></span><br><span class="line">vare_dca<span class="operator">&lt;-</span>decorana<span class="punctuation">(</span>varespec<span class="punctuation">)</span></span><br><span class="line">vare_dca</span><br></pre></td></tr></table></figure>
<p><strong>输入文件一般都为分组文件及丰度表</strong></p>
<p><img src="/2023/10/31/ggplot-picture/C:%5CUsers%5CAdministrator%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200608104456601.png" alt="image-20200608104456601"></p>
<h4 id="pls-da分析"><strong>PLS-DA分析</strong></h4>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>mixOmics<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##读入文件</span></span><br><span class="line"><span class="comment">#门水平丰度表</span></span><br><span class="line">phylum <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;phylum_table.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">phylum <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>t<span class="punctuation">(</span>phylum<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#样本分组文件</span></span><br><span class="line">group <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;group.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##PLS-DA 分析</span></span><br><span class="line"><span class="comment">#基于门水平丰度表，只展示前 3 个排序轴</span></span><br><span class="line">phylum <span class="operator">&lt;-</span> phylum<span class="punctuation">[</span>group<span class="operator">$</span><span class="built_in">names</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">plsda_result <span class="operator">&lt;-</span>plsda<span class="punctuation">(</span>phylum<span class="punctuation">,</span> group<span class="operator">$</span>group<span class="punctuation">,</span> ncomp <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#简要查看结果</span></span><br><span class="line">plsda_result</span><br><span class="line"><span class="comment">#或</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>plsda_result<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看排序轴解释量</span></span><br><span class="line">plsda_result<span class="operator">$</span>explained_variance<span class="operator">$</span>X</span><br><span class="line"><span class="comment">#查看样本排序坐标</span></span><br><span class="line">plsda_result<span class="operator">$</span>variates<span class="operator">$</span>X</span><br><span class="line"><span class="comment">#查看细菌门类群排序坐标</span></span><br><span class="line">plsda_result<span class="operator">$</span>loadings<span class="operator">$</span>X</span><br><span class="line"></span><br><span class="line"><span class="comment">#使用 plotIndiv() 绘制 PLS-DA 分析结果</span></span><br><span class="line">plotIndiv<span class="punctuation">(</span>plsda_result<span class="punctuation">,</span> ind.names <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> style <span class="operator">=</span> <span class="string">&#x27;ggplot2&#x27;</span><span class="punctuation">)</span></span><br><span class="line">plotIndiv<span class="punctuation">(</span>plsda_result<span class="punctuation">,</span> ind.names <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> style <span class="operator">=</span> <span class="string">&#x27;3d&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#提取坐标轴解释量（前两轴）</span></span><br><span class="line">plsda_result_eig <span class="operator">&lt;-</span> <span class="punctuation">&#123;</span>plsda_result<span class="operator">$</span>explained_variance<span class="operator">$</span>X<span class="punctuation">&#125;</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#提取样本点坐标（前两轴）</span></span><br><span class="line">sample_site <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>plsda_result<span class="operator">$</span>variates<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#为样本点坐标添加分组信息</span></span><br><span class="line">sample_site<span class="operator">$</span><span class="built_in">names</span> <span class="operator">&lt;-</span> rownames<span class="punctuation">(</span>sample_site<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>sample_site<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;plsda1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;plsda2&#x27;</span><span class="punctuation">)</span></span><br><span class="line">sample_site <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>sample_site<span class="punctuation">,</span> group<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&#x27;names&#x27;</span><span class="punctuation">,</span> all.x <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#可选输出各样本的 PLS-DA 分析结果</span></span><br><span class="line">write.table<span class="punctuation">(</span>sample_site<span class="punctuation">,</span> <span class="string">&#x27;plsda_sample.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#使用 ggplot2 简单绘制 PLS-DA 结果图</span></span><br><span class="line">plsda_plot <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>sample_site<span class="punctuation">,</span> aes<span class="punctuation">(</span>plsda1<span class="punctuation">,</span> plsda2<span class="punctuation">,</span> color <span class="operator">=</span> group<span class="punctuation">,</span> label <span class="operator">=</span> <span class="built_in">names</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_point<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">1.5</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">stat_ellipse<span class="punctuation">(</span>show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#添加 95% 置信椭圆</span></span><br><span class="line">scale_color_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#1D7ACC&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#F67433&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#00815F&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;grey50&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">theme<span class="punctuation">(</span>legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&#x27;PLS-DA axis1 ( explained variance &#x27;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span><span class="number">100</span> <span class="operator">*</span> plsda_result_eig<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&#x27;% )&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> y <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&#x27;PLS-DA axis2 ( explained variance &#x27;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span><span class="number">100</span> <span class="operator">*</span> plsda_result_eig<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&#x27;% )&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggsave(&#x27;plsda_plot.pdf&#x27;, plsda_plot, width = 6, height = 5)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;plsda_plot.png&#x27;</span><span class="punctuation">,</span> plsda_plot<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="nmds分析"><strong>NMDS分析</strong></h4>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>vegan<span class="punctuation">)</span>	<span class="comment">#排序分析</span></span><br><span class="line"><span class="comment">#使用OTU丰度表作为输入文件还是现有的距离矩阵作为输入文件，NMDS排序的结果是不一致的。</span></span><br><span class="line"><span class="comment">#使用OTU丰度表作为输入文件的NMDS排序分析能够更充分地进行信息挖掘</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>GUniFrac<span class="punctuation">)</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;./Abundance/Nr_abundance/Distance/&quot;</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span>	<span class="comment">#作图</span></span><br><span class="line">library<span class="punctuation">(</span>ape<span class="punctuation">)</span>	<span class="comment">#可选，用于读取进化树文件，见最后</span></span><br><span class="line"><span class="comment">##############################</span></span><br><span class="line"><span class="comment">##NMDS 排序（基于 OTU 丰度表）</span></span><br><span class="line"><span class="comment">#读入 OTU 丰度表</span></span><br><span class="line">otu <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;Genu_0.001.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">otu <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>t<span class="punctuation">(</span>otu<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">distance <span class="operator">&lt;-</span> vegdist<span class="punctuation">(</span>otu<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;bray&#x27;</span><span class="punctuation">)</span></span><br><span class="line">distance <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>distance<span class="punctuation">)</span></span><br><span class="line">write.table<span class="punctuation">(</span>distance<span class="punctuation">,</span> <span class="string">&#x27;bray-curtis_distance.txt&#x27;</span><span class="punctuation">,</span> col.names <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#排序，预设 4 个排序轴</span></span><br><span class="line">nmds1 <span class="operator">&lt;-</span> metaMDS<span class="punctuation">(</span>otu<span class="punctuation">,</span> distance <span class="operator">=</span> <span class="string">&#x27;bray&#x27;</span><span class="punctuation">,</span> k <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="operator">?</span>metaMDS<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#可简要查看结果</span></span><br><span class="line">nmds1</span><br><span class="line"><span class="comment">#或</span></span><br><span class="line">summary<span class="punctuation">(</span>nmds1<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#提取应力函数值（stress）</span></span><br><span class="line">nmds1.stress <span class="operator">&lt;-</span> nmds1<span class="operator">$</span>stress</span><br><span class="line"><span class="comment">#提取样本排序坐标</span></span><br><span class="line">nmds1.point <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>nmds1<span class="operator">$</span>point<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#提取物种（OTU）排序坐标</span></span><br><span class="line">nmds1.species <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>nmds1<span class="operator">$</span>species<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#可选择将结果输出并保存在本地，例如将样本坐标输出为 csv 格式</span></span><br><span class="line">write.csv<span class="punctuation">(</span>nmds1.point<span class="punctuation">,</span> <span class="string">&#x27;nmds.sample.csv&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#简要绘图展示</span></span><br><span class="line">nmds_plot <span class="operator">&lt;-</span> nmds1</span><br><span class="line">nmds_plot<span class="operator">$</span>species <span class="operator">&lt;-</span> <span class="punctuation">&#123;</span>nmds_plot<span class="operator">$</span>species<span class="punctuation">&#125;</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">plot<span class="punctuation">(</span>nmds_plot<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;t&#x27;</span><span class="punctuation">,</span> main <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&#x27;Stress =&#x27;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span>nmds1<span class="operator">$</span>stress<span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##############################</span></span><br><span class="line"><span class="comment">##NMDS 排序（基于现有的距离矩阵）</span></span><br><span class="line"><span class="comment">#读入现有的距离矩阵</span></span><br><span class="line">dis <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;bray-curtis_distance.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#排序，预设 4 个排序轴 dis为读入的距离矩阵</span></span><br><span class="line">nmds2 <span class="operator">&lt;-</span> metaMDS<span class="punctuation">(</span>as.dist<span class="punctuation">(</span>dis<span class="punctuation">)</span><span class="punctuation">,</span> k <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#可简要查看结果</span></span><br><span class="line">summary<span class="punctuation">(</span>nmds2<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#可发现“species”信息中为“1”，打印出来为“NA”</span></span><br><span class="line">nmds2<span class="operator">$</span>species</span><br><span class="line"><span class="comment">#简要绘图展示，可发现与基于 OTU 丰度表的 NMDS 排序结果不同</span></span><br><span class="line">plot<span class="punctuation">(</span>nmds2<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;t&#x27;</span><span class="punctuation">,</span> main <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&#x27;Stress =&#x27;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span>nmds2<span class="operator">$</span>stress<span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#可使用 wascores() 将 OTU “被动地”加入 NMDS 排序图</span></span><br><span class="line">species <span class="operator">&lt;-</span> wascores<span class="punctuation">(</span>nmds2<span class="operator">$</span>points<span class="punctuation">,</span> otu<span class="punctuation">)</span></span><br><span class="line">text<span class="punctuation">(</span>species<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> <span class="punctuation">]</span><span class="punctuation">,</span> rownames<span class="punctuation">(</span>species<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">]</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##############################</span></span><br><span class="line"><span class="comment">##NMDS 评估  可以通过比较NMDS排序图内对象的距离与原始对象距离去评估NMDS结果（Shepard图）。若R2越大，则NMDS结果越合理。</span></span><br><span class="line">stressplot<span class="punctuation">(</span>nmds_plot<span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;Shepard 图&#x27;</span><span class="punctuation">)</span></span><br><span class="line">gof <span class="operator">&lt;-</span> goodness<span class="punctuation">(</span>nmds_plot<span class="punctuation">)</span></span><br><span class="line">plot<span class="punctuation">(</span>nmds_plot<span class="punctuation">,</span>type <span class="operator">=</span> <span class="string">&#x27;t&#x27;</span><span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;拟合度&#x27;</span><span class="punctuation">)</span></span><br><span class="line">points<span class="punctuation">(</span>nmds_plot<span class="punctuation">,</span> display <span class="operator">=</span> <span class="string">&#x27;sites&#x27;</span><span class="punctuation">,</span> cex <span class="operator">=</span> gof <span class="operator">*</span> <span class="number">200</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##############################</span></span><br><span class="line"><span class="comment">##ggplot2 作图（使用基于 OTU 丰度表的 NMDS 排序结果，预设 2 个排序轴）</span></span><br><span class="line"><span class="comment">#读入 OTU 丰度表</span></span><br><span class="line">otu <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;Genu_0.001.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">otu <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>t<span class="punctuation">(</span>otu<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#读入样本分组文件</span></span><br><span class="line">group <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;sample.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#排序，预设 2 个排序轴</span></span><br><span class="line">nmds1 <span class="operator">&lt;-</span> metaMDS<span class="punctuation">(</span>otu<span class="punctuation">,</span> distance <span class="operator">=</span> <span class="string">&#x27;bray&#x27;</span><span class="punctuation">,</span> k <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#提取样本点坐标（前两轴）</span></span><br><span class="line">sample_site <span class="operator">&lt;-</span> nmds1.point<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line">sample_site<span class="operator">$</span><span class="built_in">names</span> <span class="operator">&lt;-</span> rownames<span class="punctuation">(</span>sample_site<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>sample_site<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;NMDS1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;NMDS2&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#为样本点坐标添加分组信息</span></span><br><span class="line">sample_site <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>sample_site<span class="punctuation">,</span> group<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&#x27;names&#x27;</span><span class="punctuation">,</span> all.x <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#使用 ggplot2 绘制 NMDS 排序图</span></span><br><span class="line">nmds_plot <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>sample_site<span class="punctuation">,</span> aes<span class="punctuation">(</span>NMDS1<span class="punctuation">,</span> NMDS2<span class="punctuation">,</span> group <span class="operator">=</span> group<span class="punctuation">,</span>color<span class="operator">=</span>group<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> group<span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">1.5</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment">#可在这里修改点的透明度、大小</span></span><br><span class="line">  scale_shape_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">17</span><span class="punctuation">,</span> <span class="number">16</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment">#可在这里修改点的形状</span></span><br><span class="line">  stat_ellipse<span class="punctuation">(</span>level <span class="operator">=</span> <span class="number">0.95</span><span class="punctuation">,</span> show.legend <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_color_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment">#可在这里修改点的颜色</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment">#去掉背景框</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment">#去掉图例标题及标签背景</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;NMDS axis1&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;NMDS axis2&#x27;</span><span class="punctuation">,</span> title <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&#x27;Stress =&#x27;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span>nmds1<span class="operator">$</span>stress<span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span> <span class="comment">#标题居中</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span> label <span class="operator">=</span> <span class="string">&#x27;Diarrhea&#x27;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="operator">-</span><span class="number">0.3</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">0.06</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span> label <span class="operator">=</span> <span class="string">&#x27;Healthy&#x27;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="number">0.25</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">0.25</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span> </span><br><span class="line">  <span class="comment">#geom_text(aes(label = group), data = species_site, color = &#x27;green4&#x27;, size = 2) #添加物种排序（top10 OTU，展示为标签）</span></span><br><span class="line">nmds_plot</span><br><span class="line"><span class="comment">#ggsave(&#x27;Genu_nmds.pdf&#x27;, nmds_plot, width = 6, height = 5)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;NMDS.png&#x27;</span><span class="punctuation">,</span> nmds_plot<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##############################</span></span><br><span class="line"><span class="comment">##基于 Weighted UniFrac 距离的 NMDS 排序（测试）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#加载函数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#OTU 丰度表</span></span><br><span class="line">otu <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;test_otu.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">otu <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>t<span class="punctuation">(</span>otu<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#进化树（使用 ape 包中的 read.tree() 读取，此处进化树必须为有根树）</span></span><br><span class="line">otu_tree <span class="operator">&lt;-</span> read.tree<span class="punctuation">(</span><span class="string">&#x27;test_tree.tre&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#距离矩阵（weighted unifrac 距离矩阵，使用 GUniFrac 包中的命令计算）</span></span><br><span class="line">unifrac <span class="operator">&lt;-</span> GUniFrac<span class="punctuation">(</span>otu<span class="punctuation">,</span> otu_tree<span class="punctuation">)</span><span class="operator">$</span>unifracs</span><br><span class="line">wei_unif_dis <span class="operator">&lt;-</span> as.dist<span class="punctuation">(</span>unifrac<span class="punctuation">[</span><span class="punctuation">,</span> <span class="punctuation">,</span> <span class="string">&#x27;d_1&#x27;</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="comment">#加权</span></span><br><span class="line">unwei_unif_dis <span class="operator">&lt;-</span> as.dist<span class="punctuation">(</span>unifrac<span class="punctuation">[</span><span class="punctuation">,</span> <span class="punctuation">,</span> <span class="string">&#x27;d_UW&#x27;</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="comment">#非加权</span></span><br><span class="line"><span class="comment">#以非加权为例矩阵形式保存</span></span><br><span class="line">unwei_unif_dis <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>unwei_unif_dis<span class="punctuation">)</span></span><br><span class="line">write.table<span class="punctuation">(</span>unwei_unif_dis<span class="punctuation">,</span><span class="string">&#x27;unweighted-unifrac_distance.txt&#x27;</span><span class="punctuation">,</span>col.names <span class="operator">=</span> <span class="literal">NA</span> <span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span><span class="built_in">quote</span><span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#分组文件</span></span><br><span class="line">group <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;test_group.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#NMDS 排序（基于 OTU 丰度表和进化树文件，使用 weighted unifrac 距离）</span></span><br><span class="line">nmds_un1 <span class="operator">&lt;-</span> metaMDS2<span class="punctuation">(</span>wei_unif_dis<span class="punctuation">)</span></span><br><span class="line">plot<span class="punctuation">(</span>nmds_un1<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;t&#x27;</span><span class="punctuation">,</span> main <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&#x27;Stress =&#x27;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span>nmds2<span class="operator">$</span>stress<span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#NMDS 排序（直接基于 unweighted unifrac 距离矩阵）</span></span><br><span class="line">nmds_un2 <span class="operator">&lt;-</span> metaMDS<span class="punctuation">(</span>unwei_unif_dis<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#分别作图展示</span></span><br><span class="line">sample_site2<span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>nmds_un1<span class="operator">$</span>point<span class="punctuation">)</span>; sample_site2 <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>nmds_un2<span class="operator">$</span>point<span class="punctuation">)</span></span><br><span class="line">sample_site1<span class="operator">$</span><span class="built_in">names</span> <span class="operator">&lt;-</span> rownames<span class="punctuation">(</span>sample_site1<span class="punctuation">)</span>; sample_site2<span class="operator">$</span><span class="built_in">names</span> <span class="operator">&lt;-</span> rownames<span class="punctuation">(</span>sample_site2<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>sample_site1<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;NMDS1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;NMDS2&#x27;</span><span class="punctuation">)</span>; <span class="built_in">names</span><span class="punctuation">(</span>sample_site2<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;NMDS1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;NMDS2&#x27;</span><span class="punctuation">)</span></span><br><span class="line">sample_site1 <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>sample_site1<span class="punctuation">,</span> group<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&#x27;names&#x27;</span><span class="punctuation">,</span> all.x <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span>; sample_site2 <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>sample_site2<span class="punctuation">,</span> group<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&#x27;names&#x27;</span><span class="punctuation">,</span> all.x <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>sample_site1<span class="punctuation">,</span> aes<span class="punctuation">(</span>NMDS1<span class="punctuation">,</span> NMDS2<span class="punctuation">,</span> color <span class="operator">=</span> group<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>sample_site2<span class="punctuation">,</span> aes<span class="punctuation">(</span>NMDS1<span class="punctuation">,</span> NMDS2<span class="punctuation">,</span> color <span class="operator">=</span> group<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> geom_point<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>nmds实战例子（基于OTU表）</strong></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#载入分析包</span></span><br><span class="line">library<span class="punctuation">(</span>vegan<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#载入分析数据</span></span><br><span class="line">otu <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;otu.txt&quot;</span><span class="punctuation">,</span>header<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span>row.names<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span>sep<span class="operator">=</span><span class="string">&quot;\t&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#对分析数据进行转置</span></span><br><span class="line">otu <span class="operator">&lt;-</span> t<span class="punctuation">(</span>otu<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#进行NMDS分析</span></span><br><span class="line">nmds <span class="operator">&lt;-</span> metaMDS<span class="punctuation">(</span>otu<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#保存stress结果</span></span><br><span class="line">capture.output<span class="punctuation">(</span>nmds<span class="punctuation">,</span>file <span class="operator">=</span> <span class="string">&quot;Stress.txt&quot;</span> <span class="punctuation">)</span></span><br><span class="line"><span class="comment">#保存scores结果</span></span><br><span class="line">nmds_scores<span class="operator">=</span>scores<span class="punctuation">(</span>nmds<span class="punctuation">,</span> choices <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">write.table<span class="punctuation">(</span>nmds_scores<span class="punctuation">,</span>file<span class="operator">=</span><span class="string">&quot;NMDS_scores.txt&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">scores <span class="operator">&lt;-</span>  read.table<span class="punctuation">(</span><span class="string">&quot;NMDS_scores.txt&quot;</span><span class="punctuation">,</span>header<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">groups <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;group1.txt&quot;</span><span class="punctuation">,</span> head<span class="operator">=</span><span class="built_in">F</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span>colClasses <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;character&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">pich<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">21</span><span class="operator">:</span><span class="number">24</span><span class="punctuation">)</span></span><br><span class="line">cbbPalette <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#E69F00&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#56B4E9&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#009E73&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#F0E442&quot;</span><span class="punctuation">)</span></span><br><span class="line">Palette <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#000000&quot;</span><span class="punctuation">,</span><span class="string">&quot;#000000&quot;</span><span class="punctuation">,</span><span class="string">&quot;#000000&quot;</span><span class="punctuation">,</span><span class="string">&quot;#000000&quot;</span><span class="punctuation">)</span></span><br><span class="line">plotdata <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>rownames<span class="punctuation">(</span>scores<span class="punctuation">)</span><span class="punctuation">,</span>scores<span class="operator">$</span>NMDS1<span class="punctuation">,</span>scores<span class="operator">$</span>NMDS2<span class="punctuation">,</span>groups<span class="operator">$</span>V2<span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>plotdata<span class="punctuation">)</span><span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;sample&quot;</span><span class="punctuation">,</span><span class="string">&quot;MDS1&quot;</span><span class="punctuation">,</span><span class="string">&quot;MDS2&quot;</span><span class="punctuation">,</span><span class="string">&quot;group&quot;</span><span class="punctuation">)</span></span><br><span class="line">plotdata<span class="operator">$</span>sample <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>plotdata<span class="operator">$</span>sample<span class="punctuation">)</span></span><br><span class="line">plotdata<span class="operator">$</span>MDS1 <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>as.vector<span class="punctuation">(</span>plotdata<span class="operator">$</span>MDS1<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">plotdata<span class="operator">$</span>MDS2 <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>as.vector<span class="punctuation">(</span>plotdata<span class="operator">$</span>MDS2<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>plotdata<span class="punctuation">,</span> aes<span class="punctuation">(</span>MDS1<span class="punctuation">,</span> MDS2<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>colour<span class="operator">=</span>group<span class="punctuation">,</span>shape<span class="operator">=</span>group<span class="punctuation">,</span>fill<span class="operator">=</span>group<span class="punctuation">)</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">10</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_shape_manual<span class="punctuation">(</span>values<span class="operator">=</span>pich<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_colour_manual<span class="punctuation">(</span>values<span class="operator">=</span>Palette<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span>values<span class="operator">=</span>cbbPalette<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>title<span class="operator">=</span><span class="string">&quot;NMDS Plot&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> xlab<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;MDS1&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> ylab<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;MDS2&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>text<span class="operator">=</span>element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">18</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_vline<span class="punctuation">(</span>aes<span class="punctuation">(</span>xintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span>linetype<span class="operator">=</span><span class="string">&quot;dotted&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>aes<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span>linetype<span class="operator">=</span><span class="string">&quot;dotted&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="operator">=</span><span class="built_in">max</span><span class="punctuation">(</span>MDS1<span class="punctuation">)</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="built_in">max</span><span class="punctuation">(</span>MDS2<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span>hjust<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span>vjust<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">8</span><span class="punctuation">,</span>label<span class="operator">=</span>paste<span class="punctuation">(</span><span class="string">&quot;Stress = &quot;</span><span class="punctuation">,</span><span class="built_in">round</span><span class="punctuation">(</span>nmds<span class="operator">$</span>stress<span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>colour<span class="operator">=</span><span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill<span class="operator">=</span><span class="string">&#x27;white&#x27;</span><span class="punctuation">,</span> colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.grid<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">18</span><span class="punctuation">)</span><span class="punctuation">,</span>axis.ticks.length <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span><span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        axis.ticks <span class="operator">=</span> element_line<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span>axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        axis.title.x<span class="operator">=</span>element_text<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">18</span><span class="punctuation">)</span><span class="punctuation">,</span>axis.title.y<span class="operator">=</span>element_text<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">18</span><span class="punctuation">)</span><span class="punctuation">,</span>axis.text<span class="operator">=</span>element_text<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">18</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.title<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>legend.text<span class="operator">=</span>element_text<span class="punctuation">(</span>family<span class="operator">=</span><span class="string">&quot;Arial&quot;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">18</span><span class="punctuation">)</span><span class="punctuation">,</span>legend.key<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">20</span><span class="punctuation">,</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span>face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="apcoa分析">aPCOA分析</h4>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#用法</span></span><br><span class="line">aPCoA<span class="punctuation">(</span>formula<span class="punctuation">,</span>data<span class="punctuation">,</span>maincov<span class="punctuation">,</span>drawEllipse<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span>drawCenter<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#formula：Y~ A,Y为不像似性距离。</span></span><br><span class="line"><span class="comment">#data: 需要包含所有的协变量</span></span><br><span class="line"><span class="comment">#maincov： 研究的目标协变量，必须是因子</span></span><br><span class="line"><span class="comment">#drawEllipse: 95%置信椭圆</span></span><br><span class="line"><span class="comment">#drawCenter：中心点和其他点连线</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#实例</span></span><br><span class="line">library<span class="punctuation">(</span>mvabund<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>vegan<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#install.packages(&quot;aPCoA&quot;)</span></span><br><span class="line">library<span class="punctuation">(</span>aPCoA<span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">(</span><span class="string">&quot;Tasmania&quot;</span><span class="punctuation">)</span></span><br><span class="line">data<span class="operator">&lt;-</span>data.frame<span class="punctuation">(</span>treatment<span class="operator">=</span>Tasmania<span class="operator">$</span>treatment<span class="punctuation">,</span>block<span class="operator">=</span>Tasmania<span class="operator">$</span>block<span class="punctuation">)</span></span><br><span class="line">data</span><br><span class="line"></span><br><span class="line">       treatment block</span><br><span class="line">B1D1   Disturbed     <span class="number">1</span></span><br><span class="line">B1D2   Disturbed     <span class="number">1</span></span><br><span class="line"></span><br><span class="line">bray<span class="operator">&lt;-</span>vegdist<span class="punctuation">(</span>Tasmania<span class="operator">$</span>abund<span class="punctuation">,</span> method<span class="operator">=</span><span class="string">&quot;bray&quot;</span><span class="punctuation">)</span></span><br><span class="line">rownames<span class="punctuation">(</span>data<span class="punctuation">)</span><span class="operator">&lt;-</span>rownames<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>bray<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">opar<span class="operator">&lt;-</span>par<span class="punctuation">(</span>mfrow<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">          mar<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">3.1</span><span class="punctuation">,</span> <span class="number">3.1</span><span class="punctuation">,</span> <span class="number">3.1</span><span class="punctuation">,</span> <span class="number">5.1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">          mgp<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">          oma<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#treatment为研究的目标协变量，排除其他协变量的影响</span></span><br><span class="line">result<span class="operator">&lt;-</span>aPCoA<span class="punctuation">(</span>bray<span class="operator">~</span>block<span class="punctuation">,</span>data<span class="punctuation">,</span>treatment<span class="punctuation">)</span></span><br><span class="line">par<span class="punctuation">(</span>opar<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h4 id="pcoa分析"><strong>PCOA分析</strong></h4>
<p><a href="https://mp.weixin.qq.com/s/aCyx_r81nRd6W2PHVvuSyw">PCOA示例</a></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>vegan<span class="punctuation">)</span>	<span class="comment">#排序分析</span></span><br><span class="line"><span class="comment">#无论使用OTU丰度表作为输入文件还是现有的距离矩阵作为输入文件，PCoA排序的结果是完全一致的。</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span>	<span class="comment">#作图</span></span><br><span class="line">library<span class="punctuation">(</span>ape<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>plyr<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#OTU 丰度表</span></span><br><span class="line">otu <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;Genu_0.001.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">otu <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>t<span class="punctuation">(</span>otu<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#或者现有的距离矩阵</span></span><br><span class="line">dis <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;bray-curtis_distance.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#样本分组文件</span></span><br><span class="line">group <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;sample.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#物种数据 Hellinger 预转化（处理包含很多 0 值的群落物种数据时，推荐使用）</span></span><br><span class="line">otu<span class="operator">&lt;-</span> decostand<span class="punctuation">(</span>otu<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;hellinger&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#排序（基于 OTU 丰度表）</span></span><br><span class="line">distance <span class="operator">&lt;-</span> vegdist<span class="punctuation">(</span>otu<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;bray&#x27;</span><span class="punctuation">)</span></span><br><span class="line">bray <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>bray_dis<span class="punctuation">)</span></span><br><span class="line">write.table<span class="punctuation">(</span>bray<span class="punctuation">,</span> <span class="string">&#x27;bray-curtis_distance.txt&#x27;</span><span class="punctuation">,</span> col.names <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">pcoa <span class="operator">&lt;-</span> cmdscale<span class="punctuation">(</span>distance<span class="punctuation">,</span> k <span class="operator">=</span> <span class="punctuation">(</span>nrow<span class="punctuation">(</span>otu<span class="punctuation">)</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> eig <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#或者（基于现有的距离矩阵）</span></span><br><span class="line">pcoa <span class="operator">&lt;-</span> cmdscale<span class="punctuation">(</span>as.dist<span class="punctuation">(</span>dis<span class="punctuation">)</span><span class="punctuation">,</span> k <span class="operator">=</span> <span class="punctuation">(</span>nrow<span class="punctuation">(</span>dis<span class="punctuation">)</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> eig <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#对于上述计算得到的样本间距离 distance，可转换为矩阵格式后输出，例如输出为 csv 格式</span></span><br><span class="line">write.csv<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>distance<span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&#x27;distance.csv&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#使用vegan内置命令ordiplot()简要做图展示</span></span><br><span class="line">ordiplot<span class="punctuation">(</span>scores<span class="punctuation">(</span>pcoa<span class="punctuation">)</span><span class="punctuation">[</span> <span class="punctuation">,</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;t&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#或者查看排序简要</span></span><br><span class="line">summary<span class="punctuation">(</span>pcoa<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#查看主要排序轴的特征值和各样本在各排序轴中的坐标值</span></span><br><span class="line">pcoa<span class="operator">$</span>eig</span><br><span class="line">point <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>pcoa<span class="operator">$</span>point<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#可将样本坐标转化为数据框后导出，例如导出为 csv 格式</span></span><br><span class="line">write.csv<span class="punctuation">(</span>point<span class="punctuation">,</span> <span class="string">&#x27;pcoa.sample.csv&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#可使用 wascores() 计算物种坐标</span></span><br><span class="line">species <span class="operator">&lt;-</span> wascores<span class="punctuation">(</span>pcoa<span class="operator">$</span>points<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> otu<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#可将物种坐标转化为数据框后导出，例如导出为 csv 格式</span></span><br><span class="line">write.csv<span class="punctuation">(</span>species<span class="punctuation">,</span> <span class="string">&#x27;pcoa.otu.csv&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#使用ggplot2画图</span></span><br><span class="line"><span class="comment">#坐标轴解释量（前两轴）</span></span><br><span class="line">pcoa_eig <span class="operator">&lt;-</span> <span class="punctuation">(</span>pcoa<span class="operator">$</span>eig<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">/</span> <span class="built_in">sum</span><span class="punctuation">(</span>pcoa<span class="operator">$</span>eig<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#提取样本点坐标（前两轴）</span></span><br><span class="line">sample_site <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span><span class="punctuation">&#123;</span>pcoa<span class="operator">$</span>point<span class="punctuation">&#125;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line">sample_site<span class="operator">$</span><span class="built_in">names</span> <span class="operator">&lt;-</span> rownames<span class="punctuation">(</span>sample_site<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>sample_site<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;PCoA1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;PCoA2&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#为样本点坐标添加分组信息</span></span><br><span class="line">sample_site <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>sample_site<span class="punctuation">,</span> group<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&#x27;names&#x27;</span><span class="punctuation">,</span> all.x <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#可选输出，例如输出为 csv 格式</span></span><br><span class="line">write.csv<span class="punctuation">(</span>sample_site<span class="punctuation">,</span> <span class="string">&#x27;sample_site.csv&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">sample_site<span class="operator">$</span>group <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>sample_site<span class="operator">$</span>group<span class="punctuation">,</span> levels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;D&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;H&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">##ddply() 计算同分组样本排序坐标顶点</span></span><br><span class="line">group_border <span class="operator">&lt;-</span> ddply<span class="punctuation">(</span>sample_site<span class="punctuation">,</span> <span class="string">&#x27;group&#x27;</span><span class="punctuation">,</span> <span class="keyword">function</span><span class="punctuation">(</span>df<span class="punctuation">)</span> df<span class="punctuation">[</span>chull<span class="punctuation">(</span>df<span class="punctuation">[[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">,</span> df<span class="punctuation">[[</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span><span class="punctuation">)</span><span class="comment">##df[[2]]、df[[3]]代表第二、三列，即PCoA1和PCoA2坐标列</span></span><br><span class="line"><span class="comment">#绘图</span></span><br><span class="line">pcoa_plot <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>sample_site<span class="punctuation">,</span> aes<span class="punctuation">(</span>PCoA1<span class="punctuation">,</span> PCoA2<span class="punctuation">,</span> group <span class="operator">=</span> group<span class="punctuation">,</span>color<span class="operator">=</span>group<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment">#去掉背景框</span></span><br><span class="line">  geom_vline<span class="punctuation">(</span>xintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.4</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  <span class="comment">#geom_polygon(data = group_border, aes(fill = group)) + #绘制多边形区域</span></span><br><span class="line">  stat_ellipse<span class="punctuation">(</span>level <span class="operator">=</span> <span class="number">0.95</span><span class="punctuation">,</span> show.legend <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment">#绘制置信椭圆</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.4</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> group<span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span><span class="operator">+</span><span class="comment">#可在这里修改点的透明度、大小</span></span><br><span class="line"> <span class="comment"># scale_shape_manual(values = c(17, 16))+#可在这里修改点的形状</span></span><br><span class="line">  scale_color_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment">#可在这里修改点的颜色</span></span><br><span class="line">  <span class="comment">#theme(legend.position = &#x27;none&#x27;) + # 是否展示图例</span></span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#C673FF2E&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#73D5FF2E&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment">#可在这里修改区块的颜色</span></span><br><span class="line">  guides<span class="punctuation">(</span>fill <span class="operator">=</span> guide_legend<span class="punctuation">(</span>order <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> shape <span class="operator">=</span> guide_legend<span class="punctuation">(</span>order <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> guide_legend<span class="punctuation">(</span>order <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> <span class="comment">#设置图例展示顺序</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&#x27;PCoA axis1: &#x27;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span><span class="number">100</span> <span class="operator">*</span> pcoa_eig<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&#x27;%&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> y <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&#x27;PCoA axis2: &#x27;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span><span class="number">100</span> <span class="operator">*</span> pcoa_eig<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&#x27;%&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span> label <span class="operator">=</span> <span class="string">&#x27;Diarrhea&#x27;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="operator">-</span><span class="number">0.19</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">0.06</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span> label <span class="operator">=</span> <span class="string">&#x27;Healthy&#x27;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">0.20</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span> </span><br><span class="line"></span><br><span class="line">pcoa_plot</span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;genu_pcoa.pdf&#x27;</span><span class="punctuation">,</span> pcoa_plot<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><strong>pcoa实战（基于OTU表）</strong></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">setwd<span class="punctuation">(</span><span class="string">&#x27;./Script/Red_queen/PCOA/&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#载入绘图所需的包</span></span><br><span class="line">library<span class="punctuation">(</span>vegan<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ape<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggrepel<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#分组数较少、组内生物学重复较多</span></span><br><span class="line">data <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&quot;otu.txt&quot;</span><span class="punctuation">,</span> head<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span>sep<span class="operator">=</span><span class="string">&quot;\t&quot;</span><span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">groups <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;group1.txt&quot;</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span>colClasses <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;character&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">groups <span class="operator">&lt;-</span> as.list<span class="punctuation">(</span>groups<span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> t<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">[</span><span class="built_in">is.na</span><span class="punctuation">(</span>data<span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">0</span></span><br><span class="line">data <span class="operator">&lt;-</span> vegdist<span class="punctuation">(</span>data<span class="punctuation">,</span>method <span class="operator">=</span> <span class="string">&quot;bray&quot;</span><span class="punctuation">)</span></span><br><span class="line">pcoa<span class="operator">&lt;-</span> pcoa<span class="punctuation">(</span>data<span class="punctuation">,</span> correction <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">,</span> rn <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span></span><br><span class="line">PC1 <span class="operator">=</span> pcoa<span class="operator">$</span>vectors<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">PC2 <span class="operator">=</span> pcoa<span class="operator">$</span>vectors<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line">plotdata <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>rownames<span class="punctuation">(</span>pcoa<span class="operator">$</span>vectors<span class="punctuation">)</span><span class="punctuation">,</span>PC1<span class="punctuation">,</span>PC2<span class="punctuation">,</span>groups<span class="operator">$</span>V2<span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>plotdata<span class="punctuation">)</span> <span class="operator">&lt;-</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;sample&quot;</span><span class="punctuation">,</span><span class="string">&quot;PC1&quot;</span><span class="punctuation">,</span><span class="string">&quot;PC2&quot;</span><span class="punctuation">,</span><span class="string">&quot;group&quot;</span><span class="punctuation">)</span></span><br><span class="line">pich<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">21</span><span class="operator">:</span><span class="number">24</span><span class="punctuation">)</span></span><br><span class="line">cbbPalette <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#E69F00&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#56B4E9&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#009E73&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#F0E442&quot;</span><span class="punctuation">)</span></span><br><span class="line">Palette <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#000000&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#000000&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#000000&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#000000&quot;</span><span class="punctuation">)</span></span><br><span class="line">pc1 <span class="operator">&lt;-</span><span class="built_in">floor</span><span class="punctuation">(</span>pcoa<span class="operator">$</span>values<span class="operator">$</span>Relative_eig<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="operator">*</span><span class="number">100</span><span class="punctuation">)</span></span><br><span class="line">pc2 <span class="operator">&lt;-</span><span class="built_in">floor</span><span class="punctuation">(</span>pcoa<span class="operator">$</span>values<span class="operator">$</span>Relative_eig<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="operator">*</span><span class="number">100</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">otu.adonis<span class="operator">=</span>adonis<span class="punctuation">(</span>data<span class="operator">~</span>V2<span class="punctuation">,</span>data <span class="operator">=</span> groups<span class="punctuation">,</span>distance <span class="operator">=</span> <span class="string">&quot;bray&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>plotdata<span class="punctuation">,</span> aes<span class="punctuation">(</span>PC1<span class="punctuation">,</span> PC2<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>colour<span class="operator">=</span>group<span class="punctuation">,</span>shape<span class="operator">=</span>group<span class="punctuation">,</span>fill<span class="operator">=</span>group<span class="punctuation">)</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">12</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span>y <span class="operator">=</span> <span class="number">0.35</span><span class="punctuation">,</span>label <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&quot;PERMANOVA:\n    Group_A VS Group_B\n    p-value = &quot;</span><span class="punctuation">,</span>otu.adonis<span class="operator">$</span>aov.tab<span class="operator">$</span>`Pr(&gt;F)`<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span>size <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span>hjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  stat_ellipse<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> group<span class="punctuation">)</span><span class="punctuation">,</span>geom <span class="operator">=</span> <span class="string">&quot;polygon&quot;</span><span class="punctuation">,</span>level <span class="operator">=</span> <span class="number">0.95</span><span class="punctuation">,</span>alpha <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_shape_manual<span class="punctuation">(</span>values<span class="operator">=</span>pich<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_colour_manual<span class="punctuation">(</span>values<span class="operator">=</span>Palette<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span>values<span class="operator">=</span>cbbPalette<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>title<span class="operator">=</span><span class="string">&quot;PCoA - The composition of gut microbiome&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  xlab<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;PC1 ( &quot;</span><span class="punctuation">,</span>pc1<span class="punctuation">,</span><span class="string">&quot;%&quot;</span><span class="punctuation">,</span><span class="string">&quot; )&quot;</span><span class="punctuation">,</span>sep<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  ylab<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;PC2 ( &quot;</span><span class="punctuation">,</span>pc2<span class="punctuation">,</span><span class="string">&quot;%&quot;</span><span class="punctuation">,</span><span class="string">&quot; )&quot;</span><span class="punctuation">,</span>sep<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>text<span class="operator">=</span>element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">30</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_vline<span class="punctuation">(</span>aes<span class="punctuation">(</span>xintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span>linetype<span class="operator">=</span><span class="string">&quot;dotted&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>aes<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span>linetype<span class="operator">=</span><span class="string">&quot;dotted&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill<span class="operator">=</span><span class="string">&#x27;white&#x27;</span><span class="punctuation">,</span> colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        panel.grid<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.ticks.length <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span><span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.ticks <span class="operator">=</span> element_line<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        axis.title.x<span class="operator">=</span>element_text<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.title.y<span class="operator">=</span>element_text<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.text<span class="operator">=</span>element_text<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">28</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.title<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.text<span class="operator">=</span>element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.key<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>legend.position <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.12</span><span class="punctuation">,</span><span class="number">0.88</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.key.height<span class="operator">=</span>unit<span class="punctuation">(</span><span class="number">1.6</span><span class="punctuation">,</span><span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">34</span><span class="punctuation">,</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span>hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span>face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#同时显示两种分类方法</span></span><br><span class="line">data <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&quot;otu_taxa_table.txt&quot;</span><span class="punctuation">,</span> head<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span>sep<span class="operator">=</span><span class="string">&quot;\t&quot;</span><span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">groups <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;group.list.txt&quot;</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span>colClasses <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;character&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">groups <span class="operator">&lt;-</span> as.list<span class="punctuation">(</span>groups<span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> t<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">[</span><span class="built_in">is.na</span><span class="punctuation">(</span>data<span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">0</span></span><br><span class="line">data <span class="operator">&lt;-</span> vegdist<span class="punctuation">(</span>data<span class="punctuation">,</span>method <span class="operator">=</span> <span class="string">&quot;bray&quot;</span><span class="punctuation">)</span></span><br><span class="line">pcoa<span class="operator">&lt;-</span> pcoa<span class="punctuation">(</span>data<span class="punctuation">,</span> correction <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">,</span> rn <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span></span><br><span class="line">PC1 <span class="operator">=</span> pcoa<span class="operator">$</span>vectors<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">PC2 <span class="operator">=</span> pcoa<span class="operator">$</span>vectors<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line">plotdata <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>rownames<span class="punctuation">(</span>pcoa<span class="operator">$</span>vectors<span class="punctuation">)</span><span class="punctuation">,</span>PC1<span class="punctuation">,</span>PC2<span class="punctuation">,</span>groups<span class="operator">$</span>V2<span class="punctuation">,</span>groups<span class="operator">$</span>V3<span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>plotdata<span class="punctuation">)</span> <span class="operator">&lt;-</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;sample&quot;</span><span class="punctuation">,</span><span class="string">&quot;PC1&quot;</span><span class="punctuation">,</span><span class="string">&quot;PC2&quot;</span><span class="punctuation">,</span><span class="string">&quot;Treatment&quot;</span><span class="punctuation">,</span><span class="string">&quot;Time&quot;</span><span class="punctuation">)</span></span><br><span class="line">pich<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">21</span><span class="operator">:</span><span class="number">25</span><span class="punctuation">)</span></span><br><span class="line">cbbPalette <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#E69F00&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#56B4E9&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#009E73&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#F0E442&quot;</span><span class="punctuation">)</span></span><br><span class="line">pc1 <span class="operator">&lt;-</span><span class="built_in">floor</span><span class="punctuation">(</span>pcoa<span class="operator">$</span>values<span class="operator">$</span>Relative_eig<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="operator">*</span><span class="number">100</span><span class="punctuation">)</span></span><br><span class="line">pc2 <span class="operator">&lt;-</span><span class="built_in">floor</span><span class="punctuation">(</span>pcoa<span class="operator">$</span>values<span class="operator">$</span>Relative_eig<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="operator">*</span><span class="number">100</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>plotdata<span class="punctuation">,</span> aes<span class="punctuation">(</span>PC1<span class="punctuation">,</span> PC2<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>shape<span class="operator">=</span>Time<span class="punctuation">,</span>fill<span class="operator">=</span>Treatment<span class="punctuation">,</span>colour<span class="operator">=</span>Treatment<span class="punctuation">)</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">10</span><span class="punctuation">)</span><span class="operator">+</span> </span><br><span class="line">  scale_shape_manual<span class="punctuation">(</span>values<span class="operator">=</span>pich<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_colour_manual<span class="punctuation">(</span>values<span class="operator">=</span>cbbPalette<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span>values<span class="operator">=</span>cbbPalette<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>title<span class="operator">=</span><span class="string">&quot;PCoA - PC1-VS-PC2&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  xlab<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;PC1 ( &quot;</span><span class="punctuation">,</span>pc1<span class="punctuation">,</span><span class="string">&quot;%&quot;</span><span class="punctuation">,</span><span class="string">&quot; )&quot;</span><span class="punctuation">,</span>sep<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  ylab<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;PC2 ( &quot;</span><span class="punctuation">,</span>pc2<span class="punctuation">,</span><span class="string">&quot;%&quot;</span><span class="punctuation">,</span><span class="string">&quot; )&quot;</span><span class="punctuation">,</span>sep<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>text<span class="operator">=</span>element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">30</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_vline<span class="punctuation">(</span>aes<span class="punctuation">(</span>xintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span>linetype<span class="operator">=</span><span class="string">&quot;dotted&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>aes<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span>linetype<span class="operator">=</span><span class="string">&quot;dotted&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill<span class="operator">=</span><span class="string">&#x27;white&#x27;</span><span class="punctuation">,</span> colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        panel.grid<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.ticks.length <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span><span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.ticks <span class="operator">=</span> element_line<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        axis.title.x<span class="operator">=</span>element_text<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.title.y<span class="operator">=</span>element_text<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.text<span class="operator">=</span>element_text<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">28</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.title<span class="operator">=</span>element_text<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span>size <span class="operator">=</span> <span class="number">34</span><span class="punctuation">,</span>face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.text<span class="operator">=</span>element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.key<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.key.height<span class="operator">=</span>unit<span class="punctuation">(</span><span class="number">1.6</span><span class="punctuation">,</span><span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">34</span><span class="punctuation">,</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span>hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span>face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#分组数目较多、组内生物学重复较少</span></span><br><span class="line">data <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&quot;otu 2.txt&quot;</span><span class="punctuation">,</span> head<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span>sep<span class="operator">=</span><span class="string">&quot;\t&quot;</span><span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> t<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">[</span><span class="built_in">is.na</span><span class="punctuation">(</span>data<span class="punctuation">)</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">0</span></span><br><span class="line">data <span class="operator">&lt;-</span> vegdist<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line">pcoa<span class="operator">&lt;-</span> pcoa<span class="punctuation">(</span>data<span class="punctuation">,</span> correction <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">,</span> rn <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span></span><br><span class="line">groups <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;group 2.txt&quot;</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">,</span>colClasses <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;character&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">groups <span class="operator">&lt;-</span> as.list<span class="punctuation">(</span>groups<span class="punctuation">)</span></span><br><span class="line">groups<span class="operator">$</span>V2 <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>groups<span class="operator">$</span>V2<span class="punctuation">,</span>levels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Jan&quot;</span><span class="punctuation">,</span><span class="string">&quot;Feb&quot;</span><span class="punctuation">,</span><span class="string">&quot;Mar&quot;</span><span class="punctuation">,</span><span class="string">&quot;Apr&quot;</span><span class="punctuation">,</span><span class="string">&quot;May&quot;</span><span class="punctuation">,</span><span class="string">&quot;Jun&quot;</span><span class="punctuation">,</span><span class="string">&quot;Jul&quot;</span><span class="punctuation">,</span><span class="string">&quot;Aug&quot;</span><span class="punctuation">,</span><span class="string">&quot;Sep&quot;</span><span class="punctuation">,</span><span class="string">&quot;Oct&quot;</span><span class="punctuation">,</span><span class="string">&quot;Nov&quot;</span><span class="punctuation">,</span><span class="string">&quot;Dec&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">PC1 <span class="operator">=</span> pcoa<span class="operator">$</span>vectors<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">PC2 <span class="operator">=</span> pcoa<span class="operator">$</span>vectors<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line">plotdata <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>rownames<span class="punctuation">(</span>pcoa<span class="operator">$</span>vectors<span class="punctuation">)</span><span class="punctuation">,</span>PC1<span class="punctuation">,</span>PC2<span class="punctuation">,</span>groups<span class="operator">$</span>V2<span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>plotdata<span class="punctuation">)</span> <span class="operator">&lt;-</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;sample&quot;</span><span class="punctuation">,</span><span class="string">&quot;PC1&quot;</span><span class="punctuation">,</span><span class="string">&quot;PC2&quot;</span><span class="punctuation">,</span><span class="string">&quot;group&quot;</span><span class="punctuation">)</span></span><br><span class="line">pc1 <span class="operator">&lt;-</span><span class="built_in">floor</span><span class="punctuation">(</span>pcoa<span class="operator">$</span>values<span class="operator">$</span>Relative_eig<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="operator">*</span><span class="number">100</span><span class="punctuation">)</span></span><br><span class="line">pc2 <span class="operator">&lt;-</span><span class="built_in">floor</span><span class="punctuation">(</span>pcoa<span class="operator">$</span>values<span class="operator">$</span>Relative_eig<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="operator">*</span><span class="number">100</span><span class="punctuation">)</span></span><br><span class="line">pich<span class="operator">=</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">21</span><span class="operator">:</span><span class="number">24</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>RColorBrewer<span class="punctuation">)</span></span><br><span class="line">cbbPalette <span class="operator">&lt;-</span> brewer.pal<span class="punctuation">(</span><span class="number">12</span><span class="punctuation">,</span><span class="string">&quot;Set3&quot;</span><span class="punctuation">)</span></span><br><span class="line">Palette <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;#000000&quot;</span><span class="punctuation">,</span><span class="number">12</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>plotdata<span class="punctuation">,</span> aes<span class="punctuation">(</span>PC1<span class="punctuation">,</span> PC2<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>colour<span class="operator">=</span>group<span class="punctuation">,</span>shape<span class="operator">=</span>group<span class="punctuation">,</span>fill<span class="operator">=</span>group<span class="punctuation">)</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">8</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_label_repel<span class="punctuation">(</span>aes<span class="punctuation">(</span>PC1<span class="punctuation">,</span>PC2<span class="punctuation">,</span>label <span class="operator">=</span> sample<span class="punctuation">)</span><span class="punctuation">,</span>fill <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   box.padding <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.6</span><span class="punctuation">,</span><span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>segment.colour <span class="operator">=</span> <span class="string">&quot;grey50&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   label.padding <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.35</span><span class="punctuation">,</span><span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_shape_manual<span class="punctuation">(</span>values<span class="operator">=</span>pich<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_colour_manual<span class="punctuation">(</span>values<span class="operator">=</span>Palette<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span>values<span class="operator">=</span>cbbPalette<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>title<span class="operator">=</span><span class="string">&quot;PCoA - The composition of microbiome in sediment&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  xlab<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;PC1 ( &quot;</span><span class="punctuation">,</span>pc1<span class="punctuation">,</span><span class="string">&quot;%&quot;</span><span class="punctuation">,</span><span class="string">&quot; )&quot;</span><span class="punctuation">,</span>sep<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  ylab<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;PC2 ( &quot;</span><span class="punctuation">,</span>pc2<span class="punctuation">,</span><span class="string">&quot;%&quot;</span><span class="punctuation">,</span><span class="string">&quot; )&quot;</span><span class="punctuation">,</span>sep<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>text<span class="operator">=</span>element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">30</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_vline<span class="punctuation">(</span>aes<span class="punctuation">(</span>xintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span>linetype<span class="operator">=</span><span class="string">&quot;dotted&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>aes<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span>linetype<span class="operator">=</span><span class="string">&quot;dotted&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill<span class="operator">=</span><span class="string">&#x27;white&#x27;</span><span class="punctuation">,</span> colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        panel.grid<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.ticks.length <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span><span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.ticks <span class="operator">=</span> element_line<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        axis.title.x<span class="operator">=</span>element_text<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.title.y<span class="operator">=</span>element_text<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.text<span class="operator">=</span>element_text<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">28</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.title<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.text<span class="operator">=</span>element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">28</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.key<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>legend.position <span class="operator">=</span> <span class="string">&quot;right&quot;</span><span class="punctuation">,</span></span><br><span class="line">        legend.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.key.height<span class="operator">=</span>unit<span class="punctuation">(</span><span class="number">1.55</span><span class="punctuation">,</span><span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">34</span><span class="punctuation">,</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span>hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span>face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="pca分析"><strong>PCA分析</strong></h4>
<p>PCA（principal component analysis）中文名字叫主成分分析：基于特征向量的排序方法，分析对象是原始的定量数据。排序图展示样方之间的欧氏距离。</p>
<p>PCoA（principal coordinate analysis）中文名字叫主坐标分析：分析对象为距离矩阵，而非原始的样方-变量矩阵。因此可以灵活选着关联测度。</p>
<p>这样我们就发现了这两种非约束排序的区别：PCA是基于原始物种所做的排序分析，而PCoA则是基于物种组成计算得到的距离矩阵。</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">df <span class="operator">&lt;-</span>  iris<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">df_pca <span class="operator">&lt;-</span> prcomp<span class="punctuation">(</span>df<span class="punctuation">)</span> <span class="comment">#计算主成分</span></span><br><span class="line">head<span class="punctuation">(</span>df_pca<span class="punctuation">,</span><span class="number">3</span><span class="punctuation">)</span> <span class="comment">#查看主成分结果</span></span><br><span class="line">plot<span class="punctuation">(</span>df_pca<span class="operator">$</span>x<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span>df_pca<span class="operator">$</span>x<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">df_pcs <span class="operator">&lt;-</span>data.frame<span class="punctuation">(</span>df_pca<span class="operator">$</span>x<span class="punctuation">,</span> Species <span class="operator">=</span> iris<span class="operator">$</span>Species<span class="punctuation">)</span> <span class="comment">#生成数据框</span></span><br><span class="line">df_pcs</span><br><span class="line"><span class="comment">#按Species分颜色</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df_pcs<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>PC1<span class="punctuation">,</span>y<span class="operator">=</span>PC2<span class="punctuation">,</span>color<span class="operator">=</span>Species<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>  <span class="comment">#去除背景及网格线</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span> </span><br><span class="line">  theme_bw<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.border<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>panel.grid.major<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>panel.grid.minor<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>axis.line<span class="operator">=</span> element_line<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">percentage <span class="operator">&lt;-</span> <span class="built_in">round</span><span class="punctuation">(</span>df_pca<span class="operator">$</span>sdev<span class="operator">/</span><span class="built_in">sum</span><span class="punctuation">(</span>df_pca<span class="operator">$</span>sdev<span class="punctuation">)</span><span class="operator">*</span><span class="number">100</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">percentage</span><br><span class="line">percentage <span class="operator">&lt;-</span> paste<span class="punctuation">(</span>colnames<span class="punctuation">(</span>df_pcs<span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&quot;(&quot;</span><span class="punctuation">,</span>paste<span class="punctuation">(</span><span class="built_in">as.character</span><span class="punctuation">(</span>percentage<span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&quot;%&quot;</span><span class="punctuation">,</span><span class="string">&quot;)&quot;</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df_pcs<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>PC1<span class="punctuation">,</span>y<span class="operator">=</span>PC2<span class="punctuation">,</span>color <span class="operator">=</span> Species<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span>xlab<span class="punctuation">(</span>percentage<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  ylab<span class="punctuation">(</span>percentage<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#添加置信椭圆</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df_pcs<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>PC1<span class="punctuation">,</span>y<span class="operator">=</span>PC2<span class="punctuation">,</span>color <span class="operator">=</span> Species<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_point<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span>stat_ellipse<span class="punctuation">(</span>level <span class="operator">=</span> <span class="number">0.95</span><span class="punctuation">,</span>show.legend <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span> label <span class="operator">=</span> <span class="string">&#x27;setosa&#x27;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="operator">-</span><span class="number">2</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="operator">-</span><span class="number">1.25</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&#x27;#f8766d&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span> label <span class="operator">=</span> <span class="string">&#x27;versicolor&#x27;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="operator">-</span> <span class="number">0.5</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&#x27;#00ba38&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span> label <span class="operator">=</span> <span class="string">&#x27;virginica&#x27;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&#x27;#619cff&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#查看各变量对于PCA的贡献</span></span><br><span class="line">df_r <span class="operator">&lt;-</span> as.data.frame<span class="punctuation">(</span>df_pca<span class="operator">$</span>rotation<span class="punctuation">)</span></span><br><span class="line">df_r<span class="operator">$</span>feature <span class="operator">&lt;-</span> rownames<span class="punctuation">(</span>df_r<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#贡献度绘图</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df_r<span class="punctuation">,</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> PC1<span class="punctuation">,</span>y<span class="operator">=</span> PC2 <span class="punctuation">,</span>label <span class="operator">=</span> feature <span class="punctuation">,</span>color <span class="operator">=</span> feature<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_point<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span> geom_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#绘图总展示</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df_pcs<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>PC1<span class="punctuation">,</span>y<span class="operator">=</span>PC2<span class="punctuation">,</span>color<span class="operator">=</span>Species <span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> geom_point<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span>xlab<span class="punctuation">(</span>percentage<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">+</span> ylab<span class="punctuation">(</span>percentage<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">+</span> stat_ellipse<span class="punctuation">(</span>level <span class="operator">=</span> <span class="number">0.95</span><span class="punctuation">,</span> show.legend <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span> label <span class="operator">=</span> <span class="string">&#x27;setosa&#x27;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="operator">-</span><span class="number">2</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="operator">-</span><span class="number">1.25</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&#x27;#f8766d&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span> label <span class="operator">=</span> <span class="string">&#x27;versicolor&#x27;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="operator">-</span> <span class="number">0.5</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&#x27;#00ba38&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  annotate<span class="punctuation">(</span><span class="string">&#x27;text&#x27;</span><span class="punctuation">,</span> label <span class="operator">=</span> <span class="string">&#x27;virginica&#x27;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&#x27;#619cff&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span> labs<span class="punctuation">(</span>title<span class="operator">=</span><span class="string">&quot;Iris PCA Clustering&quot;</span><span class="punctuation">,</span> </span><br><span class="line">                                                                                             subtitle<span class="operator">=</span><span class="string">&quot; PC1 and PC2 principal components &quot;</span><span class="punctuation">,</span>       caption<span class="operator">=</span><span class="string">&quot;Source: Iris&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> theme_classic<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>一种老方法<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">pca_plot <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>dddd<span class="punctuation">,</span>ggggg<span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">  library<span class="punctuation">(</span><span class="string">&quot;FactoMineR&quot;</span><span class="punctuation">)</span></span><br><span class="line">  library<span class="punctuation">(</span><span class="string">&quot;factoextra&quot;</span><span class="punctuation">)</span></span><br><span class="line">  df.pca <span class="operator">&lt;-</span> PCA<span class="punctuation">(</span>t<span class="punctuation">(</span>dddd<span class="punctuation">)</span><span class="punctuation">,</span> graph <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">  fviz_pca_ind<span class="punctuation">(</span>df.pca<span class="punctuation">,</span></span><br><span class="line">               <span class="comment">#axes = c(2,3),</span></span><br><span class="line">               geom.ind <span class="operator">=</span> <span class="string">&quot;point&quot;</span><span class="punctuation">,</span></span><br><span class="line">               col.ind <span class="operator">=</span> ggggg <span class="punctuation">,</span><span class="comment">#分组</span></span><br><span class="line">               addEllipses <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span></span><br><span class="line">               legend.title <span class="operator">=</span> <span class="string">&quot;Groups&quot;</span></span><br><span class="line">  <span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">pca_plot<span class="punctuation">(</span>otu_file<span class="punctuation">,</span>group<span class="operator">$</span>group<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><strong>另一种PCA方法(基于ggbiplot包)</strong></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>devtools<span class="punctuation">)</span></span><br><span class="line">install_github<span class="punctuation">(</span><span class="string">&quot;vqv/ggbiplot&quot;</span><span class="punctuation">)</span> <span class="comment">#安装</span></span><br><span class="line">library<span class="punctuation">(</span>ggbiplot<span class="punctuation">)</span></span><br><span class="line">design <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;sample.txt&quot;</span><span class="punctuation">,</span> header<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span> row.names<span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep<span class="operator">=</span><span class="string">&quot;\t&quot;</span><span class="punctuation">)</span>  <span class="comment">#导入分组信息表 </span></span><br><span class="line">count <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&quot;Genu_0.001.txt&quot;</span><span class="punctuation">,</span> row.names<span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>  header<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span> sep<span class="operator">=</span><span class="string">&quot;\t&quot;</span><span class="punctuation">)</span> <span class="comment">#导入相对丰度表</span></span><br><span class="line"><span class="comment"># 转换原始数据为百分比 norm = t(t(count)/colSums(count,na=T)) * 100</span></span><br><span class="line">otu.pca <span class="operator">&lt;-</span> prcomp<span class="punctuation">(</span>t<span class="punctuation">(</span>count<span class="punctuation">)</span><span class="punctuation">,</span> scale. <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> </span><br><span class="line">ggbiplot<span class="punctuation">(</span>otu.pca<span class="punctuation">,</span> obs.scale <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> var.scale <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>groups <span class="operator">=</span> design<span class="operator">$</span>group<span class="punctuation">,</span> ellipse <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span>var.axes <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">OTUs_mad.5 <span class="operator">=</span> head<span class="punctuation">(</span>count<span class="punctuation">[</span>order<span class="punctuation">(</span>apply<span class="punctuation">(</span>count<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span>mad<span class="punctuation">)</span><span class="punctuation">,</span> decreasing<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">,</span>n<span class="operator">=</span><span class="number">8</span><span class="punctuation">)</span> </span><br><span class="line">otu.pca <span class="operator">&lt;-</span> prcomp<span class="punctuation">(</span>t<span class="punctuation">(</span>OTUs_mad.5<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">ggbiplot<span class="punctuation">(</span>otu.pca<span class="punctuation">,</span> obs.scale <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> var.scale <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> groups <span class="operator">=</span> design<span class="operator">$</span>group<span class="punctuation">,</span> ellipse <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span>var.axes <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 我们仅用中值绝对偏差(mad)最大的8个OTUs进行主成分分析，即可将三组样品明显分开。</span></span><br><span class="line"><span class="comment"># 图中向量长短代表差异贡献，方向为与主成分的相关性。可以看到最长的向量Streptophyta与X轴近平行，</span></span><br><span class="line"><span class="comment"># 表示PC1的差异主要由此菌贡献。其它菌与其方向相反代表OTUs间可能负相关；夹角小于90%的代表两个OTUs有正相关</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>另外基于ggord的PCA</strong></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggord<span class="punctuation">)</span> <span class="comment">#使用geom_ord_ellipse这个图层呢，随便你加置信区间，想加几个就加几个</span></span><br><span class="line"><span class="comment">#不仅针对LDA，也支持其它的ordination plot</span></span><br><span class="line">devtools<span class="operator">::</span>install_github<span class="punctuation">(</span><span class="string">&#x27;fawda123/ggord&#x27;</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggord<span class="punctuation">)</span> </span><br><span class="line">library<span class="punctuation">(</span>MASS<span class="punctuation">)</span></span><br><span class="line">ord <span class="operator">&lt;-</span> prcomp<span class="punctuation">(</span>iris<span class="punctuation">[</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggord<span class="punctuation">(</span>ord<span class="punctuation">,</span> iris<span class="operator">$</span>Species<span class="punctuation">)</span> ;p</span><br><span class="line">library<span class="punctuation">(</span>yyplot<span class="punctuation">)</span> </span><br><span class="line">p <span class="operator">+</span> geom_ord_ellipse<span class="punctuation">(</span>ellipse_pro <span class="operator">=</span> <span class="number">.96</span><span class="punctuation">,</span> color<span class="operator">=</span><span class="string">&#x27;firebrick&#x27;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span> lty<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_ord_ellipse<span class="punctuation">(</span>ellipse_pro <span class="operator">=</span> <span class="number">.99</span><span class="punctuation">,</span> lty<span class="operator">=</span><span class="number">2</span><span class="punctuation">)</span>  </span><br></pre></td></tr></table></figure>
<p><strong>PCA</strong></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#载入分析包</span></span><br><span class="line">library<span class="punctuation">(</span>FactoMineR<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggrepel<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#载入绘图数据</span></span><br><span class="line">df <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;otu_taxa_table.txt&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#载入分组数据</span></span><br><span class="line">groups <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&quot;group.list.txt&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span></span><br><span class="line">                     colClasses<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;character&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#绝对丰度表转化为相对丰度表</span></span><br><span class="line">df1 <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span>nrow <span class="operator">=</span> nrow<span class="punctuation">(</span>df<span class="punctuation">)</span><span class="punctuation">,</span> ncol <span class="operator">=</span> ncol<span class="punctuation">(</span>df<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="keyword">for</span><span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span>ncol<span class="punctuation">(</span>df<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">  df1<span class="punctuation">[</span><span class="punctuation">,</span>i<span class="punctuation">]</span> <span class="operator">=</span> df<span class="punctuation">[</span> <span class="punctuation">,</span>i<span class="punctuation">]</span><span class="operator">/</span><span class="built_in">sum</span><span class="punctuation">(</span>df<span class="punctuation">[</span> <span class="punctuation">,</span>i<span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">colnames<span class="punctuation">(</span>df1<span class="punctuation">)</span> <span class="operator">&lt;-</span> colnames<span class="punctuation">(</span>df<span class="punctuation">)</span></span><br><span class="line">rownames<span class="punctuation">(</span>df1<span class="punctuation">)</span> <span class="operator">&lt;-</span> rownames<span class="punctuation">(</span>df<span class="punctuation">)</span></span><br><span class="line">df <span class="operator">&lt;-</span> t<span class="punctuation">(</span>df1<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#PCA        </span></span><br><span class="line">pca <span class="operator">&lt;-</span> PCA<span class="punctuation">(</span>df<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span>ncol<span class="punctuation">(</span>df<span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span>scale.unit <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span>graph <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#PCA结果保存</span></span><br><span class="line">write.csv<span class="punctuation">(</span>pca<span class="operator">$</span>ind<span class="operator">$</span>coord<span class="punctuation">,</span>file<span class="operator">=</span><span class="string">&quot;pca.csv&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#支持一种分组方式和两种分组方式，</span></span><br><span class="line">pc1 <span class="operator">&lt;-</span> pca<span class="operator">$</span>ind<span class="operator">$</span>coord<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">pc2 <span class="operator">&lt;-</span> pca<span class="operator">$</span>ind<span class="operator">$</span>coord<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line">ncol <span class="operator">&lt;-</span> ncol<span class="punctuation">(</span>groups<span class="punctuation">)</span></span><br><span class="line">group1 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">group2 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="punctuation">)</span> </span><br><span class="line"><span class="comment">#通过循环式的分组文件中样本的顺序与pca结果文件中一致</span></span><br><span class="line"><span class="keyword">for</span><span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="built_in">length</span><span class="punctuation">(</span>groups<span class="operator">$</span>V1<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">  Order <span class="operator">&lt;-</span> grep<span class="punctuation">(</span>rownames<span class="punctuation">(</span>pca<span class="operator">$</span>ind<span class="operator">$</span>coord<span class="punctuation">)</span><span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">,</span>groups<span class="operator">$</span>V1<span class="punctuation">)</span></span><br><span class="line">  group1<span class="punctuation">[</span>i<span class="punctuation">]</span> <span class="operator">&lt;-</span> groups<span class="operator">$</span>V2<span class="punctuation">[</span>Order<span class="punctuation">]</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span>ncol<span class="operator">==</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">    group2<span class="punctuation">[</span>i<span class="punctuation">]</span> <span class="operator">&lt;-</span> groups<span class="operator">$</span>V3<span class="punctuation">[</span>Order<span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">&#125;</span></span><br><span class="line"><span class="comment">#使用if来根据分组文件中的分组方式分别建立绘图文件</span></span><br><span class="line"><span class="keyword">if</span><span class="punctuation">(</span>ncol<span class="operator">==</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">  plotdata <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>rownames<span class="punctuation">(</span>pca<span class="operator">$</span>ind<span class="operator">$</span>coord<span class="punctuation">)</span><span class="punctuation">,</span>pc1<span class="punctuation">,</span>pc2<span class="punctuation">,</span>group1<span class="punctuation">)</span></span><br><span class="line">  colnames<span class="punctuation">(</span>plotdata<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;sample&quot;</span><span class="punctuation">,</span><span class="string">&quot;PC1&quot;</span><span class="punctuation">,</span><span class="string">&quot;PC2&quot;</span><span class="punctuation">,</span><span class="string">&quot;group&quot;</span><span class="punctuation">)</span></span><br><span class="line">  point <span class="operator">&lt;-</span> geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> group<span class="punctuation">,</span>fill <span class="operator">=</span> group<span class="punctuation">,</span>shape <span class="operator">=</span> group<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                      size <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span><span class="keyword">else</span> <span class="keyword">if</span><span class="punctuation">(</span>ncol<span class="operator">==</span><span class="number">3</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">  plotdata <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>rownames<span class="punctuation">(</span>pca<span class="operator">$</span>ind<span class="operator">$</span>coord<span class="punctuation">)</span><span class="punctuation">,</span>pc1<span class="punctuation">,</span>pc2<span class="punctuation">,</span>group1<span class="punctuation">,</span>group2<span class="punctuation">)</span></span><br><span class="line">  colnames<span class="punctuation">(</span>plotdata<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;sample&quot;</span><span class="punctuation">,</span><span class="string">&quot;PC1&quot;</span><span class="punctuation">,</span><span class="string">&quot;PC2&quot;</span><span class="punctuation">,</span><span class="string">&quot;group1&quot;</span><span class="punctuation">,</span><span class="string">&quot;group2&quot;</span><span class="punctuation">)</span></span><br><span class="line">  point <span class="operator">&lt;-</span> geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> group1<span class="punctuation">,</span>fill <span class="operator">=</span> group1<span class="punctuation">,</span>shape <span class="operator">=</span> group2<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                      size <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#通过向量指定绘图中的一些参数，包括坐标轴文字、样本点形状和颜色。</span></span><br><span class="line">pc1 <span class="operator">&lt;-</span> <span class="built_in">floor</span><span class="punctuation">(</span>pca<span class="operator">$</span>eig<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="operator">*</span><span class="number">100</span><span class="punctuation">)</span><span class="operator">/</span><span class="number">100</span></span><br><span class="line">pc2 <span class="operator">&lt;-</span> <span class="built_in">floor</span><span class="punctuation">(</span>pca<span class="operator">$</span>eig<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="operator">*</span><span class="number">100</span><span class="punctuation">)</span><span class="operator">/</span><span class="number">100</span></span><br><span class="line">pich <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">22</span><span class="operator">:</span><span class="number">26</span><span class="punctuation">)</span></span><br><span class="line">cbbPalette <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#E69F00&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#56B4E9&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#009E73&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#F0E442&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#计算与PCA中前两轴相关的物种</span></span><br><span class="line">di <span class="operator">&lt;-</span> dimdesc<span class="punctuation">(</span>pca<span class="punctuation">,</span> axes <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> proba <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#根据相关性结果从大到小排序，每个轴选择排名前3的物种</span></span><br><span class="line">dim1.cor <span class="operator">&lt;-</span> pca<span class="operator">$</span>var<span class="operator">$</span>cor<span class="punctuation">[</span>row.names<span class="punctuation">(</span>pca<span class="operator">$</span>var<span class="operator">$</span>coord<span class="punctuation">)</span> <span class="operator">%in%</span> </span><br><span class="line">                          row.names<span class="punctuation">(</span>di<span class="operator">$</span>Dim.1<span class="operator">$</span>quanti<span class="punctuation">[</span>order<span class="punctuation">(</span>di<span class="operator">$</span>Dim.1<span class="operator">$</span>quanti<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span> </span><br><span class="line">dim2.cor <span class="operator">&lt;-</span> pca<span class="operator">$</span>var<span class="operator">$</span>cor<span class="punctuation">[</span>row.names<span class="punctuation">(</span>pca<span class="operator">$</span>var<span class="operator">$</span>coord<span class="punctuation">)</span> <span class="operator">%in%</span> </span><br><span class="line">                          row.names<span class="punctuation">(</span>di<span class="operator">$</span>Dim.2<span class="operator">$</span>quanti<span class="punctuation">[</span>order<span class="punctuation">(</span>di<span class="operator">$</span>Dim.2<span class="operator">$</span>quanti<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line"><span class="comment">#建立绘图所需文件</span></span><br><span class="line">dim12.cor <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>dim1.cor<span class="punctuation">,</span>dim2.cor<span class="punctuation">)</span></span><br><span class="line">di.cor <span class="operator">&lt;-</span> dim12.cor<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line">di.cor <span class="operator">&lt;-</span> as.data.frame<span class="punctuation">(</span>di.cor<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#载入绘图包</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggrepel<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#图像绘制</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>plotdata<span class="punctuation">,</span>aes<span class="punctuation">(</span>PC1<span class="punctuation">,</span>PC2<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  <span class="comment">#添加样本名称</span></span><br><span class="line">  geom_label_repel<span class="punctuation">(</span>aes<span class="punctuation">(</span>PC1<span class="punctuation">,</span>PC2<span class="punctuation">,</span>label <span class="operator">=</span> sample<span class="punctuation">)</span><span class="punctuation">,</span>fill <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   box.padding <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.6</span><span class="punctuation">,</span><span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>segment.colour <span class="operator">=</span> <span class="string">&quot;grey50&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   label.padding <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.35</span><span class="punctuation">,</span><span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>family <span class="operator">=</span> <span class="string">&quot;Arial&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  point <span class="operator">+</span> </span><br><span class="line">  scale_shape_manual<span class="punctuation">(</span>values <span class="operator">=</span> pich<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span>values<span class="operator">=</span>cbbPalette<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_color_manual<span class="punctuation">(</span>values<span class="operator">=</span>cbbPalette<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>title<span class="operator">=</span><span class="string">&quot;PCA Plot&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  xlab<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;PC1 ( &quot;</span><span class="punctuation">,</span>pc1<span class="punctuation">,</span><span class="string">&quot;%&quot;</span><span class="punctuation">,</span><span class="string">&quot; )&quot;</span><span class="punctuation">,</span>sep<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  ylab<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;PC2 ( &quot;</span><span class="punctuation">,</span>pc2<span class="punctuation">,</span><span class="string">&quot;%&quot;</span><span class="punctuation">,</span><span class="string">&quot; )&quot;</span><span class="punctuation">,</span>sep<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  <span class="comment">#添加区分物种箭头</span></span><br><span class="line">  geom_segment<span class="punctuation">(</span>data <span class="operator">=</span> di.cor<span class="punctuation">,</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span>y <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span>xend <span class="operator">=</span> di.cor<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="operator">*</span><span class="number">0.06</span><span class="punctuation">,</span></span><br><span class="line">                                 yend <span class="operator">=</span> di.cor<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="operator">*</span><span class="number">0.06</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">               arrow <span class="operator">=</span> arrow<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="number">40</span><span class="punctuation">,</span><span class="built_in">length</span> <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span><span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span>size <span class="operator">=</span> <span class="number">1.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  <span class="comment">#添加区分物种名称</span></span><br><span class="line">  geom_label_repel<span class="punctuation">(</span>data <span class="operator">=</span> di.cor<span class="punctuation">,</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> di.cor<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="operator">*</span><span class="number">0.06</span><span class="punctuation">,</span>y <span class="operator">=</span> di.cor<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="operator">*</span><span class="number">0.06</span><span class="punctuation">,</span></span><br><span class="line">                                     label <span class="operator">=</span> rownames<span class="punctuation">(</span>di.cor<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   fill <span class="operator">=</span> <span class="string">&quot;grey50&quot;</span><span class="punctuation">,</span>color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span>box.padding <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.6</span><span class="punctuation">,</span><span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   segment.colour <span class="operator">=</span> <span class="string">&quot;grey50&quot;</span><span class="punctuation">,</span>label.padding <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.35</span><span class="punctuation">,</span><span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   family <span class="operator">=</span> <span class="string">&quot;Arial&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>text<span class="operator">=</span>element_text<span class="punctuation">(</span>family <span class="operator">=</span> <span class="string">&quot;Arial&quot;</span><span class="punctuation">,</span>size <span class="operator">=</span> <span class="number">34</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_vline<span class="punctuation">(</span>aes<span class="punctuation">(</span>xintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span>linetype <span class="operator">=</span> <span class="string">&quot;dotted&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>aes<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span>linetype <span class="operator">=</span> <span class="string">&quot;dotted&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;white&#x27;</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        panel.grid<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span>size <span class="operator">=</span> <span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.ticks.length <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span><span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        axis.ticks <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        axis.title.x<span class="operator">=</span>element_text<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.title.y<span class="operator">=</span>element_text<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.text<span class="operator">=</span>element_text<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">28</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.title<span class="operator">=</span>element_text<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span>size <span class="operator">=</span> <span class="number">34</span><span class="punctuation">,</span>face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.key<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.key.height<span class="operator">=</span>unit<span class="punctuation">(</span><span class="number">1.2</span><span class="punctuation">,</span><span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">34</span><span class="punctuation">,</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span>hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span></span><br><span class="line">                                  face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#保存为png图片</span></span><br><span class="line">png<span class="punctuation">(</span>filename<span class="operator">=</span><span class="string">&quot;PCA.png&quot;</span><span class="punctuation">,</span>res<span class="operator">=</span><span class="number">700</span><span class="punctuation">,</span>height<span class="operator">=</span><span class="number">5400</span><span class="punctuation">,</span>width<span class="operator">=</span><span class="number">7200</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#保存为pdf格式</span></span><br><span class="line">cairo_pdf<span class="punctuation">(</span>filename<span class="operator">=</span><span class="string">&quot;PCA.pdf&quot;</span><span class="punctuation">,</span>height<span class="operator">=</span><span class="number">10</span><span class="punctuation">,</span>width<span class="operator">=</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#通过ggsymbol包添加更多点样式</span></span><br><span class="line">ggplot<span class="punctuation">(</span>plotdata<span class="punctuation">,</span> aes<span class="punctuation">(</span>PC1<span class="punctuation">,</span> PC2<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_symbol<span class="punctuation">(</span>aes<span class="punctuation">(</span>symbol<span class="operator">=</span>group2<span class="punctuation">,</span>fill<span class="operator">=</span>group1<span class="punctuation">,</span>colour<span class="operator">=</span>group1<span class="punctuation">)</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">10</span><span class="punctuation">)</span><span class="operator">+</span> </span><br><span class="line">  scale_symbol_manual<span class="punctuation">(</span>values<span class="operator">=</span>pich<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_colour_manual<span class="punctuation">(</span>values<span class="operator">=</span>cbbPalette<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span>values<span class="operator">=</span>cbbPalette<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_label_repel<span class="punctuation">(</span>aes<span class="punctuation">(</span>PC1<span class="punctuation">,</span>PC2<span class="punctuation">,</span>label <span class="operator">=</span> sample<span class="punctuation">)</span><span class="punctuation">,</span>fill <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   box.padding <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.6</span><span class="punctuation">,</span><span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>segment.colour <span class="operator">=</span> <span class="string">&quot;grey50&quot;</span><span class="punctuation">,</span></span><br><span class="line">                   label.padding <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.35</span><span class="punctuation">,</span><span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>family <span class="operator">=</span> <span class="string">&quot;Arial&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  <span class="comment">#添加区分物种箭头</span></span><br><span class="line">  geom_segment<span class="punctuation">(</span>data <span class="operator">=</span> di.cor<span class="punctuation">,</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span>y <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span>xend <span class="operator">=</span> di.cor<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="operator">*</span><span class="number">0.06</span><span class="punctuation">,</span></span><br><span class="line">                                 yend <span class="operator">=</span> di.cor<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="operator">*</span><span class="number">0.06</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">               arrow <span class="operator">=</span> arrow<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="number">40</span><span class="punctuation">,</span><span class="built_in">length</span> <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span><span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span>size <span class="operator">=</span> <span class="number">1.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  <span class="comment">#添加区分物种名称</span></span><br><span class="line">  geom_label_repel<span class="punctuation">(</span>data <span class="operator">=</span> di.cor<span class="punctuation">,</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> di.cor<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="operator">*</span><span class="number">0.06</span><span class="punctuation">,</span>y <span class="operator">=</span> di.cor<span class="punctuation">[</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="operator">*</span><span class="number">0.06</span><span class="punctuation">,</span></span><br><span class="line">                                     label <span class="operator">=</span> rownames<span class="punctuation">(</span>di.cor<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   fill <span class="operator">=</span> <span class="string">&quot;grey50&quot;</span><span class="punctuation">,</span>color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span>box.padding <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.6</span><span class="punctuation">,</span><span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   segment.colour <span class="operator">=</span> <span class="string">&quot;grey50&quot;</span><span class="punctuation">,</span>label.padding <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.35</span><span class="punctuation">,</span><span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   family <span class="operator">=</span> <span class="string">&quot;Arial&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>title<span class="operator">=</span><span class="string">&quot;PCoA - PC1-VS-PC2&quot;</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  xlab<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;PC1 ( &quot;</span><span class="punctuation">,</span>pc1<span class="punctuation">,</span><span class="string">&quot;%&quot;</span><span class="punctuation">,</span><span class="string">&quot; )&quot;</span><span class="punctuation">,</span>sep<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  ylab<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&quot;PC2 ( &quot;</span><span class="punctuation">,</span>pc2<span class="punctuation">,</span><span class="string">&quot;%&quot;</span><span class="punctuation">,</span><span class="string">&quot; )&quot;</span><span class="punctuation">,</span>sep<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>text<span class="operator">=</span>element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">30</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_vline<span class="punctuation">(</span>aes<span class="punctuation">(</span>xintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span>linetype<span class="operator">=</span><span class="string">&quot;dotted&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_hline<span class="punctuation">(</span>aes<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span>linetype<span class="operator">=</span><span class="string">&quot;dotted&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill<span class="operator">=</span><span class="string">&#x27;white&#x27;</span><span class="punctuation">,</span> colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        panel.grid<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.ticks.length <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span><span class="string">&quot;lines&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.ticks <span class="operator">=</span> element_line<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.title.x<span class="operator">=</span>element_text<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.title.y<span class="operator">=</span>element_text<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.text<span class="operator">=</span>element_text<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">28</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.title<span class="operator">=</span>element_text<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span>size <span class="operator">=</span> <span class="number">34</span><span class="punctuation">,</span>face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.text<span class="operator">=</span>element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">34</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.key<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend.key.height<span class="operator">=</span>unit<span class="punctuation">(</span><span class="number">1.6</span><span class="punctuation">,</span><span class="string">&quot;cm&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">34</span><span class="punctuation">,</span>colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span>hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span>face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="群落bar图"><strong>群落bar图</strong></h3>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzIxNzc1Mzk3NQ==&amp;mid=2247483757&amp;idx=1&amp;sn=e3f6e387d6afef876dbd2af8b34e69dd&amp;chksm=97f5b175a0823863f9bf0ccc3272d1360a0b12869511dc82a0704a9aeeb5f4fb9fdaff8ed89a&amp;token=497100570&amp;lang=zh_CN&amp;scene=21#wechat_redirect">R语言画堆叠图实例</a></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;./Abundance/Nr_abundance/&quot;</span><span class="punctuation">)</span></span><br><span class="line">getwd<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">####读取并挑选 top10 丰度门 </span></span><br><span class="line"><span class="comment">#读取数据 </span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">phylum_top10 <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;Genu.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">phylum <span class="operator">&lt;-</span> apply<span class="punctuation">(</span>phylum_top10<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">&#123;</span>x<span class="operator">/</span><span class="built_in">sum</span><span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">&#125;</span><span class="punctuation">)</span><span class="comment">#百分比化</span></span><br><span class="line">relative_abund_table<span class="operator">&lt;-</span>decostand<span class="punctuation">(</span>abund_table<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&quot;total&quot;</span><span class="punctuation">)</span><span class="comment">#该方法也可直接计算百分比</span></span><br><span class="line">phylum_filter <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>phylum<span class="punctuation">[</span>which<span class="punctuation">(</span>apply<span class="punctuation">(</span>phylum<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">&#123;</span>mean<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">&#125;</span><span class="punctuation">)</span></span><br><span class="line">                                <span class="operator">&gt;</span><span class="number">0.001</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">,</span> check.names<span class="operator">=</span><span class="built_in">F</span><span class="punctuation">)</span> <span class="comment">#mean abundance &gt; 0.001</span></span><br><span class="line">phylum_filter <span class="operator">&lt;-</span>data.frame<span class="punctuation">(</span>phylum<span class="punctuation">[</span>apply<span class="punctuation">(</span>phylum<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="built_in">max</span><span class="punctuation">)</span><span class="operator">&gt;</span><span class="number">0.001</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="comment">#去除至少有1个样品中大于%0.1的物种</span></span><br><span class="line">phylum_filter<span class="operator">$</span><span class="built_in">sum</span> <span class="operator">&lt;-</span> rowSums<span class="punctuation">(</span>phylum_filter<span class="punctuation">)</span><span class="comment">#求各类群的丰度总和，并排序</span></span><br><span class="line">phylum_filter <span class="operator">&lt;-</span> phylum_filter<span class="punctuation">[</span>order<span class="punctuation">(</span>phylum_filter<span class="operator">$</span><span class="built_in">sum</span><span class="punctuation">,</span> decreasing <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"><span class="comment">#挑选 top10 门类群，并将 top10 外的类群合并为“Others”</span></span><br><span class="line">phylum_top10 <span class="operator">&lt;-</span> phylum_filter<span class="punctuation">[</span><span class="operator">-</span>ncol<span class="punctuation">(</span>phylum_filter<span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">phylum_top10<span class="punctuation">[</span><span class="string">&#x27;Others&#x27;</span><span class="punctuation">,</span> <span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">1</span> <span class="operator">-</span> colSums<span class="punctuation">(</span>phylum_top10<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#可选输出（如 csv 格式）</span></span><br><span class="line">write.table<span class="punctuation">(</span>phylum_top10<span class="punctuation">,</span> <span class="string">&#x27;Genu_0.001.txt&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">####barplot 作图（一个简单示例）</span></span><br><span class="line"><span class="comment">#定义作图整体分布</span></span><br><span class="line">tiff<span class="punctuation">(</span><span class="string">&#x27;barplot_plot.tiff&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">1000</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">600</span><span class="punctuation">)</span></span><br><span class="line">par<span class="punctuation">(</span>xpd <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> mar <span class="operator">=</span> par<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">$</span>mar <span class="operator">+</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">16</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">par<span class="punctuation">(</span>mar<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">6</span><span class="punctuation">,</span><span class="number">8</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">,</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span>xpd<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span>las<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span>mgp<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="comment">#mpg三个值分别控制轴标签、轴刻度值、轴刻度线与轴的距离</span></span><br><span class="line"><span class="comment">#barplot作图，包含了颜色、字体大小、图例位置等信息</span></span><br><span class="line">barplot<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span><span class="number">100</span> <span class="operator">*</span> phylum_top10<span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;yellow&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;hotpink&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;purple&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;burlywood1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;skyblue&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#8b8378&#x27;</span> <span class="punctuation">,</span><span class="string">&#x27;#458b74&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#f0ffff&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#eeb422&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#ee6aa7&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#8b3a62&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#cd5c5c&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#ee6363&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#f0e68c&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#e6e6fa&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#add8e6&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#bfefff&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#f08080&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#d1eeee&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#7a8b8b&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#8b814c&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#8b5f65&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;gray&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        legend <span class="operator">=</span> rownames<span class="punctuation">(</span>phylum_top10<span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">        cex.axis <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> cex.names <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">100</span><span class="punctuation">)</span><span class="punctuation">,</span> las <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> space <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> beside <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span></span><br><span class="line">        args.legend <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;right&#x27;</span><span class="punctuation">,</span> bty <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> inset <span class="operator">=</span> <span class="operator">-</span><span class="number">0.18</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> y.intersp <span class="operator">=</span> <span class="number">1.2</span><span class="punctuation">,</span> x.intersp <span class="operator">=</span> <span class="number">0.7</span><span class="punctuation">,</span> text.width <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">mtext<span class="punctuation">(</span><span class="string">&#x27;Relative Abundance(%)&#x27;</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> side <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> line <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">####ggplot2 作图（一个简单示例）</span></span><br><span class="line">library<span class="punctuation">(</span>reshape2<span class="punctuation">)</span>	<span class="comment">#用于排列数据</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span>	<span class="comment">#ggplot2 作图</span></span><br><span class="line"><span class="comment">#可以提前预设一个色板</span></span><br><span class="line">Palette1 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#B2182B&quot;</span><span class="punctuation">,</span><span class="string">&quot;#E69F00&quot;</span><span class="punctuation">,</span><span class="string">&quot;#56B4E9&quot;</span><span class="punctuation">,</span><span class="string">&quot;#009E73&quot;</span><span class="punctuation">,</span><span class="string">&quot;#F0E442&quot;</span><span class="punctuation">,</span><span class="string">&quot;#0072B2&quot;</span><span class="punctuation">,</span><span class="string">&quot;#D55E00&quot;</span><span class="punctuation">,</span><span class="string">&quot;#CC79A7&quot;</span><span class="punctuation">,</span><span class="string">&quot;#CC6666&quot;</span><span class="punctuation">,</span><span class="string">&quot;#9999CC&quot;</span><span class="punctuation">,</span><span class="string">&quot;#66CC99&quot;</span><span class="punctuation">,</span><span class="string">&quot;#999999&quot;</span><span class="punctuation">,</span><span class="string">&quot;#ADD1E5&quot;</span><span class="punctuation">)</span></span><br><span class="line">Palette2 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;yellow&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;hotpink&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;purple&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;burlywood1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;skyblue&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#8b8378&#x27;</span> <span class="punctuation">,</span><span class="string">&#x27;#458b74&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#f0ffff&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#eeb422&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#ee6aa7&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#8b3a62&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#cd5c5c&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#ee6363&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#f0e68c&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#e6e6fa&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#add8e6&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#bfefff&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#f08080&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#d1eeee&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#7a8b8b&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#8b814c&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;#8b5f65&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;gray&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#调整数据布局</span></span><br><span class="line">phylum_top10<span class="operator">$</span>Taxonomy <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>rownames<span class="punctuation">(</span>phylum_top10<span class="punctuation">)</span><span class="punctuation">,</span> levels <span class="operator">=</span> rev<span class="punctuation">(</span>rownames<span class="punctuation">(</span>phylum_top10<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">phylum_top10 <span class="operator">&lt;-</span> melt<span class="punctuation">(</span>phylum_top10<span class="punctuation">,</span> id <span class="operator">=</span> <span class="string">&#x27;Taxonomy&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#添加分组</span></span><br><span class="line">group <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;sample.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>group<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;variable&#x27;</span></span><br><span class="line">phylum_top10 <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>phylum_top10<span class="punctuation">,</span> group<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&#x27;variable&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#绘制带分面的柱状图</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>phylum_top10<span class="punctuation">,</span> aes<span class="punctuation">(</span>variable<span class="punctuation">,</span> <span class="number">100</span> <span class="operator">*</span> value<span class="punctuation">,</span> fill <span class="operator">=</span> Taxonomy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_col<span class="punctuation">(</span>position <span class="operator">=</span> <span class="string">&#x27;stack&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span>values <span class="operator">=</span>  Palette2<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;Relative Abundance(%)&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> strip.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">13</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">11</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme_classic<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span>scale_y_continuous<span class="punctuation">(</span>expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#scale_y_continuous(labels = scales::percent) 设置Y轴数值为百分比数值</span></span><br><span class="line"></span><br><span class="line">p1 <span class="operator">&lt;-</span> p<span class="operator">+</span> theme<span class="punctuation">(</span>text <span class="operator">=</span> element_text<span class="punctuation">(</span>family <span class="operator">=</span> <span class="string">&quot;Times&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>scale_y_continuous<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span>expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="comment">#去除空白及设置字体</span></span><br><span class="line"><span class="operator">+</span> theme<span class="punctuation">(</span>axis.text.x<span class="operator">=</span>element_text<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&quot;black&quot;</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">12</span><span class="punctuation">,</span>face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span>angle <span class="operator">=</span> <span class="operator">-</span><span class="number">90</span><span class="punctuation">,</span>vjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span>hjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span> </span><br><span class="line"> <span class="punctuation">,</span></span><br><span class="line">p</span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;Order_plot.pdf&#x27;</span><span class="punctuation">,</span> p<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">6</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##冲击图</span></span><br><span class="line">p2 <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>data <span class="operator">=</span> phylum_top10<span class="punctuation">,</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> variable<span class="punctuation">,</span> y <span class="operator">=</span> value<span class="punctuation">,</span> alluvium <span class="operator">=</span> Taxonomy<span class="punctuation">,</span> stratum <span class="operator">=</span> Taxonomy<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_alluvium<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> Taxonomy<span class="punctuation">)</span><span class="punctuation">,</span>alpha <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">,</span>width <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_stratum<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> Taxonomy<span class="punctuation">)</span><span class="punctuation">,</span>width <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">)</span><span class="operator">+</span>scale_fill_manual<span class="punctuation">(</span>values <span class="operator">=</span> rev<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span>colour<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">theme_classic<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span>scale_y_continuous<span class="punctuation">(</span>expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">   theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> strip.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.title <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">13</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.text <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">11</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;plpt.tiff&#x27;</span><span class="punctuation">,</span> p2<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">6</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h4 id="带聚类树的bar图">带聚类树的bar图</h4>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzIxNzc1Mzk3NQ==&amp;mid=2247484616&amp;idx=1&amp;sn=b7ed9e20bac5d8a8b3b72ded3d28227f&amp;chksm=97f5b4d0a0823dc6a365108ec7c5daf76a9402d28f1188b963fe307401eec3a52e8118e2570e&amp;token=497100570&amp;lang=zh_CN&amp;scene=21#wechat_redirect">R语言画聚类数实例</a></p>
<p><a href="https://www.jianshu.com/p/f28d9fbd99f3">R语言聚类树图小例子</a></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">hc<span class="operator">&lt;-</span>hclust<span class="punctuation">(</span>dist<span class="punctuation">(</span>USArrests<span class="punctuation">)</span><span class="punctuation">,</span>method<span class="operator">=</span><span class="string">&quot;ave&quot;</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggdendro<span class="punctuation">)</span></span><br><span class="line">df1<span class="operator">&lt;-</span>dendro_data<span class="punctuation">(</span>hc<span class="punctuation">,</span>type<span class="operator">=</span><span class="string">&quot;rectangle&quot;</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>segment<span class="punctuation">(</span>df1<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_segment<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>x<span class="punctuation">,</span>y<span class="operator">=</span>y<span class="punctuation">,</span>xend<span class="operator">=</span>xend<span class="punctuation">,</span>yend<span class="operator">=</span>yend<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>segment<span class="punctuation">(</span>df1<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_segment<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>x<span class="punctuation">,</span>y<span class="operator">=</span>y<span class="punctuation">,</span>xend<span class="operator">=</span>xend<span class="punctuation">,</span>yend<span class="operator">=</span>yend<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>data<span class="operator">=</span>df1<span class="operator">$</span>labels<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>x<span class="punctuation">,</span>y<span class="operator">=</span>y<span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span>label<span class="operator">=</span>label<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">            angle<span class="operator">=</span><span class="number">90</span><span class="punctuation">,</span>hjust<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span>vjust<span class="operator">=</span><span class="number">0.3</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>expand<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.2</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme_bw<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>data<span class="operator">=</span>df1<span class="operator">$</span>labels<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>x<span class="punctuation">,</span>y<span class="operator">=</span>y<span class="punctuation">)</span><span class="punctuation">,</span>color<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#给不同样品添加颜色</span></span><br><span class="line">df1<span class="operator">$</span>labels<span class="operator">$</span>Group<span class="operator">&lt;-</span><span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;A&quot;</span><span class="punctuation">,</span><span class="number">16</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;B&quot;</span><span class="punctuation">,</span><span class="number">14</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;C&quot;</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>segment<span class="punctuation">(</span>df1<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_segment<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>x<span class="punctuation">,</span>y<span class="operator">=</span>y<span class="punctuation">,</span>xend<span class="operator">=</span>xend<span class="punctuation">,</span>yend<span class="operator">=</span>yend<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>data<span class="operator">=</span>df1<span class="operator">$</span>labels<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>x<span class="punctuation">,</span>y<span class="operator">=</span>y<span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span>label<span class="operator">=</span>label<span class="punctuation">,</span>color<span class="operator">=</span>Group<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">            angle<span class="operator">=</span><span class="number">90</span><span class="punctuation">,</span>hjust<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span>vjust<span class="operator">=</span><span class="number">0.3</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>expand<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.2</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme_bw<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span>labs<span class="punctuation">(</span>x<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>data<span class="operator">=</span>df1<span class="operator">$</span>labels<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>x<span class="punctuation">,</span>y<span class="operator">=</span>y<span class="punctuation">,</span>color<span class="operator">=</span>Group<span class="punctuation">,</span>shape<span class="operator">=</span>Group<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_color_brewer<span class="punctuation">(</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span>palette <span class="operator">=</span> <span class="string">&quot;Set1&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position<span class="operator">=</span><span class="string">&quot;none&quot;</span><span class="punctuation">,</span></span><br><span class="line">        panel.grid<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        panel.border<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.text <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.ticks <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#不同样品加上阴影效果</span></span><br><span class="line">ggplot<span class="punctuation">(</span>segment<span class="punctuation">(</span>df1<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_segment<span class="punctuation">(</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>x<span class="punctuation">,</span>y<span class="operator">=</span>y<span class="punctuation">,</span>xend<span class="operator">=</span>xend<span class="punctuation">,</span>yend<span class="operator">=</span>yend<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>data<span class="operator">=</span>df1<span class="operator">$</span>labels<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>x<span class="punctuation">,</span>y<span class="operator">=</span>y<span class="operator">-</span><span class="number">1</span><span class="punctuation">,</span>label<span class="operator">=</span>label<span class="punctuation">,</span>color<span class="operator">=</span>Group<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">            angle<span class="operator">=</span><span class="number">90</span><span class="punctuation">,</span>hjust<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span>vjust<span class="operator">=</span><span class="number">0.3</span><span class="punctuation">,</span>size<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>expand<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.2</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme_bw<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span>labs<span class="punctuation">(</span>x<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_point<span class="punctuation">(</span>data<span class="operator">=</span>df1<span class="operator">$</span>labels<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>x<span class="punctuation">,</span>y<span class="operator">=</span>y<span class="punctuation">,</span>color<span class="operator">=</span>Group<span class="punctuation">,</span>shape<span class="operator">=</span>Group<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_color_brewer<span class="punctuation">(</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span>palette <span class="operator">=</span> <span class="string">&quot;Set1&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position<span class="operator">=</span><span class="string">&quot;none&quot;</span><span class="punctuation">,</span></span><br><span class="line">        panel.grid<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        panel.border<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.text <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.ticks <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_rect<span class="punctuation">(</span>aes<span class="punctuation">(</span>xmin<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>xmax<span class="operator">=</span><span class="number">16.5</span><span class="punctuation">,</span>ymin<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>ymax<span class="operator">=</span><span class="number">90</span><span class="punctuation">)</span><span class="punctuation">,</span>color<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span>fill<span class="operator">=</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span>alpha<span class="operator">=</span><span class="number">0.005</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_rect<span class="punctuation">(</span>aes<span class="punctuation">(</span>xmin<span class="operator">=</span><span class="number">16.5</span><span class="punctuation">,</span>xmax<span class="operator">=</span><span class="number">30.5</span><span class="punctuation">,</span>ymin<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>ymax<span class="operator">=</span><span class="number">90</span><span class="punctuation">)</span><span class="punctuation">,</span>color<span class="operator">=</span><span class="string">&quot;blue&quot;</span><span class="punctuation">,</span>fill<span class="operator">=</span><span class="string">&quot;blue&quot;</span><span class="punctuation">,</span>alpha<span class="operator">=</span><span class="number">0.003</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_rect<span class="punctuation">(</span>aes<span class="punctuation">(</span>xmin<span class="operator">=</span><span class="number">30.5</span><span class="punctuation">,</span>xmax<span class="operator">=</span><span class="number">50</span><span class="punctuation">,</span>ymin<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span>ymax<span class="operator">=</span><span class="number">90</span><span class="punctuation">)</span><span class="punctuation">,</span>color<span class="operator">=</span><span class="string">&quot;green&quot;</span><span class="punctuation">,</span>fill<span class="operator">=</span><span class="string">&quot;green&quot;</span><span class="punctuation">,</span>alpha<span class="operator">=</span><span class="number">0.005</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<img src="/2023/10/31/ggplot-picture/Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200707161125971.png" alt="image-20200707161125971" style="zoom:50%;">
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#导入分组文件及丰度表文件</span></span><br><span class="line"><span class="comment">#层次聚类</span></span><br><span class="line"><span class="comment">#读取 OTU 丰度表</span></span><br><span class="line">dat <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;phylum_top10.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> head <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#计算样本间距离，以群落分析中常用的 Bray-curtis 距离为例</span></span><br><span class="line">dis_bray <span class="operator">&lt;-</span> vegan<span class="operator">::</span>vegdist<span class="punctuation">(</span>t<span class="punctuation">(</span>dat<span class="punctuation">)</span><span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;bray&#x27;</span><span class="punctuation">)</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#层次聚类，以 UPGMA 为例</span></span><br><span class="line">tree <span class="operator">&lt;-</span> hclust<span class="punctuation">(</span>dis_bray<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;average&#x27;</span><span class="punctuation">)</span></span><br><span class="line">tree</span><br><span class="line"> </span><br><span class="line">plot<span class="punctuation">(</span>tree<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#接下来就是对聚类树进行调整。</span></span><br><span class="line">具体做法，首先定义一个画板，将聚类树放在画板的左侧，并按样本的已知分组信息给分支上色。聚类树的一些常见的可视化调整方法</span><br><span class="line"><span class="comment">##聚类树绘制</span></span><br><span class="line"><span class="comment">#样本分组颜色、名称等</span></span><br><span class="line">group <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;group.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> head <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">grp <span class="operator">&lt;-</span> group<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line">group_col <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>group_col<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;2&#x27;</span><span class="punctuation">)</span></span><br><span class="line">group_name <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;Control&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Treat&#x27;</span><span class="punctuation">)</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#样本分组标签</span></span><br><span class="line">layout<span class="punctuation">(</span>t<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">par<span class="punctuation">(</span>mar <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"> </span><br><span class="line">plot<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> xaxt <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> yaxt <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> frame.plot <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> xlab <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span></span><br><span class="line">    xlim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="built_in">max</span><span class="punctuation">(</span>tree<span class="operator">$</span>height<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="built_in">length</span><span class="punctuation">(</span>tree<span class="operator">$</span>order<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">legend<span class="punctuation">(</span><span class="string">&#x27;topleft&#x27;</span><span class="punctuation">,</span> legend <span class="operator">=</span> group_name<span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">15</span><span class="punctuation">,</span> col <span class="operator">=</span> group_col<span class="punctuation">,</span> bty <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#聚类树绘制，按分组给分支上色</span></span><br><span class="line">treeline <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>pos1<span class="punctuation">,</span> pos2<span class="punctuation">,</span> height<span class="punctuation">,</span> col1<span class="punctuation">,</span> col2<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    meanpos <span class="operator">=</span> <span class="punctuation">(</span>pos1<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">+</span> pos2<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">/</span> <span class="number">2</span></span><br><span class="line">    segments<span class="punctuation">(</span>y0 <span class="operator">=</span> pos1<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span> <span class="number">0.4</span><span class="punctuation">,</span> x0 <span class="operator">=</span> <span class="operator">-</span>pos1<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> y1 <span class="operator">=</span> pos1<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span> <span class="number">0.4</span><span class="punctuation">,</span> x1 <span class="operator">=</span> <span class="operator">-</span>height<span class="punctuation">,</span>  col <span class="operator">=</span> col1<span class="punctuation">,</span>lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">    segments<span class="punctuation">(</span>y0 <span class="operator">=</span> pos1<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span> <span class="number">0.4</span><span class="punctuation">,</span> x0 <span class="operator">=</span> <span class="operator">-</span>height<span class="punctuation">,</span>  y1 <span class="operator">=</span> meanpos <span class="operator">-</span> <span class="number">0.4</span><span class="punctuation">,</span> x1 <span class="operator">=</span> <span class="operator">-</span>height<span class="punctuation">,</span>  col <span class="operator">=</span> col1<span class="punctuation">,</span>lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">    segments<span class="punctuation">(</span>y0 <span class="operator">=</span> meanpos <span class="operator">-</span> <span class="number">0.4</span><span class="punctuation">,</span> x0 <span class="operator">=</span> <span class="operator">-</span>height<span class="punctuation">,</span>  y1 <span class="operator">=</span> pos2<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span> <span class="number">0.4</span><span class="punctuation">,</span> x1 <span class="operator">=</span> <span class="operator">-</span>height<span class="punctuation">,</span>  col <span class="operator">=</span> col2<span class="punctuation">,</span>lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">    segments<span class="punctuation">(</span>y0 <span class="operator">=</span> pos2<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span> <span class="number">0.4</span><span class="punctuation">,</span> x0 <span class="operator">=</span> <span class="operator">-</span>height<span class="punctuation">,</span>  y1 <span class="operator">=</span> pos2<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">-</span> <span class="number">0.4</span><span class="punctuation">,</span> x1 <span class="operator">=</span> <span class="operator">-</span>pos2<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> col <span class="operator">=</span> col2<span class="punctuation">,</span>lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"> </span><br><span class="line">meanpos <span class="operator">=</span> matrix<span class="punctuation">(</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">2</span> <span class="operator">*</span> <span class="built_in">length</span><span class="punctuation">(</span>tree<span class="operator">$</span>order<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> ncol <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">meancol <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="built_in">length</span><span class="punctuation">(</span>tree<span class="operator">$</span>order<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>step <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span>nrow<span class="punctuation">(</span>tree<span class="operator">$</span>merge<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="keyword">if</span><span class="punctuation">(</span>tree<span class="operator">$</span>merge<span class="punctuation">[</span>step<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">        pos1 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>which<span class="punctuation">(</span>tree<span class="operator">$</span>order <span class="operator">==</span> <span class="operator">-</span>tree<span class="operator">$</span>merge<span class="punctuation">[</span>step<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line">        col1 <span class="operator">&lt;-</span> group_col<span class="punctuation">[</span><span class="built_in">as.character</span><span class="punctuation">(</span>grp<span class="punctuation">[</span>tree<span class="operator">$</span>labels<span class="punctuation">[</span><span class="operator">-</span>tree<span class="operator">$</span>merge<span class="punctuation">[</span>step<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span> <span class="keyword">else</span> <span class="punctuation">&#123;</span></span><br><span class="line">        pos1 <span class="operator">&lt;-</span> meanpos<span class="punctuation">[</span>tree<span class="operator">$</span>merge<span class="punctuation">[</span>step<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">        col1 <span class="operator">&lt;-</span> meancol<span class="punctuation">[</span>tree<span class="operator">$</span>merge<span class="punctuation">[</span>step<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="keyword">if</span> <span class="punctuation">(</span>tree<span class="operator">$</span>merge<span class="punctuation">[</span>step<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;</span> <span class="number">0</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">        pos2 <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>which<span class="punctuation">(</span>tree<span class="operator">$</span>order <span class="operator">==</span> <span class="operator">-</span>tree<span class="operator">$</span>merge<span class="punctuation">[</span>step<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line">        col2 <span class="operator">&lt;-</span> group_col<span class="punctuation">[</span><span class="built_in">as.character</span><span class="punctuation">(</span>grp<span class="punctuation">[</span>tree<span class="operator">$</span>labels<span class="punctuation">[</span><span class="operator">-</span>tree<span class="operator">$</span>merge<span class="punctuation">[</span>step<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span> <span class="keyword">else</span> <span class="punctuation">&#123;</span></span><br><span class="line">        pos2 <span class="operator">&lt;-</span> meanpos<span class="punctuation">[</span>tree<span class="operator">$</span>merge<span class="punctuation">[</span>step<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">        col2 <span class="operator">&lt;-</span> meancol<span class="punctuation">[</span>tree<span class="operator">$</span>merge<span class="punctuation">[</span>step<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">    height <span class="operator">&lt;-</span> tree<span class="operator">$</span>height<span class="punctuation">[</span>step<span class="punctuation">]</span></span><br><span class="line">    treeline<span class="punctuation">(</span>pos1<span class="punctuation">,</span> pos2<span class="punctuation">,</span> height<span class="punctuation">,</span> col1<span class="punctuation">,</span> col2<span class="punctuation">)</span></span><br><span class="line">    meanpos<span class="punctuation">[</span>step<span class="punctuation">,</span> <span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="punctuation">(</span>pos1<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">+</span> pos2<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">/</span> <span class="number">2</span><span class="punctuation">,</span> height<span class="punctuation">)</span></span><br><span class="line">    <span class="keyword">if</span> <span class="punctuation">(</span>col1 <span class="operator">==</span> col2<span class="punctuation">)</span> meancol<span class="punctuation">[</span>step<span class="punctuation">]</span> <span class="operator">&lt;-</span> col1 <span class="keyword">else</span> meancol<span class="punctuation">[</span>step<span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;grey&#x27;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">##堆叠柱形图</span></span><br><span class="line"><span class="comment">#样本顺序调整为和聚类树中的顺序一致</span></span><br><span class="line">dat <span class="operator">&lt;-</span> dat<span class="punctuation">[</span> <span class="punctuation">,</span>tree<span class="operator">$</span>order<span class="punctuation">]</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#物种颜色设置</span></span><br><span class="line">phylum_color <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#8DD3C7&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FFFFB3&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#BEBADA&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FB8072&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#80B1D3&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FDB462&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#B3DE69&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FCCDE5&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#BC80BD&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#CCEBC5&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>phylum_color<span class="punctuation">)</span> <span class="operator">&lt;-</span> rownames<span class="punctuation">(</span>dat<span class="punctuation">)</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#堆叠柱形图</span></span><br><span class="line">par<span class="punctuation">(</span>mar <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"> </span><br><span class="line">bar <span class="operator">&lt;-</span> barplot<span class="punctuation">(</span>as.matrix<span class="punctuation">(</span>dat<span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> phylum_color<span class="punctuation">,</span> space <span class="operator">=</span> <span class="number">0.4</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">0.7</span><span class="punctuation">,</span> cex.axis <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> horiz <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> cex.lab <span class="operator">=</span> <span class="number">1.2</span><span class="punctuation">,</span></span><br><span class="line">    xlab <span class="operator">=</span> <span class="string">&#x27;Relative Abundance&#x27;</span><span class="punctuation">,</span> yaxt <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> las <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> ncol<span class="punctuation">(</span>dat<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> family <span class="operator">=</span> <span class="string">&#x27;mono&#x27;</span><span class="punctuation">)</span></span><br><span class="line"> </span><br><span class="line">mtext<span class="punctuation">(</span><span class="string">&#x27;Top 10 phylums&#x27;</span><span class="punctuation">,</span> side <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> line <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">text<span class="punctuation">(</span>x <span class="operator">=</span> <span class="operator">-</span><span class="number">0.05</span><span class="punctuation">,</span> y <span class="operator">=</span> bar<span class="punctuation">,</span> labels <span class="operator">=</span> colnames<span class="punctuation">(</span>dat<span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> group_col<span class="punctuation">[</span>group<span class="punctuation">[</span>tree_order<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">,</span> xpd <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#首先按聚类树中样本的顺序重新调整丰度表中样本的顺序，以保持二者能够对应，并定义颜色属性。之后绘制堆叠柱形图，放置在画板右侧区域</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#柱形图图例</span></span><br><span class="line">par<span class="punctuation">(</span>mar <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">plot<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> xaxt <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> yaxt <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> bty <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> xlab <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">)</span></span><br><span class="line">legend<span class="punctuation">(</span><span class="string">&#x27;left&#x27;</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="number">15</span><span class="punctuation">,</span> col <span class="operator">=</span> phylum_color<span class="punctuation">,</span> legend <span class="operator">=</span> <span class="built_in">names</span><span class="punctuation">(</span>phylum_color<span class="punctuation">)</span><span class="punctuation">,</span> bty <span class="operator">=</span> <span class="string">&#x27;n&#x27;</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><strong>另一种方法聚类树柱图</strong></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">getwd<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>tidyverse<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggtree<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>treeio<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggsci<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>cowplot<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 导入OTU文件</span></span><br><span class="line">otu <span class="operator">=</span> read.table<span class="punctuation">(</span><span class="string">&#x27;phylum_top10.txt&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span>  <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算距离后均值聚类并建树及可视化</span></span><br><span class="line">tree <span class="operator">=</span> hclust<span class="punctuation">(</span>vegan<span class="operator">::</span>vegdist<span class="punctuation">(</span>t<span class="punctuation">(</span>otu<span class="punctuation">)</span><span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;bray&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">              method <span class="operator">=</span> <span class="string">&#x27;average&#x27;</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  as.phylo<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">tree</span><br><span class="line"><span class="comment"># 选择节点，方便后续分开上色</span></span><br><span class="line">tree <span class="operator">=</span> groupClade<span class="punctuation">(</span>tree<span class="punctuation">,</span> .node<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">16</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制聚类图</span></span><br><span class="line">p1 <span class="operator">=</span> ggtree<span class="punctuation">(</span>tree<span class="punctuation">,</span> aes<span class="punctuation">(</span>color<span class="operator">=</span>group<span class="punctuation">,</span> linetype<span class="operator">=</span>group<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_tiplab<span class="punctuation">(</span>aes<span class="punctuation">(</span>color<span class="operator">=</span>group<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_point<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&#x27;firebrick&#x27;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">scale_color_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span></span><br><span class="line">p1</span><br><span class="line"><span class="comment">#+geom_text2(aes(subset=!isTip, label=node), hjust=-.3)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制物种组成柱状图</span></span><br><span class="line">otu<span class="operator">$</span>mean <span class="operator">=</span> apply<span class="punctuation">(</span>otu<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> mean<span class="punctuation">)</span></span><br><span class="line">otu <span class="operator">=</span> otu<span class="punctuation">[</span>order<span class="punctuation">(</span>otu<span class="operator">$</span>mean<span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">otu<span class="operator">$</span>phylum <span class="operator">=</span> factor<span class="punctuation">(</span>rownames<span class="punctuation">(</span>otu<span class="punctuation">)</span><span class="punctuation">,</span> levels <span class="operator">=</span> rownames<span class="punctuation">(</span>otu<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">otu <span class="operator">=</span> otu<span class="punctuation">[</span><span class="punctuation">,</span> <span class="operator">-</span><span class="built_in">c</span><span class="punctuation">(</span>ncol<span class="punctuation">(</span>otu<span class="punctuation">)</span><span class="operator">-</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">p2 <span class="operator">=</span> otu <span class="operator">%&gt;%</span></span><br><span class="line">  reshape2<span class="operator">::</span>melt<span class="punctuation">(</span>id.vars <span class="operator">=</span> <span class="string">&#x27;phylum&#x27;</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span></span><br><span class="line">  ggplot<span class="punctuation">(</span>aes<span class="punctuation">(</span>variable<span class="punctuation">,</span> value<span class="punctuation">,</span> fill <span class="operator">=</span> phylum<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_bar<span class="punctuation">(</span>stat <span class="operator">=</span> <span class="string">&#x27;identity&#x27;</span><span class="punctuation">,</span> position <span class="operator">=</span> <span class="string">&#x27;fill&#x27;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_x_discrete<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;t1&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;t2&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;t5&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;t4&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;t3&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;t6&#x27;</span><span class="punctuation">,</span></span><br><span class="line">                              <span class="string">&#x27;c1&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;c2&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;c6&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;c4&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;c3&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;c5&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_fill_igv<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line"> scale_y_continuous<span class="punctuation">(</span>labels <span class="operator">=</span> scales<span class="operator">::</span>percent<span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  coord_flip<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme_classic<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.ticks.y <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.title.y <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.text.y <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.line <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>y <span class="operator">=</span> <span class="string">&#x27;Percentage&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">ggdraw<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  draw_plot<span class="punctuation">(</span>p1<span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">0.06</span><span class="punctuation">,</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="number">0.95</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  draw_plot<span class="punctuation">(</span>p2<span class="punctuation">,</span> <span class="number">0.49</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h4 id="堆叠面积图">堆叠面积图</h4>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>reshape2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##读取并挑选 top10 丰度门</span></span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">phylum <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;phylum_table.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#求各类群的丰度总和，并排序</span></span><br><span class="line">phylum<span class="operator">$</span><span class="built_in">sum</span> <span class="operator">&lt;-</span> rowSums<span class="punctuation">(</span>phylum<span class="punctuation">)</span></span><br><span class="line">phylum <span class="operator">&lt;-</span> phylum<span class="punctuation">[</span>order<span class="punctuation">(</span>phylum<span class="operator">$</span><span class="built_in">sum</span><span class="punctuation">,</span> decreasing <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#挑选 top10 门类群，并将 top10 外的类群合并为“Others”</span></span><br><span class="line">phylum_top10 <span class="operator">&lt;-</span> phylum<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> <span class="operator">-</span>ncol<span class="punctuation">(</span>phylum<span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">phylum_top10<span class="punctuation">[</span><span class="string">&#x27;Others&#x27;</span><span class="punctuation">,</span> <span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">1</span> <span class="operator">-</span> colSums<span class="punctuation">(</span>phylum_top10<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#可选输出（如 csv 格式）</span></span><br><span class="line">write.csv<span class="punctuation">(</span>phylum_top10<span class="punctuation">,</span> <span class="string">&#x27;phylum_top10.csv&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#表格样式重排，借助 reshape2 包 melt() 实现</span></span><br><span class="line">phylum_top10<span class="operator">$</span>Taxonomy <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>rownames<span class="punctuation">(</span>phylum_top10<span class="punctuation">)</span><span class="punctuation">,</span> levels <span class="operator">=</span> rev<span class="punctuation">(</span>rownames<span class="punctuation">(</span>phylum_top10<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">phylum_top10 <span class="operator">&lt;-</span> melt<span class="punctuation">(</span>phylum_top10<span class="punctuation">,</span> id <span class="operator">=</span> <span class="string">&#x27;Taxonomy&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>phylum_top10<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;sample&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#合并分组信息</span></span><br><span class="line">group <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;group.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">phylum_top10 <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>phylum_top10<span class="punctuation">,</span> group<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&#x27;sample&#x27;</span><span class="punctuation">,</span> all.x <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##ggplot2 堆叠面积图</span></span><br><span class="line"><span class="comment">#初始</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>phylum_top10<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> times<span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">100</span> <span class="operator">*</span> value<span class="punctuation">,</span> fill <span class="operator">=</span> Taxonomy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_area<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;Times&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;Relative Abundance(%)&#x27;</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;Top10 Phylum&#x27;</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line"></span><br><span class="line"><span class="comment">#稍作调整后</span></span><br><span class="line">p <span class="operator">&lt;-</span> p <span class="operator">+</span> </span><br><span class="line">scale_fill_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;skyblue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;burlywood1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;purple&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;hotpink&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;yellow&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#设置颜色</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#调整背景</span></span><br><span class="line">scale_x_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">15</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">as.character</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">15</span><span class="punctuation">)</span><span class="punctuation">,</span> expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#调整坐标轴轴刻度</span></span><br><span class="line">scale_y_continuous<span class="punctuation">(</span>expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line"></span><br><span class="line"><span class="comment">#ggsave(&#x27;ggplot2_area.pdf&#x27;, p, width = 7.5, height = 4.5)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;ggplot2_area.png&#x27;</span><span class="punctuation">,</span> p<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">7.5</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">4.5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#展示部分类群，例如挑选出 top5 丰度类群，其余（包括 Others）去除不展示</span></span><br><span class="line">phylum_top5 <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>phylum_top10<span class="punctuation">,</span> Taxonomy <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;Proteobacteria&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Acidobacteria&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Bacteroidetes&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Actinobacteria&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Gemmatimonadetes&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>phylum_top5<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> times<span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">100</span> <span class="operator">*</span> value<span class="punctuation">,</span> fill <span class="operator">=</span> Taxonomy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_area<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;Times&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;Relative Abundance(%)&#x27;</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;Top5 Phylum&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_fill_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;yellow&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#设置颜色</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#调整背景</span></span><br><span class="line">scale_x_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">15</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">as.character</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">15</span><span class="punctuation">)</span><span class="punctuation">,</span> expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#调整坐标轴轴刻度</span></span><br><span class="line">scale_y_continuous<span class="punctuation">(</span>expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggsave(&#x27;ggplot2_area2.pdf&#x27;, p, width = 7.5, height = 4.5)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;ggplot2_area2.png&#x27;</span><span class="punctuation">,</span> p<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">7.5</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">4.5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h4 id="丰度星星图">丰度星星图</h4>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">##读取并挑选 top10 丰度门</span></span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">phylum <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;phylum_table.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#求各类群的丰度总和，并排序</span></span><br><span class="line">phylum<span class="operator">$</span><span class="built_in">sum</span> <span class="operator">&lt;-</span> rowSums<span class="punctuation">(</span>phylum<span class="punctuation">)</span></span><br><span class="line">phylum <span class="operator">&lt;-</span> phylum<span class="punctuation">[</span>order<span class="punctuation">(</span>phylum<span class="operator">$</span><span class="built_in">sum</span><span class="punctuation">,</span> decreasing <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#挑选 top10 门类群，并将 top10 外的类群合并为“Others”</span></span><br><span class="line">phylum_top10 <span class="operator">&lt;-</span> phylum<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> <span class="operator">-</span>ncol<span class="punctuation">(</span>phylum<span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">phylum_top10<span class="punctuation">[</span><span class="string">&#x27;Others&#x27;</span><span class="punctuation">,</span> <span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">1</span> <span class="operator">-</span> colSums<span class="punctuation">(</span>phylum_top10<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#可选输出（如 csv 格式）</span></span><br><span class="line">write.csv<span class="punctuation">(</span>phylum_top10<span class="punctuation">,</span> <span class="string">&#x27;phylum_top10.csv&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##stars() 作图（一个简单示例）</span></span><br><span class="line">t_phylum_top10 <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>t<span class="punctuation">(</span>phylum_top10<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">color <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;yellow&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;hotpink&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;purple&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;burlywood1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;skyblue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">png<span class="punctuation">(</span><span class="string">&#x27;stars_plot.png&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">1500</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">1500</span><span class="punctuation">,</span> res <span class="operator">=</span> <span class="number">300</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&#x27;px&#x27;</span><span class="punctuation">)</span></span><br><span class="line">stars<span class="punctuation">(</span>t_phylum_top10<span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> draw.segments <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> col.segments <span class="operator">=</span> color<span class="punctuation">,</span> nrow <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> key.loc <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">6</span><span class="punctuation">,</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">)</span> <span class="punctuation">,</span> frame.plot <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;Top10 Phylum&#x27;</span><span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##ggplot2 作图（一个简单示例）</span></span><br><span class="line">library<span class="punctuation">(</span>reshape2<span class="punctuation">)</span>	<span class="comment">#用于排列数据</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span>	<span class="comment">#ggplot2 作图</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#调整数据布局</span></span><br><span class="line">phylum_top10<span class="operator">$</span>Taxonomy <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>rownames<span class="punctuation">(</span>phylum_top10<span class="punctuation">)</span><span class="punctuation">,</span> levels <span class="operator">=</span> rownames<span class="punctuation">(</span>phylum_top10<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">phylum_top10_melt <span class="operator">&lt;-</span> melt<span class="punctuation">(</span>phylum_top10<span class="punctuation">,</span> id <span class="operator">=</span> <span class="string">&#x27;Taxonomy&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#以样本 c1 为例的星图，单一柱形图的坐标转换</span></span><br><span class="line">phylum_top10_c1 <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>phylum_top10_melt<span class="punctuation">,</span> variable <span class="operator">==</span> <span class="string">&#x27;c1&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p_c1 <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>phylum_top10_c1<span class="punctuation">,</span> aes<span class="punctuation">(</span>Taxonomy<span class="punctuation">,</span> value<span class="punctuation">,</span> fill <span class="operator">=</span> Taxonomy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_bar<span class="punctuation">(</span>stat <span class="operator">=</span> <span class="string">&#x27;identity&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">coord_polar<span class="punctuation">(</span>theta <span class="operator">=</span> <span class="string">&#x27;x&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_fill_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;yellow&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;hotpink&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;purple&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;burlywood1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;skyblue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&#x27;Sample: c1&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;Top10 Phylum&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.text <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.ticks <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggsave(&#x27;ggplot2_c1_plot.pdf&#x27;, p_c1, width = 5, height = 5)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;ggplot2_c1_plot.png&#x27;</span><span class="punctuation">,</span> p_c1<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#所有样本，堆叠柱形图的坐标转换</span></span><br><span class="line">p_all <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>phylum_top10_melt<span class="punctuation">,</span> aes<span class="punctuation">(</span>variable<span class="punctuation">,</span> value<span class="punctuation">,</span> fill <span class="operator">=</span> Taxonomy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_bar<span class="punctuation">(</span>stat <span class="operator">=</span> <span class="string">&#x27;identity&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">coord_polar<span class="punctuation">(</span>theta <span class="operator">=</span> <span class="string">&#x27;x&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_fill_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;yellow&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;hotpink&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;purple&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;burlywood1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;skyblue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;Top10 Phylum&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.text.y <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.ticks <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggsave(&#x27;ggplot2_all_plot.pdf&#x27;, p_all, width = 5, height = 5)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;ggplot2_all_plot.png&#x27;</span><span class="punctuation">,</span> p_all<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##一个 ggplot2 的多图组合样式，借助 grid 包完成</span></span><br><span class="line">library<span class="punctuation">(</span>grid<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#获取所有样本名称</span></span><br><span class="line">sample_name <span class="operator">&lt;-</span> levels<span class="punctuation">(</span>phylum_top10_melt<span class="operator">$</span>variable<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#创建画板，根据样本数（此处为 8 个）预设图片位置</span></span><br><span class="line"><span class="comment">#pdf(&#x27;grid_plot.pdf&#x27;, width = 9, height = 5)</span></span><br><span class="line">png<span class="punctuation">(</span><span class="string">&#x27;grid_plot.png&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">3000</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">1500</span><span class="punctuation">,</span> res <span class="operator">=</span> <span class="number">300</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&#x27;px&#x27;</span><span class="punctuation">)</span></span><br><span class="line">grid.newpage<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">n <span class="operator">&lt;-</span> 8</span><br><span class="line">split_x <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.1</span><span class="punctuation">,</span> <span class="number">0.3</span><span class="punctuation">,</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="number">0.7</span><span class="punctuation">,</span> <span class="number">0.1</span><span class="punctuation">,</span> <span class="number">0.3</span><span class="punctuation">,</span> <span class="number">0.5</span><span class="punctuation">,</span> <span class="number">0.7</span><span class="punctuation">)</span>	<span class="comment">#预设 8 张子图的横坐标</span></span><br><span class="line">split_y <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.6</span><span class="punctuation">,</span> <span class="number">0.6</span><span class="punctuation">,</span> <span class="number">0.6</span><span class="punctuation">,</span> <span class="number">0.6</span><span class="punctuation">,</span> <span class="number">0.1</span><span class="punctuation">,</span> <span class="number">0.1</span><span class="punctuation">,</span> <span class="number">0.1</span><span class="punctuation">,</span> <span class="number">0.1</span><span class="punctuation">)</span>	<span class="comment">#预设 8 张子图的纵坐标</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#使用循环，使用 ggplot2 分别绘制 8 个样本的物种丰度星图，并放置在画板对应的位置中</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span>n<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	p_i <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>subset<span class="punctuation">(</span>phylum_top10_melt<span class="punctuation">,</span> variable <span class="operator">==</span> sample_name<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> aes<span class="punctuation">(</span>Taxonomy<span class="punctuation">,</span> value<span class="punctuation">,</span> fill <span class="operator">=</span> Taxonomy<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">		geom_bar<span class="punctuation">(</span>stat <span class="operator">=</span> <span class="string">&#x27;identity&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">		coord_polar<span class="punctuation">(</span>theta <span class="operator">=</span> <span class="string">&#x27;x&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">		scale_fill_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;yellow&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;hotpink&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;cyan&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;purple&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;burlywood1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;skyblue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">		labs<span class="punctuation">(</span>title <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&#x27;Sample:&#x27;</span><span class="punctuation">,</span> sample_name<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> x <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;Top10 Phylum&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">		theme<span class="punctuation">(</span>plot.background <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.text <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.ticks <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> plot.title <span class="operator">=</span> element_text<span class="punctuation">(</span>hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">	</span><br><span class="line">	print<span class="punctuation">(</span>p_i <span class="operator">+</span> theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&#x27;none&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> vp <span class="operator">=</span> viewport<span class="punctuation">(</span>x <span class="operator">=</span> split_x<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">,</span> y <span class="operator">=</span> split_y<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#该函数用于在 ggplot2 中提取图例，参考自 https://stackoverflow.com/questions/13712574/how-to-change-position-of-grid-draw</span></span><br><span class="line"><span class="comment">#前述博文“饼图（扇形图）”中也使用到了这个方法提取 ggplot2 的图例，可参见 http://blog.sciencenet.cn/blog-3406804-1170610.html</span></span><br><span class="line">g_legend <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>gg_plot<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	tmp <span class="operator">&lt;-</span> ggplot_gtable<span class="punctuation">(</span>ggplot_build<span class="punctuation">(</span>gg_plot<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">	leg <span class="operator">&lt;-</span> which<span class="punctuation">(</span>sapply<span class="punctuation">(</span>tmp<span class="operator">$</span>grobs<span class="punctuation">,</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">)</span> x<span class="operator">$</span>name<span class="punctuation">)</span> <span class="operator">==</span> <span class="string">&#x27;guide-box&#x27;</span><span class="punctuation">)</span></span><br><span class="line">	leg <span class="operator">&lt;-</span> tmp<span class="operator">$</span>grobs<span class="punctuation">[[</span>leg<span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line">	leg</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#截取图例添加至组合图中</span></span><br><span class="line">phylum_legend <span class="operator">&lt;-</span> g_legend<span class="punctuation">(</span>p_i<span class="punctuation">)</span></span><br><span class="line">phylum_legend<span class="operator">$</span>vp<span class="operator">$</span>x <span class="operator">&lt;-</span> unit<span class="punctuation">(</span><span class="number">0.92</span><span class="punctuation">,</span> <span class="string">&#x27;npc&#x27;</span><span class="punctuation">)</span>	<span class="comment">#指定图例在 grid 画板中的横坐标位置</span></span><br><span class="line">phylum_legend<span class="operator">$</span>vp<span class="operator">$</span>y <span class="operator">&lt;-</span> unit<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="string">&#x27;npc&#x27;</span><span class="punctuation">)</span>	<span class="comment">#指定图例在 grid 画板中的纵坐标位置</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>phylum_legend<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#完成后关闭</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h4 id="圆角柱形图">圆角柱形图</h4>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>RColorBrewer<span class="punctuation">)</span></span><br><span class="line">install.packages<span class="punctuation">(</span><span class="string">&quot;ggchicklet&quot;</span><span class="punctuation">,</span> repos <span class="operator">=</span> <span class="string">&quot;https://cinc.rud.is&quot;</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggchicklet<span class="punctuation">)</span></span><br><span class="line">x<span class="operator">&lt;-</span><span class="built_in">LETTERS</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">14</span><span class="punctuation">]</span></span><br><span class="line">y<span class="operator">&lt;-</span><span class="number">1</span><span class="operator">:</span><span class="number">14</span></span><br><span class="line">df<span class="operator">&lt;-</span>data.frame<span class="punctuation">(</span>x<span class="punctuation">,</span>y<span class="punctuation">)</span></span><br><span class="line">df</span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="punctuation">,</span>y<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_chicklet<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill<span class="operator">=</span>x<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span>name<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    values <span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span>brewer.pal<span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span><span class="string">&quot;Paired&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                              brewer.pal<span class="punctuation">(</span><span class="number">10</span><span class="punctuation">,</span><span class="string">&quot;Paired&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme_bw<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span>labs<span class="punctuation">(</span>x<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#实现圆角柱形图只需要将geom_col()函数换成geom_chicklet()函数就可以了,ggchicklet包下载</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#组成图</span></span><br><span class="line">df<span class="operator">&lt;-</span>data.frame<span class="punctuation">(</span>Year<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;2019&quot;</span><span class="punctuation">,</span><span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;2018&quot;</span><span class="punctuation">,</span><span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;2017&quot;</span><span class="punctuation">,</span><span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;2017&quot;</span><span class="punctuation">,</span><span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                      <span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;2016&quot;</span><span class="punctuation">,</span><span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;2015&quot;</span><span class="punctuation">,</span><span class="number">12</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">               Month<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">12</span><span class="punctuation">,</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">               n<span class="operator">=</span>sample<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">15</span><span class="punctuation">,</span><span class="number">12</span><span class="operator">*</span><span class="number">6</span><span class="punctuation">,</span>replace <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">dim</span><span class="punctuation">(</span>df<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>df<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>RColorBrewer<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggchicklet<span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>df<span class="punctuation">,</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> factor<span class="punctuation">(</span>Year<span class="punctuation">)</span><span class="punctuation">,</span> y <span class="operator">=</span> n<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_chicklet<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> factor<span class="punctuation">(</span>Month<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                width <span class="operator">=</span> <span class="number">0.25</span><span class="punctuation">,</span> </span><br><span class="line">                radius <span class="operator">=</span> grid<span class="operator">::</span>unit<span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="string">&quot;pt&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  theme_bw<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_fill_brewer<span class="punctuation">(</span>name <span class="operator">=</span> <span class="string">&quot;Month&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    palette <span class="operator">=</span> <span class="string">&quot;Paired&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    breaks <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">12</span><span class="punctuation">,</span></span><br><span class="line">                    labels <span class="operator">=</span> <span class="built_in">month.name</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>x<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span>y<span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="批量差异检验"><strong>批量差异检验</strong></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">##wilcox 检验批处理示例</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&quot;../metagenomic/Abundance/Nr_abundance/&quot;</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>doBy<span class="punctuation">)</span>	<span class="comment">#使用其中的 summaryBy() 以方便按分组计算均值、中位数</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">getwd<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">gene <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&#x27;pathway_0.01.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">group <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&#x27;sample.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">gene <span class="operator">&lt;-</span> gene<span class="punctuation">[</span><span class="operator">-</span>nrow<span class="punctuation">(</span>gene<span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">result <span class="operator">&lt;-</span> <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>n <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span>nrow<span class="punctuation">(</span>gene<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">  gene_n <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>t<span class="punctuation">(</span>gene<span class="punctuation">[</span>n<span class="punctuation">,</span>subset<span class="punctuation">(</span>group<span class="punctuation">,</span> group <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;D&quot;</span><span class="punctuation">,</span> <span class="string">&quot;H&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">$</span>sample<span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  gene_id <span class="operator">&lt;-</span> <span class="built_in">names</span><span class="punctuation">(</span>gene_n<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">  <span class="built_in">names</span><span class="punctuation">(</span>gene_n<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;gene&#x27;</span></span><br><span class="line">  gene_n<span class="operator">$</span>sample <span class="operator">&lt;-</span> rownames<span class="punctuation">(</span>gene_n<span class="punctuation">)</span></span><br><span class="line">  gene_n <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>gene_n<span class="punctuation">,</span> group<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&#x27;sample&#x27;</span><span class="punctuation">,</span> all.x <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">  gene_n<span class="operator">$</span>group <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>gene_n<span class="operator">$</span>group<span class="punctuation">)</span></span><br><span class="line">  p_value <span class="operator">&lt;-</span> wilcox.test<span class="punctuation">(</span>gene<span class="operator">~</span>group<span class="punctuation">,</span> gene_n<span class="punctuation">,</span>exact <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="operator">$</span>p.value</span><br><span class="line">  <span class="keyword">if</span> <span class="punctuation">(</span><span class="operator">!</span><span class="built_in">is.na</span><span class="punctuation">(</span>p_value<span class="punctuation">)</span> <span class="operator">&amp;</span> p_value <span class="operator">&lt;</span> <span class="number">0.05</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">    stat <span class="operator">&lt;-</span> summaryBy<span class="punctuation">(</span>gene<span class="operator">~</span>group<span class="punctuation">,</span> gene_n<span class="punctuation">,</span> FUN <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>mean<span class="punctuation">,</span> sd<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">    result <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>result<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>gene_id<span class="punctuation">,</span> <span class="built_in">as.character</span><span class="punctuation">(</span>stat<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> stat<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> stat<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="built_in">as.character</span><span class="punctuation">(</span>stat<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> stat<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> stat<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">,</span> p_value<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">result <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>result<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>result<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;Species&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;group1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;mean1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;sd1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;group2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;mean2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;sd2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;p_value&#x27;</span><span class="punctuation">)</span></span><br><span class="line">result <span class="operator">&lt;-</span> result<span class="punctuation">[</span>order<span class="punctuation">(</span>result<span class="operator">$</span>p_value<span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span>  <span class="comment"># 从小到大排序</span></span><br><span class="line"><span class="comment"># P.adjust  p 值校正的过程 </span></span><br><span class="line"><span class="comment">#先将p值那列提出转换为矩阵形式 </span></span><br><span class="line">a <span class="operator">&lt;-</span> as.matrix<span class="punctuation">(</span>result<span class="operator">$</span>p_value<span class="punctuation">)</span></span><br><span class="line">p_adjust <span class="operator">&lt;-</span> p.adjust<span class="punctuation">(</span>a<span class="punctuation">,</span>method <span class="operator">=</span> <span class="string">&#x27;BH&#x27;</span><span class="punctuation">,</span>n <span class="operator">=</span> <span class="built_in">length</span><span class="punctuation">(</span>a<span class="punctuation">)</span><span class="punctuation">)</span> <span class="comment"># 这里使用BH 方法 和fdr结果相似</span></span><br><span class="line">result <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span>result<span class="punctuation">,</span>p_adjust<span class="punctuation">)</span></span><br><span class="line">write.table<span class="punctuation">(</span>result<span class="punctuation">,</span> <span class="string">&#x27;pathway_0.01_diff.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="绘制箱线图"><strong>绘制箱线图</strong></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#Create data</span></span><br><span class="line"><span class="built_in">names</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;Maestro&quot;</span><span class="punctuation">,</span> <span class="number">20</span><span class="punctuation">)</span> <span class="punctuation">,</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;Presto&quot;</span><span class="punctuation">,</span> <span class="number">20</span><span class="punctuation">)</span> <span class="punctuation">,</span> </span><br><span class="line">      <span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;Nerak&quot;</span><span class="punctuation">,</span> <span class="number">20</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;Eskimo&quot;</span><span class="punctuation">,</span> <span class="number">20</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;Nairobi&quot;</span><span class="punctuation">,</span> <span class="number">20</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;Artiko&quot;</span><span class="punctuation">,</span> <span class="number">20</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">value <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>  sample<span class="punctuation">(</span><span class="number">3</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> <span class="number">20</span> <span class="punctuation">,</span> replace<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span> <span class="punctuation">,</span> sample<span class="punctuation">(</span><span class="number">2</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">20</span> <span class="punctuation">,</span> replace<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span> <span class="punctuation">,</span> </span><br><span class="line">      sample<span class="punctuation">(</span><span class="number">6</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> <span class="number">20</span> <span class="punctuation">,</span> replace<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">,</span> sample<span class="punctuation">(</span><span class="number">6</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> <span class="number">20</span> <span class="punctuation">,</span> replace<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span> <span class="punctuation">,</span> </span><br><span class="line">      sample<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">7</span><span class="punctuation">,</span> <span class="number">20</span> <span class="punctuation">,</span> replace<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span><span class="punctuation">,</span> sample<span class="punctuation">(</span><span class="number">3</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">,</span> <span class="number">20</span> <span class="punctuation">,</span> replace<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span> <span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span><span class="built_in">names</span><span class="punctuation">,</span>value<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Prepare a vector of colors with specific color for Nairobi and Eskimo</span></span><br><span class="line">myColors <span class="operator">&lt;-</span> ifelse<span class="punctuation">(</span>levels<span class="punctuation">(</span>data<span class="operator">$</span><span class="built_in">names</span><span class="punctuation">)</span><span class="operator">==</span><span class="string">&quot;Nairobi&quot;</span> <span class="punctuation">,</span> rgb<span class="punctuation">(</span><span class="number">0.1</span><span class="punctuation">,</span><span class="number">0.1</span><span class="punctuation">,</span><span class="number">0.7</span><span class="punctuation">,</span><span class="number">0.5</span><span class="punctuation">)</span> <span class="punctuation">,</span> </span><br><span class="line">              ifelse<span class="punctuation">(</span>levels<span class="punctuation">(</span>data<span class="operator">$</span><span class="built_in">names</span><span class="punctuation">)</span><span class="operator">==</span><span class="string">&quot;Eskimo&quot;</span><span class="punctuation">,</span> rgb<span class="punctuation">(</span><span class="number">0.8</span><span class="punctuation">,</span><span class="number">0.1</span><span class="punctuation">,</span><span class="number">0.3</span><span class="punctuation">,</span><span class="number">0.6</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">              <span class="string">&quot;grey90&quot;</span> <span class="punctuation">)</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Build the plot</span></span><br><span class="line">boxplot<span class="punctuation">(</span>data<span class="operator">$</span>value <span class="operator">~</span> data<span class="operator">$</span><span class="built_in">names</span> <span class="punctuation">,</span> </span><br><span class="line">    col<span class="operator">=</span>myColors <span class="punctuation">,</span> </span><br><span class="line">    ylab<span class="operator">=</span><span class="string">&quot;disease&quot;</span> <span class="punctuation">,</span> xlab<span class="operator">=</span><span class="string">&quot;- variety -&quot;</span><span class="punctuation">)</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># Add a legend</span></span><br><span class="line">legend<span class="punctuation">(</span><span class="string">&quot;bottomleft&quot;</span><span class="punctuation">,</span> legend <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Positiv control&quot;</span><span class="punctuation">,</span><span class="string">&quot;Negativ control&quot;</span><span class="punctuation">)</span> <span class="punctuation">,</span> </span><br><span class="line">    col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>rgb<span class="punctuation">(</span><span class="number">0.1</span><span class="punctuation">,</span><span class="number">0.1</span><span class="punctuation">,</span><span class="number">0.7</span><span class="punctuation">,</span><span class="number">0.5</span><span class="punctuation">)</span> <span class="punctuation">,</span> rgb<span class="punctuation">(</span><span class="number">0.8</span><span class="punctuation">,</span><span class="number">0.1</span><span class="punctuation">,</span><span class="number">0.3</span><span class="punctuation">,</span><span class="number">0.6</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">,</span> bty <span class="operator">=</span> <span class="string">&quot;n&quot;</span><span class="punctuation">,</span> pch<span class="operator">=</span><span class="number">20</span> <span class="punctuation">,</span> pt.cex <span class="operator">=</span> <span class="number">3</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> horiz <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> inset <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.03</span><span class="punctuation">,</span> <span class="number">0.1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#循环箱线图</span></span><br><span class="line">par<span class="punctuation">(</span>mfrow<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> mar<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span>; 分区画图，mfrow：<span class="number">3</span>行<span class="number">2</span>列，mar每组图的边界设置。</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span><span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">boxplot<span class="punctuation">(</span>a<span class="punctuation">[</span><span class="punctuation">(</span>i<span class="operator">*</span><span class="number">2</span><span class="punctuation">)</span><span class="operator">:</span><span class="punctuation">(</span>i<span class="operator">*</span><span class="number">2</span><span class="operator">+</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span><span class="built_in">range</span><span class="operator">=</span><span class="number">1.5</span><span class="punctuation">,</span>width<span class="operator">=</span><span class="literal">NULL</span><span class="punctuation">,</span>varwidth<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">,</span>notch<span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span>outline<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span><span class="built_in">names</span><span class="punctuation">(</span>a<span class="punctuation">[</span><span class="punctuation">(</span>i<span class="operator">*</span><span class="number">2</span><span class="punctuation">)</span><span class="operator">:</span><span class="punctuation">(</span>i<span class="operator">*</span><span class="number">2</span><span class="operator">+</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span>plot<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span>col<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;green&quot;</span><span class="punctuation">,</span><span class="string">&quot;orange&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="built_in">log</span><span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">,</span>horizontal<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">,</span>add<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">,</span>at<span class="operator">=</span><span class="literal">NULL</span><span class="punctuation">)</span>;<span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#画特定物种的Boxplot</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>doBy<span class="punctuation">)</span>	<span class="comment">#使用其中的 summaryBy() 以方便按分组计算均值、中位数</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>dplyr<span class="punctuation">)</span></span><br><span class="line">gene <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&#x27;Phylum.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">group <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span><span class="string">&#x27;sample.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>reshape2<span class="punctuation">)</span>	<span class="comment">#用于排列数据</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span>	<span class="comment">#ggplot2 作图</span></span><br><span class="line">gene<span class="operator">$</span>Taxonomy <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>rownames<span class="punctuation">(</span>gene<span class="punctuation">)</span><span class="punctuation">,</span> levels <span class="operator">=</span> rownames<span class="punctuation">(</span>gene<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">gene <span class="operator">&lt;-</span> melt<span class="punctuation">(</span>gene<span class="punctuation">,</span> id <span class="operator">=</span> <span class="string">&#x27;Taxonomy&#x27;</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>group<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;variable&#x27;</span></span><br><span class="line">gene <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>gene<span class="punctuation">,</span> group<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&#x27;variable&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">gene<span class="operator">$</span>Taxonomy <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>gene<span class="operator">$</span>Taxonomy<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p2 <span class="operator">&lt;-</span> filter<span class="punctuation">(</span>gene<span class="punctuation">,</span>Taxonomy<span class="operator">%in%</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;g_Faecalibacterium&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;g_Escherichia-Shigella&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;g_Alloprevotella&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;g_Clostridium_sensu_stricto_1&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>data<span class="operator">=</span>p2<span class="punctuation">,</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>group<span class="punctuation">,</span>y<span class="operator">=</span>value<span class="punctuation">,</span>fill<span class="operator">=</span>group<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  stat_boxplot<span class="punctuation">(</span>geom <span class="operator">=</span> <span class="string">&quot;errorbar&quot;</span><span class="punctuation">)</span><span class="operator">+</span>geom_boxplot<span class="punctuation">(</span>outlier.colour <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  xlab<span class="punctuation">(</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span><span class="operator">+</span>ylab<span class="punctuation">(</span><span class="string">&quot;Relative abundance&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  facet_grid<span class="punctuation">(</span><span class="operator">~</span>Taxonomy<span class="punctuation">)</span><span class="operator">+</span><span class="comment">#legend.title = element_blank()</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>legend.key <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line">ggsave<span class="punctuation">(</span>plot<span class="operator">=</span>p<span class="punctuation">,</span><span class="string">&quot;E:/g_Alloprevotella.pdf&quot;</span><span class="punctuation">,</span>height<span class="operator">=</span><span class="number">5</span><span class="punctuation">,</span>width<span class="operator">=</span><span class="number">7</span><span class="punctuation">,</span>dpi<span class="operator">=</span><span class="number">300</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>export<span class="punctuation">)</span></span><br><span class="line">graph2ppt<span class="punctuation">(</span>file<span class="operator">=</span><span class="string">&quot;2.pptx&quot;</span><span class="punctuation">,</span> width<span class="operator">=</span><span class="number">7</span><span class="punctuation">,</span> height<span class="operator">=</span><span class="number">5</span> <span class="comment">#导入ppt中 相当于AI</span></span><br><span class="line">          </span><br><span class="line">          <span class="comment">#可以写个函数</span></span><br><span class="line">plotGeneCounts <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>genes<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line"> </span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">那么画图就是plotGeneCounts<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;STM&quot;</span><span class="punctuation">,</span><span class="string">&quot;KNAT1&quot;</span><span class="punctuation">,</span><span class="string">&quot;CLV1&quot;</span><span class="punctuation">,</span><span class="string">&quot;CLV3&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="曼哈顿图">曼哈顿图</h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">otu_stat <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;otu_sign.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#门水平排序，这里直接按首字母排序了</span></span><br><span class="line">otu_stat <span class="operator">&lt;-</span> otu_stat<span class="punctuation">[</span>order<span class="punctuation">(</span>otu_stat<span class="operator">$</span>phylum<span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">otu_stat<span class="operator">$</span>otu_sort <span class="operator">&lt;-</span> 1<span class="operator">:</span>nrow<span class="punctuation">(</span>otu_stat<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#其它自定义排序，例如你想根据 OTU 数量降序排序</span></span><br><span class="line"><span class="comment">#phylum_num &lt;- phylum_num[order(phylum_num, decreasing = TRUE)]</span></span><br><span class="line"><span class="comment">#otu_stat$phylum &lt;- factor(otu_stat$phylum, levels = names(phylum_num))</span></span><br><span class="line"><span class="comment">#otu_stat &lt;- otu_stat[order(otu_stat$phylum), ]</span></span><br><span class="line"><span class="comment">#otu_stat$otu_sort &lt;- 1:nrow(otu_stat)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##ggplot2 作图示例</span></span><br><span class="line"><span class="comment">#初始</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>otu_stat<span class="punctuation">,</span> aes<span class="punctuation">(</span>otu_sort<span class="punctuation">,</span> <span class="operator">-</span><span class="built_in">log</span><span class="punctuation">(</span>p_value<span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#</span></span><br><span class="line">geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>size <span class="operator">=</span> abundance<span class="punctuation">,</span> color <span class="operator">=</span> phylum<span class="punctuation">,</span> shape <span class="operator">=</span> enrich<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#点的大小表示 OTUs 丰度，颜色表示分类，形状表示是否为富集 OTUs</span></span><br><span class="line">scale_size<span class="punctuation">(</span><span class="built_in">range</span> <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>	<span class="comment">#点大小范围</span></span><br><span class="line">scale_shape_manual<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;sign&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;no-sign&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">16</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#点形状，实心点为富集 OTUs，空心点为非富集 OTUs	</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;-log10(P)&#x27;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="string">&#x27;relative abundance (%)&#x27;</span><span class="punctuation">,</span> shape <span class="operator">=</span> <span class="string">&#x27;enriched&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#坐标轴标题、图例标题等</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#主题调整，去除背景线等</span></span><br><span class="line">guides<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;none&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#隐藏颜色图例（OTUs 分类）</span></span><br><span class="line">geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="operator">-</span>log10<span class="punctuation">(</span><span class="number">0.01</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span>	<span class="comment">#在 p=0.01 处的 -log10 位置（即 y = 2）绘制条横虚线，表示 p&lt;0.01 为差异 OTUs 的判定标准之一</span></span><br><span class="line"></span><br><span class="line">p</span><br><span class="line"></span><br><span class="line"><span class="comment">#计算 x 轴标签、矩形区块对应的 x 轴位置</span></span><br><span class="line">phylum_num <span class="operator">&lt;-</span> summary<span class="punctuation">(</span>otu_stat<span class="operator">$</span>phylum<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">phylum_range <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> phylum_num<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">phylum_name <span class="operator">&lt;-</span> phylum_num<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">/</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">2</span><span class="operator">:</span><span class="built_in">length</span><span class="punctuation">(</span>phylum_num<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	phylum_range<span class="punctuation">[</span>i<span class="operator">+</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> phylum_range<span class="punctuation">[</span>i<span class="punctuation">]</span> <span class="operator">+</span> phylum_num<span class="punctuation">[</span>i<span class="punctuation">]</span></span><br><span class="line">	phylum_name<span class="punctuation">[</span>i<span class="punctuation">]</span> <span class="operator">&lt;-</span> phylum_range<span class="punctuation">[</span>i<span class="punctuation">]</span> <span class="operator">+</span> phylum_num<span class="punctuation">[</span>i<span class="punctuation">]</span> <span class="operator">/</span> <span class="number">2</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#添加 x 轴刻度标签</span></span><br><span class="line">p <span class="operator">&lt;-</span> p <span class="operator">+</span></span><br><span class="line">scale_x_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> phylum_name<span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">names</span><span class="punctuation">(</span>phylum_num<span class="punctuation">)</span><span class="punctuation">,</span> expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>axis.text.x <span class="operator">=</span> element_text<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="number">45</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> vjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#添加矩形区块，交替绘制为不同深度的灰色</span></span><br><span class="line"><span class="comment">#由于先绘制的散点，后绘制的矩形，即矩形图层在上，故需要设置很高的透明度才可</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="punctuation">(</span><span class="built_in">length</span><span class="punctuation">(</span>phylum_range<span class="punctuation">)</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> p <span class="operator">&lt;-</span> p <span class="operator">+</span> annotate<span class="punctuation">(</span><span class="string">&#x27;rect&#x27;</span><span class="punctuation">,</span> xmin <span class="operator">=</span> phylum_range<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">,</span> xmax <span class="operator">=</span> phylum_range<span class="punctuation">[</span>i<span class="operator">+</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> ymin <span class="operator">=</span> <span class="operator">-</span><span class="literal">Inf</span><span class="punctuation">,</span> ymax <span class="operator">=</span> <span class="literal">Inf</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">,</span> fill <span class="operator">=</span> ifelse<span class="punctuation">(</span>i <span class="operator">%%</span> <span class="number">2</span> <span class="operator">==</span> <span class="number">0</span><span class="punctuation">,</span> <span class="string">&#x27;gray60&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray40&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p</span><br><span class="line"></span><br><span class="line"><span class="comment">##推荐先调整好背景（矩形区块），再绘制散点，这样散点位于矩形区块图层的上面，更清晰</span></span><br><span class="line"><span class="comment">#背景、标签布局</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>otu_stat<span class="punctuation">,</span> aes<span class="punctuation">(</span>otu_sort<span class="punctuation">,</span> <span class="operator">-</span><span class="built_in">log</span><span class="punctuation">(</span>p_value<span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;-log10(P)&#x27;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="string">&#x27;relative abundance (%)&#x27;</span><span class="punctuation">,</span> shape <span class="operator">=</span> <span class="string">&#x27;significantly enriched&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_x_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> phylum_name<span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">names</span><span class="punctuation">(</span>phylum_num<span class="punctuation">)</span><span class="punctuation">,</span> expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>axis.text.x <span class="operator">=</span> element_text<span class="punctuation">(</span>angle <span class="operator">=</span> <span class="number">45</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> vjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#这样也没必要再为矩形设置透明度了</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="punctuation">(</span><span class="built_in">length</span><span class="punctuation">(</span>phylum_range<span class="punctuation">)</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> p <span class="operator">&lt;-</span> p <span class="operator">+</span> annotate<span class="punctuation">(</span><span class="string">&#x27;rect&#x27;</span><span class="punctuation">,</span> xmin <span class="operator">=</span> phylum_range<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">,</span> xmax <span class="operator">=</span> phylum_range<span class="punctuation">[</span>i<span class="operator">+</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> ymin <span class="operator">=</span> <span class="operator">-</span><span class="literal">Inf</span><span class="punctuation">,</span> ymax <span class="operator">=</span> <span class="literal">Inf</span><span class="punctuation">,</span> fill <span class="operator">=</span> ifelse<span class="punctuation">(</span>i <span class="operator">%%</span> <span class="number">2</span> <span class="operator">==</span> <span class="number">0</span><span class="punctuation">,</span> <span class="string">&#x27;gray95&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray85&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#最后绘制散点</span></span><br><span class="line">p <span class="operator">&lt;-</span> p <span class="operator">+</span> </span><br><span class="line">geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>size <span class="operator">=</span> abundance<span class="punctuation">,</span> color <span class="operator">=</span> phylum<span class="punctuation">,</span> shape <span class="operator">=</span> enrich<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_size<span class="punctuation">(</span><span class="built_in">range</span> <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">scale_shape_manual<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;sign&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;no-sign&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">16</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>	</span><br><span class="line">guides<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;none&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="operator">-</span>log10<span class="punctuation">(</span><span class="number">0.01</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p</span><br><span class="line"></span><br><span class="line"><span class="comment">#输出图片至本地</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;manhattan.pdf&#x27;</span><span class="punctuation">,</span> p<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;manhattan.png&#x27;</span><span class="punctuation">,</span> p<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##可再使用 AI、PS 等后期调整</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##再来个 GWAS 的数据</span></span><br><span class="line"><span class="comment">#直接使用了 qqman 包中的 gwasResults 数据集</span></span><br><span class="line">gwasResults <span class="operator">&lt;-</span> qqman<span class="operator">::</span>gwasResults</span><br><span class="line">fix<span class="punctuation">(</span>gwasResults<span class="punctuation">)</span>	<span class="comment">#查看</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#qqman 包 manhattan()绘制曼哈顿图</span></span><br><span class="line">library<span class="punctuation">(</span>qqman<span class="punctuation">)</span></span><br><span class="line">manhattan<span class="punctuation">(</span>gwasResults<span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;gray90&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray80&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#这里借助 doBy 中的 summaryBy() 计算各染色体中 SNP 序号的中值位置，以放置染色体标签</span></span><br><span class="line">library<span class="punctuation">(</span>doBy<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">gwasResults<span class="operator">$</span>SNP1 <span class="operator">&lt;-</span> seq<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> nrow<span class="punctuation">(</span>gwasResults<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">gwasResults<span class="operator">$</span>CHR <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>gwasResults<span class="operator">$</span>CHR<span class="punctuation">,</span> levels <span class="operator">=</span> unique<span class="punctuation">(</span>gwasResults<span class="operator">$</span>CHR<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">chr <span class="operator">&lt;-</span> summaryBy<span class="punctuation">(</span>SNP1<span class="operator">~</span>CHR<span class="punctuation">,</span> gwasResults<span class="punctuation">,</span> FUN <span class="operator">=</span> median<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggplot2 作图</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>gwasResults<span class="punctuation">,</span> aes<span class="punctuation">(</span>SNP1<span class="punctuation">,</span> <span class="operator">-</span><span class="built_in">log</span><span class="punctuation">(</span>P<span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> CHR<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.line <span class="operator">=</span> element_line<span class="punctuation">(</span>colour <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> CHR<span class="punctuation">)</span><span class="punctuation">,</span> show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;Chromosome&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="built_in">expression</span><span class="punctuation">(</span><span class="string">&#x27;&#x27;</span><span class="operator">~</span><span class="operator">-</span><span class="built_in">log</span><span class="punctuation">[</span><span class="number">10</span><span class="punctuation">]</span><span class="operator">~</span><span class="string">&#x27;(P)&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_x_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> chr<span class="operator">$</span>SNP1.median<span class="punctuation">,</span> labels <span class="operator">=</span> chr<span class="operator">$</span>CHR<span class="punctuation">,</span> expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_hline<span class="punctuation">(</span>yintercept <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p</span><br><span class="line"></span><br><span class="line"><span class="comment">#保存</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;GWAS.pdf&#x27;</span><span class="punctuation">,</span> p<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;GWAS.png&#x27;</span><span class="punctuation">,</span> p<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="桑葚图"><strong>桑葚图</strong></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#install.packages(&quot;ggalluvial&quot;)</span></span><br><span class="line">library<span class="punctuation">(</span>ggalluvial<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>dplyr<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#读入LIHC临床数据</span></span><br><span class="line">LIHC <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&quot;TCGA_lihc.csv&quot;</span><span class="punctuation">,</span>header<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#展示数据情况</span></span><br><span class="line">head<span class="punctuation">(</span>LIHC<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>LIHC<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#分组计算频数</span></span><br><span class="line">LIHCData <span class="operator">&lt;-</span> group_by<span class="punctuation">(</span>LIHC<span class="punctuation">,</span>AGE<span class="punctuation">,</span>SEX<span class="punctuation">,</span>AJCC_PATHOLOGIC_TUMOR_STAGE<span class="punctuation">,</span>OS_STATUS<span class="punctuation">)</span> <span class="operator">%&gt;%</span> summarise<span class="punctuation">(</span>.<span class="punctuation">,</span> count <span class="operator">=</span> n<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#查看宽数据格式</span></span><br><span class="line">head<span class="punctuation">(</span>LIHCData<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#绘制桑基图</span></span><br><span class="line"></span><br><span class="line">ggplot<span class="punctuation">(</span>as.data.frame<span class="punctuation">(</span>LIHCData<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">       aes<span class="punctuation">(</span>axis1 <span class="operator">=</span> AJCC_PATHOLOGIC_TUMOR_STAGE<span class="punctuation">,</span> axis2 <span class="operator">=</span> SEX<span class="punctuation">,</span> axis3 <span class="operator">=</span> AGE<span class="punctuation">,</span></span><br><span class="line">           y<span class="operator">=</span> count<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_x_discrete<span class="punctuation">(</span>limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;AJCC_STAGE&quot;</span><span class="punctuation">,</span> <span class="string">&quot;SEX&quot;</span><span class="punctuation">,</span> <span class="string">&quot;AGE&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">.1</span><span class="punctuation">,</span> <span class="number">.05</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_alluvium<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> OS_STATUS<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_stratum<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> geom_text<span class="punctuation">(</span>stat <span class="operator">=</span> <span class="string">&quot;stratum&quot;</span><span class="punctuation">,</span> label.strata <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_minimal<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ggtitle<span class="punctuation">(</span><span class="string">&quot;Patients in the TCGA-LIHC cohort&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="string">&quot;stratified by demographics and survival&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#2 长数据示例</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#to_lodes_form生成alluvium和stratum列，主分组位于key列中</span></span><br><span class="line">LIHC_long <span class="operator">&lt;-</span> to_lodes_form<span class="punctuation">(</span>data.frame<span class="punctuation">(</span>LIHCData<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                           key <span class="operator">=</span> <span class="string">&quot;Demographic&quot;</span><span class="punctuation">,</span></span><br><span class="line">                           axes <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>LIHC_long<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制桑基图</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data <span class="operator">=</span> LIHC_long<span class="punctuation">,</span></span><br><span class="line">       aes<span class="punctuation">(</span>x <span class="operator">=</span> Demographic<span class="punctuation">,</span> stratum <span class="operator">=</span> stratum<span class="punctuation">,</span> alluvium <span class="operator">=</span> alluvium<span class="punctuation">,</span></span><br><span class="line">           y <span class="operator">=</span> count<span class="punctuation">,</span> label <span class="operator">=</span> stratum<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_alluvium<span class="punctuation">(</span>aes<span class="punctuation">(</span>fill <span class="operator">=</span> OS_STATUS<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_stratum<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> geom_text<span class="punctuation">(</span>stat <span class="operator">=</span> <span class="string">&quot;stratum&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme_minimal<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ggtitle<span class="punctuation">(</span><span class="string">&quot;Patients in the TCGA-LIHC cohort&quot;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="string">&quot;stratified by demographics and survival&quot;</span><span class="punctuation">)</span>		 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#3 状态变化的趋势</span></span><br><span class="line"></span><br><span class="line">data<span class="punctuation">(</span>vaccinations<span class="punctuation">)</span></span><br><span class="line">levels<span class="punctuation">(</span>vaccinations<span class="operator">$</span>response<span class="punctuation">)</span> <span class="operator">&lt;-</span> rev<span class="punctuation">(</span>levels<span class="punctuation">(</span>vaccinations<span class="operator">$</span>response<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">ggplot<span class="punctuation">(</span>vaccinations<span class="punctuation">,</span></span><br><span class="line">       aes<span class="punctuation">(</span>x <span class="operator">=</span> survey<span class="punctuation">,</span> stratum <span class="operator">=</span> response<span class="punctuation">,</span> alluvium <span class="operator">=</span> subject<span class="punctuation">,</span></span><br><span class="line">           y <span class="operator">=</span> freq<span class="punctuation">,</span></span><br><span class="line">           fill <span class="operator">=</span> response<span class="punctuation">,</span> label <span class="operator">=</span> response<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_x_discrete<span class="punctuation">(</span>expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">.1</span><span class="punctuation">,</span> <span class="number">.1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_flow<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_stratum<span class="punctuation">(</span>alpha <span class="operator">=</span> <span class="number">.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>stat <span class="operator">=</span> <span class="string">&quot;stratum&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ggtitle<span class="punctuation">(</span><span class="string">&quot;vaccination survey responses at three points in time&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#4 更多细节</span></span><br><span class="line"></span><br><span class="line">vignette<span class="punctuation">(</span>topic <span class="operator">=</span> <span class="string">&quot;ggalluvial&quot;</span><span class="punctuation">,</span> package <span class="operator">=</span> <span class="string">&quot;ggalluvial&quot;</span><span class="punctuation">)</span> </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="散点图"><strong>散点图</strong></h3>
<p><a href="http://t-redactyl.io/blog/2016/05/creating-plots-in-r-using-ggplot2-part-11-linear-regression-plots.html">回归曲线添加方程</a></p>
<p>!</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">setwd<span class="punctuation">(</span><span class="string">&#x27;./Script/scatterplot/&#x27;</span><span class="punctuation">)</span></span><br><span class="line">rm<span class="punctuation">(</span><span class="built_in">list</span> <span class="operator">=</span> ls<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>readxl<span class="punctuation">)</span>  <span class="comment"># 加载readxl包</span></span><br><span class="line">Scatter <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&quot;111.txt&quot;</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">)</span> <span class="comment"># 读取Scatter数据</span></span><br><span class="line">View<span class="punctuation">(</span>Scatter<span class="punctuation">)</span>  <span class="comment"># 预览数据  也可运行  head(Scatter) 显示数据框前六行</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>Scatter<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;Height&#x27;</span></span><br><span class="line">attach<span class="punctuation">(</span>Scatter<span class="punctuation">)</span>  <span class="comment"># 绑定Scatter数据框</span></span><br><span class="line">opar <span class="operator">&lt;-</span> par<span class="punctuation">(</span>no.readonly <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="comment">#修改图形参数</span></span><br><span class="line">pdf<span class="punctuation">(</span><span class="string">&quot;Scatter plot.pdf&quot;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">5</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span>  <span class="comment">## 输出名为Scatter plot，宽度和高度为5的PDF格式的图形</span></span><br><span class="line">plot<span class="punctuation">(</span>Height<span class="punctuation">,</span>high<span class="punctuation">,</span>  <span class="comment"># 变量为x1，y1</span></span><br><span class="line">     xlab <span class="operator">=</span> <span class="string">&quot;X-axis of scatter plot&quot;</span><span class="punctuation">,</span>  <span class="comment">#添加X轴标签</span></span><br><span class="line">     ylab <span class="operator">=</span> <span class="string">&quot;Y-axis of scatter plot&quot;</span><span class="punctuation">,</span>  <span class="comment">#添加Y轴标签</span></span><br><span class="line">     main <span class="operator">=</span> <span class="string">&quot;Scatter plot title&quot;</span><span class="punctuation">,</span> <span class="comment"># 添加标题</span></span><br><span class="line">     font.axis<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span>font.lab<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span>  <span class="comment">#设置坐标轴和标签字体（2为粗体）</span></span><br><span class="line">     cex.lab<span class="operator">=</span><span class="number">1.30</span><span class="punctuation">,</span> cex.main<span class="operator">=</span><span class="number">1.55</span><span class="punctuation">,</span>cex.axis<span class="operator">=</span><span class="number">1.15</span><span class="punctuation">,</span>  <span class="comment">#设置标签、标题和坐标轴缩放倍数</span></span><br><span class="line">     family<span class="operator">=</span> <span class="string">&quot;serif&quot;</span><span class="punctuation">)</span>   <span class="comment">#设置字体为衬线，如 Time new roman字体</span></span><br><span class="line">detach<span class="punctuation">(</span>Scatter<span class="punctuation">)</span></span><br><span class="line">par<span class="punctuation">(</span>opar<span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggplot画图</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">sp1 <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>Scatter<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> Height<span class="punctuation">,</span> y <span class="operator">=</span> high<span class="punctuation">,</span> shape <span class="operator">=</span> sex<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> geom_point<span class="punctuation">(</span><span class="punctuation">)</span>; sp1</span><br><span class="line"><span class="comment"># 指定 Scatter 数据框和 X 和 Y 轴，将分组变量 sex 映射给shape</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#添加拟合线</span></span><br><span class="line">sp2 <span class="operator">&lt;-</span> sp1 <span class="operator">+</span>  geom_point<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> colour <span class="operator">=</span> <span class="string">&quot;grey60&quot;</span><span class="punctuation">)</span> <span class="operator">+</span>   <span class="comment"># 散点</span></span><br><span class="line">  scale_shape_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">16</span><span class="punctuation">,</span><span class="number">17</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>   <span class="comment"># 设置分组 散点 形状</span></span><br><span class="line">  stat_smooth<span class="punctuation">(</span>method <span class="operator">=</span> lm<span class="punctuation">,</span>   <span class="comment"># 添加线性拟合线，默认拟合 loess 曲线</span></span><br><span class="line">              se <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span>  <span class="comment"># 添加置信区间，FALSE则不添加</span></span><br><span class="line">              level <span class="operator">=</span> <span class="number">0.95</span><span class="punctuation">,</span>  <span class="comment"># 设置CI水平</span></span><br><span class="line">              colour <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">)</span>  <span class="comment"># 线的颜色，默认为蓝色</span></span><br><span class="line">sp2</span><br><span class="line"></span><br><span class="line"><span class="comment">#去除背景网格</span></span><br><span class="line">sp3 <span class="operator">&lt;-</span> sp2 <span class="operator">+</span> theme_bw<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span>  <span class="comment"># 移除背景</span></span><br><span class="line">  theme<span class="punctuation">(</span>panel.grid<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span>  <span class="comment"># 去除网格</span></span><br><span class="line">        panel.border<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.line<span class="operator">=</span>element_line<span class="punctuation">(</span>size<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span>colour<span class="operator">=</span><span class="string">&quot;black&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span>; sp3  <span class="comment"># 添加 x轴和 y轴</span></span><br><span class="line"><span class="comment">#修改坐标轴</span></span><br><span class="line">windowsFonts<span class="punctuation">(</span>myFont1 <span class="operator">=</span> windowsFont<span class="punctuation">(</span><span class="string">&quot;Times New Roman&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span>  <span class="comment"># 设定文字字体</span></span><br><span class="line">sp4 <span class="operator">&lt;-</span> sp3 <span class="operator">+</span> scale_y_continuous<span class="punctuation">(</span>expand <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>   <span class="comment"># y轴起点从0开始</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.text.x <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span> family <span class="operator">=</span> <span class="string">&quot;myFont1&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span>  <span class="comment"># X、Y坐标轴文字格式</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.title.x <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span> family <span class="operator">=</span> <span class="string">&quot;myFont1&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.text.y <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span> family <span class="operator">=</span> <span class="string">&quot;myFont1&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.title.y <span class="operator">=</span> element_text<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> face <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span> family <span class="operator">=</span> <span class="string">&quot;myFont1&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span>; sp4</span><br><span class="line"></span><br><span class="line"><span class="comment">#添加标签</span></span><br><span class="line">sp5 <span class="operator">&lt;-</span> sp4 <span class="operator">+</span> geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>y <span class="operator">=</span> high<span class="operator">+</span><span class="number">0.8</span><span class="punctuation">,</span> label<span class="operator">=</span> ID<span class="punctuation">)</span><span class="punctuation">,</span>  <span class="comment"># 将ID 映射给 label 属性，增加y的取值</span></span><br><span class="line">                       size <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span>  <span class="comment"># 设置标签大小</span></span><br><span class="line">                       vjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span>  <span class="comment"># 调节标签上下位置</span></span><br><span class="line">                       hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span></span><br><span class="line">                       color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span></span><br><span class="line">                       family <span class="operator">=</span> <span class="string">&quot;myFont1&quot;</span><span class="punctuation">)</span>; sp5  <span class="comment"># 调节标签左右位置</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&quot;output1.tiff&quot;</span><span class="punctuation">,</span> sp4<span class="punctuation">,</span>  <span class="comment"># 保存的图片文件名及格式</span></span><br><span class="line">       width <span class="operator">=</span> <span class="number">15</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">12</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&quot;cm&quot;</span><span class="punctuation">,</span> <span class="comment"># 图片宽度、高度和单位，默认输出当前图形的大小，单位英寸。</span></span><br><span class="line">       dpi <span class="operator">=</span> <span class="number">1200</span><span class="punctuation">,</span>  <span class="comment"># 图片分辨率</span></span><br><span class="line">       compression <span class="operator">=</span> <span class="string">&quot;lzw&quot;</span><span class="punctuation">)</span>  <span class="comment"># tiff格式压缩类型</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><a href="https://mp.weixin.qq.com/s?src=11&amp;timestamp=1585557391&amp;ver=2247&amp;signature=yOovH*r9fbYYqVM0C*Bw5zR7-6gXYTG8FYtcO3gicvTEVbhIfdhFMTEorSI30FiTKT6BgJooR5wKA6UvsPy0phrO02WJJrUSPqAb1U*iwBPbdddynq0l0qvrCq6u2d9J&amp;new=1">ggstar绘制星星散点图</a></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span><span class="punctuation">(</span><span class="operator">!</span>requireNamespace<span class="punctuation">(</span><span class="string">&quot;remotes&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  install.packages<span class="punctuation">(</span><span class="string">&quot;remotes&quot;</span><span class="punctuation">)</span></span><br><span class="line">remotes<span class="operator">::</span>install_github<span class="punctuation">(</span><span class="string">&quot;xiangpin/ggstar&quot;</span><span class="punctuation">)</span><span class="comment">#不行就多试几次</span></span><br><span class="line">ggplot<span class="punctuation">(</span>data<span class="operator">=</span>iris<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>Sepal.Length<span class="punctuation">,</span>y<span class="operator">=</span>Sepal.Width<span class="punctuation">,</span></span><br><span class="line">                           starshape<span class="operator">=</span>Species<span class="punctuation">,</span> fill<span class="operator">=</span>Species<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> geom_star<span class="punctuation">(</span>show.legend<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">5</span><span class="punctuation">,</span>starshape <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span>values<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#66C2A5&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#FC8D62&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#8DACB&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h4 id="ggsymbol绘制更多点样式">ggsymbol绘制更多点样式</h4>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggsymbol<span class="punctuation">)</span></span><br><span class="line">d <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>p<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="operator">:</span><span class="number">127</span><span class="punctuation">)</span><span class="punctuation">,</span>f<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;g&quot;</span><span class="punctuation">,</span><span class="number">26</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;s&quot;</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="string">&quot;g&quot;</span><span class="punctuation">,</span> <span class="number">95</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">d<span class="operator">$</span>f <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>d<span class="operator">$</span>f<span class="punctuation">,</span> levels<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;g&quot;</span><span class="punctuation">,</span> <span class="string">&quot;s&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_symbol<span class="punctuation">(</span>data<span class="operator">=</span>d<span class="punctuation">,</span> </span><br><span class="line">              mapping<span class="operator">=</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>p<span class="operator">%%</span><span class="number">16</span><span class="punctuation">,</span> y<span class="operator">=</span>p<span class="operator">%/%</span><span class="number">16</span><span class="punctuation">,</span> symbol<span class="operator">=</span>p<span class="punctuation">,</span> fill<span class="operator">=</span>f<span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">              size<span class="operator">=</span><span class="number">4</span><span class="punctuation">,</span> stroke<span class="operator">=</span><span class="number">0.5</span><span class="punctuation">,</span> show.legend<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>data<span class="operator">=</span>d<span class="punctuation">,</span> </span><br><span class="line">            mapping<span class="operator">=</span>aes<span class="punctuation">(</span>x<span class="operator">=</span>p<span class="operator">%%</span><span class="number">16</span><span class="punctuation">,</span> y<span class="operator">=</span>p<span class="operator">%/%</span><span class="number">16</span><span class="operator">+</span><span class="number">0.25</span><span class="punctuation">,</span> label<span class="operator">=</span>p<span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">            size<span class="operator">=</span><span class="number">3</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_symbol_identity<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span>values<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  xlab<span class="punctuation">(</span><span class="literal">NULL</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  ylab<span class="punctuation">(</span><span class="literal">NULL</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>axis.ticks<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">        axis.text<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line"><span class="comment">#例子</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>data<span class="operator">=</span>iris<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>Sepal.Width<span class="punctuation">,</span>y<span class="operator">=</span>Sepal.Length<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_symbol<span class="punctuation">(</span>aes<span class="punctuation">(</span>symbol<span class="operator">=</span>Species<span class="punctuation">,</span> fill<span class="operator">=</span>Species<span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">              color<span class="operator">=</span><span class="string">&quot;grey60&quot;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">2.5</span><span class="punctuation">,</span></span><br><span class="line">              stroke<span class="operator">=</span><span class="number">0.5</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span>values<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#E41A1C&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#377EB8&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#4DAF4A&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_symbol_manual<span class="punctuation">(</span>values<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">28</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">,</span> <span class="number">31</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p</span><br></pre></td></tr></table></figure>
<h3 id="箱线图和小提琴图">箱线图和小提琴图</h3>
<h4 id="ggplot2配对散点箱线图">ggplot2配对散点箱线图</h4>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">x &lt;-  rnorm(10)</span><br><span class="line">y &lt;- rnorm(10)</span><br><span class="line">d &lt;- data.frame(x=x, y=y)</span><br><span class="line">d$g &lt;- rownames(d)</span><br><span class="line">require(tidyr)</span><br><span class="line">dd &lt;- pivot_longer(d, 1:2)</span><br><span class="line"></span><br><span class="line">require(ggplot2)</span><br><span class="line">ggplot(dd, aes(name, value)) + geom_boxplot() +</span><br><span class="line">  geom_line(aes(group=g), color=&#x27;firebrick&#x27;) +</span><br><span class="line">  geom_point(aes(color=name), size=3)</span><br><span class="line"></span><br><span class="line">t1 &lt;- rnorm(10)</span><br><span class="line">t2 &lt;- rnorm(10) + 1</span><br><span class="line">t3 &lt;- rnorm(10) + 2</span><br><span class="line">t4 &lt;- rnorm(10) + 3</span><br><span class="line"></span><br><span class="line">d &lt;- data.frame(t1=t1, t2=t2, t3=t3, t4=t4)</span><br><span class="line">d$g &lt;- rownames(d)</span><br><span class="line">require(tidyr)</span><br><span class="line">dd &lt;- pivot_longer(d, 1:4)</span><br><span class="line">require(ggplot2)</span><br><span class="line">ggplot(dd, aes(name, value)) + geom_boxplot() +</span><br><span class="line">  geom_line(aes(group=g), color=&#x27;firebrick&#x27;) +</span><br><span class="line">  geom_point(aes(color=name), size=3)</span><br></pre></td></tr></table></figure>
<h4 id="箱线图实例">箱线图实例</h4>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">library<span class="punctuation">(</span>reshape2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">alpha <span class="operator">&lt;-</span> read.csv<span class="punctuation">(</span><span class="string">&#x27;alpha.csv&#x27;</span><span class="punctuation">)</span></span><br><span class="line">alpha<span class="operator">$</span>group2 <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>alpha<span class="operator">$</span>group2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">alpha1 <span class="operator">&lt;-</span> melt<span class="punctuation">(</span>alpha<span class="punctuation">,</span> id <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;samples&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;group1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;group2&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">alpha2 <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>alpha1<span class="punctuation">,</span> variable <span class="operator">==</span> <span class="string">&#x27;chao1&#x27;</span><span class="punctuation">)</span></span><br><span class="line">alpha3 <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>alpha2<span class="punctuation">,</span> group1 <span class="operator">==</span> <span class="string">&#x27;c&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##boxplot()，箱线图</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pdf(&#x27;boxplot.pdf&#x27;, width = 13, height = 5)</span></span><br><span class="line">png<span class="punctuation">(</span><span class="string">&#x27;boxplot.png&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">4000</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">1500</span><span class="punctuation">,</span> res <span class="operator">=</span> <span class="number">300</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&#x27;px&#x27;</span><span class="punctuation">)</span></span><br><span class="line">par<span class="punctuation">(</span>mfrow <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">boxplot<span class="punctuation">(</span>value<span class="operator">~</span>group2<span class="punctuation">,</span> data <span class="operator">=</span> alpha3<span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;#f8766d&#x27;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&#x27;Chao1 (group c)&#x27;</span><span class="punctuation">)</span></span><br><span class="line">boxplot<span class="punctuation">(</span>value<span class="operator">~</span>group2<span class="punctuation">,</span> data <span class="operator">=</span> alpha3<span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;#f8766d&#x27;</span><span class="punctuation">,</span> notch <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> varwidth <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&#x27;Chao1 (group c)&#x27;</span><span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##vioplot()，提琴图</span></span><br><span class="line">library<span class="punctuation">(</span>vioplot<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">c1 <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>alpha3<span class="punctuation">,</span> group2 <span class="operator">==</span> <span class="string">&#x27;1&#x27;</span><span class="punctuation">)</span><span class="operator">$</span>value</span><br><span class="line">c2 <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>alpha3<span class="punctuation">,</span> group2 <span class="operator">==</span> <span class="string">&#x27;2&#x27;</span><span class="punctuation">)</span><span class="operator">$</span>value</span><br><span class="line">c3 <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>alpha3<span class="punctuation">,</span> group2 <span class="operator">==</span> <span class="string">&#x27;3&#x27;</span><span class="punctuation">)</span><span class="operator">$</span>value</span><br><span class="line">c4 <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>alpha3<span class="punctuation">,</span> group2 <span class="operator">==</span> <span class="string">&#x27;4&#x27;</span><span class="punctuation">)</span><span class="operator">$</span>value</span><br><span class="line">c5 <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>alpha3<span class="punctuation">,</span> group2 <span class="operator">==</span> <span class="string">&#x27;5&#x27;</span><span class="punctuation">)</span><span class="operator">$</span>value</span><br><span class="line"></span><br><span class="line"><span class="comment">#pdf(&#x27;vioplot.pdf&#x27;, width = 6.5, height = 5)</span></span><br><span class="line">png<span class="punctuation">(</span><span class="string">&#x27;vioplot.png&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">2000</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">1500</span><span class="punctuation">,</span> res <span class="operator">=</span> <span class="number">300</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&#x27;px&#x27;</span><span class="punctuation">)</span></span><br><span class="line">vioplot<span class="punctuation">(</span>c1<span class="punctuation">,</span> c2<span class="punctuation">,</span> c3<span class="punctuation">,</span> c4<span class="punctuation">,</span> c5<span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;#f8766d&#x27;</span><span class="punctuation">)</span></span><br><span class="line">title<span class="punctuation">(</span>ylab <span class="operator">=</span> <span class="string">&#x27;Chao1 (group c)&#x27;</span><span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##ggplot2</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#箱线图</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>alpha2<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> group2<span class="punctuation">,</span> y <span class="operator">=</span> value<span class="punctuation">,</span> fill <span class="operator">=</span> group1<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">geom_boxplot<span class="punctuation">(</span>outlier.size <span class="operator">=</span> <span class="number">0.7</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;Chao1&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggsave(&#x27;ggplot2.box.pdf&#x27;, p, width = 6, height = 4)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;ggplot2.box.png&#x27;</span><span class="punctuation">,</span> p<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#带散点及凹槽的箱线图</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>alpha3<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> group2<span class="punctuation">,</span> y <span class="operator">=</span> value<span class="punctuation">,</span> fill <span class="operator">=</span> group1<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">geom_boxplot<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;#f8766d&#x27;</span><span class="punctuation">,</span> notch <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_jitter<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;Chao1 (group c)&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.position <span class="operator">=</span> <span class="string">&#x27;none&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggsave(&#x27;ggplot2.box_point.pdf&#x27;, p, width = 6, height = 4)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;ggplot2.box_point.png&#x27;</span><span class="punctuation">,</span> p<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#内置箱线图的提琴图</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>alpha2<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> group2<span class="punctuation">,</span> y <span class="operator">=</span> value<span class="punctuation">,</span> fill <span class="operator">=</span> group1<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">geom_violin<span class="punctuation">(</span>position <span class="operator">=</span> position_dodge<span class="punctuation">(</span>width <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> scale <span class="operator">=</span> <span class="string">&#x27;width&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_boxplot<span class="punctuation">(</span>position <span class="operator">=</span> position_dodge<span class="punctuation">(</span>width <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> outlier.size <span class="operator">=</span> <span class="number">0.7</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">,</span> show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;Chao1&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggsave(&#x27;ggplot2.box_violin.pdf&#x27;, p, width = 6, height = 4)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;ggplot2.box_violin.png&#x27;</span><span class="punctuation">,</span> p<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#带分面的箱线图</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>alpha1<span class="punctuation">,</span> aes<span class="punctuation">(</span>x <span class="operator">=</span> group2<span class="punctuation">,</span> y <span class="operator">=</span> value<span class="punctuation">,</span> fill <span class="operator">=</span> group1<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">geom_boxplot<span class="punctuation">(</span>outlier.size <span class="operator">=</span> <span class="number">0.3</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">0.25</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">facet_wrap<span class="punctuation">(</span><span class="operator">~</span>variable<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> scales <span class="operator">=</span> <span class="string">&#x27;free&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggsave(&#x27;ggplot2.box_facet.pdf&#x27;, p, width = 7, height = 5)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;ggplot2.box_facet.png&#x27;</span><span class="punctuation">,</span> p<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">7</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="ggpubr箱线图">ggpubr箱线图</h4>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">View<span class="punctuation">(</span>ToothGrowth<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggpubr<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggsignif<span class="punctuation">)</span></span><br><span class="line">ToothGrowth<span class="operator">$</span>dose <span class="operator">&lt;-</span> as.factor<span class="punctuation">(</span>ToothGrowth<span class="operator">$</span>dose<span class="punctuation">)</span></span><br><span class="line">ggboxplot<span class="punctuation">(</span>ToothGrowth<span class="punctuation">,</span> <span class="comment">#数据对象</span></span><br><span class="line">          x <span class="operator">=</span> <span class="string">&quot;dose&quot;</span><span class="punctuation">,</span> <span class="comment"># 选择x轴用那一列数据</span></span><br><span class="line">          y <span class="operator">=</span> <span class="string">&quot;len&quot;</span><span class="punctuation">,</span> <span class="comment">#选择y轴用什么数据</span></span><br><span class="line">          fill <span class="operator">=</span> <span class="string">&quot;dose&quot;</span><span class="punctuation">,</span> <span class="comment">#颜色根据哪一列决定</span></span><br><span class="line">          bxp.errorbar <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> <span class="comment">#是否添加error bar</span></span><br><span class="line">          bxp.errorbar.width <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">,</span> <span class="comment">#error bar的长度</span></span><br><span class="line">          palette <span class="operator">=</span> <span class="string">&quot;npg&quot;</span><span class="punctuation">,</span> <span class="comment">#颜色风格</span></span><br><span class="line">          add <span class="operator">=</span> <span class="string">&quot;point&quot;</span> <span class="comment"># 是否添加boxplot上面的点点</span></span><br><span class="line"><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>title <span class="operator">=</span> <span class="string">&quot;Effect of Vitamin C on Tooth Growth&quot;</span><span class="punctuation">,</span> <span class="comment"># 添加主标题</span></span><br><span class="line">       subtitle <span class="operator">=</span> <span class="string">&quot;Plot of length by dose&quot;</span><span class="punctuation">,</span> <span class="comment"># 添加次标记</span></span><br><span class="line">       caption <span class="operator">=</span> <span class="string">&quot;Data source: ToothGrowth&quot;</span><span class="punctuation">,</span> <span class="comment">#添加脚注</span></span><br><span class="line">       x <span class="operator">=</span> <span class="string">&quot;Dose (mg)&quot;</span><span class="punctuation">,</span> <span class="comment"># x轴的名字</span></span><br><span class="line">       y <span class="operator">=</span> <span class="string">&quot;Teeth length&quot;</span> <span class="comment"># y轴的名字</span></span><br><span class="line">  <span class="punctuation">)</span></span><br><span class="line">ggboxplot<span class="punctuation">(</span>ToothGrowth<span class="punctuation">,</span> <span class="comment">#数据对象</span></span><br><span class="line">          x <span class="operator">=</span> <span class="string">&quot;dose&quot;</span><span class="punctuation">,</span> <span class="comment"># 选择x轴用那一列数据</span></span><br><span class="line">          y <span class="operator">=</span> <span class="string">&quot;len&quot;</span><span class="punctuation">,</span> <span class="comment">#选择y轴用什么数据</span></span><br><span class="line">          fill <span class="operator">=</span> <span class="string">&quot;dose&quot;</span><span class="punctuation">,</span> <span class="comment">#颜色根据哪一列决定</span></span><br><span class="line">          bxp.errorbar <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> <span class="comment">#是否添加error bar</span></span><br><span class="line">          bxp.errorbar.width <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">,</span> <span class="comment">#error bar的长度</span></span><br><span class="line">          palette <span class="operator">=</span> <span class="string">&quot;npg&quot;</span><span class="punctuation">,</span> <span class="comment">#颜色风格</span></span><br><span class="line">          add <span class="operator">=</span> <span class="string">&quot;point&quot;</span> <span class="comment"># 是否添加boxplot上面的点点</span></span><br><span class="line"><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>title <span class="operator">=</span> <span class="string">&quot;Effect of Vitamin C on Tooth Growth&quot;</span><span class="punctuation">,</span> <span class="comment"># 添加主标题</span></span><br><span class="line">       subtitle <span class="operator">=</span> <span class="string">&quot;Plot of length by dose&quot;</span><span class="punctuation">,</span> <span class="comment"># 添加次标记</span></span><br><span class="line">       caption <span class="operator">=</span> <span class="string">&quot;Data source: ToothGrowth&quot;</span><span class="punctuation">,</span> <span class="comment">#添加脚注</span></span><br><span class="line">       x <span class="operator">=</span> <span class="string">&quot;Dose (mg)&quot;</span><span class="punctuation">,</span> <span class="comment"># x轴的名字</span></span><br><span class="line">       y <span class="operator">=</span> <span class="string">&quot;Teeth length&quot;</span> <span class="comment"># y轴的名字</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_signif<span class="punctuation">(</span>comparisons <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;0.5&quot;</span><span class="punctuation">,</span> <span class="string">&quot;1&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;1&quot;</span><span class="punctuation">,</span><span class="string">&quot;2&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;0.5&quot;</span><span class="punctuation">,</span><span class="string">&quot;2&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment"># 设置要对比的组</span></span><br><span class="line">              y_position <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">34</span><span class="punctuation">,</span><span class="number">36</span><span class="punctuation">,</span><span class="number">38</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment">#设置3个显著性标记的高度</span></span><br><span class="line">              tip_length <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment">#设置显著性那条横线两头向下的长度</span></span><br><span class="line">              map_signif_level <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> <span class="comment">#设置是否标记显著性的*号，还是直接标记数值</span></span><br><span class="line">              test <span class="operator">=</span> t.test <span class="comment">#设置显著性计算方式</span></span><br><span class="line">  <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#最后就是设置线宽度和字体大小，及其他的主题theme()参数：</span></span><br><span class="line"></span><br><span class="line">ggboxplot<span class="punctuation">(</span>ToothGrowth<span class="punctuation">,</span> <span class="comment">#数据对象</span></span><br><span class="line">          x <span class="operator">=</span> <span class="string">&quot;dose&quot;</span><span class="punctuation">,</span> <span class="comment"># 选择x轴用那一列数据</span></span><br><span class="line">          y <span class="operator">=</span> <span class="string">&quot;len&quot;</span><span class="punctuation">,</span> <span class="comment">#选择y轴用什么数据</span></span><br><span class="line">          fill <span class="operator">=</span> <span class="string">&quot;dose&quot;</span><span class="punctuation">,</span> <span class="comment">#颜色根据哪一列决定</span></span><br><span class="line">          bxp.errorbar <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> <span class="comment">#是否添加error bar</span></span><br><span class="line">          bxp.errorbar.width <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">,</span> <span class="comment">#error bar的长度</span></span><br><span class="line">          palette <span class="operator">=</span> <span class="string">&quot;npg&quot;</span><span class="punctuation">,</span> <span class="comment">#颜色风格</span></span><br><span class="line">          add <span class="operator">=</span> <span class="string">&quot;point&quot;</span> <span class="comment"># 是否添加boxplot上面的点点</span></span><br><span class="line"><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  labs<span class="punctuation">(</span>title <span class="operator">=</span> <span class="string">&quot;Effect of Vitamin C on Tooth Growth&quot;</span><span class="punctuation">,</span> <span class="comment"># 添加主标题</span></span><br><span class="line">       subtitle <span class="operator">=</span> <span class="string">&quot;Plot of length by dose&quot;</span><span class="punctuation">,</span> <span class="comment"># 添加次标记</span></span><br><span class="line">       caption <span class="operator">=</span> <span class="string">&quot;Data source: ToothGrowth&quot;</span><span class="punctuation">,</span> <span class="comment">#添加脚注</span></span><br><span class="line">       x <span class="operator">=</span> <span class="string">&quot;Dose (mg)&quot;</span><span class="punctuation">,</span> <span class="comment"># x轴的名字</span></span><br><span class="line">       y <span class="operator">=</span> <span class="string">&quot;Teeth length&quot;</span> <span class="comment"># y轴的名字</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_signif<span class="punctuation">(</span>comparisons <span class="operator">=</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;0.5&quot;</span><span class="punctuation">,</span> <span class="string">&quot;1&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;1&quot;</span><span class="punctuation">,</span><span class="string">&quot;2&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;0.5&quot;</span><span class="punctuation">,</span><span class="string">&quot;2&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment"># 设置要对比的组</span></span><br><span class="line">              y_position <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">34</span><span class="punctuation">,</span><span class="number">36</span><span class="punctuation">,</span><span class="number">38</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment">#设置3个显著性标记的高度</span></span><br><span class="line">              tip_length <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment">#设置显著性那条横线两头向下的长度</span></span><br><span class="line">              map_signif_level <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span> <span class="comment">#设置是否标记显著性的*号，还是直接标记数值</span></span><br><span class="line">              test <span class="operator">=</span> t.test <span class="comment">#设置显著性计算方式</span></span><br><span class="line">  <span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span></span><br><span class="line">    plot.title    <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> size   <span class="operator">=</span> <span class="number">16</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    plot.subtitle <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> size   <span class="operator">=</span> <span class="number">16</span><span class="punctuation">,</span>hjust <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    plot.caption  <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> size   <span class="operator">=</span> <span class="number">16</span><span class="punctuation">,</span>face <span class="operator">=</span> <span class="string">&quot;italic&quot;</span><span class="punctuation">,</span> hjust <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.text.x   <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">16</span><span class="punctuation">,</span> angle <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.text.y   <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">16</span><span class="punctuation">,</span> angle <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.title.x  <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">16</span><span class="punctuation">,</span> angle <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.title.y  <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">16</span><span class="punctuation">,</span> angle <span class="operator">=</span> <span class="number">90</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.title  <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> size  <span class="operator">=</span> <span class="number">16</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    legend.text   <span class="operator">=</span> element_text<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> size   <span class="operator">=</span> <span class="number">16</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">    axis.line.y <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="string">&quot;solid&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment"># y轴线特征</span></span><br><span class="line">    axis.line.x <span class="operator">=</span> element_line <span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&quot;black&quot;</span><span class="punctuation">,</span>linetype <span class="operator">=</span> <span class="string">&quot;solid&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="comment"># x轴线特征</span></span><br><span class="line">    panel.border <span class="operator">=</span> element_rect<span class="punctuation">(</span>linetype <span class="operator">=</span> <span class="string">&quot;solid&quot;</span><span class="punctuation">,</span> size <span class="operator">=</span> <span class="number">1.2</span><span class="punctuation">,</span>fill <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span> <span class="comment"># 图四周框起来</span></span><br><span class="line">  <span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="anosim分析"><strong>Anosim分析</strong></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>vegan<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#若是单纯以计算俩组beta距离值画图的话</span></span><br><span class="line">dist.abun_D <span class="operator">&lt;-</span> as.vector<span class="punctuation">(</span>vegdist<span class="punctuation">(</span>dat_genu<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">,</span>method <span class="operator">=</span> <span class="string">&#x27;bray&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">dist.abun_H <span class="operator">&lt;-</span> as.vector<span class="punctuation">(</span>vegdist<span class="punctuation">(</span>dat_genu<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">7</span><span class="operator">:</span><span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">,</span>method <span class="operator">=</span> <span class="string">&#x27;bray&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">sum</span> <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>dist.abun_D<span class="punctuation">,</span>dist.abun_H<span class="punctuation">)</span></span><br><span class="line">boxplot<span class="punctuation">(</span><span class="built_in">sum</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##读入文件</span></span><br><span class="line"><span class="comment">#现有的距离矩阵</span></span><br><span class="line">dis <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;bray.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">dis <span class="operator">&lt;-</span> as.dist<span class="punctuation">(</span>dis<span class="punctuation">)</span>	<span class="comment">#将导入的样本间距离转化为 dist 类型</span></span><br><span class="line"><span class="comment">#或者直接使用 OTU 丰度表</span></span><br><span class="line">otu <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;otu_table.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">otu <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>t<span class="punctuation">(</span>otu<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#样本分组文件</span></span><br><span class="line">group <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;group.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##ANOSIM 分析（所有分组间比较，即整体差异）</span></span><br><span class="line"><span class="comment">#（1）若是已经提供好了距离矩阵，则直接使用现有的距离矩阵进行分析即可</span></span><br><span class="line">anosim_result_dis <span class="operator">&lt;-</span> anosim<span class="punctuation">(</span>dis<span class="punctuation">,</span> group<span class="operator">$</span>site<span class="punctuation">,</span> permutations <span class="operator">=</span> <span class="number">999</span><span class="punctuation">)</span>	<span class="comment">#根据 group$site 这一列样本分组信息进行 ANOSIM 分析，随机置换检验 999 次</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#（2）若是使用 OTU 丰度表，则需要在计算时指定所依据的距离类型，这里依然使用 Bray-Curtis 距离</span></span><br><span class="line">anosim_result_otu <span class="operator">&lt;-</span> anosim<span class="punctuation">(</span>otu<span class="punctuation">,</span> group<span class="operator">$</span>site<span class="punctuation">,</span> permutations <span class="operator">=</span> <span class="number">999</span><span class="punctuation">,</span> distance <span class="operator">=</span> <span class="string">&#x27;bray&#x27;</span><span class="punctuation">)</span> 	<span class="comment">#这条命令的详情和上述命令所表示的信息一致</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#（3）或者首先根据丰度表计算样本距离，在将所的距离数据作为输入</span></span><br><span class="line">dis1 <span class="operator">&lt;-</span> vegdist<span class="punctuation">(</span>otu<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;bray&#x27;</span><span class="punctuation">)</span></span><br><span class="line">anosim_result_dis1 <span class="operator">&lt;-</span> anosim<span class="punctuation">(</span>dis1<span class="punctuation">,</span> group<span class="operator">$</span>site<span class="punctuation">,</span> permutations <span class="operator">=</span> <span class="number">999</span><span class="punctuation">)</span>	<span class="comment">#同上所述</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看结果，上述 3 条命令所计算的内容一致，以其中一个为例</span></span><br><span class="line">anosim_result_dis</span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line">summary<span class="punctuation">(</span>anosim_result_dis<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>anosim_result_dis<span class="punctuation">)</span></span><br><span class="line">anosim_result_dis<span class="operator">$</span><span class="built_in">signif</span>	<span class="comment">#p 值</span></span><br><span class="line">anosim_result_dis<span class="operator">$</span>statistic	<span class="comment">#R 值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#作图展示</span></span><br><span class="line"><span class="comment">#pdf(paste(&#x27;anosim.all.pdf&#x27;, sep = &#x27;&#x27;), width = 10, height = 5)</span></span><br><span class="line">png<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&#x27;anosim.all.png&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">800</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">400</span><span class="punctuation">)</span></span><br><span class="line">plot<span class="punctuation">(</span>anosim_result_dis<span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;purple&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##ANOSIM 分析（使用循环处理，进行小分组间比较，如两组间）</span></span><br><span class="line"><span class="comment">#推荐使用 OTU 丰度表作为输入数据，每次筛选分组后重新计算样本距离，避免由于样本数减少可能导致的距离变动而造成误差</span></span><br><span class="line">group_name <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>group<span class="operator">$</span>site<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">dir.create<span class="punctuation">(</span><span class="string">&#x27;anosim_two&#x27;</span><span class="punctuation">,</span> recursive <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line">anosim_result_two <span class="operator">&lt;-</span> <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="punctuation">(</span><span class="built_in">length</span><span class="punctuation">(</span>group_name<span class="punctuation">)</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	<span class="keyword">for</span> <span class="punctuation">(</span>j <span class="keyword">in</span> <span class="punctuation">(</span>i <span class="operator">+</span> <span class="number">1</span><span class="punctuation">)</span><span class="operator">:</span><span class="built_in">length</span><span class="punctuation">(</span>group_name<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		group_ij <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>group<span class="punctuation">,</span> site <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span>group_name<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">,</span> group_name<span class="punctuation">[</span>j<span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">		otu_ij <span class="operator">&lt;-</span> otu<span class="punctuation">[</span>group_ij<span class="operator">$</span><span class="built_in">names</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">		anosim_result_otu_ij <span class="operator">&lt;-</span> anosim<span class="punctuation">(</span>otu_ij<span class="punctuation">,</span> group_ij<span class="operator">$</span>site<span class="punctuation">,</span> permutations <span class="operator">=</span> <span class="number">999</span><span class="punctuation">,</span> distance <span class="operator">=</span> <span class="string">&#x27;bray&#x27;</span><span class="punctuation">)</span>	<span class="comment">#随机置换检验 999 次</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">#每次循环提取 R 值和 p 值（同时标记 “*” 显著性）</span></span><br><span class="line">		<span class="keyword">if</span> <span class="punctuation">(</span>anosim_result_otu_ij<span class="operator">$</span><span class="built_in">signif</span> <span class="operator">&lt;=</span> <span class="number">0.001</span><span class="punctuation">)</span> Sig <span class="operator">&lt;-</span> <span class="string">&#x27;***&#x27;</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span>anosim_result_otu_ij<span class="operator">$</span><span class="built_in">signif</span> <span class="operator">&lt;=</span> <span class="number">0.01</span><span class="punctuation">)</span> Sig <span class="operator">&lt;-</span> <span class="string">&#x27;**&#x27;</span></span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span>anosim_result_otu_ij<span class="operator">$</span><span class="built_in">signif</span> <span class="operator">&lt;=</span> <span class="number">0.05</span><span class="punctuation">)</span> Sig <span class="operator">&lt;-</span> <span class="string">&#x27;*&#x27;</span></span><br><span class="line">		<span class="keyword">else</span> Sig <span class="operator">&lt;-</span> <span class="literal">NA</span></span><br><span class="line">		anosim_result_two <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>anosim_result_two<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>paste<span class="punctuation">(</span>group_name<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">,</span> group_name<span class="punctuation">[</span>j<span class="punctuation">]</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;/&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&#x27;Bray-Curtis&#x27;</span><span class="punctuation">,</span> anosim_result_otu_ij<span class="operator">$</span>statistic<span class="punctuation">,</span> anosim_result_otu_ij<span class="operator">$</span><span class="built_in">signif</span><span class="punctuation">,</span> Sig<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">#每次循环输出图片</span></span><br><span class="line">		<span class="comment">#pdf(paste(&#x27;anosim_two/anosim.&#x27;, group_name[i], &#x27;_&#x27;, group_name[j], &#x27;.pdf&#x27;, sep = &#x27;&#x27;), width = 7, height = 5)</span></span><br><span class="line">		png<span class="punctuation">(</span>paste<span class="punctuation">(</span><span class="string">&#x27;anosim_two/anosim.&#x27;</span><span class="punctuation">,</span> group_name<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">,</span> <span class="string">&#x27;_&#x27;</span><span class="punctuation">,</span> group_name<span class="punctuation">[</span>j<span class="punctuation">]</span><span class="punctuation">,</span> <span class="string">&#x27;.png&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">600</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">400</span><span class="punctuation">)</span></span><br><span class="line">		plot<span class="punctuation">(</span>anosim_result_otu_ij<span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;gray&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">		dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	<span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#输出带 R 值和 p 值的表格</span></span><br><span class="line">anosim_result_two <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>anosim_result_two<span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>anosim_result_two<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;group&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;distance&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;R&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;P_value&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;Sig&#x27;</span><span class="punctuation">)</span></span><br><span class="line">write.table<span class="punctuation">(</span>anosim_result_two<span class="punctuation">,</span> <span class="string">&#x27;anosim_two/ANOSIM.result_two.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> na <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="分面柱状图"><strong>分面柱状图</strong></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>reshape2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>dplyr<span class="punctuation">)</span></span><br><span class="line">data_m <span class="operator">&lt;-</span> read.table<span class="punctuation">(</span>text<span class="operator">=</span>data_ori<span class="punctuation">,</span> header<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span> sep<span class="operator">=</span><span class="string">&quot;;&quot;</span><span class="punctuation">,</span> <span class="built_in">quote</span><span class="operator">=</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>data_m<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#首先看下每个基因在不同组的表达情况, facet_grid和facet_wrap可以对图形分面显示。</span></span><br><span class="line"><span class="comment"># scales: free_y 表示不同子图之间使用独立的Y轴信息</span></span><br><span class="line"><span class="comment">#         但x轴使用同样的信息。</span></span><br><span class="line"><span class="comment">#         其它可选参数有free_x, free, fixed</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>data_m<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>Gene<span class="punctuation">,</span> y<span class="operator">=</span>Expr<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_bar<span class="punctuation">(</span>stat<span class="operator">=</span><span class="string">&quot;identity&quot;</span><span class="punctuation">,</span> position<span class="operator">=</span><span class="string">&quot;dodge&quot;</span><span class="punctuation">,</span> aes<span class="punctuation">(</span>fill<span class="operator">=</span>Group<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  facet_grid<span class="punctuation">(</span>Condition<span class="operator">~</span>.<span class="punctuation">,</span> scales<span class="operator">=</span><span class="string">&quot;free_y&quot;</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line"><span class="comment"># 如果没有图形界面，运行下面的语句把图存在工作目录下的Rplots.pdf文件中</span></span><br><span class="line"><span class="comment">#dev.off()</span></span><br><span class="line"><span class="comment">#柱子有点多，也可以利用mean±SD的形式展现</span></span><br><span class="line"><span class="comment"># 获取平均值和标准差</span></span><br><span class="line"><span class="comment"># 分组时不只Gene一个变量了，还需要考虑Condition</span></span><br><span class="line">data_m_sd_mean <span class="operator">&lt;-</span> data_m <span class="operator">%&gt;%</span> group_by<span class="punctuation">(</span>Gene<span class="punctuation">,</span> Condition<span class="punctuation">)</span> <span class="operator">%&gt;%</span> dplyr<span class="operator">::</span>summarise<span class="punctuation">(</span>sd<span class="operator">=</span>sd<span class="punctuation">(</span>Expr<span class="punctuation">)</span><span class="punctuation">,</span> value<span class="operator">=</span>mean<span class="punctuation">(</span>Expr<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">data_m_sd_mean <span class="operator">&lt;-</span> as.data.frame<span class="punctuation">(</span>data_m_sd_mean<span class="punctuation">)</span></span><br><span class="line">data_m_sd_mean</span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>data_m_sd_mean<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>Gene<span class="punctuation">,</span> y<span class="operator">=</span>value<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">  geom_bar<span class="punctuation">(</span>stat<span class="operator">=</span><span class="string">&quot;identity&quot;</span><span class="punctuation">,</span> aes<span class="punctuation">(</span>fill<span class="operator">=</span>Gene<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_errorbar<span class="punctuation">(</span>aes<span class="punctuation">(</span>ymin<span class="operator">=</span>value<span class="operator">-</span>sd<span class="punctuation">,</span> ymax<span class="operator">=</span>value<span class="operator">+</span>sd<span class="punctuation">)</span><span class="punctuation">,</span> width<span class="operator">=</span><span class="number">0.2</span><span class="punctuation">,</span> position<span class="operator">=</span>position_dodge<span class="punctuation">(</span>width<span class="operator">=</span><span class="number">0.75</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  facet_wrap<span class="punctuation">(</span><span class="operator">~</span>Condition<span class="punctuation">,</span> ncol<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line"><span class="comment">#每组里面各个基因的相对表达, 纵轴的显示改为百分比</span></span><br><span class="line"><span class="comment"># position=&quot;fill&quot; 展示的是堆积柱状图各部分的相对比例</span></span><br><span class="line"><span class="comment"># position=&quot;stack&quot; 展示的是堆积柱状图的原始值，可以自己体现下看卡差别</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>data_m<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>Group<span class="punctuation">,</span> y<span class="operator">=</span>Expr<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_bar<span class="punctuation">(</span>stat<span class="operator">=</span><span class="string">&quot;identity&quot;</span><span class="punctuation">,</span> position<span class="operator">=</span><span class="string">&quot;fill&quot;</span><span class="punctuation">,</span> aes<span class="punctuation">(</span>fill<span class="operator">=</span>Gene<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>labels <span class="operator">=</span> scales<span class="operator">::</span>percent<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  facet_wrap<span class="punctuation">(</span><span class="operator">~</span>Condition<span class="punctuation">,</span> ncol<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line"><span class="comment">#在柱子中标记百分比值 (计算百分比值需要注意了, 文本显示位置还是跟之前一致)</span></span><br><span class="line"><span class="comment"># group_by: 按照给定的变量分组，然后按组操作</span></span><br><span class="line"><span class="comment"># mutate: 在当前数据表增加新变量</span></span><br><span class="line"><span class="comment"># 第一步增加每个组 (Group和Condition共同定义分组)的加和，第二步计算比例</span></span><br><span class="line">data_m <span class="operator">&lt;-</span> data_m <span class="operator">%&gt;%</span> group_by<span class="punctuation">(</span>Group<span class="punctuation">,</span> Condition<span class="punctuation">)</span> <span class="operator">%&gt;%</span> mutate<span class="punctuation">(</span>count<span class="operator">=</span><span class="built_in">sum</span><span class="punctuation">(</span>Expr<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> mutate<span class="punctuation">(</span>freq<span class="operator">=</span><span class="built_in">round</span><span class="punctuation">(</span><span class="number">100</span><span class="operator">*</span>Expr<span class="operator">/</span>count<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>data_m<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>Group<span class="punctuation">,</span> y<span class="operator">=</span>Expr<span class="punctuation">,</span> group<span class="operator">=</span>Group<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_bar<span class="punctuation">(</span>stat<span class="operator">=</span><span class="string">&quot;identity&quot;</span><span class="punctuation">,</span> position<span class="operator">=</span><span class="string">&quot;fill&quot;</span><span class="punctuation">,</span> aes<span class="punctuation">(</span>fill<span class="operator">=</span>Gene<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>labels <span class="operator">=</span> scales<span class="operator">::</span>percent<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>label<span class="operator">=</span>freq<span class="punctuation">)</span><span class="punctuation">,</span> position<span class="operator">=</span>position_fill<span class="punctuation">(</span>vjust<span class="operator">=</span><span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  facet_wrap<span class="punctuation">(</span><span class="operator">~</span>Condition<span class="punctuation">,</span> ncol<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line"><span class="comment">#文本显示位置没有问题，但柱子的位置有些奇怪，使得两组之间不可比。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#先对数据做下排序，然后再标记文本</span></span><br><span class="line"><span class="comment"># with: 产生一个由data_m组成的局部环境，再这个环境里，列名字可以直接使用</span></span><br><span class="line">data_m <span class="operator">&lt;-</span> data_m<span class="punctuation">[</span>with<span class="punctuation">(</span>data_m<span class="punctuation">,</span> order<span class="punctuation">(</span>Condition<span class="punctuation">,</span> Group<span class="punctuation">,</span> Gene<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="punctuation">]</span> </span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>data_m<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>Group<span class="punctuation">,</span> y<span class="operator">=</span>Expr<span class="punctuation">,</span> group<span class="operator">=</span>Group<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_bar<span class="punctuation">(</span>stat<span class="operator">=</span><span class="string">&quot;identity&quot;</span><span class="punctuation">,</span> position<span class="operator">=</span><span class="string">&quot;fill&quot;</span><span class="punctuation">,</span> aes<span class="punctuation">(</span>fill<span class="operator">=</span>Gene<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_y_continuous<span class="punctuation">(</span>labels <span class="operator">=</span> scales<span class="operator">::</span>percent<span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>label<span class="operator">=</span>freq<span class="punctuation">)</span><span class="punctuation">,</span> position<span class="operator">=</span>position_fill<span class="punctuation">(</span>vjust<span class="operator">=</span><span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  facet_wrap<span class="punctuation">(</span><span class="operator">~</span>Condition<span class="punctuation">,</span> ncol<span class="operator">=</span><span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="id转换"><strong>ID转换</strong></h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#source(&quot;https://bioconductor.org/biocLite.R&quot;) </span></span><br><span class="line"><span class="comment">#biocLite(&#x27;org.Hs.eg.db&#x27;)</span></span><br><span class="line"><span class="comment">#基因的entrez ID 跟symbol等其它ID的转换程序 </span></span><br><span class="line"><span class="comment">#http://www.bio-info-trainee.com/710.html</span></span><br><span class="line">keytypes<span class="punctuation">(</span>org.Hs.eg.db<span class="punctuation">)</span></span><br><span class="line">geneIDannotation <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>geneLists<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span><span class="number">9</span><span class="punctuation">)</span><span class="punctuation">,</span>name<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span>map<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span>ensemble<span class="operator">=</span><span class="built_in">F</span><span class="punctuation">,</span>accnum<span class="operator">=</span><span class="built_in">F</span><span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="comment">## input ID type : So far I just accept entrezID or symbol</span></span><br><span class="line">  <span class="comment">## default, we will annotate the entrezID and symbol, chromosone location and gene name </span></span><br><span class="line">  </span><br><span class="line">  suppressMessages<span class="punctuation">(</span>library<span class="punctuation">(</span><span class="string">&quot;org.Hs.eg.db&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  all_EG<span class="operator">=</span>mappedkeys<span class="punctuation">(</span>org.Hs.egSYMBOL<span class="punctuation">)</span> </span><br><span class="line">  EG2Symbol<span class="operator">=</span>toTable<span class="punctuation">(</span>org.Hs.egSYMBOL<span class="punctuation">)</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span> <span class="built_in">all</span><span class="punctuation">(</span><span class="operator">!</span> geneLists <span class="operator">%in%</span> all_EG<span class="punctuation">)</span> <span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">    inputType<span class="operator">=</span><span class="string">&#x27;symbol&#x27;</span></span><br><span class="line">    geneLists<span class="operator">=</span>data.frame<span class="punctuation">(</span>symbol<span class="operator">=</span>geneLists<span class="punctuation">)</span></span><br><span class="line">    results<span class="operator">=</span>merge<span class="punctuation">(</span>geneLists<span class="punctuation">,</span>EG2Symbol<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&#x27;symbol&#x27;</span><span class="punctuation">,</span>all.x<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="keyword">else</span><span class="punctuation">&#123;</span></span><br><span class="line">    inputType<span class="operator">=</span><span class="string">&#x27;entrezID&#x27;</span></span><br><span class="line">    geneLists<span class="operator">=</span>data.frame<span class="punctuation">(</span>gene_id<span class="operator">=</span>geneLists<span class="punctuation">)</span></span><br><span class="line">    results<span class="operator">=</span>merge<span class="punctuation">(</span>geneLists<span class="punctuation">,</span>EG2Symbol<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&#x27;gene_id&#x27;</span><span class="punctuation">,</span>all.x<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span> <span class="punctuation">(</span> name <span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">    EG2name<span class="operator">=</span>toTable<span class="punctuation">(</span>org.Hs.egGENENAME<span class="punctuation">)</span></span><br><span class="line">    results<span class="operator">=</span>merge<span class="punctuation">(</span>results<span class="punctuation">,</span>EG2name<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&#x27;gene_id&#x27;</span><span class="punctuation">,</span>all.x<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span>map<span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">    EG2MAP<span class="operator">=</span>toTable<span class="punctuation">(</span>org.Hs.egMAP<span class="punctuation">)</span></span><br><span class="line">    results<span class="operator">=</span>merge<span class="punctuation">(</span>results<span class="punctuation">,</span>EG2MAP<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&#x27;gene_id&#x27;</span><span class="punctuation">,</span>all.x<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span>ensemble<span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">    EG2ENSEMBL<span class="operator">=</span>toTable<span class="punctuation">(</span>org.Hs.egENSEMBL<span class="punctuation">)</span></span><br><span class="line">    results<span class="operator">=</span>merge<span class="punctuation">(</span>results<span class="punctuation">,</span>EG2ENSEMBL<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&#x27;gene_id&#x27;</span><span class="punctuation">,</span>all.x<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span>accnum<span class="punctuation">)</span><span class="punctuation">&#123;</span></span><br><span class="line">    EG2accnum<span class="operator">=</span>toTable<span class="punctuation">(</span>org.Hs.egREFSEQ<span class="punctuation">)</span> </span><br><span class="line">    results<span class="operator">=</span>merge<span class="punctuation">(</span>results<span class="punctuation">,</span>EG2MAP<span class="punctuation">,</span>by<span class="operator">=</span><span class="string">&#x27;gene_id&#x27;</span><span class="punctuation">,</span>all.x<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="built_in">return</span><span class="punctuation">(</span>results<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">geneIDannotation<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">geneIDannotation<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;TP53&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;BRCA1&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;KRAS&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;PTEN&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span>           </span><br></pre></td></tr></table></figure>
<h3 id="稀释-累积曲线和rank-abundance">稀释、累积曲线和Rank_abundance</h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#需要用到的 R 包</span></span><br><span class="line">library<span class="punctuation">(</span>vegan<span class="punctuation">)</span>	<span class="comment">#用于计算 Shannon 熵指数、Simpson 指数、Chao1 指数、ACE 指数等，同时用于抽样</span></span><br><span class="line">library<span class="punctuation">(</span>picante<span class="punctuation">)</span>	<span class="comment">#用于计算 PD_whole_tree，若不计算它就无需加载。事实上，picante 包加载时默认同时加载 vegan</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span>	<span class="comment">#用于 ggplot2 作图</span></span><br><span class="line">library<span class="punctuation">(</span>doBy<span class="punctuation">)</span>	<span class="comment">#用于分组统计（第 97 行使用到）</span></span><br><span class="line">library<span class="punctuation">(</span>ggalt<span class="punctuation">)</span>	<span class="comment">#用于绘制拟合曲线（第 138 行使用到）</span></span><br><span class="line">library<span class="punctuation">(</span>BiodiversityR<span class="punctuation">)</span>	<span class="comment">#用于绘制 Rank-abundance 曲线（第 160 行使用到）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##定义函数</span></span><br><span class="line"><span class="comment">#计算多种 Alpha 多样性指数，结果返回至向量</span></span><br><span class="line"><span class="comment">#各子函数的用法详见 http://blog.sciencenet.cn/blog-3406804-1179983.html</span></span><br><span class="line">alpha_index <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;richness&#x27;</span><span class="punctuation">,</span> tree <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> base <span class="operator">=</span> <span class="built_in">exp</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	<span class="keyword">if</span> <span class="punctuation">(</span>method <span class="operator">==</span> <span class="string">&#x27;richness&#x27;</span><span class="punctuation">)</span> result <span class="operator">&lt;-</span> rowSums<span class="punctuation">(</span>x <span class="operator">&gt;</span> <span class="number">0</span><span class="punctuation">)</span>	<span class="comment">#丰富度指数</span></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span>method <span class="operator">==</span> <span class="string">&#x27;chao1&#x27;</span><span class="punctuation">)</span> result <span class="operator">&lt;-</span> estimateR<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">3</span><span class="punctuation">,</span> <span class="punctuation">]</span>	<span class="comment">#Chao1 指数</span></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span>method <span class="operator">==</span> <span class="string">&#x27;ace&#x27;</span><span class="punctuation">)</span> result <span class="operator">&lt;-</span> estimateR<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">5</span><span class="punctuation">,</span> <span class="punctuation">]</span>	<span class="comment">#ACE 指数</span></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span>method <span class="operator">==</span> <span class="string">&#x27;shannon&#x27;</span><span class="punctuation">)</span> result <span class="operator">&lt;-</span> diversity<span class="punctuation">(</span>x<span class="punctuation">,</span> index <span class="operator">=</span> <span class="string">&#x27;shannon&#x27;</span><span class="punctuation">,</span> base <span class="operator">=</span> base<span class="punctuation">)</span>	<span class="comment">#Shannon 指数</span></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span>method <span class="operator">==</span> <span class="string">&#x27;simpson&#x27;</span><span class="punctuation">)</span> result <span class="operator">&lt;-</span> diversity<span class="punctuation">(</span>x<span class="punctuation">,</span> index <span class="operator">=</span> <span class="string">&#x27;simpson&#x27;</span><span class="punctuation">)</span>	<span class="comment">#Gini-Simpson 指数</span></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span>method <span class="operator">==</span> <span class="string">&#x27;pielou&#x27;</span><span class="punctuation">)</span> result <span class="operator">&lt;-</span> diversity<span class="punctuation">(</span>x<span class="punctuation">,</span> index <span class="operator">=</span> <span class="string">&#x27;shannon&#x27;</span><span class="punctuation">,</span> base <span class="operator">=</span> base<span class="punctuation">)</span> <span class="operator">/</span> <span class="built_in">log</span><span class="punctuation">(</span>estimateR<span class="punctuation">(</span>x<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="punctuation">,</span> <span class="punctuation">]</span><span class="punctuation">,</span> base<span class="punctuation">)</span>	<span class="comment">#Pielou 均匀度</span></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span>method <span class="operator">==</span> <span class="string">&#x27;gc&#x27;</span><span class="punctuation">)</span> result <span class="operator">&lt;-</span> 1 <span class="operator">-</span> rowSums<span class="punctuation">(</span>x <span class="operator">==</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">/</span> rowSums<span class="punctuation">(</span>x<span class="punctuation">)</span>	<span class="comment">#goods_coverage</span></span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span>method <span class="operator">==</span> <span class="string">&#x27;pd&#x27;</span> <span class="operator">&amp;</span> <span class="operator">!</span><span class="built_in">is.null</span><span class="punctuation">(</span>tree<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span>	<span class="comment">#PD_whole_tree</span></span><br><span class="line">		pd <span class="operator">&lt;-</span> pd<span class="punctuation">(</span>x<span class="punctuation">,</span> tree<span class="punctuation">,</span> include.root <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">		result <span class="operator">&lt;-</span> pd<span class="punctuation">[</span> <span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">		<span class="built_in">names</span><span class="punctuation">(</span>result<span class="punctuation">)</span> <span class="operator">&lt;-</span> rownames<span class="punctuation">(</span>pd<span class="punctuation">)</span></span><br><span class="line">	<span class="punctuation">&#125;</span></span><br><span class="line">	result</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#根据抽样步长（step），统计每个稀释梯度下的 Alpha 多样性指数，结果返回至列表</span></span><br><span class="line">alpha_curves <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">,</span> step<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;richness&#x27;</span><span class="punctuation">,</span> rare <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> tree <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> base <span class="operator">=</span> <span class="built_in">exp</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	x_nrow <span class="operator">&lt;-</span> nrow<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">	<span class="keyword">if</span> <span class="punctuation">(</span><span class="built_in">is.null</span><span class="punctuation">(</span>rare<span class="punctuation">)</span><span class="punctuation">)</span> rare <span class="operator">&lt;-</span> rowSums<span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="keyword">else</span> rare <span class="operator">&lt;-</span> <span class="built_in">rep</span><span class="punctuation">(</span>rare<span class="punctuation">,</span> x_nrow<span class="punctuation">)</span></span><br><span class="line">	alpha_rare <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span>x_nrow<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		step_num <span class="operator">&lt;-</span> seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> rare<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">,</span> step<span class="punctuation">)</span></span><br><span class="line">		<span class="keyword">if</span> <span class="punctuation">(</span><span class="built_in">max</span><span class="punctuation">(</span>step_num<span class="punctuation">)</span> <span class="operator">&lt;</span> rare<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">)</span> step_num <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>step_num<span class="punctuation">,</span> rare<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">		</span><br><span class="line">		alpha_rare_i <span class="operator">&lt;-</span> <span class="literal">NULL</span></span><br><span class="line">		<span class="keyword">for</span> <span class="punctuation">(</span>step_num_n <span class="keyword">in</span> step_num<span class="punctuation">)</span> alpha_rare_i <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>alpha_rare_i<span class="punctuation">,</span> alpha_index<span class="punctuation">(</span>x <span class="operator">=</span> rrarefy<span class="punctuation">(</span>x<span class="punctuation">[</span>i<span class="punctuation">,</span> <span class="punctuation">]</span><span class="punctuation">,</span> step_num_n<span class="punctuation">)</span><span class="punctuation">,</span> method <span class="operator">=</span> method<span class="punctuation">,</span> tree <span class="operator">=</span> tree<span class="punctuation">,</span> base <span class="operator">=</span> base<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">		<span class="built_in">names</span><span class="punctuation">(</span>alpha_rare_i<span class="punctuation">)</span> <span class="operator">&lt;-</span> step_num</span><br><span class="line">		alpha_rare <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>alpha_rare<span class="punctuation">,</span> <span class="built_in">list</span><span class="punctuation">(</span>alpha_rare_i<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">	<span class="punctuation">&#125;</span></span><br><span class="line">	</span><br><span class="line">	<span class="built_in">names</span><span class="punctuation">(</span>alpha_rare<span class="punctuation">)</span> <span class="operator">&lt;-</span> rownames<span class="punctuation">(</span>x<span class="punctuation">)</span></span><br><span class="line">	alpha_rare</span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#读取 OTU 丰度表</span></span><br><span class="line">otu <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;otu_table.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">otu <span class="operator">&lt;-</span> t<span class="punctuation">(</span>otu<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#最简单的用vegan包中自带的rarecurve函数制作</span></span><br><span class="line">rarecurve<span class="punctuation">(</span>otu<span class="punctuation">,</span> step<span class="operator">=</span><span class="number">10</span><span class="punctuation">,</span> col <span class="operator">=</span> factor<span class="punctuation">(</span>rownames<span class="punctuation">(</span>otu<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span>lwd<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span> ylab<span class="operator">=</span><span class="string">&quot;ASVs&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">##测试</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#统计 OTU 丰度表中各样本的 Shannon 指数，对数底数使用 e</span></span><br><span class="line">shannon_index <span class="operator">&lt;-</span> alpha_index<span class="punctuation">(</span>otu<span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;shannon&#x27;</span><span class="punctuation">,</span> base <span class="operator">=</span> <span class="built_in">exp</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#以 1000 条序列为抽样步长，依次对 OTU 表稀释抽样，直到最大序列深度；并统计各抽样梯度下的 OTU 丰度表中各样本的 Shannon 指数，对数底数使用 e</span></span><br><span class="line">shannon_curves <span class="operator">&lt;-</span> alpha_curves<span class="punctuation">(</span>otu<span class="punctuation">,</span> step <span class="operator">=</span> <span class="number">1000</span><span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;shannon&#x27;</span><span class="punctuation">,</span> base <span class="operator">=</span> <span class="built_in">exp</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##以下以物种丰富度指数为例绘制 Alpha 多样性曲线（当为丰富度指数时，另一个名称即为常说的稀释曲线，或物种累计曲线）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#以 2000 步长（step=2000）为例统计</span></span><br><span class="line">richness_curves <span class="operator">&lt;-</span> alpha_curves<span class="punctuation">(</span>otu<span class="punctuation">,</span> step <span class="operator">=</span> <span class="number">2000</span><span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;richness&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#获得 ggplot2 作图文件</span></span><br><span class="line">plot_richness <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="built_in">names</span><span class="punctuation">(</span>richness_curves<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	richness_curves_i <span class="operator">&lt;-</span> <span class="punctuation">(</span>richness_curves<span class="punctuation">[[</span>i<span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">	richness_curves_i <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>rare <span class="operator">=</span> <span class="built_in">names</span><span class="punctuation">(</span>richness_curves_i<span class="punctuation">)</span><span class="punctuation">,</span> alpha <span class="operator">=</span> richness_curves_i<span class="punctuation">,</span> sample <span class="operator">=</span> i<span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">	plot_richness <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>plot_richness<span class="punctuation">,</span> richness_curves_i<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">rownames<span class="punctuation">(</span>plot_richness<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></span><br><span class="line">plot_richness<span class="operator">$</span>rare <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>plot_richness<span class="operator">$</span>rare<span class="punctuation">)</span></span><br><span class="line">plot_richness<span class="operator">$</span>alpha <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>plot_richness<span class="operator">$</span>alpha<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggplot2 作图</span></span><br><span class="line">ggplot<span class="punctuation">(</span>plot_richness<span class="punctuation">,</span> aes<span class="punctuation">(</span>rare<span class="punctuation">,</span> alpha<span class="punctuation">,</span> color <span class="operator">=</span> sample<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_line<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;Number of sequences&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;Richness&#x27;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_vline<span class="punctuation">(</span>xintercept <span class="operator">=</span> <span class="built_in">min</span><span class="punctuation">(</span>rowSums<span class="punctuation">(</span>otu<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_x_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">30000</span><span class="punctuation">,</span> <span class="number">5000</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">as.character</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">30000</span><span class="punctuation">,</span> <span class="number">5000</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##多计算几次以获取均值 ± 标准差，然后再展示出也是一个不错的选择</span></span><br><span class="line"><span class="comment">#重复抽样 5 次</span></span><br><span class="line">plot_richness <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>n <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	richness_curves <span class="operator">&lt;-</span> alpha_curves<span class="punctuation">(</span>otu<span class="punctuation">,</span> step <span class="operator">=</span> <span class="number">2000</span><span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;richness&#x27;</span><span class="punctuation">)</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="built_in">names</span><span class="punctuation">(</span>richness_curves<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		richness_curves_i <span class="operator">&lt;-</span> <span class="punctuation">(</span>richness_curves<span class="punctuation">[[</span>i<span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">		richness_curves_i <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>rare <span class="operator">=</span> <span class="built_in">names</span><span class="punctuation">(</span>richness_curves_i<span class="punctuation">)</span><span class="punctuation">,</span> alpha <span class="operator">=</span> richness_curves_i<span class="punctuation">,</span> sample <span class="operator">=</span> i<span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">		plot_richness <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>plot_richness<span class="punctuation">,</span> richness_curves_i<span class="punctuation">)</span></span><br><span class="line">	<span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#计算均值 ± 标准差（doBy 包中的 summaryBy() 函数）</span></span><br><span class="line">plot_richness_stat <span class="operator">&lt;-</span> summaryBy<span class="punctuation">(</span>alpha<span class="operator">~</span>sample<span class="operator">+</span>rare<span class="punctuation">,</span> plot_richness<span class="punctuation">,</span> FUN <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>mean<span class="punctuation">,</span> sd<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">plot_richness_stat<span class="operator">$</span>rare <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>plot_richness_stat<span class="operator">$</span>rare<span class="punctuation">)</span></span><br><span class="line">plot_richness_stat<span class="punctuation">[</span>which<span class="punctuation">(</span>plot_richness_stat<span class="operator">$</span>rare <span class="operator">==</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;alpha.sd&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="literal">NA</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggplot2 作图</span></span><br><span class="line">ggplot<span class="punctuation">(</span>plot_richness_stat<span class="punctuation">,</span> aes<span class="punctuation">(</span>rare<span class="punctuation">,</span> alpha.mean<span class="punctuation">,</span> color <span class="operator">=</span> sample<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_line<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_point<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_errorbar<span class="punctuation">(</span>aes<span class="punctuation">(</span>ymin <span class="operator">=</span> alpha.mean <span class="operator">-</span> alpha.sd<span class="punctuation">,</span> ymax <span class="operator">=</span> alpha.mean <span class="operator">+</span> alpha.sd<span class="punctuation">)</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">500</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;Number of sequences&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;Richness&#x27;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_vline<span class="punctuation">(</span>xintercept <span class="operator">=</span> <span class="built_in">min</span><span class="punctuation">(</span>rowSums<span class="punctuation">(</span>otu<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_x_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">30000</span><span class="punctuation">,</span> <span class="number">5000</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">as.character</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">30000</span><span class="punctuation">,</span> <span class="number">5000</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##对于 Shannon 指数等，方法类似</span></span><br><span class="line"><span class="comment">#以 2000 步长（step=2000）为例统计每个稀释梯度下的 Shannon 指数，Shannon 公式的对数底数默认为 e，若有需要可更改（例如 2）</span></span><br><span class="line">shannon_curves <span class="operator">&lt;-</span> alpha_curves<span class="punctuation">(</span>otu<span class="punctuation">,</span> step <span class="operator">=</span> <span class="number">2000</span><span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;shannon&#x27;</span><span class="punctuation">,</span> base <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#获得 ggplot2 作图文件（略，参见上述）</span></span><br><span class="line"><span class="comment">#ggplot2 作图（略，参见上述）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##若简单的“geom_line()”样式波动幅度过大，不平滑等，可以尝试拟合曲线的样式</span></span><br><span class="line"><span class="comment">#获得作图数据。前面多生成一个点，使得 Shannon 拟合曲线更加平滑（你把 shannon_curves1 注释掉就知道我说的啥了）</span></span><br><span class="line">shannon_curves1 <span class="operator">&lt;-</span> alpha_curves<span class="punctuation">(</span>otu<span class="punctuation">,</span> step <span class="operator">=</span> <span class="number">200</span><span class="punctuation">,</span> rare <span class="operator">=</span> <span class="number">200</span><span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;shannon&#x27;</span><span class="punctuation">)</span></span><br><span class="line">shannon_curves2 <span class="operator">&lt;-</span> alpha_curves<span class="punctuation">(</span>otu<span class="punctuation">,</span> step <span class="operator">=</span> <span class="number">2000</span><span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;shannon&#x27;</span><span class="punctuation">)</span></span><br><span class="line">shannon_curves <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>shannon_curves1<span class="punctuation">,</span> shannon_curves2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">plot_shannon <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="built_in">length</span><span class="punctuation">(</span>shannon_curves<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	shannon_curves_i <span class="operator">&lt;-</span> shannon_curves<span class="punctuation">[[</span>i<span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line">	shannon_curves_i <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>rare <span class="operator">=</span> <span class="built_in">names</span><span class="punctuation">(</span>shannon_curves_i<span class="punctuation">)</span><span class="punctuation">,</span> alpha <span class="operator">=</span> shannon_curves_i<span class="punctuation">,</span> sample <span class="operator">=</span> <span class="built_in">names</span><span class="punctuation">(</span>shannon_curves<span class="punctuation">)</span><span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">	plot_shannon <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>plot_shannon<span class="punctuation">,</span> shannon_curves_i<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">rownames<span class="punctuation">(</span>plot_shannon<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></span><br><span class="line">plot_shannon<span class="operator">$</span>rare <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>plot_shannon<span class="operator">$</span>rare<span class="punctuation">)</span></span><br><span class="line">plot_shannon<span class="operator">$</span>alpha <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>plot_shannon<span class="operator">$</span>alpha<span class="punctuation">)</span></span><br><span class="line">plot_shannon <span class="operator">&lt;-</span> plot_shannon<span class="punctuation">[</span>order<span class="punctuation">(</span>plot_shannon<span class="operator">$</span>sample<span class="punctuation">,</span> plot_shannon<span class="operator">$</span>rare<span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggplot2 作图（使用到 ggalt 包的 geom_xspline() 绘制平滑拟合线）</span></span><br><span class="line">ggplot<span class="punctuation">(</span>plot_shannon<span class="punctuation">,</span> aes<span class="punctuation">(</span>rare<span class="punctuation">,</span> alpha<span class="punctuation">,</span> color <span class="operator">=</span> sample<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_xspline<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;Number of sequences&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;Shannon&#x27;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_vline<span class="punctuation">(</span>xintercept <span class="operator">=</span> <span class="built_in">min</span><span class="punctuation">(</span>rowSums<span class="punctuation">(</span>otu<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> linetype <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_x_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">30000</span><span class="punctuation">,</span> <span class="number">5000</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">as.character</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">30000</span><span class="punctuation">,</span> <span class="number">5000</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##对于 PD_whole_tree，除了 OTU 丰度表，还使用到进化树文件</span></span><br><span class="line"><span class="comment">#加载 OTU 丰度表和进化树文件</span></span><br><span class="line">otu <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;otu_table.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">otu <span class="operator">&lt;-</span> t<span class="punctuation">(</span>otu<span class="punctuation">)</span></span><br><span class="line">tree <span class="operator">&lt;-</span> read.tree<span class="punctuation">(</span><span class="string">&#x27;otu_tree.tre&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#以 2000 步长（step=2000）为例统计</span></span><br><span class="line">pd_curves <span class="operator">&lt;-</span> alpha_curves<span class="punctuation">(</span>otu<span class="punctuation">,</span> tree <span class="operator">=</span> tree<span class="punctuation">,</span> step <span class="operator">=</span> <span class="number">2000</span><span class="punctuation">,</span> method <span class="operator">=</span> <span class="string">&#x27;pd&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#统计及做图方法同上述</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##Rank-abundance 曲线</span></span><br><span class="line"><span class="comment">#统计（BiodiversityR 包 rankabundance() 实现 OTU 排序）</span></span><br><span class="line">otu_relative <span class="operator">&lt;-</span> otu <span class="operator">/</span> rowSums<span class="punctuation">(</span>otu<span class="punctuation">)</span></span><br><span class="line">rank_dat <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> rownames<span class="punctuation">(</span>otu_relative<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	rank_dat_i <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>rankabundance<span class="punctuation">(</span>subset<span class="punctuation">(</span>otu_relative<span class="punctuation">,</span> rownames<span class="punctuation">(</span>otu_relative<span class="punctuation">)</span> <span class="operator">==</span> i<span class="punctuation">)</span><span class="punctuation">,</span> digits <span class="operator">=</span> <span class="number">6</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line">	rank_dat_i<span class="operator">$</span>sample <span class="operator">&lt;-</span> i</span><br><span class="line">	rank_dat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>rank_dat<span class="punctuation">,</span> rank_dat_i<span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">rank_dat <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>rank_dat<span class="punctuation">,</span> rank_dat<span class="operator">$</span>abundance <span class="operator">!=</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggplot2 作图</span></span><br><span class="line">ggplot<span class="punctuation">(</span>rank_dat<span class="punctuation">,</span> aes<span class="punctuation">(</span>rank<span class="punctuation">,</span> <span class="built_in">log</span><span class="punctuation">(</span>abundance<span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> sample<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_line<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;OTUs rank&#x27;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&#x27;Relative adundance (%)&#x27;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_y_continuous<span class="punctuation">(</span>breaks <span class="operator">=</span> <span class="number">0</span><span class="operator">:</span><span class="operator">-</span><span class="number">5</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;100&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;10&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;0.1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;0.01&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;0.001&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="operator">-</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#累积曲线</span></span><br><span class="line">BCI这个数据，它的每一行代表了一个样本，不同样本采样的地点不同，每一列是<span class="number">1</span>个物种的丰度</span><br><span class="line">library<span class="punctuation">(</span>vegan<span class="punctuation">)</span></span><br><span class="line">data<span class="punctuation">(</span>BCI<span class="punctuation">)</span></span><br><span class="line">sp1 <span class="operator">&lt;-</span> specaccum<span class="punctuation">(</span>BCI<span class="punctuation">,</span> method<span class="operator">=</span><span class="string">&quot;random&quot;</span><span class="punctuation">)</span></span><br><span class="line">plot<span class="punctuation">(</span>sp1<span class="punctuation">,</span> ci.type<span class="operator">=</span><span class="string">&quot;poly&quot;</span><span class="punctuation">,</span> col<span class="operator">=</span><span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> lwd<span class="operator">=</span><span class="number">2</span><span class="punctuation">,</span> ci.lty<span class="operator">=</span><span class="number">0</span><span class="punctuation">,</span> ci.col<span class="operator">=</span><span class="string">&quot;lightblue&quot;</span><span class="punctuation">)</span></span><br><span class="line">boxplot<span class="punctuation">(</span>sp1<span class="punctuation">,</span> col<span class="operator">=</span><span class="string">&quot;yellow&quot;</span><span class="punctuation">,</span> add<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span> pch<span class="operator">=</span><span class="string">&quot;+&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="pls-da最小二乘法分析">pls_da最小二乘法分析</h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>mixOmics<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##读入文件</span></span><br><span class="line"><span class="comment">#门水平丰度表</span></span><br><span class="line">phylum <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;phylum_table.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">phylum <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>t<span class="punctuation">(</span>phylum<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#样本分组文件</span></span><br><span class="line">group <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;group.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##PLS-DA 分析</span></span><br><span class="line"><span class="comment">#基于门水平丰度表，只展示前 3 个排序轴</span></span><br><span class="line">phylum <span class="operator">&lt;-</span> phylum<span class="punctuation">[</span>group<span class="operator">$</span><span class="built_in">names</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">plsda_result <span class="operator">&lt;-</span>plsda<span class="punctuation">(</span>phylum<span class="punctuation">,</span> group<span class="operator">$</span>group<span class="punctuation">,</span> ncomp <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#简要查看结果</span></span><br><span class="line">plsda_result</span><br><span class="line"><span class="comment">#或</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>plsda_result<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看排序轴解释量</span></span><br><span class="line">plsda_result<span class="operator">$</span>explained_variance<span class="operator">$</span>X</span><br><span class="line"><span class="comment">#查看样本排序坐标</span></span><br><span class="line">plsda_result<span class="operator">$</span>variates<span class="operator">$</span>X</span><br><span class="line"><span class="comment">#查看细菌门类群排序坐标</span></span><br><span class="line">plsda_result<span class="operator">$</span>loadings<span class="operator">$</span>X</span><br><span class="line"></span><br><span class="line"><span class="comment">#使用 plotIndiv() 绘制 PLS-DA 分析结果</span></span><br><span class="line">plotIndiv<span class="punctuation">(</span>plsda_result<span class="punctuation">,</span> ind.names <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> style <span class="operator">=</span> <span class="string">&#x27;ggplot2&#x27;</span><span class="punctuation">)</span></span><br><span class="line">plotIndiv<span class="punctuation">(</span>plsda_result<span class="punctuation">,</span> ind.names <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> style <span class="operator">=</span> <span class="string">&#x27;3d&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#提取坐标轴解释量（前两轴）</span></span><br><span class="line">plsda_result_eig <span class="operator">&lt;-</span> <span class="punctuation">&#123;</span>plsda_result<span class="operator">$</span>explained_variance<span class="operator">$</span>X<span class="punctuation">&#125;</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#提取样本点坐标（前两轴）</span></span><br><span class="line">sample_site <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>plsda_result<span class="operator">$</span>variates<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#为样本点坐标添加分组信息</span></span><br><span class="line">sample_site<span class="operator">$</span><span class="built_in">names</span> <span class="operator">&lt;-</span> rownames<span class="punctuation">(</span>sample_site<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>sample_site<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;plsda1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;plsda2&#x27;</span><span class="punctuation">)</span></span><br><span class="line">sample_site <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>sample_site<span class="punctuation">,</span> group<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&#x27;names&#x27;</span><span class="punctuation">,</span> all.x <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#可选输出各样本的 PLS-DA 分析结果</span></span><br><span class="line">write.table<span class="punctuation">(</span>sample_site<span class="punctuation">,</span> <span class="string">&#x27;plsda_sample.txt&#x27;</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#使用 ggplot2 简单绘制 PLS-DA 结果图</span></span><br><span class="line">plsda_plot <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>sample_site<span class="punctuation">,</span> aes<span class="punctuation">(</span>plsda1<span class="punctuation">,</span> plsda2<span class="punctuation">,</span> color <span class="operator">=</span> group<span class="punctuation">,</span> label <span class="operator">=</span> <span class="built_in">names</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_point<span class="punctuation">(</span>size <span class="operator">=</span> <span class="number">1.5</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.6</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">stat_ellipse<span class="punctuation">(</span>show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span>	<span class="comment">#添加 95% 置信椭圆</span></span><br><span class="line">scale_color_manual<span class="punctuation">(</span>values <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#1D7ACC&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#F67433&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#00815F&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_line<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;grey50&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> panel.background <span class="operator">=</span> element_rect<span class="punctuation">(</span>color <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> </span><br><span class="line">theme<span class="punctuation">(</span>legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.key <span class="operator">=</span> element_rect<span class="punctuation">(</span>fill <span class="operator">=</span> <span class="string">&#x27;transparent&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&#x27;PLS-DA axis1 ( explained variance &#x27;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span><span class="number">100</span> <span class="operator">*</span> plsda_result_eig<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&#x27;% )&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> y <span class="operator">=</span> paste<span class="punctuation">(</span><span class="string">&#x27;PLS-DA axis2 ( explained variance &#x27;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span><span class="number">100</span> <span class="operator">*</span> plsda_result_eig<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&#x27;% )&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggsave(&#x27;plsda_plot.pdf&#x27;, plsda_plot, width = 6, height = 5)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;plsda_plot.png&#x27;</span><span class="punctuation">,</span> plsda_plot<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="物种丰度关联弦图">物种丰度关联弦图</h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env Rscript</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##加载R包，初始传递命令</span></span><br><span class="line">library<span class="punctuation">(</span>circlize<span class="punctuation">)</span> <span class="comment">#使用该包绘制 circos 图</span></span><br><span class="line">library<span class="punctuation">(</span>reshape2<span class="punctuation">)</span> <span class="comment">#在某步排列表格用（第 48 行“plot_data &lt;- melt(otu_table, id = &#x27;otu_ID&#x27;)”）</span></span><br><span class="line">library<span class="punctuation">(</span>ComplexHeatmap<span class="punctuation">)</span> <span class="comment">#可用此包添加图例</span></span><br><span class="line">library<span class="punctuation">(</span>grid<span class="punctuation">)</span> <span class="comment">#可用此包调整画板</span></span><br><span class="line"></span><br><span class="line">otu_table_file <span class="operator">&lt;-</span> <span class="string">&#x27;otu_table.txt&#x27;</span></span><br><span class="line">group_file <span class="operator">&lt;-</span> <span class="string">&#x27;group.txt&#x27;</span></span><br><span class="line">taxonomy_file <span class="operator">&lt;-</span> <span class="string">&#x27;taxonomy.txt&#x27;</span></span><br><span class="line">color_otu <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#8DD3C7&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FFFFB3&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#BEBADA&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FB8072&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#80B1D3&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FDB462&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#B3DE69&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FCCDE5&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#BC80BD&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#CCEBC5&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FFED6F&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#E41A1C&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#377EB8&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#4DAF4A&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#984EA3&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FF7F00&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FFFF33&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#A65628&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#F781BF&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#66C2A5&#x27;</span><span class="punctuation">)</span></span><br><span class="line">color_sample <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#6181BD&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#F34800&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#64A10E&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FF00FF&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#c7475b&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#049a0b&#x27;</span><span class="punctuation">)</span></span><br><span class="line">color_phylum <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#BEAED4&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FDC086&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#FFFF99&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#386CB0&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#F0027F&#x27;</span><span class="punctuation">)</span></span><br><span class="line">color_group <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#4253ff&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#ff4308&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">####预处理</span></span><br><span class="line"><span class="comment">##读取数据</span></span><br><span class="line"><span class="comment">#依据 taxonomy_file 的内容，获取“OTU/分类”排序</span></span><br><span class="line">taxonomy <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>taxonomy_file<span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">tax_phylum <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>taxonomy<span class="operator">$</span>phylum<span class="punctuation">)</span></span><br><span class="line">taxonomy<span class="operator">$</span>phylum <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>taxonomy<span class="operator">$</span>phylum<span class="punctuation">,</span> levels <span class="operator">=</span> tax_phylum<span class="punctuation">)</span></span><br><span class="line">all_otu <span class="operator">&lt;-</span> taxonomy<span class="operator">$</span>OTU_ID</span><br><span class="line">taxonomy<span class="operator">$</span>OTU_ID <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>taxonomy<span class="operator">$</span>OTU_ID<span class="punctuation">,</span> levels <span class="operator">=</span> all_otu<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#依据 group_file 的内容，获取“样本/分组”排序</span></span><br><span class="line">group <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>group_file<span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br><span class="line">all_group <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>group<span class="operator">$</span>group_ID<span class="punctuation">)</span></span><br><span class="line">group<span class="operator">$</span>group_ID <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>group<span class="operator">$</span>group_ID<span class="punctuation">,</span> levels <span class="operator">=</span> all_group<span class="punctuation">)</span></span><br><span class="line">all_sample <span class="operator">&lt;-</span> group<span class="operator">$</span>sample_ID</span><br><span class="line"></span><br><span class="line"><span class="comment">#基于上述排序结果，预处理 otu_table_file</span></span><br><span class="line">otu_table <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>otu_table_file<span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">)</span></span><br><span class="line">otu_table <span class="operator">&lt;-</span> merge<span class="punctuation">(</span>taxonomy<span class="punctuation">,</span> otu_table<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&#x27;OTU_ID&#x27;</span><span class="punctuation">)</span></span><br><span class="line">otu_table <span class="operator">&lt;-</span> otu_table<span class="punctuation">[</span>order<span class="punctuation">(</span>otu_table<span class="operator">$</span>phylum<span class="punctuation">,</span> otu_table<span class="operator">$</span>OTU_ID<span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">rownames<span class="punctuation">(</span>otu_table<span class="punctuation">)</span> <span class="operator">&lt;-</span> otu_table<span class="operator">$</span>OTU_ID</span><br><span class="line">otu_table <span class="operator">&lt;-</span> otu_table<span class="punctuation">[</span>all_sample<span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##生成绘图文件</span></span><br><span class="line"><span class="comment">#circlize 外圈属性数据</span></span><br><span class="line">all_ID <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span>all_otu<span class="punctuation">,</span> all_sample<span class="punctuation">)</span></span><br><span class="line">accum_otu <span class="operator">&lt;-</span> rowSums<span class="punctuation">(</span>otu_table<span class="punctuation">)</span></span><br><span class="line">accum_sample <span class="operator">&lt;-</span> colSums<span class="punctuation">(</span>otu_table<span class="punctuation">)</span></span><br><span class="line">all_ID_xlim <span class="operator">&lt;-</span> cbind<span class="punctuation">(</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="built_in">length</span><span class="punctuation">(</span>all_ID<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span>data.frame<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span>accum_otu<span class="punctuation">,</span> accum_sample<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#circlize 内圈连线数据</span></span><br><span class="line">otu_table<span class="operator">$</span>otu_ID <span class="operator">&lt;-</span> all_otu</span><br><span class="line">plot_data <span class="operator">&lt;-</span> melt<span class="punctuation">(</span>otu_table<span class="punctuation">,</span> id <span class="operator">=</span> <span class="string">&#x27;otu_ID&#x27;</span><span class="punctuation">)</span> <span class="comment">#此处使用了reshape2包中的melt()命令</span></span><br><span class="line">colnames<span class="punctuation">(</span>plot_data<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;sample_ID&#x27;</span></span><br><span class="line">plot_data<span class="operator">$</span>otu_ID <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>plot_data<span class="operator">$</span>otu_ID<span class="punctuation">,</span> levels <span class="operator">=</span> all_otu<span class="punctuation">)</span></span><br><span class="line">plot_data<span class="operator">$</span>sample_ID <span class="operator">&lt;-</span> factor<span class="punctuation">(</span>plot_data<span class="operator">$</span>sample_ID<span class="punctuation">,</span> levels <span class="operator">=</span> all_sample<span class="punctuation">)</span></span><br><span class="line">plot_data <span class="operator">&lt;-</span> plot_data<span class="punctuation">[</span>order<span class="punctuation">(</span>plot_data<span class="operator">$</span>otu_ID<span class="punctuation">,</span> plot_data<span class="operator">$</span>sample_ID<span class="punctuation">)</span><span class="punctuation">,</span> <span class="punctuation">]</span></span><br><span class="line">plot_data <span class="operator">&lt;-</span> plot_data<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">2</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#颜色设置</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>color_otu<span class="punctuation">)</span> <span class="operator">&lt;-</span> all_otu</span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>color_sample<span class="punctuation">)</span> <span class="operator">&lt;-</span> all_sample</span><br><span class="line"></span><br><span class="line"><span class="comment">####circlize 绘图</span></span><br><span class="line">pdf<span class="punctuation">(</span><span class="string">&#x27;circlize_plot.pdf&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">20</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span></span><br><span class="line">circle_size <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="string">&#x27;snpc&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##整体布局</span></span><br><span class="line">gap_size <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="built_in">length</span><span class="punctuation">(</span>all_otu<span class="punctuation">)</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">6</span><span class="punctuation">,</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="built_in">length</span><span class="punctuation">(</span>all_sample<span class="punctuation">)</span> <span class="operator">-</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">6</span><span class="punctuation">)</span></span><br><span class="line">circos.par<span class="punctuation">(</span>cell.padding <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> start.degree <span class="operator">=</span> <span class="number">270</span><span class="punctuation">,</span> gap.degree <span class="operator">=</span> gap_size<span class="punctuation">)</span></span><br><span class="line">circos.initialize<span class="punctuation">(</span>factors <span class="operator">=</span> factor<span class="punctuation">(</span>all_ID<span class="punctuation">,</span> levels <span class="operator">=</span> all_ID<span class="punctuation">)</span><span class="punctuation">,</span> xlim <span class="operator">=</span> all_ID_xlim<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##绘制 OTU 分类、样本分组区块（第一圈）</span></span><br><span class="line">circos.trackPlotRegion<span class="punctuation">(</span></span><br><span class="line">	ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.03</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> </span><br><span class="line">	panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">,</span> y<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		sector.index <span class="operator">=</span> get.cell.meta.data<span class="punctuation">(</span><span class="string">&#x27;sector.index&#x27;</span><span class="punctuation">)</span></span><br><span class="line">		xlim <span class="operator">=</span> get.cell.meta.data<span class="punctuation">(</span><span class="string">&#x27;xlim&#x27;</span><span class="punctuation">)</span></span><br><span class="line">		ylim <span class="operator">=</span> get.cell.meta.data<span class="punctuation">(</span><span class="string">&#x27;ylim&#x27;</span><span class="punctuation">)</span></span><br><span class="line">	<span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="built_in">length</span><span class="punctuation">(</span>tax_phylum<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	tax_OTU <span class="operator">&lt;-</span> <span class="punctuation">&#123;</span>subset<span class="punctuation">(</span>taxonomy<span class="punctuation">,</span> phylum <span class="operator">==</span> tax_phylum<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">&#125;</span><span class="operator">$</span>OTU_ID</span><br><span class="line">	highlight.sector<span class="punctuation">(</span>tax_OTU<span class="punctuation">,</span> track.index <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> col <span class="operator">=</span> color_phylum<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">,</span> text <span class="operator">=</span> tax_phylum<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">,</span> text.col <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> niceFacing <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="built_in">length</span><span class="punctuation">(</span>all_group<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	group_sample <span class="operator">&lt;-</span> <span class="punctuation">&#123;</span>subset<span class="punctuation">(</span>group<span class="punctuation">,</span> group_ID <span class="operator">==</span> all_group<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">&#125;</span><span class="operator">$</span>sample_ID</span><br><span class="line">	highlight.sector<span class="punctuation">(</span>group_sample<span class="punctuation">,</span> track.index <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> col <span class="operator">=</span> color_group<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">,</span> text <span class="operator">=</span> all_group<span class="punctuation">[</span>i<span class="punctuation">]</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">0.7</span><span class="punctuation">,</span> text.col <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> niceFacing <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##各 OTU、样本绘制区</span></span><br><span class="line"><span class="comment">#添加百分比注释（第二圈）</span></span><br><span class="line">circos.trackPlotRegion<span class="punctuation">(</span></span><br><span class="line">	ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> </span><br><span class="line">	panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">,</span> y<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		sector.index <span class="operator">=</span> get.cell.meta.data<span class="punctuation">(</span><span class="string">&#x27;sector.index&#x27;</span><span class="punctuation">)</span></span><br><span class="line">		xlim <span class="operator">=</span> get.cell.meta.data<span class="punctuation">(</span><span class="string">&#x27;xlim&#x27;</span><span class="punctuation">)</span></span><br><span class="line">		ylim <span class="operator">=</span> get.cell.meta.data<span class="punctuation">(</span><span class="string">&#x27;ylim&#x27;</span><span class="punctuation">)</span></span><br><span class="line">	<span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">circos.track<span class="punctuation">(</span></span><br><span class="line">	track.index <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> </span><br><span class="line">	panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">,</span> y<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		xlim <span class="operator">=</span> get.cell.meta.data<span class="punctuation">(</span><span class="string">&#x27;xlim&#x27;</span><span class="punctuation">)</span></span><br><span class="line">		ylim <span class="operator">=</span> get.cell.meta.data<span class="punctuation">(</span><span class="string">&#x27;ylim&#x27;</span><span class="punctuation">)</span></span><br><span class="line">		sector.name <span class="operator">=</span> get.cell.meta.data<span class="punctuation">(</span><span class="string">&#x27;sector.index&#x27;</span><span class="punctuation">)</span></span><br><span class="line">		xplot <span class="operator">=</span> get.cell.meta.data<span class="punctuation">(</span><span class="string">&#x27;xplot&#x27;</span><span class="punctuation">)</span></span><br><span class="line">		</span><br><span class="line">		by <span class="operator">=</span> ifelse<span class="punctuation">(</span><span class="built_in">abs</span><span class="punctuation">(</span>xplot<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">-</span> xplot<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">&gt;</span> <span class="number">30</span><span class="punctuation">,</span> <span class="number">0.25</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">		<span class="keyword">for</span> <span class="punctuation">(</span>p <span class="keyword">in</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> seq<span class="punctuation">(</span>by<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> by <span class="operator">=</span> by<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> circos.text<span class="punctuation">(</span>p<span class="operator">*</span><span class="punctuation">(</span>xlim<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">-</span> xlim<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">+</span> xlim<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> mean<span class="punctuation">(</span>ylim<span class="punctuation">)</span> <span class="operator">+</span> <span class="number">0.4</span><span class="punctuation">,</span> paste0<span class="punctuation">(</span>p<span class="operator">*</span><span class="number">100</span><span class="punctuation">,</span> <span class="string">&#x27;%&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">0.4</span><span class="punctuation">,</span> adj <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> niceFacing <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">		</span><br><span class="line">		circos.lines<span class="punctuation">(</span>xlim<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>mean<span class="punctuation">(</span>ylim<span class="punctuation">)</span><span class="punctuation">,</span> mean<span class="punctuation">(</span>ylim<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> lty <span class="operator">=</span> <span class="number">3</span><span class="punctuation">)</span></span><br><span class="line">	<span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#绘制 OTU、样本主区块（第三圈）</span></span><br><span class="line">circos.trackPlotRegion<span class="punctuation">(</span></span><br><span class="line">	ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.03</span><span class="punctuation">,</span> bg.col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>color_otu<span class="punctuation">,</span> color_sample<span class="punctuation">)</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> track.margin <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">0.01</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">	panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">,</span> y<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		xlim <span class="operator">=</span> get.cell.meta.data<span class="punctuation">(</span><span class="string">&#x27;xlim&#x27;</span><span class="punctuation">)</span></span><br><span class="line">		sector.name <span class="operator">=</span> get.cell.meta.data<span class="punctuation">(</span><span class="string">&#x27;sector.index&#x27;</span><span class="punctuation">)</span></span><br><span class="line">		circos.axis<span class="punctuation">(</span>h <span class="operator">=</span> <span class="string">&#x27;top&#x27;</span><span class="punctuation">,</span> labels.cex <span class="operator">=</span> <span class="number">0.4</span><span class="punctuation">,</span> major.tick.percentage <span class="operator">=</span> <span class="number">0.4</span><span class="punctuation">,</span> labels.niceFacing <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">		circos.text<span class="punctuation">(</span>mean<span class="punctuation">(</span>xlim<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0.2</span><span class="punctuation">,</span> sector.name<span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">0.4</span><span class="punctuation">,</span> niceFacing <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> adj <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">	<span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#绘制 OTU、样本副区块（第四圈）</span></span><br><span class="line">circos.trackPlotRegion<span class="punctuation">(</span>ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.03</span><span class="punctuation">,</span> track.margin <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">0.01</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##绘制 OTU-样本关联连线（最内圈）</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="built_in">seq_len</span><span class="punctuation">(</span>nrow<span class="punctuation">(</span>plot_data<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	circos.link<span class="punctuation">(</span></span><br><span class="line">		plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>accum_otu<span class="punctuation">[</span>plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">,</span> accum_otu<span class="punctuation">[</span>plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">-</span> plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">		plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>accum_sample<span class="punctuation">[</span>plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">,</span> accum_sample<span class="punctuation">[</span>plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">-</span> plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">		col <span class="operator">=</span> paste0<span class="punctuation">(</span>color_otu<span class="punctuation">[</span>plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="string">&#x27;70&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="literal">NA</span> <span class="punctuation">)</span></span><br><span class="line">	</span><br><span class="line">	circos.rect<span class="punctuation">(</span>accum_otu<span class="punctuation">[</span>plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> accum_otu<span class="punctuation">[</span>plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">-</span> plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> sector.index <span class="operator">=</span> plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> col <span class="operator">=</span> color_sample<span class="punctuation">[</span>plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span></span><br><span class="line">	circos.rect<span class="punctuation">(</span>accum_sample<span class="punctuation">[</span>plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> accum_sample<span class="punctuation">[</span>plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">-</span> plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> sector.index <span class="operator">=</span> plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">,</span> col <span class="operator">=</span> color_otu<span class="punctuation">[</span>plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">)</span></span><br><span class="line">	</span><br><span class="line">	accum_otu<span class="punctuation">[</span>plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">=</span> accum_otu<span class="punctuation">[</span>plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">-</span> plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span></span><br><span class="line">	accum_sample<span class="punctuation">[</span>plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">=</span> accum_sample<span class="punctuation">[</span>plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">-</span> plot_data<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##添加图例</span></span><br><span class="line">otu_legend <span class="operator">&lt;-</span> Legend<span class="punctuation">(</span></span><br><span class="line">		at <span class="operator">=</span> all_otu<span class="punctuation">,</span> labels <span class="operator">=</span> taxonomy<span class="operator">$</span>detail<span class="punctuation">,</span> labels_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">,</span>    </span><br><span class="line">		grid_height <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> grid_width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;points&#x27;</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> background <span class="operator">=</span> color_otu<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">0.85</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>otu_legend<span class="punctuation">)</span></span><br><span class="line">upViewport<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">		</span><br><span class="line"><span class="comment">##清除 circlize 样式并关闭画板</span></span><br><span class="line">circos.clear<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="绘制细菌基因组重测序变异圈图">绘制细菌基因组重测序变异圈图</h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env Rscript</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##加载 R 包 &amp; 初始传递命令</span></span><br><span class="line">library<span class="punctuation">(</span>stringr<span class="punctuation">)</span>	<span class="comment">#方便处理字符串</span></span><br><span class="line">library<span class="punctuation">(</span>circlize<span class="punctuation">)</span>	<span class="comment">#绘制圈图</span></span><br><span class="line">library<span class="punctuation">(</span>ComplexHeatmap<span class="punctuation">)</span>	<span class="comment">#绘制图例</span></span><br><span class="line">library<span class="punctuation">(</span>grid<span class="punctuation">)</span>	<span class="comment">#组合画板，圈图 + 图例</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##命令传递</span></span><br><span class="line">sample_name <span class="operator">&lt;-</span> <span class="string">&#x27;Bacillus_subtilis&#x27;</span>	<span class="comment">#测序样本名称</span></span><br><span class="line">ref_name <span class="operator">&lt;-</span> <span class="string">&#x27;Bacillus_subtilis str168&#x27;</span>	<span class="comment">#参考基因组名称</span></span><br><span class="line"></span><br><span class="line">genome_gff <span class="operator">&lt;-</span> <span class="string">&#x27;Bacillus_subtilis.str168.gff&#x27;</span>	<span class="comment">#参考基因组 gff 注释文件</span></span><br><span class="line">snp_vcf <span class="operator">&lt;-</span> <span class="string">&#x27;Bacillus_subtilis.snp.vcf&#x27;</span>	<span class="comment">#SNP 检测结果 vcf 文件</span></span><br><span class="line">indel_vcf <span class="operator">&lt;-</span> <span class="string">&#x27;Bacillus_subtilis.indel.vcf&#x27;</span>	<span class="comment">#InDel 检测结果 vcf 文件</span></span><br><span class="line">cnv_cnv <span class="operator">&lt;-</span> <span class="string">&#x27;Bacillus_subtilis.cnv&#x27;</span>	<span class="comment">#cnv 检测结果文件</span></span><br><span class="line">sv_ctx <span class="operator">&lt;-</span> <span class="string">&#x27;Bacillus_subtilis.ctx&#x27;</span>	<span class="comment">#sv 检测结果文件</span></span><br><span class="line">depth_base_stat <span class="operator">&lt;-</span> <span class="string">&#x27;Bacillus_subtilis.depth_base.txt&#x27;</span>	<span class="comment">#测序深度、碱基含量统计结果文件</span></span><br><span class="line">seq_split <span class="operator">&lt;-</span> 2000	<span class="comment">#滑窗大小，与 depth_base_stat 中使用的滑窗大小对应</span></span><br><span class="line"></span><br><span class="line">out_dir <span class="operator">=</span> <span class="string">&#x27;output&#x27;</span>	<span class="comment">#生成一个目录，用于存放结果文件</span></span><br><span class="line"><span class="keyword">if</span> <span class="punctuation">(</span><span class="operator">!</span>file.exists<span class="punctuation">(</span>out_dir<span class="punctuation">)</span><span class="punctuation">)</span> dir.create<span class="punctuation">(</span>out_dir<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#####################</span></span><br><span class="line"><span class="comment">##参考基因组长度、GC 统计 &amp; 测序覆盖度、深度统计</span></span><br><span class="line">depth_base <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>depth_base_stat<span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">genome_size <span class="operator">&lt;-</span> <span class="built_in">sum</span><span class="punctuation">(</span>depth_base<span class="operator">$</span>seq_end <span class="operator">-</span> depth_base<span class="operator">$</span>seq_start <span class="operator">+</span> <span class="number">1</span><span class="punctuation">)</span> </span><br><span class="line">genome_GC <span class="operator">&lt;-</span> <span class="built_in">round</span><span class="punctuation">(</span>mean<span class="punctuation">(</span>depth_base<span class="operator">$</span>GC<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">depth_exist <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>depth_base<span class="punctuation">,</span> depth <span class="operator">!=</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line">coverage <span class="operator">&lt;-</span> <span class="built_in">round</span><span class="punctuation">(</span><span class="number">100</span> <span class="operator">*</span> <span class="built_in">sum</span><span class="punctuation">(</span>depth_exist<span class="operator">$</span>seq_end <span class="operator">-</span> depth_exist<span class="operator">$</span>seq_start <span class="operator">+</span> <span class="number">1</span><span class="punctuation">)</span> <span class="operator">/</span> genome_size<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">average_depth <span class="operator">&lt;-</span> <span class="built_in">round</span><span class="punctuation">(</span>mean<span class="punctuation">(</span>depth_base<span class="operator">$</span>depth<span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">seq_stat <span class="operator">&lt;-</span> <span class="literal">NULL</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>seq_id <span class="keyword">in</span> unique<span class="punctuation">(</span>depth_base<span class="operator">$</span>seq_ID<span class="punctuation">)</span><span class="punctuation">)</span> seq_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>seq_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_id<span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> <span class="built_in">max</span><span class="punctuation">(</span>subset<span class="punctuation">(</span>depth_base<span class="punctuation">,</span> seq_ID <span class="operator">==</span> seq_id<span class="punctuation">)</span><span class="operator">$</span>seq_end<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">seq_stat <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>seq_stat<span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">colnames<span class="punctuation">(</span>seq_stat<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;seq_ID&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_start&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">)</span></span><br><span class="line">rownames<span class="punctuation">(</span>seq_stat<span class="punctuation">)</span> <span class="operator">&lt;-</span> seq_stat<span class="operator">$</span>seq_ID</span><br><span class="line">seq_stat<span class="operator">$</span>seq_start <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>seq_stat<span class="operator">$</span>seq_start<span class="punctuation">)</span></span><br><span class="line">seq_stat<span class="operator">$</span>seq_end <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>seq_stat<span class="operator">$</span>seq_end<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">write.table<span class="punctuation">(</span>seq_stat<span class="punctuation">,</span> str_c<span class="punctuation">(</span>out_dir<span class="punctuation">,</span> <span class="string">&#x27;/&#x27;</span><span class="punctuation">,</span> sample_name<span class="punctuation">,</span> <span class="string">&#x27;.genome_stat.txt&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##参考基因组基因信息，CDS &amp; rRNA &amp; tRNA</span></span><br><span class="line">gene <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>genome_gff<span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> comment.char <span class="operator">=</span> <span class="string">&#x27;#&#x27;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">gene <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>gene<span class="punctuation">,</span> V3 <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;CDS&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;rRNA&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;tRNA&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>gene<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;seq_ID&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_start&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;type&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;strand&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">gene<span class="punctuation">[</span>which<span class="punctuation">(</span>gene<span class="operator">$</span>type <span class="operator">==</span> <span class="string">&#x27;CDS&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;type&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">1</span></span><br><span class="line">gene<span class="punctuation">[</span>which<span class="punctuation">(</span>gene<span class="operator">$</span>type <span class="operator">==</span> <span class="string">&#x27;rRNA&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;type&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">2</span></span><br><span class="line">gene<span class="punctuation">[</span>which<span class="punctuation">(</span>gene<span class="operator">$</span>type <span class="operator">==</span> <span class="string">&#x27;tRNA&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;type&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">3</span></span><br><span class="line">gene<span class="operator">$</span>type <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>gene<span class="operator">$</span>type<span class="punctuation">)</span></span><br><span class="line">gene <span class="operator">&lt;-</span> <span class="built_in">list</span><span class="punctuation">(</span>subset<span class="punctuation">(</span>gene<span class="punctuation">,</span> strand <span class="operator">==</span> <span class="string">&#x27;-&#x27;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="operator">-</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">,</span> subset<span class="punctuation">(</span>gene<span class="punctuation">,</span> strand <span class="operator">==</span> <span class="string">&#x27;+&#x27;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="operator">-</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##读取 SNP 检测结果</span></span><br><span class="line"><span class="comment">#读取 vcf 文件，统计 SNP 类型</span></span><br><span class="line">snp <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>snp_vcf<span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> colClasses <span class="operator">=</span> <span class="string">&#x27;character&#x27;</span><span class="punctuation">,</span> comment.char <span class="operator">=</span> <span class="string">&#x27;#&#x27;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">snp<span class="operator">$</span>V2 <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>snp<span class="operator">$</span>V2<span class="punctuation">)</span></span><br><span class="line">snp<span class="operator">$</span>change <span class="operator">&lt;-</span> str_c<span class="punctuation">(</span>snp<span class="operator">$</span>V4<span class="punctuation">,</span> snp<span class="operator">$</span>V5<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;AT&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;A&gt;T|T&gt;A&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;tv&#x27;</span></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;AG&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;A&gt;G|T&gt;C&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;ti&#x27;</span></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;AC&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;A&gt;C|T&gt;G&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;tv&#x27;</span></span><br><span class="line"></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;TA&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;A&gt;T|T&gt;A&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;tv&#x27;</span></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;TG&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;A&gt;C|T&gt;G&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;tv&#x27;</span></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;TC&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;A&gt;G|T&gt;C&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;ti&#x27;</span></span><br><span class="line"></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;GA&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;G&gt;A|C&gt;T&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;ti&#x27;</span></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;GT&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;G&gt;T|C&gt;A&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;tv&#x27;</span></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;GC&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;G&gt;C|C&gt;G&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;tv&#x27;</span></span><br><span class="line"></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;CA&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;G&gt;T|C&gt;A&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;tv&#x27;</span></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;CT&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;G&gt;A|C&gt;T&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;ti&#x27;</span></span><br><span class="line">change <span class="operator">&lt;-</span> which<span class="punctuation">(</span>snp<span class="operator">$</span>change <span class="operator">==</span> <span class="string">&#x27;CG&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type1&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;G&gt;C|C&gt;G&#x27;</span>; snp<span class="punctuation">[</span>change<span class="punctuation">,</span><span class="string">&#x27;type2&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;tv&#x27;</span></span><br><span class="line"></span><br><span class="line">snp_ti <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>snp<span class="operator">$</span>type2 <span class="operator">==</span> <span class="string">&#x27;ti&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">snp_tv <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>snp<span class="operator">$</span>type2 <span class="operator">==</span> <span class="string">&#x27;tv&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">snp_at <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>snp<span class="operator">$</span>type1 <span class="operator">==</span> <span class="string">&#x27;A&gt;T|T&gt;A&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">snp_ag <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>snp<span class="operator">$</span>type1 <span class="operator">==</span> <span class="string">&#x27;A&gt;G|T&gt;C&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">snp_ac <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>snp<span class="operator">$</span>type1 <span class="operator">==</span> <span class="string">&#x27;A&gt;C|T&gt;G&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">snp_ga <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>snp<span class="operator">$</span>type1 <span class="operator">==</span> <span class="string">&#x27;G&gt;A|C&gt;T&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">snp_gt <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>snp<span class="operator">$</span>type1 <span class="operator">==</span> <span class="string">&#x27;G&gt;T|C&gt;A&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">snp_gc <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>snp<span class="operator">$</span>type1 <span class="operator">==</span> <span class="string">&#x27;G&gt;C|C&gt;G&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#统计 SNP 密度</span></span><br><span class="line">snp <span class="operator">&lt;-</span> snp<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">6</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">colnames<span class="punctuation">(</span>snp<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;seq_ID&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_site&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">snp_stat <span class="operator">&lt;-</span> <span class="literal">NULL</span></span><br><span class="line">seq_ID <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>snp<span class="operator">$</span>seq_ID<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>seq_ID_n <span class="keyword">in</span> seq_ID<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	snp_subset <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>snp<span class="punctuation">,</span> seq_ID <span class="operator">==</span> seq_ID_n<span class="punctuation">)</span></span><br><span class="line">	seq_end <span class="operator">&lt;-</span> seq_split</span><br><span class="line">	snp_num <span class="operator">&lt;-</span> 0</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span>nrow<span class="punctuation">(</span>snp_subset<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		<span class="keyword">if</span> <span class="punctuation">(</span>snp_subset<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;seq_site&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;=</span> seq_end<span class="punctuation">)</span> snp_num <span class="operator">&lt;-</span> snp_num <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">		<span class="keyword">else</span> <span class="punctuation">&#123;</span></span><br><span class="line">			snp_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>snp_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_ID_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_end<span class="punctuation">,</span> snp_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">			</span><br><span class="line">			seq_end <span class="operator">&lt;-</span> seq_end <span class="operator">+</span> seq_split</span><br><span class="line">			snp_num <span class="operator">&lt;-</span> 0</span><br><span class="line">			<span class="keyword">while</span> <span class="punctuation">(</span>snp_subset<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;seq_site&#x27;</span><span class="punctuation">]</span> <span class="operator">&gt;</span> seq_end<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">				snp_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>snp_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_ID_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_end<span class="punctuation">,</span> snp_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">				seq_end <span class="operator">&lt;-</span> seq_end <span class="operator">+</span> seq_split</span><br><span class="line">			<span class="punctuation">&#125;</span></span><br><span class="line">			snp_num <span class="operator">&lt;-</span> snp_num <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">		<span class="punctuation">&#125;</span></span><br><span class="line">	<span class="punctuation">&#125;</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span> <span class="punctuation">(</span>seq_end <span class="operator">&lt;</span> seq_stat<span class="punctuation">[</span>seq_ID_n<span class="punctuation">,</span><span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		snp_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>snp_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_ID_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_end<span class="punctuation">,</span> snp_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">		seq_end <span class="operator">&lt;-</span> seq_end <span class="operator">+</span> seq_split</span><br><span class="line">		snp_num <span class="operator">&lt;-</span> 0</span><br><span class="line">	<span class="punctuation">&#125;</span></span><br><span class="line">	snp_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>snp_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_ID_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_stat<span class="punctuation">[</span>seq_ID_n<span class="punctuation">,</span><span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">]</span><span class="punctuation">,</span> snp_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">snp_stat <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>snp_stat<span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>snp_stat<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;seq_ID&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_start&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;snp_num&#x27;</span><span class="punctuation">)</span></span><br><span class="line">snp_stat<span class="operator">$</span>seq_start <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>snp_stat<span class="operator">$</span>seq_start<span class="punctuation">)</span></span><br><span class="line">snp_stat<span class="operator">$</span>seq_end <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>snp_stat<span class="operator">$</span>seq_end<span class="punctuation">)</span></span><br><span class="line">snp_stat<span class="operator">$</span>snp_num <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>snp_stat<span class="operator">$</span>snp_num<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">write.table<span class="punctuation">(</span>snp_stat<span class="punctuation">,</span> str_c<span class="punctuation">(</span>out_dir<span class="punctuation">,</span> <span class="string">&#x27;/&#x27;</span><span class="punctuation">,</span> sample_name<span class="punctuation">,</span> <span class="string">&#x27;.snp_stat.txt&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##读取 InDel 检测结果</span></span><br><span class="line"><span class="comment">#读取 vcf 文件，统计 InDel 长度</span></span><br><span class="line">indel <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>indel_vcf<span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> colClasses <span class="operator">=</span> <span class="string">&#x27;character&#x27;</span><span class="punctuation">,</span> comment.char <span class="operator">=</span> <span class="string">&#x27;#&#x27;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">indel<span class="operator">$</span>V2 <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>indel<span class="operator">$</span>V2<span class="punctuation">)</span></span><br><span class="line">indel<span class="operator">$</span><span class="built_in">length</span> <span class="operator">&lt;-</span> str_length<span class="punctuation">(</span>indel<span class="punctuation">[</span> <span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="operator">-</span> str_length<span class="punctuation">(</span>indel<span class="punctuation">[</span> <span class="punctuation">,</span><span class="number">3</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line">indel_insert <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>indel<span class="operator">$</span><span class="built_in">length</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">indel_delet <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>indel<span class="operator">$</span><span class="built_in">length</span> <span class="operator">&lt;</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#统计 InDel 密度</span></span><br><span class="line">indel <span class="operator">&lt;-</span> indel<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">colnames<span class="punctuation">(</span>indel<span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;seq_ID&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_site&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">indel_stat <span class="operator">&lt;-</span> <span class="literal">NULL</span></span><br><span class="line">seq_ID <span class="operator">&lt;-</span> unique<span class="punctuation">(</span>indel<span class="operator">$</span>seq_ID<span class="punctuation">)</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>seq_ID_n <span class="keyword">in</span> seq_ID<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	indel_subset <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>indel<span class="punctuation">,</span> seq_ID <span class="operator">==</span> seq_ID_n<span class="punctuation">)</span></span><br><span class="line">	seq_end <span class="operator">&lt;-</span> seq_split</span><br><span class="line">	indel_num <span class="operator">&lt;-</span> 0</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span>nrow<span class="punctuation">(</span>indel_subset<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		<span class="keyword">if</span> <span class="punctuation">(</span>indel_subset<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;seq_site&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;=</span> seq_end<span class="punctuation">)</span> indel_num <span class="operator">&lt;-</span> indel_num <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">		<span class="keyword">else</span> <span class="punctuation">&#123;</span></span><br><span class="line">			indel_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>indel_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_ID_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_end<span class="punctuation">,</span> indel_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">			</span><br><span class="line">			seq_end <span class="operator">&lt;-</span> seq_end <span class="operator">+</span> seq_split</span><br><span class="line">			indel_num <span class="operator">&lt;-</span> 0</span><br><span class="line">			<span class="keyword">while</span> <span class="punctuation">(</span>indel_subset<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;seq_site&#x27;</span><span class="punctuation">]</span> <span class="operator">&gt;</span> seq_end<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">				indel_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>indel_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_ID_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_end<span class="punctuation">,</span> indel_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">				seq_end <span class="operator">&lt;-</span> seq_end <span class="operator">+</span> seq_split</span><br><span class="line">			<span class="punctuation">&#125;</span></span><br><span class="line">			indel_num <span class="operator">&lt;-</span> indel_num <span class="operator">+</span> <span class="number">1</span></span><br><span class="line">		<span class="punctuation">&#125;</span></span><br><span class="line">	<span class="punctuation">&#125;</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">while</span> <span class="punctuation">(</span>seq_end <span class="operator">&lt;</span> seq_stat<span class="punctuation">[</span>seq_ID_n<span class="punctuation">,</span><span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		indel_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>indel_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_ID_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_end<span class="punctuation">,</span> indel_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">		seq_end <span class="operator">&lt;-</span> seq_end <span class="operator">+</span> seq_split</span><br><span class="line">		indel_num <span class="operator">&lt;-</span> 0</span><br><span class="line">	<span class="punctuation">&#125;</span></span><br><span class="line">	indel_stat <span class="operator">&lt;-</span> rbind<span class="punctuation">(</span>indel_stat<span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>seq_ID_n<span class="punctuation">,</span> seq_end <span class="operator">-</span> seq_split <span class="operator">+</span> <span class="number">1</span><span class="punctuation">,</span> seq_stat<span class="punctuation">[</span>seq_ID_n<span class="punctuation">,</span><span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">]</span><span class="punctuation">,</span> indel_num<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">indel_stat <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>indel_stat<span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>indel_stat<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;seq_ID&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_start&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;indel_num&#x27;</span><span class="punctuation">)</span></span><br><span class="line">indel_stat<span class="operator">$</span>seq_start <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>indel_stat<span class="operator">$</span>seq_start<span class="punctuation">)</span></span><br><span class="line">indel_stat<span class="operator">$</span>seq_end <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>indel_stat<span class="operator">$</span>seq_end<span class="punctuation">)</span></span><br><span class="line">indel_stat<span class="operator">$</span>indel_num <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>indel_stat<span class="operator">$</span>indel_num<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">write.table<span class="punctuation">(</span>indel_stat<span class="punctuation">,</span> str_c<span class="punctuation">(</span>out_dir<span class="punctuation">,</span> <span class="string">&#x27;/&#x27;</span><span class="punctuation">,</span> sample_name<span class="punctuation">,</span> <span class="string">&#x27;.indel_stat.txt&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> row.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> <span class="built_in">quote</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##读取 CNV 检测结果</span></span><br><span class="line">cnv <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>cnv_cnv<span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span>nrow<span class="punctuation">(</span>cnv<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	str_split <span class="operator">&lt;-</span> unlist<span class="punctuation">(</span>str_split<span class="punctuation">(</span>cnv<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="string">&#x27;[:-]&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">	cnv<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;seq_ID&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> str_split<span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">	cnv<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;seq_start&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> str_split<span class="punctuation">[</span><span class="number">2</span><span class="punctuation">]</span></span><br><span class="line">	cnv<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="string">&#x27;seq_end&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> str_split<span class="punctuation">[</span><span class="number">3</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">cnv <span class="operator">&lt;-</span> cnv<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">cnv<span class="operator">$</span>seq_start <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>cnv<span class="operator">$</span>seq_start<span class="punctuation">)</span></span><br><span class="line">cnv<span class="operator">$</span>seq_end <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>cnv<span class="operator">$</span>seq_end<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">cnv_dup <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>cnv<span class="punctuation">[[</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">==</span> <span class="string">&#x27;duplication&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">cnv_del <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>cnv<span class="punctuation">[[</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">==</span> <span class="string">&#x27;deletion&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##读取 SV 检测结果</span></span><br><span class="line">sv <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span>sv_ctx<span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> comment.char <span class="operator">=</span> <span class="string">&#x27;#&#x27;</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line">sv_in_de <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>sv<span class="punctuation">,</span> sv<span class="punctuation">[[</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">%in%</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;INS&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;DEL&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">]</span></span><br><span class="line">sv_ITX <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>sv<span class="punctuation">,</span> sv<span class="punctuation">[[</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">%in%</span> <span class="string">&#x27;ITX&#x27;</span><span class="punctuation">)</span></span><br><span class="line">sv_CTX <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>sv<span class="punctuation">,</span> sv<span class="punctuation">[[</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">%in%</span> <span class="string">&#x27;CTX&#x27;</span><span class="punctuation">)</span></span><br><span class="line">sv_INV <span class="operator">&lt;-</span> subset<span class="punctuation">(</span>sv<span class="punctuation">,</span> sv<span class="punctuation">[[</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">%in%</span> <span class="string">&#x27;INV&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">sv_ins <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>sv<span class="punctuation">[[</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">==</span> <span class="string">&#x27;INS&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">sv_del <span class="operator">&lt;-</span> <span class="built_in">length</span><span class="punctuation">(</span>which<span class="punctuation">(</span>sv<span class="punctuation">[[</span><span class="number">5</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">==</span> <span class="string">&#x27;DEL&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">sv_itx <span class="operator">&lt;-</span> nrow<span class="punctuation">(</span>sv_ITX<span class="punctuation">)</span></span><br><span class="line">sv_ctx <span class="operator">&lt;-</span> nrow<span class="punctuation">(</span>sv_CTX<span class="punctuation">)</span></span><br><span class="line">sv_inv <span class="operator">&lt;-</span> nrow<span class="punctuation">(</span>sv_INV<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#####################</span></span><br><span class="line"><span class="comment">##circlize 绘图</span></span><br><span class="line">pdf<span class="punctuation">(</span>str_c<span class="punctuation">(</span>out_dir<span class="punctuation">,</span> <span class="string">&#x27;/&#x27;</span><span class="punctuation">,</span> sample_name<span class="punctuation">,</span> <span class="string">&#x27;.circlize.pdf&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">14</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span></span><br><span class="line">circle_size <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="string">&quot;snpc&quot;</span><span class="punctuation">)</span></span><br><span class="line">circos.par<span class="punctuation">(</span>gap.degree <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">circos.genomicInitialize<span class="punctuation">(</span>seq_stat<span class="punctuation">,</span> plotType <span class="operator">=</span> <span class="string">&#x27;axis&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">circos.track<span class="punctuation">(</span></span><br><span class="line">	ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> bg.col <span class="operator">=</span> <span class="string">&#x27;#8DD3C7&#x27;</span><span class="punctuation">,</span></span><br><span class="line">	panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>x<span class="punctuation">,</span> y<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		xlim <span class="operator">=</span> CELL_META<span class="operator">$</span>xlim</span><br><span class="line">		ylim <span class="operator">=</span> CELL_META<span class="operator">$</span>ylim</span><br><span class="line">		seq_ID <span class="operator">=</span> CELL_META<span class="operator">$</span>sector.index</span><br><span class="line">		circos.text<span class="punctuation">(</span>mean<span class="punctuation">(</span>xlim<span class="punctuation">)</span><span class="punctuation">,</span> mean<span class="punctuation">(</span>ylim<span class="punctuation">)</span><span class="punctuation">,</span> seq_ID<span class="punctuation">,</span> cex <span class="operator">=</span> <span class="number">0.7</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;black&#x27;</span><span class="punctuation">,</span> facing <span class="operator">=</span> <span class="string">&#x27;inside&#x27;</span><span class="punctuation">,</span> niceFacing <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">	<span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#GC% 含量图</span></span><br><span class="line">circos.genomicTrack<span class="punctuation">(</span></span><br><span class="line">	depth_base<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.08</span><span class="punctuation">,</span> bg.col <span class="operator">=</span> <span class="string">&#x27;#EEEEEE6E&#x27;</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span></span><br><span class="line">	panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		circos.genomicLines<span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">0.35</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line">		circos.lines<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="built_in">max</span><span class="punctuation">(</span>region<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>genome_GC<span class="punctuation">,</span> genome_GC<span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;blue2&#x27;</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">0.15</span><span class="punctuation">,</span> lty <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">	circos.yaxis<span class="punctuation">(</span>labels.cex <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">,</span> tick.length <span class="operator">=</span> convert_x<span class="punctuation">(</span><span class="number">0.15</span><span class="punctuation">,</span> <span class="string">&#x27;mm&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">	<span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">gc_legend <span class="operator">&lt;-</span> Legend<span class="punctuation">(</span></span><br><span class="line">	at <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>str_c<span class="punctuation">(</span><span class="string">&#x27;GC % ( Average: &#x27;</span><span class="punctuation">,</span> genome_GC<span class="punctuation">,</span> <span class="string">&#x27; % )&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> labels_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">	grid_height <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> grid_width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;lines&#x27;</span><span class="punctuation">,</span> background <span class="operator">=</span> <span class="string">&#x27;#EEEEEE6E&#x27;</span><span class="punctuation">,</span> </span><br><span class="line">	legend_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>col <span class="operator">=</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#覆盖度 &amp; 深度</span></span><br><span class="line">circos.genomicTrack<span class="punctuation">(</span></span><br><span class="line">	depth_base<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.08</span><span class="punctuation">,</span> ylim <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="punctuation">(</span><span class="built_in">max</span><span class="punctuation">(</span>depth_base<span class="operator">$</span>depth<span class="punctuation">)</span> <span class="operator">+</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> bg.col <span class="operator">=</span> <span class="string">&#x27;#EEEEEE6E&#x27;</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span></span><br><span class="line">	panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>region<span class="punctuation">,</span>value<span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		circos.genomicRect<span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> ytop.column <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> ybottom <span class="operator">=</span> <span class="number">0</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="string">&#x27;white&#x27;</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">0.02</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line">		circos.lines<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="built_in">max</span><span class="punctuation">(</span>region<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">c</span><span class="punctuation">(</span>average_depth<span class="punctuation">,</span> average_depth<span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;red3&#x27;</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">0.15</span><span class="punctuation">,</span> lty <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span></span><br><span class="line">		circos.yaxis<span class="punctuation">(</span>labels.cex <span class="operator">=</span> <span class="number">0.2</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">0.1</span><span class="punctuation">,</span> tick.length <span class="operator">=</span> convert_x<span class="punctuation">(</span><span class="number">0.15</span><span class="punctuation">,</span> <span class="string">&#x27;mm&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">	<span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">depth_legend <span class="operator">&lt;-</span> Legend<span class="punctuation">(</span></span><br><span class="line">	at <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> labels <span class="operator">=</span> str_c<span class="punctuation">(</span><span class="string">&#x27; Depth ( average: &#x27;</span><span class="punctuation">,</span> average_depth<span class="punctuation">,</span> <span class="string">&#x27; X )&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> labels_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">	title <span class="operator">=</span> str_c<span class="punctuation">(</span><span class="string">&#x27;Coverage: &#x27;</span><span class="punctuation">,</span> coverage <span class="punctuation">,</span> <span class="string">&#x27; %&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> title_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">9</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">	grid_height <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> grid_width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;points&#x27;</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> background <span class="operator">=</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#CDS &amp; rRNA &amp; tRNA</span></span><br><span class="line">color_assign <span class="operator">&lt;-</span> colorRamp2<span class="punctuation">(</span>breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#00ADFF&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green2&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">circos.genomicTrackPlotRegion<span class="punctuation">(</span></span><br><span class="line">	gene<span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.12</span><span class="punctuation">,</span> stack <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span></span><br><span class="line">	panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		circos.genomicRect<span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> col <span class="operator">=</span> color_assign<span class="punctuation">(</span>value<span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line">	<span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">gene_legend <span class="operator">&lt;-</span> Legend<span class="punctuation">(</span></span><br><span class="line">	at <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27; CDS&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27; rRNA&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27; tRNA&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> labels_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">	title <span class="operator">=</span> <span class="string">&#x27;CDS | rRNA | tRNA&#x27;</span><span class="punctuation">,</span> title_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">9</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">	grid_height <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> grid_width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.4</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;points&#x27;</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> background <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#00ADFF&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;orange&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green2&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#SNP 密度</span></span><br><span class="line">value_max <span class="operator">&lt;-</span> <span class="built_in">max</span><span class="punctuation">(</span>snp_stat<span class="operator">$</span>snp_num<span class="punctuation">)</span></span><br><span class="line">colorsChoice <span class="operator">&lt;-</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;white&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#245B8E&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">color_assign <span class="operator">&lt;-</span> colorRamp2<span class="punctuation">(</span>breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="operator">:</span>value_max<span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> colorsChoice<span class="punctuation">(</span>value_max <span class="operator">+</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">circos.genomicTrackPlotRegion<span class="punctuation">(</span></span><br><span class="line">	snp_stat<span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.08</span><span class="punctuation">,</span> stack <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span></span><br><span class="line">	panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		circos.genomicRect<span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> col <span class="operator">=</span> color_assign<span class="punctuation">(</span>value<span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line">	<span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">snp_legend <span class="operator">&lt;-</span> Legend<span class="punctuation">(</span></span><br><span class="line">	at <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> value_max<span class="punctuation">,</span> length.out <span class="operator">=</span> <span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> labels_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">	col_fun <span class="operator">=</span> colorRamp2<span class="punctuation">(</span><span class="built_in">round</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> value_max<span class="punctuation">,</span> length.out <span class="operator">=</span> <span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> colorsChoice<span class="punctuation">(</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">	title_position <span class="operator">=</span> <span class="string">&#x27;topleft&#x27;</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&#x27;SNP density&#x27;</span><span class="punctuation">,</span> legend_height <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> title_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">9</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#InDel 密度</span></span><br><span class="line">value_max <span class="operator">&lt;-</span> <span class="built_in">max</span><span class="punctuation">(</span>indel_stat<span class="operator">$</span>indel_num<span class="punctuation">)</span></span><br><span class="line">colorsChoice <span class="operator">&lt;-</span> colorRampPalette<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;white&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#7744A4&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">color_assign <span class="operator">&lt;-</span> colorRamp2<span class="punctuation">(</span>breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="operator">:</span>value_max<span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> colorsChoice<span class="punctuation">(</span>value_max <span class="operator">+</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">circos.genomicTrackPlotRegion<span class="punctuation">(</span></span><br><span class="line">	indel_stat<span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.08</span><span class="punctuation">,</span> stack <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span></span><br><span class="line">	panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		circos.genomicRect<span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> col <span class="operator">=</span> color_assign<span class="punctuation">(</span>value<span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line">	<span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">indel_legend <span class="operator">&lt;-</span> Legend<span class="punctuation">(</span></span><br><span class="line">	at <span class="operator">=</span> <span class="built_in">round</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> value_max<span class="punctuation">,</span> length.out <span class="operator">=</span> <span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> labels_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">	col_fun <span class="operator">=</span> colorRamp2<span class="punctuation">(</span><span class="built_in">round</span><span class="punctuation">(</span>seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> value_max<span class="punctuation">,</span> length.out <span class="operator">=</span> <span class="number">6</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> colorsChoice<span class="punctuation">(</span><span class="number">6</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">	title_position <span class="operator">=</span> <span class="string">&#x27;topleft&#x27;</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&#x27;InDel density&#x27;</span><span class="punctuation">,</span> legend_height <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> title_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">9</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#CNV 变异 duplication、deletion，1 插入、2 缺失</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span>nrow<span class="punctuation">(</span>cnv<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	<span class="keyword">if</span> <span class="punctuation">(</span>cnv<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="operator">==</span> <span class="string">&#x27;duplication&#x27;</span><span class="punctuation">)</span> cnv<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">1</span></span><br><span class="line">	<span class="keyword">if</span> <span class="punctuation">(</span>cnv<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="operator">==</span> <span class="string">&#x27;deletion&#x27;</span><span class="punctuation">)</span> cnv<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">2</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">cnv<span class="punctuation">[[</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>cnv<span class="punctuation">[[</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">color_assign <span class="operator">&lt;-</span> colorRamp2<span class="punctuation">(</span>breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#FB564A&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#74C476&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">circos.genomicTrackPlotRegion<span class="punctuation">(</span></span><br><span class="line">	cnv<span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.06</span><span class="punctuation">,</span> stack <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span></span><br><span class="line">	panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		circos.genomicRect<span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> col <span class="operator">=</span> color_assign<span class="punctuation">(</span>value<span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line">	<span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">cnv_legend <span class="operator">&lt;-</span> Legend<span class="punctuation">(</span></span><br><span class="line">	at <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27; Duplication&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27; Deletion&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> labels_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&#x27;CNV type&#x27;</span><span class="punctuation">,</span> title_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">9</span><span class="punctuation">)</span><span class="punctuation">,</span>  </span><br><span class="line">	grid_height <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> grid_width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;points&#x27;</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> background <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#FB564A&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#74C476&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#SV 变异</span></span><br><span class="line"><span class="comment">#INS、DEL，1 插入、2 缺失</span></span><br><span class="line"><span class="keyword">for</span> <span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span>nrow<span class="punctuation">(</span>sv_in_de<span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">	<span class="keyword">if</span> <span class="punctuation">(</span>sv_in_de<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="operator">==</span> <span class="string">&#x27;INS&#x27;</span><span class="punctuation">)</span> sv_in_de<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">1</span></span><br><span class="line">	<span class="keyword">if</span> <span class="punctuation">(</span>sv_in_de<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="operator">==</span> <span class="string">&#x27;DEL&#x27;</span><span class="punctuation">)</span> sv_in_de<span class="punctuation">[</span>i<span class="punctuation">,</span><span class="number">4</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="number">2</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line">sv_in_de<span class="punctuation">[[</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="built_in">as.numeric</span><span class="punctuation">(</span>sv_in_de<span class="punctuation">[[</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">color_assign <span class="operator">&lt;-</span> colorRamp2<span class="punctuation">(</span>breaks <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#FB564A&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#74C476&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">circos.genomicTrackPlotRegion<span class="punctuation">(</span></span><br><span class="line">	sv_in_de<span class="punctuation">,</span> track.height <span class="operator">=</span> <span class="number">0.06</span><span class="punctuation">,</span> stack <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> bg.border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span></span><br><span class="line">	panel.fun <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> ...<span class="punctuation">)</span> <span class="punctuation">&#123;</span></span><br><span class="line">		circos.genomicRect<span class="punctuation">(</span>region<span class="punctuation">,</span> value<span class="punctuation">,</span> col <span class="operator">=</span> color_assign<span class="punctuation">(</span>value<span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> border <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> ...<span class="punctuation">)</span></span><br><span class="line">	<span class="punctuation">&#125;</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ITX，内易位</span></span><br><span class="line">circos.genomicLink<span class="punctuation">(</span>sv_ITX<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span> sv_ITX<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;#FF46346E&#x27;</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#CTX，间易位</span></span><br><span class="line">circos.genomicLink<span class="punctuation">(</span>sv_CTX<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span> sv_CTX<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;#66CB716E&#x27;</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#INV，倒位</span></span><br><span class="line">circos.genomicLink<span class="punctuation">(</span>sv_INV<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span> sv_INV<span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="string">&#x27;#53C6FF6E&#x27;</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">sv_legend <span class="operator">&lt;-</span> Legend<span class="punctuation">(</span></span><br><span class="line">	at <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27; INS&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27; DEL&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27; ITX&#x27;</span><span class="punctuation">,</span><span class="string">&#x27; CTX&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27; INV&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">	labels_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">8</span><span class="punctuation">)</span><span class="punctuation">,</span> grid_height <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> grid_width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0.5</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">	type <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;points&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;points&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;lines&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;lines&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;lines&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> background <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;#FB564A&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#74C476&#x27;</span><span class="punctuation">,</span> <span class="literal">NA</span><span class="punctuation">,</span> <span class="literal">NA</span><span class="punctuation">,</span> <span class="literal">NA</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">	legend_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="literal">NA</span><span class="punctuation">,</span> <span class="literal">NA</span><span class="punctuation">,</span> <span class="string">&#x27;#FF4634&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#66CB71&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;#53C6FF&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">	title <span class="operator">=</span> <span class="string">&#x27;SV type&#x27;</span><span class="punctuation">,</span> title_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">9</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#添加图例</span></span><br><span class="line">y_coord <span class="operator">&lt;-</span> 0.8</span><br><span class="line">x_coord <span class="operator">&lt;-</span> 0.87</span><br><span class="line"></span><br><span class="line">pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>x <span class="operator">=</span> x_coord <span class="operator">+</span> <span class="number">0.011</span><span class="punctuation">,</span> y <span class="operator">=</span> y_coord<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>gc_legend<span class="punctuation">)</span></span><br><span class="line">y_coord <span class="operator">&lt;-</span> y_coord <span class="operator">-</span> <span class="number">0.06</span></span><br><span class="line">upViewport<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>x <span class="operator">=</span> x_coord <span class="operator">+</span> <span class="number">0.005</span><span class="punctuation">,</span> y <span class="operator">=</span> y_coord<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>depth_legend<span class="punctuation">)</span></span><br><span class="line">y_coord <span class="operator">&lt;-</span> y_coord <span class="operator">-</span> <span class="number">0.1</span></span><br><span class="line">upViewport<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>x <span class="operator">=</span> x_coord <span class="operator">-</span> <span class="number">0.0063</span><span class="punctuation">,</span> y <span class="operator">=</span> y_coord<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>gene_legend<span class="punctuation">)</span></span><br><span class="line">y_coord <span class="operator">&lt;-</span> y_coord <span class="operator">-</span> <span class="number">0.19</span></span><br><span class="line">upViewport<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>x <span class="operator">=</span> x_coord <span class="operator">-</span> <span class="number">0.0205</span><span class="punctuation">,</span> y <span class="operator">=</span> y_coord<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>snp_legend<span class="punctuation">)</span></span><br><span class="line">y_coord <span class="operator">&lt;-</span> y_coord</span><br><span class="line">upViewport<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>x <span class="operator">=</span> x_coord <span class="operator">+</span> <span class="number">0.0505</span><span class="punctuation">,</span> y <span class="operator">=</span> y_coord<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>indel_legend<span class="punctuation">)</span></span><br><span class="line">y_coord <span class="operator">&lt;-</span> y_coord <span class="operator">-</span> <span class="number">0.195</span></span><br><span class="line">upViewport<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>x <span class="operator">=</span> x_coord <span class="operator">-</span> <span class="number">0.018</span><span class="punctuation">,</span> y <span class="operator">=</span> y_coord<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>cnv_legend<span class="punctuation">)</span></span><br><span class="line">y_coord <span class="operator">&lt;-</span> y_coord</span><br><span class="line">upViewport<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>x <span class="operator">=</span> x_coord <span class="operator">+</span> <span class="number">0.04</span><span class="punctuation">,</span> y <span class="operator">=</span> y_coord <span class="operator">-</span> <span class="number">0.0373</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>sv_legend<span class="punctuation">)</span></span><br><span class="line">y_coord <span class="operator">&lt;-</span> y_coord</span><br><span class="line">upViewport<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#统计总览（涵括了上文大部分的统计结果信息，例如 SNP 替换类型统计等）</span></span><br><span class="line">stat_legend <span class="operator">&lt;-</span> Legend<span class="punctuation">(</span></span><br><span class="line">	at <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> labels <span class="operator">=</span> <span class="string">&#x27;1&#x27;</span><span class="punctuation">,</span> labels_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="punctuation">,</span> title_gp <span class="operator">=</span> gpar<span class="punctuation">(</span>fontsize <span class="operator">=</span> <span class="number">9</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">	grid_height <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> grid_width <span class="operator">=</span> unit<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="string">&#x27;cm&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;points&#x27;</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> background <span class="operator">=</span> <span class="literal">NA</span><span class="punctuation">,</span> </span><br><span class="line">	title <span class="operator">=</span> str_c<span class="punctuation">(</span><span class="string">&#x27;Sample: &#x27;</span><span class="punctuation">,</span> sample_name<span class="punctuation">,</span> <span class="string">&#x27;\nRefer species: &#x27;</span><span class="punctuation">,</span> ref_name<span class="punctuation">,</span> <span class="string">&#x27;\nRefer size: &#x27;</span><span class="punctuation">,</span> genome_size<span class="punctuation">,</span> <span class="string">&#x27; bp\nRefer GC: &#x27;</span><span class="punctuation">,</span> genome_GC<span class="punctuation">,</span> <span class="string">&#x27; %\n\n\nTotal SNP: &#x27;</span><span class="punctuation">,</span> snp_ti <span class="operator">+</span> snp_tv<span class="punctuation">,</span> <span class="string">&#x27;\nTransitions: &#x27;</span><span class="punctuation">,</span> snp_ti<span class="punctuation">,</span> <span class="string">&#x27;\nTransversions: &#x27;</span><span class="punctuation">,</span> snp_tv<span class="punctuation">,</span> <span class="string">&#x27;\nTi/Tv: &#x27;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span>snp_ti <span class="operator">/</span> snp_tv<span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&#x27;\nA&gt;T|T&gt;A: &#x27;</span><span class="punctuation">,</span> snp_at<span class="punctuation">,</span> <span class="string">&#x27;\nA&gt;G|T&gt;C: &#x27;</span><span class="punctuation">,</span> snp_ag<span class="punctuation">,</span> <span class="string">&#x27;\nA&gt;C|T&gt;G: &#x27;</span><span class="punctuation">,</span> snp_ac<span class="punctuation">,</span> <span class="string">&#x27;\nG&gt;A|C&gt;T: &#x27;</span><span class="punctuation">,</span> snp_ga<span class="punctuation">,</span> <span class="string">&#x27;\nG&gt;T|C&gt;A: &#x27;</span><span class="punctuation">,</span> snp_gt<span class="punctuation">,</span> <span class="string">&#x27;\nG&gt;C|C&gt;G: &#x27;</span><span class="punctuation">,</span> snp_gc<span class="punctuation">,</span> <span class="string">&#x27;\n\n\nTotal InDel: &#x27;</span><span class="punctuation">,</span> indel_insert <span class="operator">+</span> indel_delet<span class="punctuation">,</span> <span class="string">&#x27;\nInsert: &#x27;</span><span class="punctuation">,</span> indel_insert<span class="punctuation">,</span> <span class="string">&#x27;\nDelet: &#x27;</span><span class="punctuation">,</span> indel_delet<span class="punctuation">,</span> <span class="string">&#x27;\n\n\nTotal CNV: &#x27;</span><span class="punctuation">,</span> cnv_dup <span class="operator">+</span> cnv_del<span class="punctuation">,</span> <span class="string">&#x27;\nDuplication: &#x27;</span><span class="punctuation">,</span> cnv_dup<span class="punctuation">,</span> <span class="string">&#x27;\nDeletion: &#x27;</span><span class="punctuation">,</span> cnv_del<span class="punctuation">,</span> <span class="string">&#x27;\n\n\nTotal SV: &#x27;</span><span class="punctuation">,</span> sv_ins <span class="operator">+</span> sv_del <span class="operator">+</span> sv_itx <span class="operator">+</span> sv_ctx <span class="operator">+</span> sv_inv<span class="punctuation">,</span> <span class="string">&#x27;\nINS: &#x27;</span><span class="punctuation">,</span> sv_ins<span class="punctuation">,</span><span class="string">&#x27;\nDEL: &#x27;</span><span class="punctuation">,</span> sv_del<span class="punctuation">,</span> <span class="string">&#x27;\nITX: &#x27;</span><span class="punctuation">,</span> sv_itx<span class="punctuation">,</span> <span class="string">&#x27;\nCTX: &#x27;</span><span class="punctuation">,</span> sv_ctx<span class="punctuation">,</span> <span class="string">&#x27;\nINV: &#x27;</span><span class="punctuation">,</span> sv_inv<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">pushViewport<span class="punctuation">(</span>viewport<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">0.12</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">0.5</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">grid.draw<span class="punctuation">(</span>stat_legend<span class="punctuation">)</span></span><br><span class="line">upViewport<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">circos.clear<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="三元相图">三元相图</h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#示例数据“data.txt”</span></span><br><span class="line"><span class="comment">#第一列，OTU 名称</span></span><br><span class="line"><span class="comment">#第二、三、四列，OTU 在 3 个样本中的丰度信息</span></span><br><span class="line"><span class="comment">#第五列，标注了这些 OTU 在哪个样本中发生了富集</span></span><br><span class="line"><span class="comment">#第六列，OTU 的门类群</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#读取数据</span></span><br><span class="line">dat <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span><span class="string">&#x27;data.txt&#x27;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&#x27;\t&#x27;</span><span class="punctuation">,</span> stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> check.names <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##ternaryplot() 三元图</span></span><br><span class="line">library<span class="punctuation">(</span>vcd<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">dat1 <span class="operator">&lt;-</span> dat</span><br><span class="line"></span><br><span class="line"><span class="comment">#定义图中点的大小，这里取 3 个样本的平均值的 0.4 次方再除以 10......</span></span><br><span class="line"><span class="comment">#丰度差异过大，调整图中点大小确实是件麻烦事</span></span><br><span class="line">dat1<span class="operator">$</span>size <span class="operator">&lt;-</span> <span class="punctuation">(</span>apply<span class="punctuation">(</span>dat1<span class="punctuation">[</span><span class="number">2</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> mean<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">^</span><span class="number">0.4</span> <span class="operator">/</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#定义富集 OTUs 的颜色，按富集样本划分</span></span><br><span class="line">dat1<span class="punctuation">[</span>which<span class="punctuation">(</span>dat1<span class="operator">$</span>rich <span class="operator">==</span> <span class="string">&#x27;env1&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;color&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;red&#x27;</span></span><br><span class="line">dat1<span class="punctuation">[</span>which<span class="punctuation">(</span>dat1<span class="operator">$</span>rich <span class="operator">==</span> <span class="string">&#x27;env2&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;color&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;blue&#x27;</span></span><br><span class="line">dat1<span class="punctuation">[</span>which<span class="punctuation">(</span>dat1<span class="operator">$</span>rich <span class="operator">==</span> <span class="string">&#x27;env3&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;color&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;green3&#x27;</span></span><br><span class="line">dat1<span class="punctuation">[</span>which<span class="punctuation">(</span>dat1<span class="operator">$</span>rich <span class="operator">==</span> <span class="string">&#x27;0&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="string">&#x27;color&#x27;</span><span class="punctuation">]</span> <span class="operator">&lt;-</span> <span class="string">&#x27;gray&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ternaryplot() 示例，按 OTUs 富集区域着色</span></span><br><span class="line"><span class="comment">#pdf(&#x27;ternaryplot.pdf&#x27;)</span></span><br><span class="line">png<span class="punctuation">(</span><span class="string">&#x27;ternaryplot.png&#x27;</span><span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">2000</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">2000</span><span class="punctuation">,</span> res <span class="operator">=</span> <span class="number">300</span><span class="punctuation">,</span> units <span class="operator">=</span> <span class="string">&#x27;px&#x27;</span><span class="punctuation">)</span></span><br><span class="line">ternaryplot<span class="punctuation">(</span>dat1<span class="punctuation">[</span><span class="number">2</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">,</span> scale <span class="operator">=</span> <span class="literal">NULL</span><span class="punctuation">,</span> col <span class="operator">=</span> dat1<span class="operator">$</span>color<span class="punctuation">,</span> prop_size <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> cex <span class="operator">=</span> dat1<span class="operator">$</span>size<span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;Enriched OTUs&#x27;</span><span class="punctuation">)</span></span><br><span class="line">grid_legend<span class="punctuation">(</span>x <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="number">0.7</span><span class="punctuation">,</span> pch <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">19</span><span class="punctuation">,</span> <span class="number">19</span><span class="punctuation">,</span> <span class="number">19</span><span class="punctuation">)</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green3&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> label <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;env1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;env2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;env3&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">,</span> frame <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##ggtern 三元图</span></span><br><span class="line">library<span class="punctuation">(</span>ggtern<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">dat2 <span class="operator">&lt;-</span> dat</span><br><span class="line"></span><br><span class="line"><span class="comment">#用于定义图中点的大小，这里取 3 个样本的平均值的 0.5 次方......</span></span><br><span class="line">dat2<span class="operator">$</span>size <span class="operator">&lt;-</span> <span class="punctuation">(</span>apply<span class="punctuation">(</span>dat2<span class="punctuation">[</span><span class="number">2</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">]</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> mean<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">^</span><span class="number">0.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggtern，按 OTUs 富集区域着色</span></span><br><span class="line">p_rich <span class="operator">&lt;-</span> ggtern<span class="punctuation">(</span>dat2<span class="punctuation">,</span> aes<span class="punctuation">(</span>env1<span class="punctuation">,</span> env2<span class="punctuation">,</span> env3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_mask<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> rich<span class="punctuation">,</span> size <span class="operator">=</span> size<span class="punctuation">)</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">,</span> show.legend <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_size<span class="punctuation">(</span><span class="built_in">range</span> <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">6</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_colour_manual<span class="punctuation">(</span>values  <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;red&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;green3&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;gray&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> limits <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;env1&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;env2&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;env3&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;0&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme_bw<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>axis.text <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.ticks <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggtern，按 OTUs 类群着色</span></span><br><span class="line">p_taxonomy <span class="operator">&lt;-</span> ggtern<span class="punctuation">(</span>dat2<span class="punctuation">,</span> aes<span class="punctuation">(</span>env1<span class="punctuation">,</span> env2<span class="punctuation">,</span> env3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_mask<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>color <span class="operator">=</span> taxonomy<span class="punctuation">,</span> size <span class="operator">=</span> size<span class="punctuation">)</span><span class="punctuation">,</span> alpha <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">scale_size<span class="punctuation">(</span><span class="built_in">range</span> <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">6</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme_bw<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>axis.text <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> axis.ticks <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">guides<span class="punctuation">(</span>size <span class="operator">=</span> <span class="string">&#x27;none&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggsave(&#x27;ggtern.pdf&#x27;, p_rich, width = 6, height = 6)</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&#x27;ggtern.png&#x27;</span><span class="punctuation">,</span> p_rich<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span> height <span class="operator">=</span> <span class="number">6</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#密度图举例</span></span><br><span class="line">ggtern<span class="punctuation">(</span>dat2<span class="punctuation">,</span> aes<span class="punctuation">(</span>env1<span class="punctuation">,</span> env2<span class="punctuation">,</span> env3<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">stat_density_tern<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<img src="/2023/10/31/ggplot-picture/Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200301165119323.png" alt="image-20200301165119323" style="zoom:33%;">
<h3 id="生存曲线图">生存曲线图</h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="punctuation">(</span><span class="operator">!</span>requireNamespace<span class="punctuation">(</span><span class="string">&quot;BiocManager&quot;</span><span class="punctuation">,</span> quietly <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  install.packages<span class="punctuation">(</span><span class="string">&quot;BiocManager&quot;</span><span class="punctuation">)</span></span><br><span class="line">BiocManager<span class="operator">::</span>install<span class="punctuation">(</span><span class="string">&quot;survival&quot;</span><span class="punctuation">,</span> version <span class="operator">=</span> <span class="string">&quot;3.8&quot;</span><span class="punctuation">)</span></span><br><span class="line">BiocManager<span class="operator">::</span>install<span class="punctuation">(</span><span class="string">&quot;ggplot2&quot;</span><span class="punctuation">,</span> version <span class="operator">=</span> <span class="string">&quot;3.8&quot;</span><span class="punctuation">)</span></span><br><span class="line">BiocManager<span class="operator">::</span>install<span class="punctuation">(</span><span class="string">&quot;survminer&quot;</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>survival<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>survminer<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#读取个人采集的生存曲线数据表</span></span><br><span class="line">survival_time<span class="operator">&lt;-</span>read.csv<span class="punctuation">(</span><span class="string">&quot;survival_time.csv&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span> sep<span class="operator">=</span><span class="string">&quot;,&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#创建生存对象surv（time，status）不变，分组变量可根据自己实验分组，此处以性别sex分类</span></span><br><span class="line">fit <span class="operator">&lt;-</span> survfit<span class="punctuation">(</span>Surv<span class="punctuation">(</span>time<span class="punctuation">,</span> status<span class="punctuation">)</span> <span class="operator">~</span> sex<span class="punctuation">,</span> data <span class="operator">=</span> survival_time<span class="punctuation">)</span> </span><br><span class="line"><span class="comment">#最基本绘图</span></span><br><span class="line">ggsurvplot<span class="punctuation">(</span>fit<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#绘制个性化生存曲线</span></span><br><span class="line">ggsurvplot<span class="punctuation">(</span>fit<span class="punctuation">,</span>risk.table<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span><span class="comment">#生存统计统计表</span></span><br><span class="line">           conf.int<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span><span class="comment">#添加置信区间带</span></span><br><span class="line">           palette <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;skyblue&quot;</span><span class="punctuation">,</span> <span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span><span class="comment">#颜色设置</span></span><br><span class="line">           pval<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span><span class="comment">#log-rank检验</span></span><br><span class="line">           pval.method<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">)</span><span class="comment">#添加检验text</span></span><br><span class="line"></span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span>示例数据<span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">library<span class="punctuation">(</span>survival<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#示例数据，详情 ?lung</span></span><br><span class="line">data<span class="punctuation">(</span>lung<span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>lung<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#Kaplan-Meier 分析，详情 ?survfit</span></span><br><span class="line">KM <span class="operator">&lt;-</span> survfit<span class="punctuation">(</span>Surv<span class="punctuation">(</span>time<span class="punctuation">,</span> status<span class="punctuation">)</span> <span class="operator">~</span> sex<span class="punctuation">,</span> data <span class="operator">=</span> lung<span class="punctuation">,</span> type <span class="operator">=</span> <span class="string">&#x27;kaplan-meier&#x27;</span><span class="punctuation">,</span> conf.type <span class="operator">=</span> <span class="string">&#x27;log&#x27;</span><span class="punctuation">)</span></span><br><span class="line">KM</span><br><span class="line">summary<span class="punctuation">(</span>KM<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#结果提取，例如重要的统计值</span></span><br><span class="line">summary<span class="punctuation">(</span>KM<span class="punctuation">)</span><span class="operator">$</span>table</span><br><span class="line"><span class="comment">#对数秩检验，详情 ?survdiff</span></span><br><span class="line">survdiff<span class="punctuation">(</span>Surv<span class="punctuation">(</span>time<span class="punctuation">,</span> status<span class="punctuation">)</span> <span class="operator">~</span> sex<span class="punctuation">,</span> data <span class="operator">=</span> lung<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#绘制生存曲线，反映了尚在世的患者数量比例和时间的关系</span></span><br><span class="line">plot<span class="punctuation">(</span>KM<span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;Kaplan-Meier &#x27;</span><span class="punctuation">,</span> xlab <span class="operator">=</span> <span class="string">&#x27;Time (days)&#x27;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&#x27;Overall survival&#x27;</span><span class="punctuation">,</span> </span><br><span class="line">     lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">legend<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;topright&#x27;</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> legend <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;1: male&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;2: female&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#绘制累积风险曲线，反映了疾病风险和时间的关系，与累积的去世患者数量有关</span></span><br><span class="line">plot<span class="punctuation">(</span>KM<span class="punctuation">,</span> main <span class="operator">=</span> <span class="string">&#x27;Cumulative hazard&#x27;</span><span class="punctuation">,</span> xlab <span class="operator">=</span> <span class="string">&#x27;Time (days)&#x27;</span><span class="punctuation">,</span> ylab <span class="operator">=</span> <span class="string">&#x27;Cumulative hazard&#x27;</span><span class="punctuation">,</span> </span><br><span class="line">     lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> fun <span class="operator">=</span> <span class="string">&#x27;cumhaz&#x27;</span><span class="punctuation">)</span></span><br><span class="line">legend<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&#x27;topright&#x27;</span><span class="punctuation">,</span> col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> lwd <span class="operator">=</span> <span class="number">2</span><span class="punctuation">,</span> legend <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;1: male&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;2: female&#x27;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>survminer<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#生存曲线，详情 ?ggsurvplot</span></span><br><span class="line">ggsurvplot<span class="punctuation">(</span>KM<span class="punctuation">,</span> conf.int <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> palette <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> risk.table <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> pval <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#累积风险曲线</span></span><br><span class="line">ggsurvplot<span class="punctuation">(</span>KM<span class="punctuation">,</span> conf.int <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span> palette <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;blue&#x27;</span><span class="punctuation">,</span> <span class="string">&#x27;red&#x27;</span><span class="punctuation">)</span><span class="punctuation">,</span> fun <span class="operator">=</span> <span class="string">&#x27;cumhaz&#x27;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="风玫瑰图">风玫瑰图</h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#基于疫情数据</span></span><br><span class="line">require<span class="punctuation">(</span>nCov2019<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>dplyr<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">y <span class="operator">=</span> load_nCov2019<span class="punctuation">(</span>lang <span class="operator">=</span> <span class="string">&#x27;zh&#x27;</span><span class="punctuation">)</span></span><br><span class="line">y</span><br><span class="line">d <span class="operator">=</span> y<span class="punctuation">[</span><span class="string">&#x27;global&#x27;</span><span class="punctuation">]</span></span><br><span class="line">dd <span class="operator">&lt;-</span>  filter<span class="punctuation">(</span>d<span class="punctuation">,</span> time <span class="operator">==</span> time<span class="punctuation">(</span>y<span class="punctuation">)</span><span class="operator">&amp;</span> country <span class="operator">!=</span> <span class="string">&#x27;中国&#x27;</span><span class="punctuation">)</span><span class="operator">%&gt;%</span></span><br><span class="line">  arrange<span class="punctuation">(</span>desc<span class="punctuation">(</span>cum_confirm<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">dd <span class="operator">=</span> dd<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">40</span><span class="punctuation">,</span><span class="punctuation">]</span></span><br><span class="line">dd<span class="operator">$</span>country <span class="operator">=</span> factor<span class="punctuation">(</span>dd<span class="operator">$</span>country<span class="punctuation">,</span>levels <span class="operator">=</span> dd<span class="operator">$</span>country<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">dd<span class="operator">$</span>angle <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="number">40</span><span class="operator">*</span><span class="number">360</span><span class="operator">/</span><span class="number">40</span>	</span><br><span class="line">ggplot<span class="punctuation">(</span>dd<span class="punctuation">,</span>aes<span class="punctuation">(</span>country<span class="punctuation">,</span>cum_confirm<span class="punctuation">,</span>fill<span class="operator">=</span>cum_confirm<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_col<span class="punctuation">(</span>width <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>color <span class="operator">=</span> <span class="string">&#x27;grey90&#x27;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_col<span class="punctuation">(</span>aes<span class="punctuation">(</span>y<span class="operator">=</span>I<span class="punctuation">(</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span>width <span class="operator">=</span> <span class="number">1</span><span class="punctuation">,</span>fill <span class="operator">=</span> <span class="string">&#x27;white&#x27;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_y_log10<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_fill_gradientn<span class="punctuation">(</span>colors<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;darkgreen&quot;</span><span class="punctuation">,</span><span class="string">&quot;green&quot;</span><span class="punctuation">,</span><span class="string">&quot;orange&quot;</span><span class="punctuation">,</span><span class="string">&quot;firebrick&quot;</span><span class="punctuation">,</span><span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>trans<span class="operator">=</span><span class="string">&quot;log&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>label<span class="operator">=</span>paste<span class="punctuation">(</span>country<span class="punctuation">,</span>cum_confirm<span class="punctuation">,</span>sep <span class="operator">=</span><span class="string">&quot;\n&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                y <span class="operator">=</span> cum_confirm<span class="operator">*</span><span class="number">.8</span><span class="punctuation">,</span>angle<span class="operator">=</span>angle<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">            data<span class="operator">=</span><span class="keyword">function</span><span class="punctuation">(</span>d<span class="punctuation">)</span>d<span class="punctuation">[</span>d<span class="operator">$</span>cum_confirm <span class="operator">&gt;</span> <span class="number">100</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            color <span class="operator">=</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span>fontface <span class="operator">=</span> <span class="string">&quot;bold&quot;</span><span class="punctuation">,</span> vjust <span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  geom_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>label <span class="operator">=</span> paste0<span class="punctuation">(</span>cum_confirm<span class="punctuation">,</span><span class="string">&quot;例&quot;</span><span class="punctuation">,</span>country<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                y <span class="operator">=</span> cum_confirm <span class="operator">*</span><span class="number">2</span><span class="punctuation">,</span> angle <span class="operator">=</span> angle<span class="operator">+</span><span class="number">90</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">            data <span class="operator">=</span> <span class="keyword">function</span><span class="punctuation">(</span>d<span class="punctuation">)</span> d<span class="punctuation">[</span>d<span class="operator">$</span>cum_confirm <span class="operator">&lt;</span> <span class="number">100</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            vjust <span class="operator">=</span> <span class="number">0</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  coord_polar<span class="punctuation">(</span>direction <span class="operator">=</span> <span class="operator">-</span><span class="number">1</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme_void<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  theme<span class="punctuation">(</span>legend.position <span class="operator">=</span> <span class="string">&quot;none&quot;</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<p><strong>画cog注释的玫瑰图</strong></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#载入绘图包</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#导入绘图数据</span></span><br><span class="line">f<span class="operator">&lt;-</span>read.table<span class="punctuation">(</span><span class="string">&quot;cog_lab&quot;</span><span class="punctuation">,</span> header<span class="operator">=</span><span class="built_in">T</span><span class="punctuation">,</span> sep<span class="operator">=</span><span class="string">&quot;\t&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#对图例标签进行处理</span></span><br><span class="line">myLabel <span class="operator">=</span> as.vector<span class="punctuation">(</span>f<span class="operator">$</span>lab<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#根据数据计算每个功能分类所占的比例并添加到图例标签中</span></span><br><span class="line">myLabel <span class="operator">=</span> paste<span class="punctuation">(</span>myLabel<span class="punctuation">,</span> <span class="string">&quot; (&quot;</span><span class="punctuation">,</span> <span class="built_in">round</span><span class="punctuation">(</span>f<span class="operator">$</span>mag <span class="operator">/</span> <span class="built_in">sum</span><span class="punctuation">(</span>f<span class="operator">$</span>mag<span class="punctuation">)</span> <span class="operator">*</span> <span class="number">100</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&quot;%) &quot;</span><span class="punctuation">,</span> sep <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#绘制图像</span></span><br><span class="line">p<span class="operator">&lt;-</span>ggplot<span class="punctuation">(</span>f<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>dir<span class="punctuation">,</span> y<span class="operator">=</span>factor<span class="punctuation">(</span>mag<span class="punctuation">)</span><span class="punctuation">,</span> fill<span class="operator">=</span>dir<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">geom_bar<span class="punctuation">(</span>stat<span class="operator">=</span><span class="string">&#x27;identity&#x27;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">coord_polar<span class="punctuation">(</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">labs<span class="punctuation">(</span>x <span class="operator">=</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="string">&quot;Number of Unigenes&quot;</span><span class="punctuation">,</span> title <span class="operator">=</span> <span class="string">&quot;COG Function Classification of Unigene Sequence&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>axis.ticks <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>legend.title <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">theme<span class="punctuation">(</span>panel.background<span class="operator">=</span>element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">scale_fill_discrete<span class="punctuation">(</span>breaks <span class="operator">=</span> f<span class="operator">$</span>dir<span class="punctuation">,</span> labels <span class="operator">=</span> myLabel<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#图像输出</span></span><br><span class="line">png<span class="punctuation">(</span><span class="string">&quot;COG.png&quot;</span><span class="punctuation">,</span>width <span class="operator">=</span> <span class="number">8200</span><span class="punctuation">,</span>height <span class="operator">=</span> <span class="number">5400</span><span class="punctuation">,</span>res <span class="operator">=</span> <span class="number">600</span><span class="punctuation">,</span>type <span class="operator">=</span> <span class="string">&quot;cairo&quot;</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line">dev.off<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="制作六边形logo">制作六边形Logo</h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">library<span class="punctuation">(</span>hexSticker<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>ggstar<span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>x <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="number">3</span><span class="punctuation">)</span><span class="punctuation">,</span> y <span class="operator">=</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">3</span><span class="punctuation">,</span> each <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span></span><br><span class="line">                                               len <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span><span class="punctuation">,</span> group <span class="operator">=</span> <span class="built_in">letters</span><span class="punctuation">[</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">12</span><span class="punctuation">)</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">p <span class="operator">&lt;-</span> ggplot<span class="punctuation">(</span>data<span class="operator">=</span>iris<span class="punctuation">,</span> aes<span class="punctuation">(</span>x<span class="operator">=</span>Sepal.Length<span class="punctuation">,</span>y<span class="operator">=</span>Sepal.Width<span class="punctuation">,</span></span><br><span class="line">                           starshape<span class="operator">=</span>Species<span class="punctuation">,</span> fill<span class="operator">=</span>Species<span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> geom_star<span class="punctuation">(</span>show.legend<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">1.8</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  scale_fill_manual<span class="punctuation">(</span>values<span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#66C2A5&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#FC8D62&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#8DA0CB&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line">p <span class="operator">&lt;-</span> p <span class="operator">+</span> theme_void<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span> theme<span class="punctuation">(</span>axis.line.x.bottom <span class="operator">=</span> element_line<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&quot;white&quot;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">0.22</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                              axis.line.y.left <span class="operator">=</span> element_line<span class="punctuation">(</span>color<span class="operator">=</span><span class="string">&quot;white&quot;</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">0.22</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span> theme_transparent<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">p</span><br><span class="line">sticker<span class="punctuation">(</span>p<span class="punctuation">,</span> package<span class="operator">=</span><span class="string">&quot;ggstar&quot;</span><span class="punctuation">,</span> p_size<span class="operator">=</span><span class="number">14</span><span class="punctuation">,</span> s_x<span class="operator">=</span><span class="number">1</span><span class="punctuation">,</span> s_y<span class="operator">=</span><span class="number">.75</span><span class="punctuation">,</span> s_width<span class="operator">=</span><span class="number">1.3</span><span class="punctuation">,</span> s_height<span class="operator">=</span><span class="number">0.68</span><span class="punctuation">,</span></span><br><span class="line">        h_fill<span class="operator">=</span><span class="string">&quot;black&quot;</span><span class="punctuation">,</span> h_color<span class="operator">=</span><span class="string">&quot;#B3B3B3&quot;</span><span class="punctuation">,</span> p_color<span class="operator">=</span><span class="string">&quot;#FFDF00&quot;</span><span class="punctuation">,</span></span><br><span class="line">        filename<span class="operator">=</span><span class="string">&quot;ggstarlog.png&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#package指的是输入字体 p_color字体颜色 h_color边框颜色 h_fill背景</span></span><br></pre></td></tr></table></figure>
<h3 id="chord-diagram">Chord diagram</h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#http://houyun.xyz/post/2019/12/08/chord-diagram/</span></span><br><span class="line"><span class="keyword">if</span><span class="punctuation">(</span><span class="operator">!</span>require<span class="punctuation">(</span>devtools<span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">  install.packages<span class="punctuation">(</span>devtools<span class="punctuation">)</span></span><br><span class="line">devtools<span class="operator">::</span>install_github<span class="punctuation">(</span><span class="string">&quot;houyunhuang/nivochord&quot;</span><span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>nivochord<span class="punctuation">)</span></span><br><span class="line">nivochord<span class="punctuation">(</span>data.matrix<span class="punctuation">(</span>mtcars<span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">8</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">8</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="built_in">LETTERS</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">8</span><span class="punctuation">]</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#第一个参数是类矩阵的数据，需要是行列数相等，且都是数值型，</span></span><br><span class="line"><span class="comment">#第二个参数keys是每个类的名称，若为NULL，赋值为第一个参数的行名或者列名。</span></span><br><span class="line">library<span class="punctuation">(</span>RColorBrewer<span class="punctuation">)</span></span><br><span class="line">m <span class="operator">&lt;-</span> matrix<span class="punctuation">(</span>runif<span class="punctuation">(</span><span class="number">36</span><span class="punctuation">)</span><span class="punctuation">,</span> ncol <span class="operator">=</span> <span class="number">6</span><span class="punctuation">)</span></span><br><span class="line">rownames<span class="punctuation">(</span>m<span class="punctuation">)</span> <span class="operator">&lt;-</span> paste0<span class="punctuation">(</span><span class="string">&quot;row&quot;</span><span class="punctuation">,</span> <span class="number">1</span><span class="operator">:</span><span class="number">6</span><span class="punctuation">)</span></span><br><span class="line">col <span class="operator">&lt;-</span> brewer.pal<span class="punctuation">(</span><span class="number">3</span><span class="punctuation">,</span> <span class="string">&quot;Set2&quot;</span><span class="punctuation">)</span></span><br><span class="line">nivochord<span class="punctuation">(</span>m<span class="punctuation">,</span> colors <span class="operator">=</span> col<span class="punctuation">)</span></span><br><span class="line">nivochord<span class="punctuation">(</span>m<span class="punctuation">,</span> colors <span class="operator">=</span> col<span class="punctuation">,</span> innerRadiusRatio <span class="operator">=</span> <span class="number">0.8</span><span class="punctuation">)</span><span class="comment">#innerRadiusOffset = 0.05;innerRadiusOffset用来控制ribbon和圆环之间的距离，默认是0。</span></span><br><span class="line"><span class="comment">#innerRadiusRatio用来控制内部（ribbon）所在区域的比较，</span></span><br><span class="line"><span class="comment">#默认是0.9（即90%），这里我们设置成0.8，圆环宽度就相应的变大了。</span></span><br><span class="line"><span class="comment">#padAngle = 0.05 padAngle参数比较好玩，可以在每个小的圆环之间增加空白</span></span><br><span class="line"><span class="comment">#margin = .margin(90, 60, 10, 60)四个参数分别是下、左上、右四个方位的空白，单位是像素（px）。</span></span><br><span class="line">colors <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;red&quot;</span><span class="punctuation">,</span> <span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> <span class="string">&quot;yellow&quot;</span><span class="punctuation">)</span></span><br><span class="line">nivochord<span class="punctuation">(</span>m<span class="punctuation">,</span> colors <span class="operator">=</span> colors<span class="punctuation">,</span> legends <span class="operator">=</span> .legends<span class="punctuation">(</span>anchor <span class="operator">=</span> <span class="string">&quot;top&quot;</span><span class="punctuation">,</span></span><br><span class="line">                                                 translateY <span class="operator">=</span> <span class="operator">-</span><span class="number">45</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="maptree">Maptree</h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#导入otu表格</span></span><br><span class="line">otu <span class="operator">=</span> read.delim<span class="punctuation">(</span><span class="string">&quot;./otutab.txt&quot;</span><span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>otu<span class="punctuation">)</span></span><br><span class="line">otu <span class="operator">=</span> as.matrix<span class="punctuation">(</span>otu<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># str(otu)</span></span><br><span class="line"><span class="comment">#导入注释文件</span></span><br><span class="line">tax <span class="operator">=</span> read.delim<span class="punctuation">(</span><span class="string">&quot;./taxonomy.txt&quot;</span><span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="number">1</span><span class="punctuation">)</span></span><br><span class="line">head<span class="punctuation">(</span>tax<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#将物种注释文件转化为矩阵，方便使用phyloseq封装</span></span><br><span class="line">tax <span class="operator">=</span> as.matrix<span class="punctuation">(</span>tax<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#基本函数，画出maptree</span></span><br><span class="line">mapdata <span class="operator">=</span> data_to_maptree <span class="punctuation">(</span>otu<span class="punctuation">,</span>tax<span class="punctuation">,</span><span class="number">200</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">#参数N代表选取OTU的数量（按照丰度排序，选取丰度最高的前N个OTU做展示），这里我设置N = 200</span></span><br><span class="line"><span class="comment">#提取图形部分并保存</span></span><br><span class="line">p1<span class="operator">=</span> mapdata<span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line">p1</span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&quot;./maptree1.pdf&quot;</span><span class="punctuation">,</span> p1<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">12</span><span class="punctuation">,</span> height <span class="operator">=</span><span class="number">10</span> <span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#按照物种分类信息上色</span></span><br><span class="line"><span class="comment">#按照平均丰度修改大小和按照门水平上色颜色</span></span><br><span class="line">mapadd <span class="operator">=</span> maptree_add1_plot<span class="punctuation">(</span>mapdata<span class="punctuation">)</span></span><br><span class="line">p2 <span class="operator">=</span> mapadd<span class="punctuation">[[</span><span class="number">1</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line">p2</span><br><span class="line"><span class="comment">#d导出ggplot对象的优点就是可以随心所欲的修改图形上的内容</span></span><br><span class="line">p2 <span class="operator">+</span>scale_fill_brewer<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment"># p2 + scale_color_gradient2()</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&quot;./maptree.pdf&quot;</span><span class="punctuation">,</span> p2<span class="punctuation">,</span> width <span class="operator">=</span> <span class="number">12</span><span class="punctuation">,</span> height <span class="operator">=</span><span class="number">10</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ggraph版本的物种分类树</span></span><br><span class="line">graph <span class="operator">=</span> mapadd<span class="punctuation">[[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#展示物种分类关系</span></span><br><span class="line">ggraph<span class="punctuation">(</span>graph<span class="punctuation">,</span> <span class="string">&#x27;dendrogram&#x27;</span><span class="punctuation">,</span> circular <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_edge_elbow<span class="punctuation">(</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   scale_edge_colour_distiller<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;RdPu&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_node_point<span class="punctuation">(</span>aes<span class="punctuation">(</span> x <span class="operator">=</span> x<span class="punctuation">,</span> y<span class="operator">=</span>y<span class="punctuation">,</span> filter <span class="operator">=</span> leaf<span class="punctuation">,</span>size<span class="operator">=</span>mean<span class="punctuation">,</span>colour<span class="operator">=</span>Phylum<span class="punctuation">,</span> alpha<span class="operator">=</span><span class="number">0.2</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_node_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> x<span class="operator">*</span><span class="number">1.05</span><span class="punctuation">,</span> y<span class="operator">=</span>y<span class="operator">*</span><span class="number">1.05</span><span class="punctuation">,</span> filter <span class="operator">=</span> leaf<span class="punctuation">,</span> label<span class="operator">=</span>name<span class="punctuation">,</span></span><br><span class="line">   hjust<span class="operator">=</span><span class="string">&#x27;outward&#x27;</span><span class="punctuation">,</span> angle <span class="operator">=</span> <span class="operator">-</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="operator">-</span>node_angle<span class="punctuation">(</span>x<span class="punctuation">,</span> y<span class="punctuation">)</span><span class="operator">+</span><span class="number">90</span><span class="punctuation">)</span><span class="operator">%%</span><span class="number">180</span><span class="punctuation">)</span><span class="operator">+</span><span class="number">90</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">   colour<span class="operator">=</span>Phylum<span class="punctuation">)</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">0.8</span><span class="punctuation">,</span> alpha<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span>  <span class="operator">+</span> theme_void<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#另一种形式</span></span><br><span class="line">graph <span class="operator">=</span> mapadd<span class="punctuation">[[</span><span class="number">2</span><span class="punctuation">]</span><span class="punctuation">]</span></span><br><span class="line"><span class="comment"># data = create_layout(graph, layout = &#x27;dendrogram&#x27;, circular = TRUE)</span></span><br><span class="line"><span class="comment"># head(data)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#展示为无数种分类树，这种方式也是我知道</span></span><br><span class="line">ggraph<span class="punctuation">(</span>graph<span class="punctuation">,</span> layout <span class="operator">=</span> <span class="string">&#x27;dendrogram&#x27;</span><span class="punctuation">,</span> circular <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   geom_edge_diagonal<span class="punctuation">(</span>colour<span class="operator">=</span><span class="string">&quot;blue&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">   scale_edge_colour_distiller<span class="punctuation">(</span>palette <span class="operator">=</span> <span class="string">&quot;RdPu&quot;</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_node_point<span class="punctuation">(</span>aes<span class="punctuation">(</span> x <span class="operator">=</span> x<span class="punctuation">,</span> y<span class="operator">=</span>y<span class="punctuation">,</span> filter <span class="operator">=</span> leaf<span class="punctuation">,</span>size<span class="operator">=</span>mean<span class="punctuation">,</span>colour<span class="operator">=</span>Phylum<span class="punctuation">,</span> alpha<span class="operator">=</span><span class="number">0.2</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="operator">+</span></span><br><span class="line">  geom_node_text<span class="punctuation">(</span>aes<span class="punctuation">(</span>x <span class="operator">=</span> x<span class="operator">*</span><span class="number">1.05</span><span class="punctuation">,</span> y<span class="operator">=</span>y<span class="operator">*</span><span class="number">1.05</span><span class="punctuation">,</span> filter <span class="operator">=</span> leaf<span class="punctuation">,</span> label<span class="operator">=</span>name<span class="punctuation">,</span></span><br><span class="line">   hjust<span class="operator">=</span><span class="string">&#x27;outward&#x27;</span><span class="punctuation">,</span> angle <span class="operator">=</span> <span class="operator">-</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="operator">-</span>node_angle<span class="punctuation">(</span>x<span class="punctuation">,</span> y<span class="punctuation">)</span><span class="operator">+</span><span class="number">90</span><span class="punctuation">)</span><span class="operator">%%</span><span class="number">180</span><span class="punctuation">)</span><span class="operator">+</span><span class="number">90</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">3</span><span class="punctuation">,</span></span><br><span class="line">   colour<span class="operator">=</span>Phylum<span class="punctuation">)</span><span class="punctuation">,</span> size<span class="operator">=</span><span class="number">0.5</span><span class="punctuation">,</span> alpha<span class="operator">=</span><span class="number">1</span><span class="punctuation">)</span>  <span class="operator">+</span> theme_void<span class="punctuation">(</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="3d柱状图">3D柱状图</h3>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">set.seed<span class="punctuation">(</span><span class="number">1234</span><span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span>a <span class="operator">=</span> sample<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">50</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                                       b <span class="operator">=</span> sample<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">50</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                                       <span class="built_in">c</span> <span class="operator">=</span> sample<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">50</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                                       d <span class="operator">=</span> sample<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">50</span><span class="punctuation">,</span> <span class="number">10</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">rownames<span class="punctuation">(</span>data<span class="punctuation">)</span> <span class="operator">&lt;-</span> <span class="built_in">LETTERS</span><span class="punctuation">[</span><span class="number">1</span><span class="operator">:</span><span class="number">10</span><span class="punctuation">]</span></span><br><span class="line">library<span class="punctuation">(</span>rgl<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>barplot3d<span class="punctuation">)</span></span><br><span class="line">library<span class="punctuation">(</span>RColorBrewer<span class="punctuation">)</span></span><br><span class="line">install.packages<span class="punctuation">(</span><span class="string">&#x27;barplot3d&#x27;</span><span class="punctuation">)</span></span><br><span class="line">barplot3d<span class="punctuation">(</span>rows <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> cols <span class="operator">=</span> <span class="number">4</span><span class="punctuation">,</span> <span class="comment">#先根据数据构造一个画图矩阵</span></span><br><span class="line">                    <span class="comment">#画图要用的数据，必须是matrix类型</span></span><br><span class="line">                  z <span class="operator">=</span> data <span class="operator">%&gt;%</span> as.matrix<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="comment">#展示角度，正面观</span></span><br><span class="line">                    theta<span class="operator">=</span><span class="number">30</span><span class="punctuation">,</span></span><br><span class="line">                   <span class="comment">#展示角度，顶面观（出的图是可旋转的，所以这些都无关紧要）</span></span><br><span class="line">                    phi<span class="operator">=</span><span class="number">30</span><span class="punctuation">,</span></span><br><span class="line">                  <span class="comment">#调整出图的高矮胖瘦的，挺重要！</span></span><br><span class="line">                    scalexy<span class="operator">=</span><span class="number">20</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="comment">#柱子（什么鬼）的侧面颜色，可调整透明度</span></span><br><span class="line">                    sidecolors<span class="operator">=</span>brewer.pal<span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span><span class="string">&quot;Dark2&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> alpha<span class="operator">=</span><span class="number">0.4</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="comment">#顶面颜色</span></span><br><span class="line">                    topcolors <span class="operator">=</span> brewer.pal<span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span><span class="string">&quot;Dark2&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="comment">#x轴刻度标注，向量形式</span></span><br><span class="line">                    xlabels <span class="operator">=</span> colnames<span class="punctuation">(</span>data<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="comment">#y轴刻度标注，向量形式</span></span><br><span class="line">                    ylabels <span class="operator">=</span> rownames<span class="punctuation">(</span>data<span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">                   <span class="comment">#z轴刻度，逻辑值</span></span><br><span class="line">                    zlabels <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#再用barplot包里的测试数据画个“乐高图”</span></span><br><span class="line">x<span class="operator">=</span>system.file<span class="punctuation">(</span><span class="string">&quot;extdata&quot;</span><span class="punctuation">,</span> <span class="string">&quot;signature_probabilities.txt&quot;</span><span class="punctuation">,</span> package <span class="operator">=</span> <span class="string">&quot;barplot3d&quot;</span><span class="punctuation">)</span></span><br><span class="line">sigdata<span class="operator">=</span>read.table<span class="punctuation">(</span>x<span class="punctuation">,</span>header<span class="operator">=</span><span class="literal">TRUE</span><span class="punctuation">,</span>stringsAsFactors <span class="operator">=</span> <span class="literal">FALSE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Plot signature 2 without axis labels, with Sanger colors and some transparency so we can see all bars</span></span><br><span class="line">legoplot3d<span class="punctuation">(</span>contextdata<span class="operator">=</span>sigdata<span class="operator">$</span>Signature_7<span class="punctuation">,</span></span><br><span class="line">                      labels<span class="operator">=</span><span class="literal">FALSE</span><span class="punctuation">,</span></span><br><span class="line">                       scalexy<span class="operator">=</span><span class="number">0.01</span><span class="punctuation">,</span></span><br><span class="line">                      sixcolors<span class="operator">=</span><span class="string">&quot;sanger&quot;</span><span class="punctuation">,</span></span><br><span class="line">                       alpha<span class="operator">=</span><span class="number">0.4</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>
<h3 id="dotplot气球图">Dotplot气球图</h3>
<p><a href="http://rpkgs.datanovia.com/ggpubr/reference/ggballoonplot.html">balloonplot</a></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#第一种就是简单的用ggplot画的散点图</span></span><br><span class="line">setwd<span class="punctuation">(</span><span class="string">&#x27;./Script/Dot_plot/&#x27;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载ggplot2包</span></span><br><span class="line">library<span class="punctuation">(</span>ggplot2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#读入数据</span></span><br><span class="line">dt<span class="operator">&lt;-</span>read.table<span class="punctuation">(</span><span class="string">&quot;testdata.txt&quot;</span><span class="punctuation">,</span>sep <span class="operator">=</span> <span class="string">&quot;\t&quot;</span><span class="punctuation">,</span>header <span class="operator">=</span> <span class="built_in">T</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看数据框dt的前6行</span></span><br><span class="line">head<span class="punctuation">(</span>dt<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#加载reshape2包</span></span><br><span class="line">library<span class="punctuation">(</span>reshape2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#将“宽型”数据框转成“长型”数据框</span></span><br><span class="line">dt2<span class="operator">&lt;-</span>melt<span class="punctuation">(</span>dt<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看数据框dt2的前6行</span></span><br><span class="line">head<span class="punctuation">(</span>dt2<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#指定纵轴标签顺序</span></span><br><span class="line">dt2<span class="operator">$</span>Genus<span class="operator">&lt;-</span>factor<span class="punctuation">(</span>dt2<span class="operator">$</span>Genus<span class="punctuation">,</span>levels <span class="operator">=</span> rev<span class="punctuation">(</span>unique<span class="punctuation">(</span>dt2<span class="operator">$</span>Genus<span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span>ordered <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#绘制正方形“点”，带描边</span></span><br><span class="line">p1<span class="operator">&lt;-</span>ggplot<span class="punctuation">(</span>dt2<span class="punctuation">,</span> aes<span class="punctuation">(</span>variable<span class="punctuation">,</span> Genus<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>size<span class="operator">=</span>value<span class="punctuation">)</span><span class="punctuation">,</span>shape<span class="operator">=</span><span class="number">22</span><span class="punctuation">,</span>color<span class="operator">=</span><span class="string">&quot;steelblue&quot;</span><span class="punctuation">,</span>fill<span class="operator">=</span><span class="string">&quot;white&quot;</span><span class="punctuation">)</span></span><br><span class="line">p1</span><br><span class="line"></span><br><span class="line"><span class="comment">#绘制“圆点”，不带描边颜色</span></span><br><span class="line">p2<span class="operator">&lt;-</span>ggplot<span class="punctuation">(</span>dt2<span class="punctuation">,</span> aes<span class="punctuation">(</span>variable<span class="punctuation">,</span> Genus<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>size<span class="operator">=</span>value<span class="punctuation">)</span><span class="punctuation">,</span>shape<span class="operator">=</span><span class="number">16</span><span class="punctuation">,</span>color<span class="operator">=</span><span class="string">&quot;steelblue&quot;</span><span class="punctuation">)</span></span><br><span class="line">p2</span><br><span class="line"></span><br><span class="line"><span class="comment">#建立颜色与数据的关系,这里让不同的样本的点显示不同的颜色</span></span><br><span class="line">p3<span class="operator">&lt;-</span>ggplot<span class="punctuation">(</span>dt2<span class="punctuation">,</span> aes<span class="punctuation">(</span>variable<span class="punctuation">,</span> Genus<span class="punctuation">)</span><span class="punctuation">)</span><span class="operator">+</span>geom_point<span class="punctuation">(</span>aes<span class="punctuation">(</span>size<span class="operator">=</span>value<span class="punctuation">,</span>color<span class="operator">=</span>variable<span class="punctuation">)</span><span class="punctuation">,</span>shape<span class="operator">=</span><span class="number">16</span><span class="punctuation">)</span></span><br><span class="line">p3</span><br><span class="line"></span><br><span class="line"><span class="comment">#自定义颜色，这里使用RColorBrewer的颜色集</span></span><br><span class="line">p4<span class="operator">&lt;-</span>p3<span class="operator">+</span>scale_color_brewer<span class="punctuation">(</span>palette<span class="operator">=</span><span class="string">&quot;Dark2&quot;</span><span class="punctuation">)</span></span><br><span class="line">p4</span><br><span class="line"></span><br><span class="line"><span class="comment">#更改图表的主题，实现类似iTOL的点状图效果</span></span><br><span class="line">p5<span class="operator">&lt;-</span>p4<span class="operator">+</span>theme_minimal<span class="punctuation">(</span><span class="punctuation">)</span></span><br><span class="line">p5</span><br><span class="line"></span><br><span class="line"><span class="comment">#不想要网格线也可以去掉，甚至图例也可用legend.position = &quot;none&quot;去掉</span></span><br><span class="line">p6<span class="operator">&lt;-</span>p5<span class="operator">+</span>theme<span class="punctuation">(</span>panel.grid <span class="operator">=</span> element_blank<span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line">p6</span><br><span class="line"></span><br><span class="line"><span class="comment">#保存图表为pdf格式</span></span><br><span class="line">ggsave<span class="punctuation">(</span><span class="string">&quot;p6.pdf&quot;</span><span class="punctuation">,</span>width <span class="operator">=</span> <span class="number">4.4</span><span class="punctuation">,</span>height <span class="operator">=</span> <span class="number">6</span><span class="punctuation">,</span>units <span class="operator">=</span> <span class="string">&quot;in&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#第二种就是用ggpubr中的函数画气球图</span></span><br><span class="line">my_cols <span class="operator">&lt;-</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;#0D0887FF&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#6A00A8FF&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#B12A90FF&quot;</span><span class="punctuation">,</span></span><br><span class="line">             <span class="string">&quot;#E16462FF&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#FCA636FF&quot;</span><span class="punctuation">,</span> <span class="string">&quot;#F0F921FF&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>ggpubr<span class="punctuation">)</span></span><br><span class="line">data <span class="operator">&lt;-</span> read.delim<span class="punctuation">(</span></span><br><span class="line">  system.file<span class="punctuation">(</span><span class="string">&quot;demo-data/housetasks.txt&quot;</span><span class="punctuation">,</span> package <span class="operator">=</span> <span class="string">&quot;ggpubr&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  row.names <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">)</span></span><br><span class="line">data </span><br><span class="line">ggballoonplot<span class="punctuation">(</span>data<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#试试上述的图</span></span><br><span class="line">dt<span class="operator">%&gt;%</span>tibble<span class="operator">::</span>column_to_rownames<span class="punctuation">(</span><span class="string">&#x27;Genus&#x27;</span><span class="punctuation">)</span> <span class="operator">%&gt;%</span> ggballoonplot<span class="punctuation">(</span>.<span class="punctuation">,</span>fill <span class="operator">=</span> <span class="string">&quot;value&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_fill_gradientn<span class="punctuation">(</span>colors <span class="operator">=</span> my_cols<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#加上颜色</span></span><br><span class="line">ggballoonplot<span class="punctuation">(</span>data<span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;#0073C2FF&quot;</span><span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&quot;#0073C2FF&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Change color according to the value of table cells</span></span><br><span class="line">ggballoonplot<span class="punctuation">(</span>data<span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&quot;value&quot;</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  scale_fill_gradientn<span class="punctuation">(</span>colors <span class="operator">=</span> my_cols<span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Change the plotting symbol shape</span></span><br><span class="line">ggballoonplot<span class="punctuation">(</span>data<span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&quot;value&quot;</span><span class="punctuation">,</span>  shape <span class="operator">=</span> <span class="number">23</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  gradient_fill<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> <span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set points size to 8, but change fill color by values</span></span><br><span class="line"><span class="comment"># Sow labels</span></span><br><span class="line">ggballoonplot<span class="punctuation">(</span>data<span class="punctuation">,</span> fill <span class="operator">=</span> <span class="string">&quot;value&quot;</span><span class="punctuation">,</span> color <span class="operator">=</span> <span class="string">&quot;lightgray&quot;</span><span class="punctuation">,</span></span><br><span class="line">              size <span class="operator">=</span> <span class="number">10</span><span class="punctuation">,</span> show.label <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">)</span><span class="operator">+</span></span><br><span class="line">  gradient_fill<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;blue&quot;</span><span class="punctuation">,</span> <span class="string">&quot;white&quot;</span><span class="punctuation">,</span> <span class="string">&quot;red&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>ggplot</tag>
      </tags>
  </entry>
  <entry>
    <title>regression</title>
    <url>/2024/01/31/regression/</url>
    <content><![CDATA[<table>
<thead>
<tr>
<th>x</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr>
<td>1531</td>
<td>4320</td>
</tr>
<tr>
<td>2220</td>
<td>2262</td>
</tr>
<tr>
<td>1181</td>
<td>2141</td>
</tr>
<tr>
<td>4740</td>
<td>3840</td>
</tr>
<tr>
<td>4856</td>
<td>4116</td>
</tr>
</tbody>
</table>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 真正的函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">g</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.1</span> * (x ** <span class="number">3</span> + x ** <span class="number">2</span> + x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 随意准备一些向真正的函数加入了一点噪声的训练数据</span></span><br><span class="line">train_x = np.linspace(-<span class="number">2</span>, <span class="number">2</span>, <span class="number">8</span>)</span><br><span class="line">train_y = g(train_x) + np.random.randn(train_x.size) * <span class="number">0.05</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 标准化</span></span><br><span class="line">mu = train_x.mean()</span><br><span class="line">sigma = train_x.std()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standardize</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> (x - mu) / sigma</span><br><span class="line"></span><br><span class="line">train_z = standardize(train_x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建训练数据的矩阵</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_matrix</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> np.vstack([</span><br><span class="line">        np.ones(x.size),</span><br><span class="line">        x,</span><br><span class="line">        x ** <span class="number">2</span>,</span><br><span class="line">        x ** <span class="number">3</span>,</span><br><span class="line">        x ** <span class="number">4</span>,</span><br><span class="line">        x ** <span class="number">5</span>,</span><br><span class="line">        x ** <span class="number">6</span>,</span><br><span class="line">        x ** <span class="number">7</span>,</span><br><span class="line">        x ** <span class="number">8</span>,</span><br><span class="line">        x ** <span class="number">9</span>,</span><br><span class="line">        x ** <span class="number">10</span></span><br><span class="line">    ]).T</span><br><span class="line"></span><br><span class="line">X = to_matrix(train_z)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数初始化</span></span><br><span class="line">theta = np.random.randn(X.shape[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 预测函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> np.dot(x, theta)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">E</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.5</span> * np.<span class="built_in">sum</span>((y - f(x)) ** <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 正则化常量</span></span><br><span class="line">LAMBDA = <span class="number">0.5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 学习率</span></span><br><span class="line">ETA = <span class="number">1e-4</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 误差</span></span><br><span class="line">diff = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重复学习（不应用正则化）</span></span><br><span class="line">error = E(X, train_y)</span><br><span class="line"><span class="keyword">while</span> diff &gt; <span class="number">1e-6</span>:</span><br><span class="line">    theta = theta - ETA * (np.dot(f(X) - train_y, X))</span><br><span class="line"></span><br><span class="line">    current_error = E(X, train_y)</span><br><span class="line">    diff = error - current_error</span><br><span class="line">    error = current_error</span><br><span class="line"></span><br><span class="line">theta1 = theta</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重复学习（应用正则化）</span></span><br><span class="line">theta = np.random.randn(X.shape[<span class="number">1</span>])</span><br><span class="line">diff = <span class="number">1</span></span><br><span class="line">error = E(X, train_y)</span><br><span class="line"><span class="keyword">while</span> diff &gt; <span class="number">1e-6</span>:</span><br><span class="line">    reg_term = LAMBDA * np.hstack([<span class="number">0</span>, theta[<span class="number">1</span>:]])</span><br><span class="line">    theta = theta - ETA * (np.dot(f(X) - train_y, X) + reg_term)</span><br><span class="line"></span><br><span class="line">    current_error = E(X, train_y)</span><br><span class="line">    diff = error - current_error</span><br><span class="line">    error = current_error</span><br><span class="line"></span><br><span class="line">theta2 = theta</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘图确认</span></span><br><span class="line">plt.plot(train_z, train_y, <span class="string">&#x27;o&#x27;</span>)</span><br><span class="line">z = standardize(np.linspace(-<span class="number">2</span>, <span class="number">2</span>, <span class="number">100</span>))</span><br><span class="line">theta = theta1 <span class="comment"># 未应用正则化</span></span><br><span class="line">plt.plot(z, f(to_matrix(z)), linestyle=<span class="string">&#x27;dashed&#x27;</span>)</span><br><span class="line">theta = theta2 <span class="comment"># 应用正则化</span></span><br><span class="line">plt.plot(z, f(to_matrix(z)))</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读入训练数据</span></span><br><span class="line">train = np.loadtxt(<span class="string">&#x27;click.csv&#x27;</span>, delimiter=<span class="string">&#x27;,&#x27;</span>, dtype=<span class="string">&#x27;int&#x27;</span>, skiprows=<span class="number">1</span>)</span><br><span class="line">train_x = train[:,<span class="number">0</span>]</span><br><span class="line">train_y = train[:,<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 标准化</span></span><br><span class="line">mu = train_x.mean()</span><br><span class="line">sigma = train_x.std()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standardize</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> (x - mu) / sigma</span><br><span class="line"></span><br><span class="line">train_z = standardize(train_x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数初始化</span></span><br><span class="line">theta0 = np.random.rand()</span><br><span class="line">theta1 = np.random.rand()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 预测函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> theta0 + theta1 * x</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">E</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.5</span> * np.<span class="built_in">sum</span>((y - f(x)) ** <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 学习率</span></span><br><span class="line">ETA = <span class="number">1e-3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 误差的差值</span></span><br><span class="line">diff = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新次数</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 直到误差的差值小于 0.01 为止，重复参数更新</span></span><br><span class="line">error = E(train_z, train_y)</span><br><span class="line"><span class="keyword">while</span> diff &gt; <span class="number">1e-2</span>:</span><br><span class="line">    <span class="comment"># 更新结果保存到临时变量</span></span><br><span class="line">    tmp_theta0 = theta0 - ETA * np.<span class="built_in">sum</span>((f(train_z) - train_y))</span><br><span class="line">    tmp_theta1 = theta1 - ETA * np.<span class="built_in">sum</span>((f(train_z) - train_y) * train_z)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 更新参数</span></span><br><span class="line">    theta0 = tmp_theta0</span><br><span class="line">    theta1 = tmp_theta1</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算与上一次误差的差值</span></span><br><span class="line">    current_error = E(train_z, train_y)</span><br><span class="line">    diff = error - current_error</span><br><span class="line">    error = current_error</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 输出日志</span></span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    log = <span class="string">&#x27;第 &#123;&#125; 次 : theta0 = &#123;:.3f&#125;, theta1 = &#123;:.3f&#125;, 差值 = &#123;:.4f&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(log.<span class="built_in">format</span>(count, theta0, theta1, diff))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘图确认</span></span><br><span class="line">x = np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">100</span>)</span><br><span class="line">plt.plot(train_z, train_y, <span class="string">&#x27;o&#x27;</span>)</span><br><span class="line">plt.plot(x, f(x))</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读入训练数据</span></span><br><span class="line">train = np.loadtxt(<span class="string">&#x27;click.csv&#x27;</span>, delimiter=<span class="string">&#x27;,&#x27;</span>, dtype=<span class="string">&#x27;int&#x27;</span>, skiprows=<span class="number">1</span>)</span><br><span class="line">train_x = train[:,<span class="number">0</span>]</span><br><span class="line">train_y = train[:,<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 标准化</span></span><br><span class="line">mu = train_x.mean()</span><br><span class="line">sigma = train_x.std()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standardize</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> (x - mu) / sigma</span><br><span class="line"></span><br><span class="line">train_z = standardize(train_x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数初始化</span></span><br><span class="line">theta = np.random.rand(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建训练数据的矩阵</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_matrix</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> np.vstack([np.ones(x.size), x, x ** <span class="number">2</span>]).T</span><br><span class="line"></span><br><span class="line">X = to_matrix(train_z)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 预测函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> np.dot(x, theta)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">E</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0.5</span> * np.<span class="built_in">sum</span>((y - f(x)) ** <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 学习率</span></span><br><span class="line">ETA = <span class="number">1e-3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 误差的差值</span></span><br><span class="line">diff = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新次数</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 直到误差的差值小于 0.01 为止，重复参数更新</span></span><br><span class="line">error = E(X, train_y)</span><br><span class="line"><span class="keyword">while</span> diff &gt; <span class="number">1e-2</span>:</span><br><span class="line">    <span class="comment"># 更新结果保存到临时变量</span></span><br><span class="line">    theta = theta - ETA * np.dot(f(X) - train_y, X)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算与上一次误差的差值</span></span><br><span class="line">    current_error = E(X, train_y)</span><br><span class="line">    diff = error - current_error</span><br><span class="line">    error = current_error</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 输出日志</span></span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    log = <span class="string">&#x27;第 &#123;&#125; 次 : theta = &#123;&#125;, 差值 = &#123;:.4f&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(log.<span class="built_in">format</span>(count, theta, diff))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘图确认</span></span><br><span class="line">x = np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">100</span>)</span><br><span class="line">plt.plot(train_z, train_y, <span class="string">&#x27;o&#x27;</span>)</span><br><span class="line">plt.plot(x, f(to_matrix(x)))</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读入训练数据</span></span><br><span class="line">train = np.loadtxt(<span class="string">&#x27;click.csv&#x27;</span>, delimiter=<span class="string">&#x27;,&#x27;</span>, dtype=<span class="string">&#x27;int&#x27;</span>, skiprows=<span class="number">1</span>)</span><br><span class="line">train_x = train[:,<span class="number">0</span>]</span><br><span class="line">train_y = train[:,<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 标准化</span></span><br><span class="line">mu = train_x.mean()</span><br><span class="line">sigma = train_x.std()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">standardize</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> (x - mu) / sigma</span><br><span class="line"></span><br><span class="line">train_z = standardize(train_x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 参数初始化</span></span><br><span class="line">theta = np.random.rand(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建训练数据的矩阵</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">to_matrix</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> np.vstack([np.ones(x.size), x, x ** <span class="number">2</span>]).T</span><br><span class="line"></span><br><span class="line">X = to_matrix(train_z)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 预测函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> np.dot(x, theta)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 均方误差</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MSE</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">return</span> (<span class="number">1</span> / x.shape[<span class="number">0</span>]) * np.<span class="built_in">sum</span>((y - f(x)) ** <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 学习率</span></span><br><span class="line">ETA = <span class="number">1e-3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 误差的差值</span></span><br><span class="line">diff = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 更新次数</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重复学习</span></span><br><span class="line">error = MSE(X, train_y)</span><br><span class="line"><span class="keyword">while</span> diff &gt; <span class="number">1e-2</span>:</span><br><span class="line">    <span class="comment"># 使用随机梯度下降法更新参数</span></span><br><span class="line">    p = np.random.permutation(X.shape[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">for</span> x, y <span class="keyword">in</span> <span class="built_in">zip</span>(X[p,:], train_y[p]):</span><br><span class="line">        theta = theta - ETA * (f(x) - y) * x</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算与上一次误差的差值</span></span><br><span class="line">    current_error = MSE(X, train_y)</span><br><span class="line">    diff = error - current_error</span><br><span class="line">    error = current_error</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 输出日志</span></span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    log = <span class="string">&#x27;第 &#123;&#125; 次 : theta = &#123;&#125;, 差值 = &#123;:.4f&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(log.<span class="built_in">format</span>(count, theta, diff))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘图确认</span></span><br><span class="line">x = np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">100</span>)</span><br><span class="line">plt.plot(train_z, train_y, <span class="string">&#x27;o&#x27;</span>)</span><br><span class="line">plt.plot(x, f(to_matrix(x)))</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>regression</tag>
      </tags>
  </entry>
  <entry>
    <title>通俗理解LDA主题模</title>
    <url>/2023/08/31/%E9%80%9A%E4%BF%97%E7%90%86%E8%A7%A3LDA%E4%B8%BB%E9%A2%98%E6%A8%A1/</url>
    <content><![CDATA[<p>[TOC]</p>
<h1>前言</h1>
<p><strong>[转自] <a href="https://blog.csdn.net/v_july_v/article/details/41209515#t14">https://blog.csdn.net/v_july_v/article/details/41209515#t14</a></strong></p>
<p>这篇博客清楚的交代了LDA主题建模所需要的框架，后面更是以很通俗的语言进行了描述，让初学者对LDA主题建模有了更直观的了解。</p>
<p>不足之处是，关于概率部分依然是公式先行，让人云里雾里。尤其是非数学/计算机专业的人摸不着头脑。本人有幸，学过概率和统计、数学分析等课程不错，以后会出一个系列，通俗的讲解这部分。</p>
<p>目前正在做基因组，发现基因组和文本有很多相似之处。本着最朴素的想法（模仿），将文本处理中新算法应用到基因组处理，于是开启了长征。从百度lattice parsing开发了新冠疫苗，一路找到了enbadding，TF-IDF，Bert、LDA分布，LDA主题模型，以及bertipic，确实很受启发。</p>
<p>最后补充一句：自然语言处理的思想和算法确实领先于基因组处理算法。</p>
<h1>通俗理解LDA主题模</h1>
<p>LDA，可以分为下述5个步骤：</p>
<ol>
<li>一个函数：gamma函数</li>
<li>四个分布：二项分布、多项分布、beta分布、Dirichlet分布</li>
<li>一个概念和一个理念：共轭先验和贝叶斯框架</li>
<li>两个模型：pLSA、LDA</li>
<li>一个采样：Gibbs采样</li>
</ol>
<h2 id="gamma函数">gamma函数</h2>
<h3 id="整体把握lda">整体把握LDA</h3>
<p>关于LDA有两种含义，一种是线性判别分析（Linear Discriminant Analysis），一种是概率主题模型：隐含狄利克雷分布（Latent Dirichlet Allocation，简称LDA），本文讲后者。</p>
<p>另外，我先简单说下LDA的整体思想，不然我怕你看了半天，铺了太长的前奏，却依然因没见到LDA的影子而显得“心浮气躁”，导致不想再继续看下去。所以，先给你吃一颗定心丸，明白整体框架后，咱们再一步步抽丝剥茧，展开来论述。</p>
<p>按照wiki上的介绍，LDA由Blei, David M.、Ng, Andrew Y.、Jordan于2003年提出，是一种<a href="http://zh.wikipedia.org/wiki/%E4%B8%BB%E9%A2%98%E6%A8%A1%E5%9E%8B">主题模型</a>，它可以<strong>将文档集 中每篇文档的主题以概率分布的形式给出</strong>，从而通过分析一些文档抽取出它们的主题（分布）出来后，便可以根据主题（分布）进行主题聚类或文本分类。同时，它是一种典型的词袋模型，即一篇文档是由一组词构成，词与词之间没有先后顺序的关系。</p>
<p>此外，一篇文档可以包含多个主题，文档中每一个词都由其中的一个主题生成。</p>
<p>人类是怎么生成文档的呢？LDA的这三位作者在原始论文中给了一个简单的例子。比如假设事先给定了这几个主题：Arts、Budgets、Children、Education，然后通过学习训练，获取每个主题Topic对应的词语。如下图所示：</p>
<p><img src="https://img-blog.csdn.net/20141117153816148" alt="img"></p>
<p>然后以一定的概率选取上述某个主题，再以一定的概率选取那个主题下的某个单词，不断的重复这两步，最终生成如下图所示的一篇文章（其中不同颜色的词语分别对应上图中不同主题下的词）：</p>
<p><img src="https://img-blog.csdn.net/20141117154035285" alt="img"></p>
<p>而当我们看到一篇文章后，往往喜欢推测这篇文章是如何生成的，我们可能会认为作者先确定这篇文章的几个主题，然后围绕这几个主题遣词造句，表达成文。</p>
<p>LDA就是要干这事：<strong>根据给定的一篇文档，反推其主题分布</strong>。</p>
<p>通俗来说，可以假定认为<strong>人类是根据上述文档生成过程写成了各种各样的文章，现在某小撮人想让计算机利用LDA干一件事：你计算机给我推测分析网络上各篇文章分别都写了些啥主题，且各篇文章中各个主题出现的概率大小（主题分布）是啥</strong>。</p>
<p>然，就是这么一个看似普通的LDA，一度吓退了不少想深入探究其内部原理的初学者。难在哪呢，难就难在LDA内部涉及到的数学知识点太多了。</p>
<p>在LDA模型中，一篇文档生成的方式如下：</p>
<ul>
<li>
<p>从狄利克雷分布<img src="https://img-blog.csdn.net/20141117160438989" alt="img">中取样生成文档 i 的主题分布<img src="https://img-blog.csdn.net/20141117160452327" alt="img"></p>
</li>
<li>
<p>从主题的多项式分布<img src="https://img-blog.csdn.net/20141117160452327" alt="img">中取样生成文档i第 j 个词的主题<img src="https://img-blog.csdn.net/20141117160518098" alt="img"></p>
</li>
<li>
<p>从狄利克雷分布<img src="https://img-blog.csdn.net/20141117160531515" alt="img">中取样生成主题<img src="https://img-blog.csdn.net/20141117160518098" alt="img">对应的词语分布<img src="https://img-blog.csdn.net/20141117160613962" alt="img"></p>
</li>
<li>
<p>从词语的多项式分布<img src="https://img-blog.csdn.net/20141117160613962" alt="img">中采样最终生成词语<img src="https://img-blog.csdn.net/20141117160656067" alt="img"></p>
<p>其中，类似Beta分布是二项式分布的共轭先验概率分布，而狄利克雷分布（Dirichlet分布）是多项式分布的共轭先验概率分布。</p>
<p>此外，LDA的图模型结构如下图所示（类似<a href="http://blog.csdn.net/v_july_v/article/details/40984699#t6">贝叶斯网络</a>结构）：</p>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141117152903751" alt="img"></p>
<p>恩，不错，短短6句话整体概括了整个LDA的主体思想！但也就是上面短短6句话，却接连不断或重复出现了二项分布、多项式分布、beta分布、狄利克雷分布（Dirichlet分布）、共轭先验概率分布、取样，那么请问，这些都是啥呢？</p>
<p>这里先简单解释下二项分布、多项分布、beta分布、Dirichlet 分布这4个分布。</p>
<ul>
<li>
<p><strong>二项分布（Binomial distribution）</strong>。</p>
<p>二项分布是从伯努利分布推进的。伯努利分布，又称两点分布或0-1分布，是一个离散型的随机分布，其中的随机变量只有两类取值，非正即负{+，-}。而二项分布即重复n次的伯努利试验，记为 <img src="https://img-blog.csdn.net/20141213220758218" alt="img">。简言之，只做一次实验，是伯努利分布，重复做了n次，是二项分布。二项分布的概率密度函数为：</p>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141117234739906" alt="img"></p>
<p>对于k = 0, 1, 2, …, n，其中的<img src="https://img-blog.csdn.net/20141118110903312" alt="img">是二项式系数（这就是二项分布的名称的由来），又记为<img src="https://img-blog.csdn.net/20141213220516940" alt="img">。回想起高中所学的那丁点概率知识了么：想必你当年一定死记过这个二项式系数<img src="https://img-blog.csdn.net/20141213220516940" alt="img">就是<img src="https://img-blog.csdn.net/20141126120105034" alt="img">。</p>
<ul>
<li>
<p><strong>多项分布，是二项分布扩展到多维的情况</strong>。</p>
<p>多项分布是指单次试验中的随机变量的取值不再是0-1的，而是有多种离散值可能（1,2,3…,k）。比如投掷6个面的骰子实验，N次实验结果服从K=6的多项分布。其中</p>
</li>
</ul>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141117235427677" alt="img"></p>
</blockquote>
<p>多项分布的概率密度函数为：</p>
<p><img src="https://img-blog.csdn.net/20141117235452512" alt="img"></p>
<ul>
<li>
<p><strong>Beta分布，二项分布的共轭先验分布</strong>。</p>
<p>给定参数<img src="https://img-blog.csdn.net/20141117235016719" alt="img">和<img src="https://img-blog.csdn.net/20141117235020968" alt="img">，取值范围为[0,1]的随机变量 x 的概率密度函数：</p>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141117235056953" alt="img"></p>
<p>其中：</p>
<p><img src="https://img-blog.csdn.net/20141117235115532" alt="img">，<img src="https://img-blog.csdn.net/20141117235123035" alt="img">。</p>
<p>注：<img src="https://img-blog.csdn.net/20141117175537939" alt="img">便是所谓的gamma函数，下文会具体阐述。</p>
<ul>
<li>
<p><strong>Dirichlet分布，是beta分布在高维度上的推广</strong>。</p>
<p>Dirichlet分布的的密度函数形式跟beta分布的密度函数如出一辙：</p>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141117235506350" alt="img"></p>
<p>其中</p>
<p><img src="https://img-blog.csdn.net/20141117235524695" alt="img"></p>
<p>至此，我们可以看到<strong>二项分布和多项分布</strong>很相似，<strong>Beta分布和Dirichlet 分布</strong>很相似，而至于**“<strong>Beta分布是二项式分布的共轭先验概率分布，而狄利克雷分布（Dirichlet分布）是多项式分布的共轭先验概率分布</strong>”**这点在下文中说明。</p>
<p>OK，接下来，咱们就按照本文开头所说的思路：“一个函数：gamma函数，四个分布：二项分布、多项分布、beta分布、Dirichlet分布，外加一个概念和一个理念：共轭先验和贝叶斯框架，两个模型：pLSA、LDA（文档-主题，主题-词语），一个采样：Gibbs采样”一步步详细阐述，争取给读者一个尽量清晰完整的LDA。</p>
<p>（当然，如果你不想深究背后的细节原理，只想整体把握LDA的主体思想，可直接跳到本文<a href="http://blog.csdn.net/v_july_v/article/details/41209515#t13"><strong>第4 部分</strong></a>，看完第4部分后，若还是想深究背后的细节原理，可再回到此处开始看）</p>
<h3 id="gamma函数">gamma函数</h3>
<p>咱们先来考虑一个问题（此问题1包括下文的问题2-问题4皆取材自LDA数学八卦）：</p>
<ol>
<li><strong>问题1</strong> 随机变量<img src="https://img-blog.csdn.net/20141117171124858" alt="img"></li>
<li>把这n 个随机变量排序后得到顺序统计量<img src="https://img-blog.csdn.net/20141117171142782" alt="img"></li>
<li>然后请问<img src="https://img-blog.csdn.net/20141117171153983" alt="img">的分布是什么。</li>
</ol>
<p>为解决这个问题，可以尝试计算<img src="https://img-blog.csdn.net/20141117171153983" alt="img">落在区间[x,x+Δx]的概率。即求下述式子的值：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141117171416755" alt="img"></p>
</blockquote>
<p>首先，把 [0,1] 区间分成三段 [0,x)，[x,x+Δx]，(x+Δx,1]，然后考虑下简单的情形：即假设n 个数中只有1个落在了区间 [x,x+Δx]内，由于这个区间内的数X(k)是第k大的，所以[0,x)中应该有 k−1 个数，(x+Δx,1] 这个区间中应该有n−k 个数。如下图所示：</p>
<p><img src="https://img-blog.csdn.net/20141117171917031" alt="img"></p>
<p>从而问题转换为下述事件E：</p>
<p><img src="https://img-blog.csdn.net/20141117172536573" alt="img"></p>
<p>对于上述事件E，有：</p>
<p><img src="https://img-blog.csdn.net/20141117172713937" alt="img"></p>
<p>其中，o(Δx)表示Δx的高阶无穷小。显然，由于不同的排列组合，即n个数中有一个落在 [x,x+Δx]区间的有n种取法，余下n−1个数中有k−1个落在[0,x)的有<img src="https://img-blog.csdn.net/20141117172953349" alt="img">种组合，所以和事件E等价的事件一共有<img src="https://img-blog.csdn.net/20141117173003692" alt="img">个。</p>
<p>如果有2个数落在区间[x,x+Δx]呢？如下图所示：</p>
<p><img src="https://img-blog.csdn.net/20141117173556252" alt="img"></p>
<p>类似于事件E，对于2个数落在区间[x,x+Δx]的事件E’：</p>
<p><img src="https://img-blog.csdn.net/20141117174658754" alt="img"></p>
<p>有：</p>
<p><img src="https://img-blog.csdn.net/20141117174704125" alt="img"></p>
<p>从上述的事件E、事件E‘中，可以看出，只要落在[x,x+Δx]内的数字超过一个，则对应的事件的概率就是 o(Δx)。于是乎有：</p>
<p><img src="https://img-blog.csdn.net/20141117174416718" alt="img"></p>
<p>从而得到<img src="https://img-blog.csdn.net/20141117171153983" alt="img">的概率密度函数<img src="https://img-blog.csdn.net/20141117175925730" alt="img">为：</p>
<p><img src="https://img-blog.csdn.net/20141117174509835" alt="img"></p>
<p>至此，本节开头提出的问题得到解决。然仔细观察<img src="https://img-blog.csdn.net/20141117171153983" alt="img">的概率密度函数，发现式子的最终结果有阶乘，联想到阶乘在实数上的推广<img src="https://img-blog.csdn.net/20141117175537939" alt="img">函数：</p>
<p><img src="https://img-blog.csdn.net/20141117175605598" alt="img"></p>
<p>两者结合是否会产生奇妙的效果呢？考虑到<img src="https://img-blog.csdn.net/20141117175537939" alt="img">具有如下性质：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141117175735048" alt="img"></p>
</blockquote>
<p>故将代入到<img src="https://img-blog.csdn.net/20141117171153983" alt="img">的概率密度函数<img src="https://img-blog.csdn.net/20141117175925730" alt="img">中，可得：</p>
<p><img src="https://img-blog.csdn.net/20141117180109671" alt="img"></p>
<p>然后取<img src="https://img-blog.csdn.net/20141213220932734" alt="img">，<img src="https://img-blog.csdn.net/20141213223805718" alt="img">，转换<img src="https://img-blog.csdn.net/20141117175925730" alt="img">得到：</p>
<p><img src="https://img-blog.csdn.net/20141117180513843" alt="img"></p>
<p>如果熟悉beta分布的朋友，可能会惊呼：哇，竟然推出了beta分布！</p>
<h2 id="beta分布">beta分布</h2>
<h3 id="beta分布">beta分布</h3>
<p>在概率论中，beta是指一组定义在<img src="https://img-blog.csdn.net/20141117180859890" alt="img">区间的连续概率分布，有两个参数<img src="https://img-blog.csdn.net/20141117181123550" alt="img">和<img src="https://img-blog.csdn.net/20141117181134937" alt="img">，且<img src="https://img-blog.csdn.net/20141117180930419" alt="img">。</p>
<p>beta分布的概率密度函数是：</p>
<p><img src="https://img-blog.csdn.net/20141117181504150" alt="img"></p>
<p>其中的<img src="https://img-blog.csdn.net/20141117181601605" alt="img">便是<img src="https://img-blog.csdn.net/20141117175537939" alt="img">函数：</p>
<p><img src="https://img-blog.csdn.net/20141117175605598" alt="img"></p>
<p>随机变量X服从参数为的beta分布通常写作：<img src="https://img-blog.csdn.net/20141117181719980" alt="img">。</p>
<h3 id="beta-binomial-共轭">Beta-Binomial 共轭</h3>
<p>回顾下1.1节开头所提出的问题：“问题1 随机变量<img src="https://img-blog.csdn.net/20141117171124858" alt="img">，把这n 个随机变量排序后得到顺序统计量<img src="https://img-blog.csdn.net/20141117171142782" alt="img">，然后请问<img src="https://img-blog.csdn.net/20141117171153983" alt="img">的分布是什么。” 如果，咱们要在这个问题的基础上增加一些观测数据，变成<strong>问题2</strong>：</p>
<ul>
<li>
<p><img src="https://img-blog.csdn.net/20141117171124858" alt="img">，对应的顺序统计量是<img src="https://img-blog.csdn.net/20141117171142782" alt="img">，需要猜测<img src="https://img-blog.csdn.net/20141117182441741" alt="img">；</p>
</li>
<li>
<p><img src="https://img-blog.csdn.net/20141117182537296" alt="img">， <img src="https://img-blog.csdn.net/20141117183329656" alt="img">中有<img src="https://img-blog.csdn.net/20141117183159618" alt="img">个比p小，<img src="https://img-blog.csdn.net/20141117183207590" alt="img">个比<img src="https://img-blog.csdn.net/20141117184123125" alt="img">大；</p>
</li>
<li>
<p>那么，请问<img src="https://img-blog.csdn.net/20141117183246106" alt="img">的分布是什么。</p>
<p>根据“Yi中有<img src="https://img-blog.csdn.net/20141117183159618" alt="img">个比<img src="https://img-blog.csdn.net/20141117184123125" alt="img">小，<img src="https://img-blog.csdn.net/20141117183207590" alt="img">个比<img src="https://img-blog.csdn.net/20141117184123125" alt="img">大”，换言之，Yi中有<img src="https://img-blog.csdn.net/20141117183159618" alt="img">个比<img src="https://img-blog.csdn.net/20141117171153983" alt="img">小，<img src="https://img-blog.csdn.net/20141117183207590" alt="img">个比<img src="https://img-blog.csdn.net/20141117171153983" alt="img">大，所以<img src="https://img-blog.csdn.net/20141117171153983" alt="img">是<img src="https://img-blog.csdn.net/20141117182908359" alt="img">中第<img src="https://img-blog.csdn.net/20141117183148792" alt="img">大的数。</p>
<p>根据1.1节最终得到的结论“只要落在[x,x+Δx]内的数字超过一个，则对应的事件的概率就是 o(Δx)”，继而推出事件服从beta分布，从而可知<img src="https://img-blog.csdn.net/20141117182441741" alt="img">的概率密度函数为：</p>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141117183714937" alt="img"></p>
<p>熟悉贝叶斯方法的朋友心里估计又犯“嘀咕”了，这不就是贝叶斯式的思考过程么？</p>
<ol>
<li>为了猜测<img src="https://img-blog.csdn.net/20141117182441741" alt="img">，在获得一定的观测数据前，我们对<img src="https://img-blog.csdn.net/20141117184123125" alt="img">的认知是：<img src="https://img-blog.csdn.net/20141118100645570" alt="img">，此称为<img src="https://img-blog.csdn.net/20141117184123125" alt="img">的先验分布；</li>
<li>然后为了获得这个结果“ <img src="https://img-blog.csdn.net/20141117183329656" alt="img">中有<img src="https://img-blog.csdn.net/20141117183159618" alt="img">个比p小，<img src="https://img-blog.csdn.net/20141117183207590" alt="img">个比<img src="https://img-blog.csdn.net/20141117184123125" alt="img">大”，针对<img src="https://img-blog.csdn.net/20141117183329656" alt="img">是做了<img src="https://img-blog.csdn.net/20141117184532817" alt="img">次贝努利实验，所以<img src="https://img-blog.csdn.net/20141117183159618" alt="img">服从二项分布<img src="https://img-blog.csdn.net/20141117184624234" alt="img">；</li>
<li>在给定了来自数据提供的<img src="https://img-blog.csdn.net/20141117184713218" alt="img">的知识后，<img src="https://img-blog.csdn.net/20141117184123125" alt="img">的后验分布变为<img src="https://img-blog.csdn.net/20141117184810158" alt="img">。</li>
</ol>
<p>回顾下贝叶斯派思考问题的固定模式：</p>
<ul>
<li>
<p><strong>先验分布<img src="https://img-blog.csdn.net/20141110214925523" alt="img"> + 样本信息<img src="https://img-blog.csdn.net/20141110211153578" alt="img"> <img src="https://img-blog.csdn.net/20141110190250086" alt="img"> 后验分布<img src="https://img-blog.csdn.net/20141110215058639" alt="img"></strong></p>
<p>上述思考模式意味着，新观察到的样本信息将修正人们以前对事物的认知。换言之，在得到新的样本信息之前，人们对<img src="https://img-blog.csdn.net/20141110210919359" alt="img">的认知是先验分布<img src="https://img-blog.csdn.net/20141110214925523" alt="img">，在得到新的样本信息<img src="https://img-blog.csdn.net/20141110211153578" alt="img">后，人们对<img src="https://img-blog.csdn.net/20141110210919359" alt="img">的认知为<img src="https://img-blog.csdn.net/20141110215058639" alt="img">。</p>
<p>类比到现在这个问题上，我们也可以试着写下：</p>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141117185216670" alt="img"></p>
<p>其中<img src="https://img-blog.csdn.net/20141117184713218" alt="img">对应的是二项分布<img src="https://img-blog.csdn.net/20141117185530298" alt="img">的计数。</p>
<p>更一般的，对于非负实数<img src="https://img-blog.csdn.net/20141117181123550" alt="img">和<img src="https://img-blog.csdn.net/20141117181134937" alt="img">，我们有如下关系</p>
<p><img src="https://img-blog.csdn.net/20141117185325671" alt="img"></p>
<p>针对于这种<strong>观测到的数据符合二项分布</strong>，<strong>参数的先验分布和后验分布都是Beta分布</strong>的情况**，就是Beta-Binomial共轭**。换言之，<strong>Beta分布是二项式分布的共轭先验概率分布</strong>。</p>
<p>二项分布和Beta分布是共轭分布意味着，如果我们为二项分布的参数p选取的先验分布是Beta分布，那么以p为参数的二项分布用贝叶斯估计得到的后验分布仍然服从Beta分布。</p>
<p>此外，如何理解参数<img src="https://img-blog.csdn.net/20141117181123550" alt="img">和<img src="https://img-blog.csdn.net/20141117181134937" alt="img">所表达的意义呢？<img src="https://img-blog.csdn.net/20141117181123550" alt="img">、<img src="https://img-blog.csdn.net/20141117181134937" alt="img">可以认为形状参数，通俗但不严格的理解是，<img src="https://img-blog.csdn.net/20141117181123550" alt="img">和<img src="https://img-blog.csdn.net/20141117181134937" alt="img">共同控制Beta分布的函数“长的样子”：形状千奇百怪，高低胖瘦，如下图所示：</p>
<p><img src="https://img-blog.csdn.net/20141118115514401" alt="img"></p>
<h3 id="共轭先验分布">共轭先验分布</h3>
<p>什么又是共轭呢？轭的意思是束缚、控制，共轭从字面上理解，则是共同约束，或互相约束。</p>
<p><strong>在贝叶斯概率理论中，如果后验概率P(θ|x)和先验概率p(θ)满足同样的分布律，那么，先验分布和后验分布被叫做共轭分布，同时，先验分布叫做似然函数的共轭先验分布</strong>。</p>
<p>比如，某观测数据服从概率分布**P(θ)**时，当观测到新的X数据时，我们一般会遇到如下问题：</p>
<ul>
<li>可否根据新观测数据<strong>X</strong>，更新参数θ？</li>
<li>根据新观测数据可以在多大程度上改变参数θ，即</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141117223124750" alt="img"></p>
<ul>
<li>
<p>当重新估计θ的时候，给出新参数值θ的新概率分布，即<strong>P(θ|x)</strong>。</p>
<p>事实上，根据根据贝叶斯公式可知：</p>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141117223514396" alt="img"></p>
<p>其中，P(x|θ)表示以预估θ为参数的x概率分布，可以直接求得，P(θ)是已有原始的θ概率分布。<br>
所以，如果我们选取P(x|θ)的共轭先验作为P(θ)的分布，那么P(x|θ)乘以P(θ)，然后归一化的结果P(θ|x)跟和P(θ)的形式一样。换句话说，先验分布是P(θ)，后验分布是P(θ|x)，<strong>先验分布跟后验分布同属于一个分布族，故称该分布族是θ的共轭先验分布（族）</strong>。</p>
<p>举个例子。投掷一个非均匀硬币，可以使用参数为θ的伯努利模型，θ为硬币为正面的概率，那么结果x的分布形式为：</p>
<p><img src="https://img-blog.csdn.net/20141117224140453" alt="img"></p>
<p>其共轭先验为beta分布，具有两个参数<img src="https://img-blog.csdn.net/20141117181123550" alt="img">和<img src="https://img-blog.csdn.net/20141117181134937" alt="img">，称为超参数（hyperparameters）。且这两个参数决定了θ参数，其Beta分布形式为</p>
<p><img src="https://img-blog.csdn.net/20141117230028113" alt="img"></p>
<p>然后计算后验概率</p>
<p><img src="https://img-blog.csdn.net/20141117230441640" alt="img"></p>
<p>归一化这个等式后会得到另一个Beta分布，从而证明了Beta分布确实是伯努利分布的共轭先验分布。</p>
<h3 id="从beta分布推广到dirichlet-分布">从beta分布推广到Dirichlet 分布</h3>
<p>接下来，咱们来考察beta分布的一个性质。</p>
<p>如果<img src="https://img-blog.csdn.net/20141117203613655" alt="img">，则有：</p>
<p><img src="https://img-blog.csdn.net/20141117203629988" alt="img"></p>
<p>注意到上式最后结果的右边积分</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141117204305979" alt="img"></p>
</blockquote>
<p>其类似于概率分布<img src="https://img-blog.csdn.net/20141117203736023" alt="img">，而对于这个分布有</p>
<p><img src="https://img-blog.csdn.net/20141117203818843" alt="img"></p>
<p>从而求得</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141117204305979" alt="img"></p>
</blockquote>
<p>的结果为</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141117204625363" alt="img"></p>
</blockquote>
<p>最后将此结果带入<img src="https://img-blog.csdn.net/20141117203959187" alt="img">的计算式，得到：</p>
<p><img src="https://img-blog.csdn.net/20141117204010541" alt="img"></p>
<p>最后的这个结果意味着对于Beta 分布的随机变量，其均值（期望）可以用<img src="https://img-blog.csdn.net/20141117205049284" alt="img">来估计。此外，狄利克雷Dirichlet 分布也有类似的结论，即如果<img src="https://img-blog.csdn.net/20141117211131796" alt="img">，同样可以证明有下述结论成立：</p>
<p><img src="https://img-blog.csdn.net/20141117211142562" alt="img"></p>
<p>那什么是Dirichlet 分布呢？简单的理解Dirichlet 分布就是一组连续多变量概率分布，是多变量普遍化的beta分布。为了纪念德国数学家约翰·彼得·古斯塔夫·勒热纳·狄利克雷（Peter Gustav Lejeune Dirichlet）而命名。狄利克雷分布常作为贝叶斯统计的先验概率。</p>
<h2 id="dirichlet-分布">Dirichlet 分布</h2>
<h3 id="dirichlet-分布">Dirichlet 分布</h3>
<p>根据wikipedia上的介绍，维度K ≥ 2（x1,x2…xK-1维，共K个）的狄利克雷分布在参数α1, …, αK &gt; 0上、基于欧几里得空间RK-1里的勒贝格测度有个概率密度函数，定义为：</p>
<p><img src="https://img-blog.csdn.net/20141117232638381" alt="img"></p>
<p>其中，<img src="https://img-blog.csdn.net/20141117233333953" alt="img">相当于是多项beta函数</p>
<p><img src="https://img-blog.csdn.net/20141117233352295" alt="img"></p>
<p>且<img src="https://img-blog.csdn.net/20141117233400236" alt="img"></p>
<p>此外，x1+x2+…+xK-1+xK=1，x1,x2…xK-1&gt;0，且在(K-1)维的单纯形上，其他区域的概率密度为0。</p>
<p>当然，也可以如下定义Dirichlet 分布</p>
<p><img src="https://img-blog.csdn.net/20141117233150484" alt="img"></p>
<p>其中的<img src="https://img-blog.csdn.net/20141121104155483" alt="img">称为Dirichlet 分布的归一化系数：</p>
<p><img src="https://img-blog.csdn.net/20141121104233812" alt="img"></p>
<p>且根据Dirichlet分布的积分为1（概率的基本性质），可以得到：</p>
<p><img src="https://img-blog.csdn.net/20141127072603172" alt="img"></p>
<h3 id="dirichlet-multinomial-共轭">Dirichlet-Multinomial 共轭</h3>
<p>下面，在2.2节问题2的基础上继续深入，引出<strong>问题3</strong>。</p>
<ul>
<li>
<p><img src="https://img-blog.csdn.net/20141117171124858" alt="img">，</p>
</li>
<li>
<p>排序后对应的顺序统计量<img src="https://img-blog.csdn.net/20141117234106703" alt="img">,</p>
</li>
<li>
<p>问<img src="https://img-blog.csdn.net/20141117234117660" alt="img">的联合分布是什么？</p>
<p>为了简化计算，取x3满足x1+x2+x3=1,但只有x1,x2是变量，如下图所示：</p>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141117234134290" alt="img"></p>
<p>从而有：</p>
<p><img src="https://img-blog.csdn.net/20141118003458723" alt="img"></p>
<p>继而得到于是我们得到<img src="https://img-blog.csdn.net/20141117234117660" alt="img">的联合分布为：</p>
<p><img src="https://img-blog.csdn.net/20141118003624156" alt="img"></p>
<p>观察上述式子的最终结果，可以看出上面这个分布其实就是3维形式的 Dirichlet 分布</p>
<p><img src="https://img-blog.csdn.net/20141118003740698" alt="img"></p>
<p>令<img src="https://img-blog.csdn.net/20141118003757702" alt="img">，于是分布密度可以写为</p>
<p><img src="https://img-blog.csdn.net/20141118003817062" alt="img"></p>
<p>这个就是一般形式的3维 Dirichlet 分布，即便<img src="https://img-blog.csdn.net/20141118003830275" alt="img">延拓到非负实数集合，以上概率分布也是良定义的。</p>
<p>将Dirichlet分布的概率密度函数取对数，绘制对称Dirichlet分布的图像如下图所示（截取自wikipedia上）：</p>
<p><img src="https://img-blog.csdnimg.cn/img_convert/0beb4b53b969f87ff42219feb3dea94c.gif" alt="img"></p>
<p>上图中，取K=3，也就是有两个独立参数x1,x2，分别对应图中的两个坐标轴，第三个参数始终满足x3=1-x1-x2且α1=α2=α3=α，图中反映的是参数α从α=(0.3, 0.3, 0.3)变化到(2.0, 2.0, 2.0)时的概率对数值的变化情况。</p>
<p>为了论证Dirichlet分布是多项式分布的共轭先验概率分布，下面咱们继续在上述问题3的基础上再进一步，提出<strong>问题4</strong>。</p>
<ol>
<li><strong>问题4</strong> <img src="https://img-blog.csdn.net/20141118180531757" alt="img">，排序后对应的顺序统计量<img src="https://img-blog.csdn.net/20141118180542427" alt="img"></li>
<li>令<img src="https://img-blog.csdn.net/20141118180558421" alt="img">,<img src="https://img-blog.csdn.net/20141118180611890" alt="img">,<img src="https://img-blog.csdn.net/20141118180622671" alt="img">（此处的p3非变量，只是为了表达方便），现在要猜测<img src="https://img-blog.csdn.net/20141118180717390" alt="img">；</li>
<li><img src="https://img-blog.csdn.net/20141118180744295" alt="img">，Yi中落到<img src="https://img-blog.csdn.net/20141118180754809" alt="img">，<img src="https://img-blog.csdn.net/20141118180800191" alt="img">，<img src="https://img-blog.csdn.net/20141118180806244" alt="img"> 三个区间的个数分别为 m1,m2,m3，m=m1+m2+m3；</li>
<li>问后验分布<img src="https://img-blog.csdn.net/20141118180831609" alt="img">的分布是什么。</li>
</ol>
<p>为了方便讨论，记<img src="https://img-blog.csdn.net/20141118214256906" alt="img">，及<img src="https://img-blog.csdn.net/20141118214259932" alt="img">，根据已知条件“<img src="https://img-blog.csdn.net/20141118180744295" alt="img">，Yi中落到<img src="https://img-blog.csdn.net/20141118180754809" alt="img">，<img src="https://img-blog.csdn.net/20141118180800191" alt="img">，<img src="https://img-blog.csdn.net/20141118180806244" alt="img"> 三个区间的个数分别为 m1,m2”，可得<img src="https://img-blog.csdn.net/20141118214717703" alt="img">、<img src="https://img-blog.csdn.net/20141118214721560" alt="img">分别是这m+n个数中第<img src="https://img-blog.csdn.net/20141118214854567" alt="img">大、第<img src="https://img-blog.csdn.net/20141118214859481" alt="img">大的数。于是，后验分布<img src="https://img-blog.csdn.net/20141118215138703" alt="img">应该为<img src="https://img-blog.csdn.net/20141118215146718" alt="img">，即一般化的形式表示为：<img src="https://img-blog.csdn.net/20141118215151082" alt="img">。</p>
<p>同样的，按照贝叶斯推理的逻辑，可将上述过程整理如下：</p>
<ol>
<li>我们要猜测参数<img src="https://img-blog.csdn.net/20141118220412816" alt="img">，其先验分布为<img src="https://img-blog.csdn.net/20141118220433171" alt="img">；</li>
<li>数据Yi落到三个区间<img src="https://img-blog.csdn.net/20141118180754809" alt="img">，<img src="https://img-blog.csdn.net/20141118180800191" alt="img">，<img src="https://img-blog.csdn.net/20141118180806244" alt="img"> 的个数分别为<img src="https://img-blog.csdn.net/20141118220524935" alt="img">，所以<img src="https://img-blog.csdn.net/20141118220449991" alt="img">服从多项分布<img src="https://img-blog.csdn.net/20141118220553625" alt="img"></li>
<li>在给定了来自数据提供的知识<img src="https://img-blog.csdn.net/20141118220601657" alt="img">后，<img src="https://img-blog.csdn.net/20141118220609473" alt="img">的后验分布变为<img src="https://img-blog.csdn.net/20141118220620315" alt="img"></li>
</ol>
<p>上述贝叶斯分析过程的直观表述为：</p>
<p><img src="https://img-blog.csdn.net/20141118220632031" alt="img"></p>
<p>令<img src="https://img-blog.csdn.net/20141118221128562" alt="img">，可把<img src="https://img-blog.csdn.net/20141118221159725" alt="img">从整数集合延拓到实数集合，从而得到更一般的表达式如下：</p>
<p><img src="https://img-blog.csdn.net/20141118220737504" alt="img"></p>
<p>针对于这种<strong>观测到的数据符合多项分布，参数的先验分布和后验分布都是Dirichlet 分布</strong>的情况，<strong>就是Dirichlet-Multinomial 共轭</strong>。换言之，至此已经证明了Dirichlet分布的确就是多项式分布的共轭先验概率分布。</p>
<p>意味着，如果我们为多项分布的参数p选取的先验分布是Dirichlet分布，那么以p为参数的多项分布用贝叶斯估计得到的后验分布仍然服从Dirichlet分布。</p>
<p>进一步，一般形式的Dirichlet 分布定义如下：</p>
<p><img src="https://img-blog.csdn.net/20141118224014683" alt="img"></p>
<p>而对于给定的<img src="https://img-blog.csdn.net/20141118224321837" alt="img">和<img src="https://img-blog.csdn.net/20141118224327281" alt="img">，其多项分布为：</p>
<p><img src="https://img-blog.csdn.net/20141118224347655" alt="img"></p>
<p>结论是：Dirichlet分布<img src="https://img-blog.csdn.net/20141118224449899" alt="img">和多项分布<img src="https://img-blog.csdn.net/20141118224457093" alt="img">是共轭关系。</p>
<h2 id="主题模型lda">主题模型LDA</h2>
<p>​    在开始下面的旅程之前，先来总结下我们目前所得到的最主要的几个收获：</p>
<ul>
<li>
<p>通过上文的第2.2节，我们知道</p>
<p>beta分布</p>
<p>是二项式分布的共轭先验概率分布：</p>
<ul>
<li>**“**对于非负实数<img src="https://img-blog.csdn.net/20141117181123550" alt="img">和<img src="https://img-blog.csdn.net/20141117181134937" alt="img">，我们有如下关系</li>
</ul>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141117185325671" alt="img"></p>
<p>其中<img src="https://img-blog.csdn.net/20141117184713218" alt="img">对应的是二项分布<img src="https://img-blog.csdn.net/20141117185530298" alt="img">的计数。针对于这种观测到的数据符合二项分布，参数的先验分布和后验分布都是Beta分布的情况，就是Beta-Binomial 共轭。<strong>”</strong></p>
<ul>
<li>
<p>通过上文的3.2节，我们知道狄利克雷分布</p>
<p>（Dirichlet分布）</p>
<p>是多项式分布的共轭先验概率分布：</p>
<ul>
<li><strong>“</strong> 把<img src="https://img-blog.csdn.net/20141118221159725" alt="img">从整数集合延拓到实数集合，从而得到更一般的表达式如下：</li>
</ul>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141118220737504" alt="img"></p>
<p>针对于这种观测到的数据符合多项分布，参数的先验分布和后验分布都是Dirichlet 分布的情况，就是 Dirichlet-Multinomial 共轭。 <strong>”</strong></p>
<ul>
<li>
<p>以及贝叶斯派思考问题的固定模式：</p>
<ul>
<li>
<p><strong>先验分布<img src="https://img-blog.csdn.net/20141110214925523" alt="img"> + 样本信息<img src="https://img-blog.csdn.net/20141110211153578" alt="img"> <img src="https://img-blog.csdn.net/20141110190250086" alt="img"> 后验分布<img src="https://img-blog.csdn.net/20141110215058639" alt="img"></strong></p>
<p>上述思考模式意味着，新观察到的样本信息将修正人们以前对事物的认知。换言之，在得到新的样本信息之前，人们对<img src="https://img-blog.csdn.net/20141110210919359" alt="img">的认知是先验分布<img src="https://img-blog.csdn.net/20141110214925523" alt="img">，在得到新的样本信息<img src="https://img-blog.csdn.net/20141110211153578" alt="img">后，人们对<img src="https://img-blog.csdn.net/20141110210919359" alt="img">的认知为<img src="https://img-blog.csdn.net/20141110215058639" alt="img">。</p>
</li>
</ul>
</li>
<li>
<p>顺便提下频率派与贝叶斯派各自不同的思考方式：</p>
<ul>
<li>频率派把需要推断的参数θ看做是固定的未知常数，即概率<img src="https://img-blog.csdn.net/20141110214603237" alt="img">虽然是未知的，但最起码是确定的一个值，同时，样本X 是随机的，所以频率派重点研究样本空间，大部分的概率计算都是针对样本X 的分布；</li>
<li>而<strong>贝叶斯派</strong>的观点则截然相反，他们认为待估计的参数<img src="https://img-blog.csdn.net/20141110214603237" alt="img">是随机变量，服从一定的分布，而样本X 是固定的，由于样本是固定的，所以他们重点研究的是参数<img src="https://img-blog.csdn.net/20141110214603237" alt="img">的分布。</li>
</ul>
<p>OK，在杀到终极boss——LDA模型之前，再循序渐进理解基础模型：Unigram model、mixture of unigrams model，以及跟LDA最为接近的pLSA模型。</p>
<p>为了方便描述，首先定义一些变量：</p>
</li>
<li>
<p><img src="https://img-blog.csdn.net/20141118232053295" alt="img">表示词，<img src="https://img-blog.csdn.net/20141118232219439" alt="img">表示所有单词的个数（固定值）</p>
</li>
<li>
<p><img src="https://img-blog.csdn.net/20141118232105500" alt="img">表示主题，<img src="https://img-blog.csdn.net/20141118232243400" alt="img">是主题的个数（预先给定，固定值）</p>
</li>
<li>
<p><img src="https://img-blog.csdn.net/20141118232121329" alt="img">表示语料库，其中的<img src="https://img-blog.csdn.net/20141118232236677" alt="img">是语料库中的文档数（固定值）</p>
</li>
<li>
<p><img src="https://img-blog.csdn.net/20141118232113406" alt="img">表示文档，其中的<img src="https://img-blog.csdn.net/20141118232228453" alt="img">表示一个文档中的词数（随机变量）</p>
</li>
</ul>
<h3 id="各个基础模型">各个基础模型</h3>
<p>4.1.1 Unigram model</p>
<p>对于文档<img src="https://img-blog.csdn.net/20141118232113406" alt="img">，用<img src="https://img-blog.csdn.net/20141118232926037" alt="img">表示词<img src="https://img-blog.csdn.net/20141118232935912" alt="img">的先验概率，生成文档<img src="https://img-blog.csdn.net/20141118233058873" alt="img">的概率为：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141118233228339" alt="img"></p>
</blockquote>
<p>其图模型为（图中被涂色的w表示可观测变量，N表示一篇文档中总共N个单词，M表示M篇文档）：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141118233121976" alt="img"></p>
</blockquote>
<p>或为：</p>
<p><img src="https://img-blog.csdn.net/20141118234545921" alt="img"></p>
<p>unigram model假设文本中的词服从Multinomial分布，而我们已经知道Multinomial分布的先验分布为Dirichlet分布。<br>
上图中的<img src="https://img-blog.csdn.net/20141118234749489" alt="img">表示在文本中观察到的第n个词，n∈[1,N]表示该文本中一共有N个单词。加上方框表示重复，即一共有N个这样的随机变量<img src="https://img-blog.csdn.net/20141118234749489" alt="img">。其中，p和α是隐含未知变量：</p>
<ul>
<li>
<p>p是词服从的Multinomial分布的参数</p>
</li>
<li>
<p>α是Dirichlet分布（即Multinomial分布的先验分布）的参数。</p>
<p>一般α由经验事先给定，p由观察到的文本中出现的词学习得到，表示文本中出现每个词的概率。</p>
</li>
</ul>
<p>4.1.2 Mixture of unigrams model</p>
<p>该模型的生成过程是：给某个文档先选择一个主题<img src="https://img-blog.csdn.net/20141118232105500" alt="img">，再根据该主题生成文档，该文档中的所有词都来自一个主题。假设主题有<img src="https://img-blog.csdn.net/20141118234021812" alt="img">，生成文档<img src="https://img-blog.csdn.net/20141118233058873" alt="img">的概率为：</p>
<p><img src="https://img-blog.csdn.net/20141118234201515" alt="img"></p>
<p>其图模型为（图中被涂色的w表示可观测变量，未被涂色的z表示未知的隐变量，N表示一篇文档中总共N个单词，M表示M篇文档）：</p>
<p><img src="https://img-blog.csdn.net/20141118234219252" alt="img"></p>
<h3 id="plsa模型">PLSA模型</h3>
<p>啊哈，长征两万五，经过前面这么长的铺垫，终于快要接近LDA模型了！因为跟LDA模型最为接近的便是下面要阐述的这个pLSA模型，理解了pLSA模型后，到LDA模型也就一步之遥——给pLSA加上贝叶斯框架，便是LDA。</p>
<p>4.2.1 pLSA模型下生成文档</p>
<p>OK，在上面的Mixture of unigrams model中，我们假定一篇文档只有一个主题生成，可实际中，一篇文章往往有多个主题，只是这多个主题各自在文档中出现的概率大小不一样。比如介绍一个国家的文档中，往往会分别从教育、经济、交通等多个主题进行介绍。那么在pLSA中，<strong>文档是怎样被生成的呢</strong>？</p>
<p>假设你要写M篇文档，由于一篇文档由各个不同的词组成，所以你需要确定每篇文档里每个位置上的词。</p>
<p>再假定你一共有K个可选的主题，有V个可选的词，咱们来玩一个扔骰子的游戏。</p>
<ul>
<li>*<strong>1*</strong>. 假设你每写一篇文档会制作一颗K面的“文档-主题”骰子（扔此骰子能得到K个主题中的任意一个），和K个V面的“主题-词项” 骰子（每个骰子对应一个主题，K个骰子对应之前的K个主题，且骰子的每一面对应要选择的词项，V个面对应着V个可选的词）。
<ul>
<li>比如可令K=3，即制作1个含有3个主题的“文档-主题”骰子，这3个主题可以是：教育、经济、交通。然后令V = 3，制作3个有着3面的“主题-词项”骰子，其中，教育主题骰子的3个面上的词可以是：大学、老师、课程，经济主题骰子的3个面上的词可以是：市场、企业、金融，交通主题骰子的3个面上的词可以是：高铁、汽车、飞机。</li>
</ul>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141119110830531" alt="img"></p>
<ul>
<li>
<p>*<strong>2*</strong>. 每写一个词，先扔该“文档-主题”骰子选择主题，得到主题的结果后，使用和主题结果对应的那颗“主题-词项”骰子，扔该骰子选择要写的词。</p>
<ul>
<li>先扔“文档-主题”的骰子，假设（以一定的概率）得到的主题是教育，所以下一步便是扔教育主题筛子，（以一定的概率）得到教育主题筛子对应的某个词：大学。
<ul>
<li>上面这个投骰子产生词的过程简化下便是：“先以一定的概率选取主题，再以一定的概率选取词”。事实上，一开始可供选择的主题有3个：教育、经济、交通，那为何偏偏选取教育这个主题呢？其实是随机选取的，只是这个随机遵循一定的概率分布。比如可能选取教育主题的概率是0.5，选取经济主题的概率是0.3，选取交通主题的概率是0.2，那么<strong>这3个主题的概率分布便是{教育：0.5，经济：0.3，交通：0.2}</strong>，我们把各个主题z在文档d中出现的概率分布称之为主题分布，且是一个多项分布。</li>
<li>同样的，从主题分布中随机抽取出教育主题后，依然面对着3个词：大学、老师、课程，这3个词都可能被选中，但它们被选中的概率也是不一样的。比如大学这个词被选中的概率是0.5，老师这个词被选中的概率是0.3，课程被选中的概率是0.2，那么<strong>这3个词的概率分布便是{大学：0.5，老师：0.3，课程：0.2}</strong>，我们把各个词语w在主题z下出现的概率分布称之为词分布，这个词分布也是一个多项分布。</li>
<li>所以，*<em>选主题和选词都是两个随机的过程，先从主题分布**{教育：0.5，经济：0.3，交通：0.2}*<em>中抽取出主题：教育，然后从该教育主题对应的词分布*</em>{大学：0.5，老师：0.3，课程：0.2}*<em>中抽取出词：大学</em></em>。</li>
</ul>
</li>
</ul>
</li>
<li>
<p>*<strong>3*</strong>. 最后，你不停的重复扔“文档-主题”骰子和”主题-词项“骰子，重复N次（产生N个词），完成一篇文档，重复这产生一篇文档的方法M次，则完成M篇文档。</p>
<p>上述过程抽象出来即是PLSA的文档生成模型。在这个过程中，我们并未关注词和词之间的出现顺序，所以pLSA是一种词袋方法。具体说来，该模型假设一组共现(co-occurrence)词项关联着一个隐含的主题类别<img src="https://img-blog.csdn.net/20141119004817915" alt="img">。同时定义：</p>
</li>
<li>
<p><img src="https://img-blog.csdn.net/20141119004830562" alt="img">表示海量文档中某篇文档被选中的概率。</p>
</li>
<li></li>
</ul>
<p>表示词<img src="https://img-blog.csdn.net/20141119004858101" alt="img">在给定文档</p>
<p>中出现的概率。</p>
<ul>
<li>
<p>怎么计算得到呢？针对海量文档，对所有文档进行分词后，得到一个词汇列表，这样每篇文档就是一个词语的集合。对于每个词语，用它在文档中出现的次数除以文档中词语总的数目便是它在文档中出现的概率<img src="https://img-blog.csdn.net/20141124203846866" alt="img">。</p>
</li>
<li>
<p><img src="https://img-blog.csdn.net/20141119004915308" alt="img">表示具体某个主题<img src="https://img-blog.csdn.net/20141119005048281" alt="img">在给定文档<img src="https://img-blog.csdn.net/20141119004838164" alt="img">下出现的概率。</p>
</li>
<li>
<p><img src="https://img-blog.csdn.net/20141119004850551" alt="img">表示具体某个词<img src="https://img-blog.csdn.net/20141119004858101" alt="img">在给定主题<img src="https://img-blog.csdn.net/20141119004906734" alt="img">下出现的概率，与主题关系越密切的词，其条件概率<img src="https://img-blog.csdn.net/20141119004850551" alt="img">越大。</p>
<p>利用上述的第1、3、4个概率，我们便可以按照如下的步骤得到“文档-词项”的生成模型：</p>
</li>
</ul>
<ol>
<li>按照概率<img src="https://img-blog.csdn.net/20141119004830562" alt="img">选择一篇文档<img src="https://img-blog.csdn.net/20141119004838164" alt="img"></li>
<li>选定文档<img src="https://img-blog.csdn.net/20141119004838164" alt="img">后，从主题分布中按照概率<img src="https://img-blog.csdn.net/20141119004915308" alt="img">选择一个隐含的主题类别<img src="https://img-blog.csdn.net/20141119005048281" alt="img"></li>
<li>选定<img src="https://img-blog.csdn.net/20141119005048281" alt="img">后，从词分布中按照概率<img src="https://img-blog.csdn.net/20141119004850551" alt="img">选择一个词<img src="https://img-blog.csdn.net/20141119004858101" alt="img"></li>
</ol>
<p>所以pLSA中生成文档的整个过程便是选定文档生成主题，确定主题生成词。</p>
<p>4.2.1 根据文档反推其主题分布</p>
<p>反过来，既然文档已经产生，那么如何根据已经产生好的文档反推其主题呢？这个利用看到的文档推断其隐藏的主题（分布）的过程（其实也就是产生文档的逆过程），便是主题建模的目的：自动地发现文档集中的主题（分布）。</p>
<p>换言之，人类根据文档生成模型写成了各类文章，然后丢给了<strong>计算机，相当于计算机看到的是一篇篇已经写好的文章。现在计算机需要根据一篇篇文章中看到的一系列词归纳出当篇文章的主题，进而得出各个主题各自不同的出现概率：主题分布</strong>。即文档d和单词w是可被观察到的，但主题z却是隐藏的。</p>
<p>如下图所示（图中被涂色的d、w表示可观测变量，未被涂色的z表示未知的隐变量，N表示一篇文档中总共N个单词，M表示M篇文档）：</p>
<p><img src="https://img-blog.csdn.net/20141118234229125" alt="img"></p>
<p>上图中，文档d和词w是我们得到的样本（样本随机，参数虽未知但固定，所以pLSA属于频率派思想。区别于下文要介绍的LDA中：样本固定，参数未知但不固定，是个随机变量，服从一定的分布，所以LDA属于贝叶斯派思想），可观测得到，所以对于任意一篇文档，其<img src="https://img-blog.csdn.net/20141124203846866" alt="img">是已知的。</p>
<p>从而可以根据大量已知的文档-词项信息<img src="https://img-blog.csdn.net/20141124203846866" alt="img">，训练出文档-主题<img src="https://img-blog.csdn.net/20141119004915308" alt="img">和主题-词项<img src="https://img-blog.csdn.net/20141119004850551" alt="img">，如下公式所示：</p>
<p><img src="https://img-blog.csdn.net/20141124221914437" alt="img"></p>
<p>故得到文档中每个词的生成概率为：</p>
<p><img src="https://img-blog.csdn.net/20141119005004510" alt="img"></p>
<p>由于<img src="https://img-blog.csdn.net/20141119004830562" alt="img">可事先计算求出，<strong>而<img src="https://img-blog.csdn.net/20141119004850551" alt="img">和<img src="https://img-blog.csdn.net/20141119004915308" alt="img">未知，所以<img src="https://img-blog.csdn.net/20141119132914266" alt="img">就是我们要估计的参数（值）</strong>，通俗点说，就是要最大化这个θ。</p>
<p>用什么方法进行估计呢，常用的参数估计方法有极大似然估计MLE、最大后验证估计MAP、贝叶斯估计等等。因为该待估计的参数中含有隐变量z，所以我们可以考虑EM算法。</p>
<p>4.2.1.1 EM算法的简单介绍</p>
<p>EM算法，全称为Expectation-maximization algorithm，为期望最大算法，其基本思想是：首先随机选取一个值去初始化待估计的值<img src="https://img-blog.csdn.net/20141119142305046" alt="img">，然后不断迭代寻找更优的<img src="https://img-blog.csdn.net/20141119142335046" alt="img">使得其似然函数likelihood <img src="https://img-blog.csdn.net/20141119142434921" alt="img">比原来的<img src="https://img-blog.csdn.net/20141119142450410" alt="img">要大。换言之，假定现在得到了<img src="https://img-blog.csdn.net/20141119142518131" alt="img">，想求<img src="https://img-blog.csdn.net/20141119142539343" alt="img">，使得</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141119142548109" alt="img"></p>
</blockquote>
<p>EM的关键便是要找到<img src="https://img-blog.csdn.net/20141119152956312" alt="img">的一个下界<img src="https://img-blog.csdn.net/20141119152550519" alt="img">（注：<img src="https://img-blog.csdn.net/20141119145102518" alt="img">，其中，X表示已经观察到的随机变量），然后不断最大化这个下界，通过不断求解下界<img src="https://img-blog.csdn.net/20141119152550519" alt="img">的极大化，从而逼近要求解的似然函数<img src="https://img-blog.csdn.net/20141119152956312" alt="img">。</p>
<p>所以EM算法的一般步骤为：</p>
<ul>
<li>
<p>\1. 随机选取或者根据先验知识初始化<img src="https://img-blog.csdn.net/20141119142305046" alt="img">；</p>
</li>
<li>
<p>\2. 不断迭代下述两步</p>
<ul>
<li>①给出当前的参数估计<img src="https://img-blog.csdn.net/20141119142518131" alt="img">，计算似然函数<img src="https://img-blog.csdn.net/20141119152956312" alt="img">的下界<img src="https://img-blog.csdn.net/20141119152550519" alt="img"></li>
<li>②重新估计参数θ，即求<img src="https://img-blog.csdn.net/20141119142539343" alt="img">，使得<img src="https://img-blog.csdn.net/20141119152555886" alt="img"></li>
</ul>
</li>
<li>
<p>\3. 上述第二步后，如果<img src="https://img-blog.csdn.net/20141119152956312" alt="img">收敛（即<img src="https://img-blog.csdn.net/20141119152550519" alt="img">收敛）则退出算法，否则继续回到第二步。</p>
<p>上述过程好比在二维平面上，有两条不相交的曲线，一条曲线在上（简称上曲线<img src="https://img-blog.csdn.net/20141213212154044" alt="img">），一条曲线在下（简称下曲线<img src="https://img-blog.csdn.net/20141213212254984" alt="img">），下曲线为上曲线的下界。现在对上曲线未知，只已知下曲线，为了求解上曲线的最高点，我们试着不断增大下曲线，使得下曲线不断逼近上曲线，下曲线在某一个点达到局部最大值并与上曲线在这点的值相等，记录下这个值，然后继续增大下曲线，寻找下曲线上与上曲线上相等的值，迭代到<img src="https://img-blog.csdn.net/20141119152956312" alt="img">收敛（即<img src="https://img-blog.csdn.net/20141119152550519" alt="img">收敛）停止，从而利用当前下曲线上的局部最大值当作上曲线的全局最大值（换言之，EM算法不保证一定能找到全局最优值）。如下图所示：</p>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141129191346265" alt="img"></p>
<p>以下是详细介绍。</p>
<p>假定有训练集<img src="https://img-blog.csdn.net/20141120010841491" alt="img">，包含m个独立样本，希望从中找到该组数据的模型p(x,z)的参数。</p>
<p>然后通过极大似然估计建立目标函数–对数似然函数：</p>
<p><img src="https://img-blog.csdn.net/20141120010951176" alt="img"></p>
<p>这里，z是隐随机变量，直接找到参数的估计是很困难的。我们的策略是建立<img src="https://img-blog.csdn.net/20141120012432984" alt="img">的下界，并且求该下界的最大值；重复这个过程，直到收敛到局部最大值。</p>
<p>令Qi是z的某一个分布，Qi≥0，且结合Jensen不等式，有：</p>
<p><img src="https://img-blog.csdn.net/20141120011131391" alt="img"></p>
<p>为了寻找尽量紧的下界，我们可以让使上述等号成立，而若要让等号成立的条件则是：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141120011315802" alt="img"></p>
</blockquote>
<p>换言之，有以下式子成立：<img src="https://img-blog.csdn.net/20141120011341074" alt="img">，且由于有：<img src="https://img-blog.csdn.net/20141120011351609" alt="img"></p>
<p>所以可得：</p>
<p><img src="https://img-blog.csdn.net/20141120011352275" alt="img"></p>
<p>最终得到EM算法的整体框架如下：</p>
<p><img src="https://img-blog.csdn.net/20141120011357126" alt="img"></p>
<p>OK，EM算法还会在本博客后面的博文中具体阐述。接下来，回到pLSA参数的估计问题上。</p>
<p>4.2.1.2 EM算法估计pLSA的两未知参数</p>
<p>首先尝试<strong>从矩阵的角度来描述待估计的两个未知变量****<img src="https://img-blog.csdn.net/20141119231257263" alt="img">*<em>和*</em><img src="https://img-blog.csdn.net/20141119231307918" alt="img"></strong>。</p>
<ul>
<li>假定用<img src="https://img-blog.csdn.net/20141119231329546" alt="img">表示词表<img src="https://img-blog.csdn.net/20141119231339695" alt="img">在主题<img src="https://img-blog.csdn.net/20141119231347433" alt="img">上的一个多项分布，则<img src="https://img-blog.csdn.net/20141119231410474" alt="img">可以表示成一个向量，每个元素**<img src="https://img-blog.csdn.net/20141119231428328" alt="img">*<em>表示词项*</em><img src="https://img-blog.csdn.net/20141119231439125" alt="img">*<em>出现在主题*</em><img src="https://img-blog.csdn.net/20141119231347433" alt="img">**<strong>中的概率</strong>，即</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141119231639109" alt="img"></p>
<ul>
<li>用<img src="https://img-blog.csdn.net/20141119231715834" alt="img">表示所有主题<img src="https://img-blog.csdn.net/20141119231726286" alt="img">在文档<img src="https://img-blog.csdn.net/20141119231734648" alt="img">上的一个多项分布，则<img src="https://img-blog.csdn.net/20141119231743696" alt="img">可以表示成一个向量，每个元素**<img src="https://img-blog.csdn.net/20141119231757234" alt="img">表示主题<img src="https://img-blog.csdn.net/20141119231347433" alt="img">出现在文档<img src="https://img-blog.csdn.net/20141119231734648" alt="img">中的概率**，即</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141119231850031" alt="img"></p>
<p>这样，<strong>巧妙的把<img src="https://img-blog.csdn.net/20141119231257263" alt="img">*<em>和*</em><img src="https://img-blog.csdn.net/20141119231307918" alt="img">转换成了两个矩阵</strong>。换言之，最终我们要求解的参数是这两个矩阵：</p>
<p><img src="https://img-blog.csdn.net/20141119231907109" alt="img"></p>
<p><img src="https://img-blog.csdn.net/20141212233215365" alt="img"></p>
<p>由于词和词之间是相互独立的，所以整篇文档N个词的分布为：</p>
<p><img src="https://img-blog.csdn.net/20141212232331064" alt="img"></p>
<p>再由于文档和文档之间也是相互独立的，所以整个语料库中词的分布为（整个语料库M篇文档，每篇文档N个词）：</p>
<p><img src="https://img-blog.csdn.net/20141212233703984" alt="img"></p>
<p>其中，<img src="https://img-blog.csdn.net/20141119232304125" alt="img">表示词项<img src="https://img-blog.csdn.net/20141119231439125" alt="img">在文档<img src="https://img-blog.csdn.net/20141119231734648" alt="img">中的词频，<img src="https://img-blog.csdn.net/20141119232311218" alt="img">表示文档di中词的总数，显然有<img src="https://img-blog.csdn.net/20141119232321951" alt="img">。<br>
从而得到整个语料库的词分布的对数似然函数（下述公式中有个小错误，正确的应该是：N为M，M为N）：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141119232348890" alt="img"></p>
</blockquote>
<p>现在，我们需要最大化上述这个对数似然函数来求解参数<img src="https://img-blog.csdn.net/20141119231428328" alt="img">和<img src="https://img-blog.csdn.net/20141119231757234" alt="img">。对于这种含有隐变量的最大似然估计，可以使用EM算法。EM算法，分为两个步骤：先E-step，后M-step。</p>
<ul>
<li>
<p><strong>E-step</strong>：假定参数已知，计算此时隐变量的后验概率。</p>
<p>利用贝叶斯法则，可以得到：</p>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141119232636140" alt="img"></p>
<ul>
<li>
<p><strong>M-step</strong>：带入隐变量的后验概率，最大化样本分布的对数似然函数，求解相应的参数。</p>
<p>观察之前得到的对数似然函数<img src="https://img-blog.csdn.net/20141213121218348" alt="img">的结果，由于文档长度<img src="https://img-blog.csdn.net/20141119232733735" alt="img">可以单独计算，所以去掉它不影响最大化似然函数。此外，根据E-step的计算结果，把 <img src="https://img-blog.csdn.net/20141119232746871" alt="img">代入<img src="https://img-blog.csdn.net/20141213121218348" alt="img">，于是我们只要最大化下面这个函数 <img src="https://img-blog.csdn.net/20141119234540074" alt="img"> 即可（下述公式中有个小错误，正确的应该是：N为M，M为N）：</p>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141119232802453" alt="img"></p>
<p>这是一个多元函数求极值问题，并且已知有如下约束条件（下述公式中有个小错误，正确的应该是：M为N）：</p>
<p><img src="https://img-blog.csdn.net/20141119232831812" alt="img"></p>
<p>熟悉凸优化的朋友应该知道，一般处理这种带有约束条件的极值问题，常用的方法便是拉格朗日乘数法，即通过引入拉格朗日乘子将约束条件和多元（目标）函数融合到一起，转化为无约束条件的极值问题。</p>
<p>这里我们引入两个拉格朗日乘子<img src="https://img-blog.csdn.net/20141119234516082" alt="img">和<img src="https://img-blog.csdn.net/20141119234526705" alt="img">，从而写出拉格朗日函数（下述公式中有个小错误，正确的应该是：N为M，M为N）：</p>
<p><img src="https://img-blog.csdn.net/20141119232849551" alt="img"></p>
<p>因为我们要求解的参数是<img src="https://img-blog.csdn.net/20141119231428328" alt="img">和<img src="https://img-blog.csdn.net/20141119231757234" alt="img">，所以分别对<img src="https://img-blog.csdn.net/20141119231428328" alt="img">和<img src="https://img-blog.csdn.net/20141119231757234" alt="img">求偏导，然后令偏导结果等于0，得到（下述公式中有个小错误，正确的应该是：N为M，M为N）：</p>
<p><img src="https://img-blog.csdn.net/20141119232904593" alt="img"></p>
<p>消去拉格朗日乘子，最终可估计出参数<img src="https://img-blog.csdn.net/20141119231428328" alt="img">和<img src="https://img-blog.csdn.net/20141119231757234" alt="img">（下述公式中有个小错误，正确的应该是：N为M，M为N）：</p>
<p><img src="https://img-blog.csdn.net/20141119232913560" alt="img"></p>
<p>综上，在pLSA中：</p>
<ol>
<li><strong>由于<img src="https://img-blog.csdn.net/20141119004850551" alt="img">*<em>和*</em><img src="https://img-blog.csdn.net/20141119004915308" alt="img">*<em>未知，所以*</em>*<em>我们用*</em>*<em>EM算法去估计*</em><img src="https://img-blog.csdn.net/20141119132914266" alt="img">*<em>这个*</em>*<em>参数的值。*</em></strong></li>
<li><em><em><em>*而后，用<img src="https://img-blog.csdn.net/20141119231428328" alt="img">表示词项<img src="https://img-blog.csdn.net/20141119231439125" alt="img">出现在主题<img src="https://img-blog.csdn.net/20141119231347433" alt="img">中的概率，即<img src="https://img-blog.csdnimg.cn/img_convert/c50227481eb1d4b4f6e8e0f29791f864.png" alt="img">，用<img src="https://img-blog.csdn.net/20141119231757234" alt="img">表示主题<img src="https://img-blog.csdn.net/20141119231347433" alt="img">出现在文档<img src="https://img-blog.csdn.net/20141119231734648" alt="img">中的概率，即<img src="https://img-blog.csdnimg.cn/img_convert/0f9b1fe6a11b3afce7f95ddb1c16fe2c.png" alt="img">，从而把<img src="https://img-blog.csdn.net/20141119231257263" alt="img">转换成了*</em>*</em>“主题-词项”矩阵Φ（主题生成词），把*</em><img src="https://img-blog.csdn.net/20141119231307918" alt="img">*<em>转换成了“文档-主题”矩阵Θ（文档生成主题）。*</em>**</li>
<li><strong>最终求解出<img src="https://img-blog.csdn.net/20141119231428328" alt="img">、<img src="https://img-blog.csdn.net/20141119231757234" alt="img"></strong>。</li>
</ol>
<h3 id="lda模型">LDA模型</h3>
<p>事实上，理解了pLSA模型，也就差不多快理解了LDA模型，因为LDA就是在pLSA的基础上加层贝叶斯框架，即LDA就是pLSA的贝叶斯版本（正因为LDA被贝叶斯化了，所以才需要考虑历史先验知识，才加的两个先验参数）。</p>
<p>4.3.1 pLSA跟LDA的对比：生成文档与参数估计</p>
<p>在pLSA模型中，我们按照如下的步骤得到“文档-词项”的生成模型：</p>
<ol>
<li>按照概率<img src="https://img-blog.csdn.net/20141119004830562" alt="img">选择一篇文档<img src="https://img-blog.csdn.net/20141119004838164" alt="img"></li>
<li>选定文档<img src="https://img-blog.csdn.net/20141119004838164" alt="img">后，确定文章的主题分布</li>
<li>从主题分布中按照概率<img src="https://img-blog.csdn.net/20141119004915308" alt="img">选择一个隐含的主题类别<img src="https://img-blog.csdn.net/20141119005048281" alt="img"></li>
<li>选定<img src="https://img-blog.csdn.net/20141119005048281" alt="img">后，确定主题下的词分布</li>
<li>从词分布中按照概率<img src="https://img-blog.csdn.net/20141119004850551" alt="img">选择一个词<img src="https://img-blog.csdn.net/20141119004858101" alt="img"> <strong>”</strong></li>
</ol>
<p>下面，咱们对比下本文开头所述的LDA模型中一篇文档生成的方式是怎样的：</p>
<ol>
<li>按照先验概率<img src="https://img-blog.csdn.net/20141119004830562" alt="img">选择一篇文档<img src="https://img-blog.csdn.net/20141119004838164" alt="img"></li>
<li>从狄利克雷分布（即Dirichlet分布）<img src="https://img-blog.csdn.net/20141117160438989" alt="img">中取样生成文档 <img src="https://img-blog.csdn.net/20141119004838164" alt="img">的主题分布<img src="https://img-blog.csdn.net/20141117160452327" alt="img">，换言之，主题分布<img src="https://img-blog.csdn.net/20141117160452327" alt="img">由超参数为<img src="https://img-blog.csdn.net/20141117160438989" alt="img">的Dirichlet分布生成</li>
<li>从主题的多项式分布<img src="https://img-blog.csdn.net/20141117160452327" alt="img">中取样生成文档<img src="https://img-blog.csdn.net/20141119004838164" alt="img">第 j 个词的主题<img src="https://img-blog.csdn.net/20141117160518098" alt="img"></li>
<li>从狄利克雷分布（即Dirichlet分布）<img src="https://img-blog.csdn.net/20141117160531515" alt="img">中取样生成主题<img src="https://img-blog.csdn.net/20141117160518098" alt="img">对应的词语分布<img src="https://img-blog.csdn.net/20141117160613962" alt="img">，换言之，词语分布<img src="https://img-blog.csdn.net/20141117160613962" alt="img">由参数为<img src="https://img-blog.csdn.net/20141117160531515" alt="img">的Dirichlet分布生成</li>
<li>从词语的多项式分布<img src="https://img-blog.csdn.net/20141117160613962" alt="img">中采样最终生成词语<img src="https://img-blog.csdn.net/20141117160656067" alt="img"> <strong>”</strong></li>
</ol>
<p>从上面两个过程可以看出，LDA在PLSA的基础上，为主题分布和词分布分别加了两个Dirichlet先验。</p>
<p>继续拿之前讲解PLSA的例子进行具体说明。如前所述，在PLSA中，选主题和选词都是两个随机的过程，先从主题分布{教育：0.5，经济：0.3，交通：0.2}中抽取出主题：教育，然后从该主题对应的词分布{大学：0.5，老师：0.3，课程：0.2}中抽取出词：大学。</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141119110830531" alt="img"></p>
</blockquote>
<p>而在LDA中，选主题和选词依然都是两个随机的过程，依然可能是先从主题分布{教育：0.5，经济：0.3，交通：0.2}中抽取出主题：教育，然后再从该主题对应的词分布{大学：0.5，老师：0.3，课程：0.2}中抽取出词：大学。</p>
<p>那PLSA跟LDA的区别在于什么地方呢？区别就在于：</p>
<ul>
<li>
<p><strong><em>*PLSA中，主题分布和词分布是唯一*</em>*<em>确定的，*</em>**能明确的指出主题分布可能就是*</strong>*<strong>{教育：0.5，经济：0.3，交通：0.2}，词分布可能就是{大学：0.5，老师：0.3，课程：0.2}</strong>。</p>
</li>
<li>
<p>但在<strong>LDA中，*<em>主题分布和词分布不再唯一确定不变，即*<em>无法确切给出。例如主题分布可能是{教育：0.5，经济：0.3，交通：0.2}，也可能是{教育：0.6，经济：0.2，交通：0.2}，到底是哪个我们不再确定（即不知道），因为它是随机的可变化的。但再怎么变化，也依然服从一定的分布，即主题分布跟词分布由Dirichlet</em></em>**先验随机确定</strong>。</p>
<p>看到这，你可能凌乱了，你说面对多个主题或词，各个主题或词被抽中的概率不一样，所以抽取主题或词是随机抽取，还好理解。但现在你说主题分布和词分布本身也都是不确定的，这是怎么回事？没办法，谁叫Blei等人“强行”给PLSA安了个贝叶斯框架呢，正因为LDA是PLSA的贝叶斯版本，所以主题分布跟词分布本身由先验知识随机给定。</p>
<p>进一步，你会发现：</p>
</li>
<li>
<p><strong>pLSA中</strong>，主题分布和词分布确定后，以一定的概率（</p>
<p>、</p>
<p>）分别选取具体的主题和词项，生成好文档。而后根据生成好的文档反推其主题分布、词分布时，</p>
<p>最终用EM算法（极大似然估计思想）求解出了两个未知但固定的参数的值：</p>
<p><img src="https://img-blog.csdn.net/20141119231428328" alt="img"></p>
<p>（由</p>
<p>转换而来）和</p>
<p><img src="https://img-blog.csdn.net/20141119231757234" alt="img"></p>
<p>（由</p>
<p>转换而来）。</p>
<ul>
<li>文档d产生主题z的概率，主题z产生单词w的概率都是两个固定的值。
<ul>
<li>举个文档d产生主题z的例子。给定一篇文档d，主题分布是一定的，比如{ P(zi|d), i = 1,2,3 }可能就是{0.4,0.5,0.1}，表示z1、z2、z3，这3个主题被文档d选中的概率都是个固定的值：P(z1|d) = 0.4、P(z2|d) = 0.5、P(z3|d) = 0.1，如下图所示（图截取自沈博PPT上）：</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141206001916157" alt="img"></p>
<ul>
<li>
<p>但在贝叶斯框架下的<strong>LDA中</strong>，我们<strong>不再</strong>认为</p>
<p>主题分布（各个主题在文档中出现的概率分布）和词分布（各个词语在某个主题下出现的概率分布）是唯一确定的（</p>
<p>而是随机变量</p>
<p>）</p>
<p>，而是有很多种可能。但一篇文档总得对应一个主题分布和一个词分布吧，怎么办呢？LDA为它们弄了两个Dirichlet先验参数，这个Dirichlet先验为某篇</p>
<p>文档随机抽取出某个主题分布和词分布。</p>
<ul>
<li>文档d产生主题z（准确的说，其实是Dirichlet先验为文档d生成主题分布Θ，然后根据主题分布Θ产生主题z）的概率，主题z产生单词w的概率都不再是某两个确定的值，而是随机变量。
<ul>
<li>还是再次举下文档d具体产生主题z的例子。给定一篇文档d，现在有多个主题z1、z2、z3，它们的主题分布{ P(zi|d), i = 1,2,3 }可能是{0.4,0.5,0.1}，也可能是{0.2,0.2,0.6}，即这些主题被d选中的概率都不再认为是确定的值，可能是P(z1|d) = 0.4、P(z2|d) = 0.5、P(z3|d) = 0.1，也有可能是P(z1|d) = 0.2、P(z2|d) = 0.2、P(z3|d) = 0.6等等，而主题分布到底是哪个取值集合我们不确定（为什么？这就是贝叶斯派的核心思想，把未知参数当作是随机变量，不再认为是某一个确定的值），但其先验分布是dirichlet 分布，所以可以从无穷多个主题分布中按照dirichlet 先验随机抽取出某个主题分布出来。如下图所示（图截取自沈博PPT上）：</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="https://img-blog.csdn.net/20141127192035125" alt="img"></p>
<p>换言之，LDA在pLSA的基础上给这两参数（<img src="https://img-blog.csdn.net/20141119231307918" alt="img">、<img src="https://img-blog.csdn.net/20141119231257263" alt="img">）加了两个先验分布的参数（贝叶斯化）：一个主题分布的先验分布Dirichlet分布<img src="https://img-blog.csdn.net/20141117160438989" alt="img">，和一个词语分布的先验分布Dirichlet分布<img src="https://img-blog.csdn.net/20141117160531515" alt="img">。</p>
<p>综上，LDA真的只是pLSA的贝叶斯版本，文档生成后，两者都要根据文档去推断其主题分布和词语分布（即两者本质都是为了估计给定文档生成主题，给定主题生成词语的概率），只是用的参数推断方法不同，在pLSA中用极大似然估计的思想去推断两未知的固定参数，而LDA则把这两参数弄成随机变量，且加入dirichlet先验。</p>
<p>所以，pLSA跟LDA的本质区别就在于它们去估计未知参数所采用的思想不同，前者用的是频率派思想，后者用的是贝叶斯派思想。<br>
好比，我去一朋友家：</p>
<ul>
<li>
<p>按照频率派的思想，我估计他在家的概率是1/2，不在家的概率也是1/2，是个定值。</p>
</li>
<li>
<p>而按照贝叶斯派的思想，他在家不在家的概率不再认为是个定值1/2，而是随机变量。比如按照我们的经验（比如当天周末），猜测他在家的概率是0.6，但这个0.6不是说就是完全确定的，也有可能是0.7。如此，贝叶斯派没法确切给出参数的确定值（0.3,0.4，0.6,0.7，0.8,0.9都有可能），但至少明白在哪个范围或哪些取值（0.6,0.7，0.8,0.9）更有可能，哪个范围或哪些取值（0.3,0.4） 不太可能。进一步，贝叶斯估计中，参数的多个估计值服从一定的先验分布，而后根据实践获得的数据（例如周末不断跑他家），不断修正之前的参数估计，从先验分布慢慢过渡到后验分布。</p>
<p>OK，相信已经解释清楚了。如果是在机器学习班上face-to-face，更好解释和沟通。</p>
</li>
</ul>
<p>4.3.2 LDA生成文档过程的进一步理解</p>
<p>上面说，LDA中，主题分布 —— 比如{ P(zi), i =1,2,3 }等于{0.4,0.5,0.1}或{0.2,0.2,0.6} —— 是由dirichlet先验给定的，不是根据文档产生的。所以，<strong>LDA生成文档的过程中，先从dirichlet先验中“随机”抽取出主题分布</strong>，然后从主题分布中“随机”抽取出主题，最后从确定后的主题对应的词分布中“随机”抽取出词。</p>
<p>那么，dirichlet先验到底是如何“随机”抽取主题分布的呢？</p>
<p>事实上，从dirichlet分布中随机抽取主题分布，这个过程不是完全随机的。为了说清楚这个问题，咱们得回顾下dirichlet分布。事实上，如果我们取3个事件的话，可以建立一个三维坐标系，类似xyz三维坐标系，这里，我们把3个坐标轴弄为p1、p2、p3，如下图所示：</p>
<p><img src="https://img-blog.csdn.net/20141128165431218" alt="img"></p>
<p>在这个三维坐标轴所划分的空间里，每一个坐标点(p1,p2,p3)就对应着一个主题分布，且某一个点(p1,p2,p3)的大小表示3个主题z1、z2、z3出现的概率大小（因为各个主题出现的概率和为1，所以p1+p2+p3 = 1，且p1、p2、p3这3个点最大取值为1）。比如(p1,p2,p3) = (0.4,0.5,0.1)便对应着主题分布{ P(zi), i =1,2,3 } = {0.4,0.5,0.1}。</p>
<p>可以想象到，空间里有很多这样的点(p1,p2,p3)，意味着有很多的主题分布可供选择，那dirichlet分布如何选择主题分布呢？把上面的斜三角形放倒，映射到底面的平面上，便得到如下所示的一些彩图（3个彩图中，每一个点对应一个主题分布，高度代表某个主题分布被dirichlet分布选中的概率，且<strong>选不同的<img src="https://img-blog.csdn.net/20141117181123550" alt="img">，dirichlet 分布会偏向不同的主题分布</strong>）：</p>
<p><img src="https://img-blog.csdn.net/20141118174935062" alt="img"></p>
<p>我们来看上图中左边这个图，高度就是代表dirichlet分布选取某个坐标点(p1,p2,p3)（这个点就是一个主题分布）的概率大小。如下图所示，平面投影三角形上的三个顶点上的点：A=(0.9,0.05,0.05)、B=(0.05,0.9,0.05)、C=(0.05,0.05,0.9)各自对应的主题分布被dirichlet分布选中的概率值很大，而平面三角形内部的两个点：D、E对应的主题分布被dirichlet分布选中的概率值很小。</p>
<p><img src="https://img-blog.csdn.net/20141128172421973" alt="img"><img src="https://img-blog.csdn.net/20141128172441161" alt="img"></p>
<p>所以虽然说dirichlet分布是随机选取任意一个主题分布的，但依然存在着P(A) = P(B) = P© &gt;&gt; P(D) = P(E)，即dirichlet分布还是“偏爱”某些主题分布的。至于dirichlet分布的参数<img src="https://img-blog.csdn.net/20141117181123550" alt="img">是如何决定dirichlet分布的形状的，可以从dirichlet分布的定义和公式思考。</p>
<p>此外，就算说“随机”选主题也是根据主题分布来“随机”选取，这里的随机不是完全随机的意思，而是根据各个主题出现的概率值大小来抽取。比如当dirichlet先验为文档d生成的主题分布{ P(zi), i =1,2,3 }是{0.4,0.5,0.1}时，那么主题z2在文档d中出现的概率便是0.5。所以，从主题分布中抽取主题，这个过程也不是完全随机的，而是按照各个主题出现的概率值大小进行抽取。</p>
<p>4.3.3 pLSA跟LDA的概率图对比</p>
<p>接下来，对比下LDA跟pLSA的概率模型图模型，左图是pLSA，右图是LDA（右图不太规范，z跟w都得是小写， 其中，阴影圆圈表示可观测的变量，非阴影圆圈表示隐变量，箭头表示两变量间的条件依赖性conditional dependency，方框表示重复抽样，方框右下角的数字代表重复抽样的次数）：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141118234229125" alt="img">     <img src="https://img-blog.csdn.net/20141120172828681" alt="img"></p>
</blockquote>
<p>对应到上面右图的LDA，只有W / w是观察到的变量，其他都是隐变量或者参数，其中，Φ表示词分布，Θ表示主题分布，<img src="https://img-blog.csdn.net/20141117160438989" alt="img"> 是主题分布Θ的先验分布（即Dirichlet 分布）的参数，<img src="https://img-blog.csdn.net/20141117160531515" alt="img">是词分布Φ的先验分布（即Dirichlet 分布）的参数，N表示文档的单词总数，M表示文档的总数。</p>
<p>所以，对于一篇文档d中的每一个单词，LDA根据先验知识<img src="https://img-blog.csdn.net/20141117160438989" alt="img">确定某篇文档的主题分布θ，然后从该文档所对应的多项分布（主题分布）θ中抽取一个主题z，接着根据先验知识<img src="https://img-blog.csdn.net/20141117160531515" alt="img">确定当前主题的词语分布ϕ，然后从主题z所对应的多项分布（词分布）ϕ中抽取一个单词w。然后将这个过程重复N次，就产生了文档d。</p>
<p>换言之：</p>
<ol>
<li>假定语料库中共有M篇文章，每篇文章下的Topic的<strong>主题分布</strong>是一个<strong>从参数为<img src="https://img-blog.csdn.net/20141117160438989" alt="img">的Dirichlet先验分布中采样得到</strong>的Multinomial分布，每个Topic下的<strong>词分布</strong>是一个<strong>从参数为<img src="https://img-blog.csdn.net/20141117160531515" alt="img">的Dirichlet先验分布中采样得到</strong>的Multinomial分布。</li>
<li>对于某篇文章中的第n个词，首先从该文章中出现的每个主题的Multinomial分布**（主题分布）中选择或采样一个主题**，然后再在这个主题<strong>对应的</strong>词的Multinomial分布**（词分布）中选择或采样一个词**。不断重复这个随机生成过程，直到M篇文章全部生成完成。</li>
</ol>
<p>综上，M 篇文档会对应于 M 个独立的 Dirichlet-Multinomial 共轭结构，K 个 topic 会对应于 K 个独立的 Dirichlet-Multinomial 共轭结构。</p>
<ul>
<li>其中，<img src="https://img-blog.csdn.net/20141117160438989" alt="img">→θ→z 表示生成文档中的所有词对应的主题，显然 <img src="https://img-blog.csdn.net/20141117160438989" alt="img">→θ 对应的是Dirichlet 分布，θ→z 对应的是 Multinomial 分布，所以整体是一个 Dirichlet-Multinomial 共轭结构，如下图所示：</li>
</ul>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141120174743000" alt="img"></p>
</blockquote>
<ul>
<li>类似的，<img src="https://img-blog.csdn.net/20141117160531515" alt="img">→φ→w，容易看出， 此时β→φ对应的是 Dirichlet 分布， φ→w 对应的是 Multinomial 分布， 所以整体也是一个Dirichlet-Multinomial 共轭结构，如下图所示：</li>
</ul>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141120174912796" alt="img"></p>
</blockquote>
<p>4.3.4 pLSA跟LDA参数估计方法的对比</p>
<p>上面对比了pLSA跟LDA生成文档的不同过程，下面，咱们反过来，假定文档已经产生，反推其主题分布。那么，它们估计未知参数所采用的方法又有什么不同呢？</p>
<ul>
<li>在pLSA中，我们使用EM算法去估计“主题-词项”矩阵Φ（由<img src="https://img-blog.csdn.net/20141119231257263" alt="img">转换得到）和“文档-主题”矩阵Θ（由<img src="https://img-blog.csdn.net/20141119231307918" alt="img">转换得到）这两个参数，而且这两参数都是个固定的值，只是未知，使用的思想其实就是极大似然估计MLE。</li>
<li><strong>而在LDA中，估计*<em>Φ、**Θ这两**</em>*未知参数可以用变分(Variational inference)-EM算法，也可以用<strong><strong>gibbs采样，前者的思想是</strong></strong>最大后验估计MAP</strong>（MAP与MLE类似，都把未知参数当作固定的值）**，后者的思想是****贝叶斯估计。**贝叶斯估计是对MAP的扩展，但它与MAP有着本质的不同，即贝叶斯估计把待估计的参数看作是服从某种先验分布的随机变量。
<ul>
<li>关于贝叶斯估计再举个例子。假设中国的大学只有两种：理工科和文科，这两种学校数量的比例是1:1，其中，理工科男女比例7:1，文科男女比例1:7。某天你被外星人随机扔到一个校园，问你该学校可能的男女比例是多少？然后，你实际到该校园里逛了一圈，看到的5个人全是男的，这时候再次问你这个校园的男女比例是多少？</li>
</ul>
</li>
</ul>
<ol>
<li>因为刚开始时，有先验知识，所以该学校的男女比例要么是7:1，要么是1:7，即P(比例为7:1) = 1/2，P(比例为1:7) = 1/2。</li>
<li>然后看到5个男生后重新估计男女比例，其实就是求P(比例7:1|5个男生）= ？，P(比例1:7|5个男生) = ？</li>
<li>用贝叶斯公式<img src="https://img-blog.csdn.net/20141110213025473" alt="img">，可得：P(比例7:1|5个男生) = P(比例7:1)*P(5个男生|比例7:1) / P(5个男生)，P(5个男生)是5个男生的先验概率，与学校无关，所以是个常数；类似的，P(比例1:7|5个男生) = P((比例1:7)*P(5个男生|比例1:7)/P(5个男生)。</li>
<li>最后将上述两个等式比一下，可得：P(比例7:1|5个男生)/P(比例1:7|5个男生) = {P((比例7:1)*P(5个男生|比例7:1)} / { P(比例1:7)*P(5个男生|比例1:7)}。</li>
</ol>
<p>由于LDA把要估计的主题分布和词分布看作是其先验分布是Dirichlet分布的随机变量，所以，在LDA这个估计主题分布、词分布的过程中，它们的先验分布（即Dirichlet分布）事先由人为给定，那么LDA就是要去求它们的后验分布（LDA中可用gibbs采样去求解它们的后验分布，得到期望<img src="https://img-blog.csdn.net/20141122141624588" alt="img">、<img src="https://img-blog.csdn.net/20141122141643109" alt="img">）！</p>
<p>此外，不厌其烦的再插一句，在LDA中，主题分布和词分布本身都是多项分布，而由上文3.2节可知“Dirichlet分布是多项式分布的共轭先验概率分布”，因此选择Dirichlet 分布作为它们的共轭先验分布。意味着为多项分布的参数p选取的先验分布是Dirichlet分布，那么以p为参数的多项分布用贝叶斯估计得到的后验分布仍然是Dirichlet分布。</p>
<p>4.3.5 LDA参数估计：Gibbs采样</p>
<p>理清了LDA中的物理过程，下面咱们来看下如何学习估计。</p>
<p>类似于pLSA，LDA的原始论文中是用的变分-EM算法估计未知参数，后来发现另一种估计LDA未知参数的方法更好，这种方法就是：Gibbs Sampling，有时叫Gibbs采样或Gibbs抽样，都一个意思。Gibbs抽样是马尔可夫链蒙特卡尔理论（MCMC）中用来获取一系列近似等于指定多维概率分布（比如2个或者多个随机变量的联合概率分布）观察样本的算法。</p>
<p>OK，给定一个文档集合，w是可以观察到的已知变量，<img src="https://img-blog.csdn.net/20141117160438989" alt="img">和<img src="https://img-blog.csdn.net/20141117160531515" alt="img">是根据经验给定的先验参数，其他的变量z，θ和φ都是未知的隐含变量，需要根据观察到的变量来学习估计的。根据LDA的图模型，可以写出所有变量的联合分布：</p>
<p><img src="https://img-blog.csdn.net/20141121010801261" alt="img"></p>
<p>注：上述公式中及下文中，<img src="https://img-blog.csdn.net/20141121011305243" alt="img">等价上文中定义的<img src="https://img-blog.csdn.net/20141117160518098" alt="img">，<img src="https://img-blog.csdn.net/20141121011310969" alt="img">等价于上文中定义的<img src="https://img-blog.csdn.net/20141117160656067" alt="img">，<img src="https://img-blog.csdn.net/20141121011424772" alt="img">等价于上文中定义的<img src="https://img-blog.csdn.net/20141117160613962" alt="img">，等价于上文中定义的<img src="https://img-blog.csdn.net/20141117160452327" alt="img">。</p>
<p>因为<img src="https://img-blog.csdn.net/20141117160438989" alt="img">产生主题分布θ，主题分布θ确定具体主题，且<img src="https://img-blog.csdn.net/20141117160531515" alt="img">产生词分布φ、词分布φ确定具体词，所以上述式子等价于下述式子所表达的<strong>联合概率分布<img src="https://img-blog.csdn.net/20141121101528765" alt="img"></strong>：</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141121100115734" alt="img"></p>
</blockquote>
<p>其中，<strong>第一项因子<img src="https://img-blog.csdn.net/20141121101735203" alt="img">表示的是根据确定的主题<img src="https://img-blog.csdn.net/20141121102832253" alt="img">和词分布的先验分布参数<img src="https://img-blog.csdn.net/20141117160531515" alt="img">采样词的过程，第二项因子<img src="https://img-blog.csdn.net/20141121101731716" alt="img">是根据主题分布的先验分布参数<img src="https://img-blog.csdn.net/20141117160438989" alt="img">采样主题的过程，这两项因子是****需要计算的两个未知参数</strong>。</p>
<p>由于这两个过程是独立的，所以下面可以分别处理，各个击破。</p>
<p>第一个因子<img src="https://img-blog.csdn.net/20141121101735203" alt="img">，可以根据确定的主题<img src="https://img-blog.csdn.net/20141121102832253" alt="img">和从先验分布<img src="https://img-blog.csdn.net/20141117160531515" alt="img">取样得到的词分布Φ产生：</p>
<p><img src="https://img-blog.csdn.net/20141121100114141" alt="img"></p>
<p>由于样本中的词服从参数为主题<img src="https://img-blog.csdn.net/20141121103415953" alt="img">的独立多项分布，这意味着可以把上面对词的乘积分解成分别对主题和对词的两层乘积：</p>
<p><img src="https://img-blog.csdn.net/20141121100719993" alt="img"></p>
<p>其中，<img src="https://img-blog.csdn.net/20141121100128328" alt="img">是词 t 在主题 k 中出现的次数。</p>
<p>回到第一个因子上来。目标分布<img src="https://img-blog.csdn.net/20141121103631468" alt="img">需要对词分布Φ积分，且结合我们之前在3.1节定义的Dirichlet 分布的归一化系数<img src="https://img-blog.csdn.net/20141121104155483" alt="img">的公式</p>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141121111405799" alt="img"></p>
</blockquote>
<p>可得：</p>
<p><img src="https://img-blog.csdn.net/20141121100131691" alt="img"></p>
<p>这个结果可以看作K个Dirichlet-Multinomial模型的乘积。<br>
现在开始求第二个因子<img src="https://img-blog.csdn.net/20141121101731716" alt="img">。类似于<img src="https://img-blog.csdn.net/20141121100137666" alt="img">的步骤，先写出条件分布，然后分解成两部分的乘积：</p>
<p><img src="https://img-blog.csdn.net/20141121100152921" alt="img"></p>
<p>其中，<img src="https://img-blog.csdn.net/20141119004838164" alt="img"> 表示的单词 i 所属的文档，<img src="https://img-blog.csdn.net/20141121100159437" alt="img">是主题 k 在文章 m 中出现的次数。</p>
<p>对主题分布Θ积分可得：</p>
<p><img src="https://img-blog.csdn.net/20141121100156011" alt="img"></p>
<p>综合第一个因子和第二个因子的结果，<strong>得到<img src="https://img-blog.csdn.net/20141121101528765" alt="img">的联合分布结果为</strong>：</p>
<p><img src="https://img-blog.csdn.net/20141121100200504" alt="img"></p>
<p>接下来，<strong>有了联合分布<img src="https://img-blog.csdn.net/20141121101528765" alt="img">，咱们便可以通过联合分布来计算在给定可观测变量 w 下的隐变量 z 的条件分布（后验分布）<img src="https://img-blog.csdn.net/20141124000913687" alt="img">来进行贝叶斯分析</strong>。</p>
<p>换言之，有了这个联合分布后，要求解第m篇文档中的第n个词（下标为<img src="https://img-blog.csdn.net/20141121114116267" alt="img">的词）的全部条件概率就好求了。</p>
<p>先定义几个变量。<img src="https://img-blog.csdn.net/20141121114858171" alt="img">表示除去<img src="https://img-blog.csdn.net/20141121114902718" alt="img">的词，<img src="https://img-blog.csdn.net/20141121114217201" alt="img">，<img src="https://img-blog.csdn.net/20141121114238885" alt="img">。</p>
<p>然后，排除当前词的主题分配，即根据其他词的主题分配和观察到的单词来计算当前词主题的概率公式为：</p>
<p><img src="https://img-blog.csdn.net/20141121114250569" alt="img"></p>
<p>勘误：考虑到<img src="https://img-blog.csdn.net/20160121160044384" alt="img">，所以上述公式的第二行的分子，非p(w,z) *p(z)，而是p(w|z)*p(z)。</p>
<p>且有：</p>
<p><img src="https://img-blog.csdn.net/20141121135231473" alt="img"></p>
<p>最后一步，便是根据Markov链的状态<img src="https://img-blog.csdn.net/20141121103415953" alt="img">获取主题分布的参数Θ和词分布的参数Φ。</p>
<p>换言之根据贝叶斯法则和Dirichlet先验，以及上文中得到的<img src="https://img-blog.csdn.net/20141121133110586" alt="img">和<img src="https://img-blog.csdn.net/20141121133116935" alt="img">各自被分解成两部分乘积的结果，可以计算得到<strong>每个文档上Topic的后验分布和每个Topic下的词的后验分布分别如下（<strong>据上文可知：其后验分布跟它们的先验分布一样，也都是Dirichlet 分布</strong>）</strong>：</p>
<p><img src="https://img-blog.csdn.net/20141121122941710" alt="img"></p>
<p>其中，<img src="https://img-blog.csdn.net/20141121123131296" alt="img">是构成文档m的主题数向量，<img src="https://img-blog.csdn.net/20141121123130052" alt="img">是构成主题k的词项数向量。</p>
<p>此外，别忘了上文中2.4节所述的Dirichlet的一个性质，如下：</p>
<p><strong>“</strong> 如果<img src="https://img-blog.csdn.net/20141117211131796" alt="img">，同样可以证明有下述结论成立：</p>
<p><img src="https://img-blog.csdn.net/20141117211142562" alt="img"></p>
<p>即：如果<img src="https://img-blog.csdn.net/20141121133928937" alt="img">，则<img src="https://img-blog.csdn.net/20141121133928070" alt="img">中的任一元素<img src="https://img-blog.csdn.net/20141121133937197" alt="img">的期望是：</p>
<p><img src="https://img-blog.csdn.net/20141121134006609" alt="img"></p>
<p>可以看出，超参数<img src="https://img-blog.csdn.net/20141121134008709" alt="img">的直观意义就是事件先验的伪计数(prior pseudo-count)。 <strong>”</strong><br>
所以，<strong>最终求解的Dirichlet 分布期望为</strong>：</p>
<blockquote>
<blockquote>
<p><img src="https://img-blog.csdn.net/20141121123225837" alt="img"></p>
</blockquote>
</blockquote>
<p>然后将<img src="https://img-blog.csdn.net/20141121123447751" alt="img">和<img src="https://img-blog.csdn.net/20141121123507265" alt="img">的结果代入之前得到的<img src="https://img-blog.csdn.net/20141121135643522" alt="img">的结果中，可得：</p>
<p><img src="https://img-blog.csdn.net/20141121135716671" alt="img"></p>
<p>仔细观察上述结果，可以发现，式子的右半部分便是<img src="https://img-blog.csdn.net/20141121135724875" alt="img">，这个概率的值对应着<img src="https://img-blog.csdn.net/20141121135730453" alt="img">的路径概率。如此，K 个topic 对应着K条路径，Gibbs Sampling 便在这K 条路径中进行采样，如下图所示：</p>
<p><img src="https://img-blog.csdn.net/20141121135741734" alt="img"></p>
<p>何等奇妙，就这样，Gibbs Sampling通过求解出主题分布和词分布的后验分布，从而成功解决主题分布和词分布这两参数未知的问题。</p>
]]></content>
      <tags>
        <tag>-Topic Modeling -LDA -Dirichlet 分布</tag>
      </tags>
  </entry>
  <entry>
    <title>LDA Modeling Practise</title>
    <url>/2023/08/31/Practise/</url>
    <content><![CDATA[<p>[TOC]</p>
<h1>前言</h1>
<p>1、[转自]<a href="https://blog.csdn.net/pi9nc/article/details/9017153">概率主题模型简介 Introduction to Probabilistic Topic Models_pi9nc的博客-CSDN博客</a>，为<a href="http://www.cs.princeton.edu/~blei/topicmodeling.html">David M. Blei</a>所写的《<a href="http://www.cs.princeton.edu/~blei/papers/Blei2012.pdf">Introduction to Probabilistic Topic Models</a>》的译文</p>
<p>2、转自一篇国外小哥的博客，具体在哪儿发现的找不到了，等可以科学上网的时候补上</p>
<h1>Introduction to Probabilistic Topic Models</h1>
<p>摘要：概率主题模型是一系列旨在发现隐藏在大规模文档中的主题结构的算法。本文首先回顾了这一领域的主要思想，接着调研了当前的研究水平，最后展望某些有所希望的方向。从最简单的主题模型——潜在狄立克雷分配（Latent Dirichlet Allocation，LDA）出发，讨论了其与概率建模的联系，描述了用于主题发现的两种算法。主题模型日新月异，被扩展和应用许多领域，其中不乏有趣之处。我们调研发现很多扩展都弱化了LDA的统计假设，加入元数据（meta-data）进行文档分析，使用近似的模型分析如社会网络、图像和基因这类多样化的数据类型。我们在文章的最后给出了主题模型目前还未探索但很重要的方向，包括严格检验数据模型的方法，文本和其它高维数据可视化的新技术，以及如何从传统信息工程中的应用推广到更多科学应用。</p>
<h2 id="引言">引言</h2>
<p>如今公开的知识日益以新闻、博客、网页、科学论文、书籍、图像、声音、视频和社交网络的形式被数字化存储，巨大的信息量同时也增加了人们寻找和发现自己所需要的知识的难度。人们需要新的计算工具以组织、搜索和理解这些庞大的信息量。现在的在线信息挖掘使用两种主要的工具——搜索和链接。向搜索引擎提交关键词就可以找到相关的文档和其它相链接的文档。这种与在线文档的交互方式虽然有效，但却丢失了某些信息。<br>
假设所要搜索和寻找的文档由各类主题组成。这样，通过对文章进行“放大”和“缩小”就可以得到较具体或者较粗略的主题；在文档中就可以看到这些主题是如何随着时间变化，或者说是如何相互联系的。搜索文档就不只是通过关键词寻找，取而代之的是先找到相关的主题，然后再查找与这一主题相关的文档。<br>
拿纽约时报所记载的历史举例。从较广的层次来看，报纸中的主题就对应着报纸各个版块——对外政策、国内事务、体育，再拿对外政策进行“放大”，就可以得到其不同方面——中国对外政策、中东冲突、英国与俄罗斯的关系。接下来，我们跟踪这些专题是如何随着时间演变的，例如过去50年里的中东冲突。如此这般探索就能找到与主题相关的原始文档。可见，这种主题结构是探索和理解文档的新窗口。<br>
但以这种方法与电子文档进行交互是不现实的，因为随着网上文本的数量越来越多，单单仅靠人力已经无法全部阅读和研究所有的文本。由此，概率主题建模应运而生。机器学习领域的研究人员们开发出了一套旨在发现和标记大规模文档的主题信息的算法。主题建模算法是一种统计方法，它通过分析原文本中的词以发现蕴藏于其中的主题，主题间的联系，以及主题随时间的演变（就比如后面图3，通过分析耶鲁法律找到主题），而且不需要事前对文档进行标记。也就是说，人力所无法完成的文档标记，主题建模算法能够进行组织和归纳。</p>
<h2 id="潜在狄立克雷分配">潜在狄立克雷分配</h2>
<p>潜在狄立克雷分配（LDA）是最简单的主题模型，其基础是文档是由多个主题构成的。如图1所示，《Seeking Life’s Bare(Genetic) Necessities》是一篇对基因数量进行数据分析的文章（基因是有机体赖以进化的基础）。<br>
<img src="https://images0.cnblogs.com/blog/401489/201301/30080332-dd3fabd59925417eaf349c6732931bf5.png" alt="img"><br>
图1：潜在狄立克雷分配的直观现象。如图左所示，假设主题是词语上的概率分布；图右是主题直方图。从直方图到文章的词的过程是这样的：首先随机产生一个主题直方图，然后选择其中一主题，最后从该主题对应的主题分布中选择一个词。这里的主题和主题直方图只作说明之用，与文章其实并不相匹配。相匹配的主题见图2。</p>
<p>文章中不同的词被高亮在不同的颜色。如“computer”和“prediction”之类有关数据分析的词以蓝色标记；如“life”和“organism”之类关于进化生物学的词以粉红色标记；如“sequenced”和“genes”之类有关遗传学的词以黄色标记。将所有词语进行这样的标记，并剔除“and”、“but”和“if”这类包含极少主题内容的词语后可以发现，这篇文章由不同主题以不同的比例组成，更进一步地看，多个主题可以帮助人们在一堆科技论文中发现这篇文章。<br>
建立在文档集合上的统计模型LDA就试图描述上述直观的现象。LDA可以看作是一个文档产生的过程（2.1节将具体解释概率模型LDA）。形式化地定义主题是固定的词语的概率分布。例如，“遗传学”主题中“genes”的概率就相当高，类似地，“进化生物学”主题中“life”的概率也相对较高。假设所有的主题在文档产生之前就已经产生且指定。生成文档（或者说生成文档中的词）可以看成是如下两个过程：</p>
<ol>
<li>随机产生一个主题直方图（或者说分布）；</li>
<li>对文档中的每个词：
<ol>
<li>(a) 从第一步产生的直方图里随机选择一个主题；</li>
<li>(b) 从主题对应的词语的概率分布中随机选择一个词。</li>
</ol>
</li>
</ol>
<p>从文档产生的过程来看，第一步使得每篇文档由不同主题以不同比例组成。第二步的第二小步（b）使得每篇文档中每个词从一个主题中得来，其中的主题从第一小步（a）得来。实际上，第一步主题直方图（或者说分布）是一个狄立克雷分布（Dirichlet distribution），其作用是将文档中的词分配给不同的主题，那为什么是潜在的呢？且听后面分解。<br>
对图1所示的文章来说，主题直方图中主题“遗传学”、“数据分析”和“进化生物学”都会占一定比例，文章中每个词都由这三个主题中的一个所给出。文档集中也可能会有一篇关于“数据分析”和“神经科学”；其主题直方图中这两个主题都将占有一定的比例；这就是潜在狄立克雷分配的显著特征——集合中所有文档共享同一主题集合，但每个文档中各个主题所占的比例又都各不相同。<br>
如前引言所述，主题建模的目的是为了自动地发现文档集中的主题。文档自然是可被观察到的，但主题结构——主题、主题直方图（或者分布）和主题的词分布——却是隐藏的。所以主题建模的中心问题就是利用看到的文档推断出隐藏的主题结构，其实也就是产生文档的逆过程。<br>
<img src="https://images0.cnblogs.com/blog/401489/201301/30080433-9031b8dee6064377b68aac2ca4f99866.png" alt="img"><br>
图2：图1的LDA。我们从《自然》上的17000篇文章提取100个主题及其相关词，然后对图1所示的文章进行分析，左边是主题所占比例的直方图，右边是文章常见主题的最常出现的前15个词。</p>
<p>如图2所示，就是一个推断图1中文章的例子。使用主题建模算法（假设有100个主题）推断《科学》上17000篇文章的潜在主题结构，然后推断出最能描述图1中示例文章的主题分布（图左）。需要注意的是，尽管主题分布上有无穷个主题，但事实上只有其中的一小部分的概率不为零。进一步地，文章中词可被分主题进行组织，可以看到最常见的主题所包含的概率最大的词。<br>
需要强调的是，算法事先并不知道这些主题，文章也未有关键词或主题标记。计算潜在结构得到的主题分布可以产生所观察到的文档集合（由推断算法产生的主题对所分析的文档集合几乎都具有可解释性，主题似乎与语言的统计结构和LDA的具体概率假设有关）。如图3显示了《Yale Law Journal》中发现的主题（这里设置主题数为20）。主题由基因和数据分析替换为歧视和合同法。主题建模是管理、组织和标记大规模文本的一种算法。推断得到的隐藏结构近似于文档集的主题结构，能标记文档集中各个文档。这代替了痛苦的手工标记，并有助于信息检索，分类和语料库搜索。</p>
<h3 id="lda和概率模型">LDA和概率模型</h3>
<p>LDA和其它主题模型都属于概率建模这一更大领域。数据被看作是经过包括隐藏变量在内的生成过程得到的。生成过程定义了观测随机变量和隐藏随机变量的联合概率分布。通过使用联合分布来计算在给定观测变量下隐藏变量的条件分布（后验分布）来进行数据分析。对于LDA来说，观测变量就是文档中的词；隐藏变量就是主题结构；生成过程如之前所述。那么推测从文档中隐藏的主题结构的问题其实就是计算在给定文档下隐藏变量的条件分布（后验分布）。<br>
形式化地定义如下：所有主题为β1:K，其中βk是第k个主题的词的分布（如图1左部所示）。第d个文档中主题所占的比例为θd，其中θd,k表示第k个主题在第d个文档中的比例（图1右部的直方图）。第d个文档的主题全体为zd，其中zd,n是第d个文档中第n个词的主题（如图1中有颜色的圆圈）。第d个文档中所有词记为wd，其中wd,n是第d个文档中第n个词，每个词都是固定的词汇表中的元素。那么LDA的生成过程对应的观测变量和隐藏变量的联合分布如下：</p>
<p>p(β1:K,θ1:D,z1:D,w1:D)=∏i=1Kp(β)∏d=1Dp(θd)(∏n=1Np(zd,n|θd)p(wd,n|β1:K,zd,n))</p>
<p>（1）</p>
<p>这一分布指明变量之间的依赖关系。例如，zd,n依赖于θd，wd,n依赖于zd,n和β1:K（在操作上，先确定zd,n指的哪个主题，然后再看wd,n在主题中的概率）。正是这些依赖定义了LDA：它们存在于生成过程的统计假设里，在联合分布的特定数学形式里以及LDA的概率图模型里（概率图模型为描述概率分布提供一个图形化的语言，如图4所示。事实上概率图模型是阐明概率独立、图理论和计算概率分布的算法的有力工具）。这三种表现形式在描述LDA的概率假设上是等价的。<br>
<img src="https://images0.cnblogs.com/blog/401489/201301/30080525-a2e8a8fdf5a1498ea3555d111d381b59.png" alt="img"><br>
图4:LDA的图模型。每个结点表示一个随机变量，并且根据其在生成过程中的角色予以标记（见图1）。隐藏变量对应的结点是白色的，观测变量wd,n对应的结点是灰色的。在图模型中，矩形表示变量的重复。</p>
<p>从历史来看，潜在语义分析中最具开创性的研究是对文档词矩阵进行奇异值分解得到词之间，文档之间和文档与词之间的潜在联系。概率潜在语义分析（probabilistic latent semantic analysis,pLSI）是它的概率版本，而LDA是用以解决pLSI的问题，可以看作是对离散数据进行主成分分析。下一章节将详细描述LDA的推断算法。</p>
<h3 id="lda后验概率的计算">LDA后验概率的计算</h3>
<p>使用前面的记号，LDA后验概率的公式为</p>
<p>p(β1:K,θ1:D,z1:D|w1:D)=p(β1:K,θ1:D,z1:D,w1:D)p(w1:D)</p>
<p>分子为随机变量的联合分布。对于隐藏变量的任何值来说，联合分布是容易计算的。分母是观测变量的边际概率，是通过观察可见的语料库得到的概率。理论上，可以通过将联合分布对隐藏变量的所有可能值进行累加得到。但其计算量在实际操作中是异常庞大的（对于一个主题，这种累加包括了将每个词的所有可能的主题配置，而且文档集合通常有数量级达百万的词）。就像众多现代概率模型（包括贝叶斯统计）那样，后验概率的分母（即先验概率）往往是无法计算得到的。故而现代概率建模的一个核心研究目标就是尽一切可能接近之。如前图1和图3所述的那样，主题建模算法其实是求得近似后验分布的常用方法的一种变种。<br>
主题建模算法主要有两类：基于采样的算法和变分算法。基于采样的算法通过收集后验分布的样本，以样本的分布求得后验分布的近似。主题建模中最常用的采样算法是吉布斯采样（Gibbs sampling），通过吉布斯采样构造马尔可夫链（Markov chain），而马尔可夫链的极限分布就是后验分布。马尔可夫链是由独立于前一个随机变量的随机变量组成的串。对主题模型来说，随机变量就是定义在一个特定的语料库上的隐藏主题。采样算法从马尔可夫链的极限分布上收集样本，再用这些样本来近似后验分布。通常，只有概率最高的样本会被收集以作为主题结构的近似。<br>
变分算法的确定性要比基于采样算法高上不少。变分算法先假定一族在隐藏结构之上的参数化的分布，再寻找与后验分布最接近的分布（概率分布之间的距离使用信息论的Kullback-Leibler散度度量，）。也就说，推断问题转换为了最优化问题。变分算法的创新之处也正在于此，它将最优化引入了概率建模中。文献[8]介绍了协调上升的变分推断算法；文献[20]介绍了一个更为快速的在线算法（以及开源软件），它能轻松处理上百万文档并能适应文本流的集合。<br>
粗略地讲，这两种算法都在主题结构上进行了搜索，而固定的文档集合提供了搜索的方向。哪种方法更适合取决于所使用的具体的主题模型（下面的章节会介绍除LDA以外的其它主题模型），而这通常是学院派们争论的导火索。文献[1]很好地讨论了这两种方法的优缺点。</p>
<h2 id="主题建模的研究进展">主题建模的研究进展</h2>
<p>简单的LDA模型提供发现和探索大规模文本中隐藏主题结构的有力工具。LDA形式化为概率模型的一个主要优点在于它可以作为一个模块被其它更复杂的模块应用更为复杂的应用系统中。</p>
<h3 id="弱化lda的假设">弱化LDA的假设</h3>
<p>LDA由对语料库的统计假设定义，主题建模研究领域中一个热点就是如何弱化和扩展这些假设以发现文本中更加复杂的结构。<br>
如果不考虑词在文档中的顺序，那么一个文档就是一个词袋。“词袋”就是LDA的一个假设（对于文档中词的任意排列，式（1）都不变）。这个假设当然不符合现实，对于复杂的诸如语言生成之类的目标显然是不合适的，但对发现文本语义结构是有理可循的（缓慢移动图1文章中的词，尽管词移动了位置，文章仍然与遗传学相关）。LDA上模型的不可交换的词也有诸多扩展。例如，文献[36]弱化了词袋模型，假设主题生成词时以前一个词作为条件；文献[18]提出了在LDA和隐马尔可夫模型之间进行切换的主题模型。这些模型显著地扩展了参数空间，并且显示了语言建模带来的性能提升。<br>
LDA的另一个假设是文档的顺序与LDA无关（对于文档的任意顺序的排列，式（1）同样不变）。但当文档集所跨越的时间有几年或几个世纪时，这个假设可能就不合理了。当遇到这样的集合时，通常假设主题是随着时间而发生变化的。这样，主题就是动态的[5]。动态主题模型考虑了文档的先后顺序，并给出了内涵比LDA更丰富后验主题结构。图5展示了使用动态主题模型分析所有科学杂志得到的一个主题。这个主题就不只是词的单一分布，而是词的一连串分布。这样，潜在的主题就可以被发现和跟踪。<br>
<img src="https://images0.cnblogs.com/blog/401489/201301/30080550-8b03186099274b28b0d0e1ce81765987.png" alt="img"><br>
图5：两个主题的动态主题模型。这个模型的语料库是1880年到2002年的《科学》杂志。图中每十年提取一些常见词。</p>
<p>LDA的第三个假设是主题的数量已知且固定。贝叶斯非参数主题模型[34]提供了：在后验推断中文档集决定了主题数量，而且新文档中会有前面文档所没有的主题。贝叶斯非参数主题模型可以通过数据推断，扩展成一系列从较通用到较具体的主题层次，就像一棵主题树一样。<br>
LDA还有弱化其它假设的扩展。相关主题模型[6]和弹球分配机器[24]将同时出现的主题视作相关（例如与地理有关的文档可能运动相关，但它更可能与化学相关）；球状主题模型[28]允许词不太可能在主题中出现（例如，“扭伤”显然不太可能出现有关“猫”的主题里）；稀疏主题模型进一步强化了主题分布的结构[37]；而“稠密”主题模型则是词数的一个更符合实际的模型[15]。</p>
<h3 id="结合元数据">结合元数据</h3>
<p>在文本分析配置中，文档通常包含些诸如作者、题目、地理位置、链接等其它额外信息。这些信息可以被用于适配主题模型。目前如何结合这些元数据是百家争鸣。<br>
作者主题模型[29]是较早成功的例子。每个作者拥有一个主题直方图；多个作者的论文中的词由其中一个作者的主题直方图决定。作者主题模型允许从作者或文档进行推断。Rosen-Zvi等人在论文中展示利用作者的主题直方图计算作者间的相似性的例子，而LDA是无法胜任这一工作的。又比如，由于许多文档集合通常是相互链接的（例如科技论文相互引用或者网页相互链接），一些主题模型就考虑将那些链接用以估计主题。关系主题模型[13]假设所有文档都由LDA生成，文档间的链接取决于它们主题直方图的距离。关系主题模型不仅是新的主题模型，而且是新的网络模型，其与传统网络统计模型不同之处在于，它将用于为链接建模的节点属性（文档的词）考虑在内。<br>
其它结合元数据的主题模型有语言结构模型[10]，关注语料库间的距离的模型[38]，命名实体模型[26]。更一般的方法包括狄立克雷多项式回归模型[25]和监督主题模型[7]。</p>
<h3 id="其他类型的数据">其他类型的数据</h3>
<p>在LDA中，主题是词上的离散分布，并用于产生文档中的词（观测值）。LDA的一个优势在于其主题参数和数据生成所用的分布，它们经过微调就可以适配于其它类型的观测值所对应的推断算法。LDA作为典型的主题模型，可以看作是分组数据的成员混合模型（mixed-membership model），而不只是将一组文档（观测值）与一个主题（部件）相关。每组文档都以不同的比例包含着不同的主题。为了适配诸如调查数据、用户偏好、声频和音乐、计算机代码、网络日志和社交网络这些多种多样的数据，LDA衍生出众多模型来处理和分析之。下面介绍两个成员混合模型已取得显著成功的领域。<br>
在群体遗传学中，研究人员也独立地开发出了相同的概率模型，用以在个体采样得到的基因中寻找人类祖先（例如，人类从非洲、欧洲或中东等地起源）[27]。基本原理是每个个体的基因型是由一个或多个祖先群体遗传的。生物学家们通过与LDA非常相似的模型，描述了在这些人群中的基因模式（即“主题”），并辨认出单个个体的基因组成（即“主题直方图”）。这一模型如此有效的原因就在于即使具有“纯种”祖先基因的个体不存在，其基因模式依然可以假设，并通过实验得到。<br>
LDA模型的推断算法还可用于自然图像的检索、分类和组织，因此LDA也被广泛地应用于计算机视觉中。研究者们已经从图像到文档做了一个直接的类比。在文档分析的假设中，每个文档包含多个主题，文档集中的所有文档共享同一个主题集。在图像分析的假设中，每副图像是多个视觉模式的组合，同一个视觉模式在图像集中不断重现（预处理阶段会分析图像以得到视觉模式（或者“视觉单词”）的集合）。主题模型在计算机视觉中被用于图像分类[16]，关联图像和字幕[4]，建立图像层次[2,23,31]等。</p>
<h2 id="展望">展望</h2>
<p>主题模型是机器学习的新兴领域，有很多新方向亟待探索。<br>
评价和模型验证 主题模型的评测和有效性脱节。一般的评价过程如下，首先取一部分语料做为测试集，然后从剩下的语料中训练不同的主题模型，并在测试集上度量其近似性（例如概率），最后选择性能最好的模型。但主题模型通常是用于组织、总结和帮助研究者探索大规模语料，技术上无法保证，准确性越高，组织性就越好或者解释得就越简单。主题建模的一个开放课题是与算法使用相匹配的评测方法。那么如何基于主题的解释性来比较主题模型呢？这就是模型验证问题，当面对一个新语料和新问题时，应该如何选择主题模型呢？哪些建模假设对问题是重要的，哪些是不重要的？该如何试验众多已经开发的主题模型呢？这些问题引起了统计学家的兴趣[9,30]，但他们对机器学习处理的问题的规模认识不足。这些计算问题的新答案将是对主题模型的重要贡献。<br>
可视化和用户接口 主题模型另一个充满希望的未来方向是开发与主题和语料库交互的新方法。主题模型提供了探索大规模文本的新结构，那么如何使用这一结构呢？一个问题就是如何展示主题。主题一般通过列举其最常出现的词来展示（如图2），但选择不同的词展示或者以不同的方式来标记主题，可能会更有效。更进一步，如何更好地展示一个文档中的主题模型呢？从文档上来看，主题模型提供了文档结构的潜在的有用信息。结合有效的主题标记，读者可以辨认出文档中最感兴趣的部分。此外，隐藏的主题直方图隐式地将各个文档相互连接（考虑文档直方图的距离）。如何显示这些连接？整个语料与其推断的主题结构的有效接口是什么？<br>
这些用户接口问题对主题建模非常重要。主题建模算法很有希望提示大规模文档的有意义的主题结构，但要让它有用需要在信息可视化和用户接口上多下工夫。<br>
用主题模型进行数据发现 主题模型伴随着信息工程应用而来，主题模型作为统计模型应该能提供关于数据的信息或者帮助建立假设。主题模型的后验分布提供了什么信息？这一问题已经出现在政治科学[19]、生物学[17]和心理学[32]等领域，这类研究使用主题模型来度量所关注的外部变量，是非监督学习中的难题，必须小心验证。<br>
这个问题通常可由计算机科学家与其它领域的学者合作使用主题模型来助力数据的探索、可视化和抽象假设。除了遗传学和神经学等科学应用系统，主题模型还可以应用于历史、社会、语言、政治学、法律学和比较文学等其它以文本作为研究媒介的领域。通过与各学科的学者进行合作，计算机科学家们开始开发出新的跨学科的计算方法，来处理大量的文本，并从中提取潜在内涵。</p>
<h2 id="总结">总结</h2>
<p>本文调研了处理大规模文档的一套统计模型——概率主题模型。近年来，随着可扩展部件建模、后验推断的可扩展算法和大数据集的日益增多等非监督机器学习的有力支持，主题模型有希望成为总结和理解人们日益增长的数字化信息档案的重要部件。</p>
<h2 id="参考文献">参考文献</h2>
<p>[1]Asuncion, M. Welling, P. Smyth, and Y. Teh. On smoothing and inference for topic models. In Uncertainty in Artificial Intelligence, 2009.<br>
[2]E. Bart, M. Welling, and P. Perona. Unsupervised organization of image collections: Unsupervised organization of image collections: Taxonomies and beyond. Transactions on Pattern Recognition and Machine Intelligence, 2010.<br>
[3] D. Blei, T. Griffths, and M. Jordan. The nested Chinese restaurant process and Bayesian nonparametric inference of topic hierarchies. Journal of the ACM, 57(2):1–30, 2010.<br>
[4] D. Blei and M. Jordan. Modeling annotated data. In Proceedings of the 26th annual International ACM SIGIR Conference on Research and Development in Information Retrieval, pages 127–134. ACM Press, 2003.<br>
[5] D. Blei and J. Lafferty. Dynamic topic models. In International Conference on Machine Learning, pages 113–120, New York, NY, USA, 2006. ACM.<br>
[6] D. Blei and J. Lafferty. A correlated topic model of Science. Annals of Applied Statistics, 1(1):17–35, 2007.<br>
[7] D. Blei and J. McAuliffe. Supervised topic models. In Neural Information Processing Systems, 2007.<br>
[8] D. Blei, A. Ng, and M. Jordan. Latent Dirichlet allocation. Journal of Machine Learning Research, 3:993–1022, January 2003.<br>
[9] G. Box. Sampling and Bayes’ inference in scientiﬁc modeling and robustness. Journal of the Royal Statistical Society, Series A, 143(4):383–430, 1980.<br>
[10] J. Boyd-Graber and D. Blei. Syntactic topic models. In Neural Information Processing Systems, 2009.<br>
[11] W. Buntine. Variational extentions to EM and multinomial PCA. In European Conference on Machine Learning, 2002.<br>
[12] W. Buntine and A. Jakulin. Discrete component analysis. In Subspace, Latent Structure and Feature Selection. Springer, 2006.<br>
[13] J. Chang and D. Blei. Hierarchical relational models for document networks. Annals of Applied Statistics, 4(1), 2010.<br>
[14] S. Deerwester, S. Dumais, T. Landauer, G. Furnas, and R. Harshman. Indexing by latent semantic analysis. Journal of the American Society of Information Science, 41(6):391–407, 1990.<br>
[15] G. Doyle and C. Elkan. Accounting for burstiness in topic models. In International Conference on Machine Learning, pages 281–288. ACM, 2009.<br>
[16] L. Fei-Fei and P. Perona. A Bayesian hierarchical model for learning natural scene categories. IEEE Computer Vision and Pattern Recognition, pages 524–531, 2005.<br>
[17] S. Gerrish and D. Blei. A language-based approach to measuring scholarly impact. In International Conference on Machine Learning, 2010.<br>
[18] T. Griﬃths, M. Steyvers, D. Blei, and J. Tenenbaum. Integrating topics and syntax. In L. K. Saul, Y. Weiss, and L. Bottou, editors, Advances in Neural Information Processing Systems 17, pages 537–544, Cambridge, MA, 2005. MIT Press.<br>
[19] J. Grimmer. A Bayesian hierarchical topic model for political texts: Measuring expressed agendas in senate press releases. Political Analysis, 18(1):1, 2010.<br>
[20] M. Hoffman, D. Blei, and F. Bach. On-line learning for latent Dirichlet allocation. In Neural Information Processing Systems, 2010.<br>
[21] T. Hofmann. Probabilistic latent semantic analysis. In Uncertainty in Artiﬁcial Intelli-gence (UAI), 1999.<br>
[22] M. Jordan, Z. Ghahramani, T. Jaakkola, and L. Saul. Introduction to variational methods for graphical models. Machine Learning, 37:183–233, 1999.<br>
[23] J. Li, C. Wang, Y. Lim, D. Blei, and L. Fei-Fei. Building and using a semantivisual image hierarchy. In Computer Vision and Pattern Recognition, 2010.<br>
[24] W. Li and A. McCallum. Pachinko allocation: DAG-structured mixture models of topic correlations. In International Conference on Machine Learning, pages 577–584, 2006.<br>
[25] D. Mimno and A. McCallum. Topic models conditioned on arbitrary features with Dirichlet-multinomial regression. In Uncertainty in Artiﬁcial Intelligence, 2008.<br>
[26] D. Newman, C. Chemudugunta, and P. Smyth. Statistical entity-topic models. In Knowledge Discovery and Data Mining, 2006.<br>
[27] J. Pritchard, M. Stephens, and P. Donnelly. Inference of population structure using multilocus genotype data. Genetics, 155:945–959, June 2000.<br>
[28] J. Reisinger, A. Waters, B. Silverthorn, and R. Mooney. Spherical topic models. In International Conference on Machine Learning, 2010.<br>
[29] M. Rosen-Zvi, T. Griffths, M. Steyvers, and P. Smith. The author-topic model for authors and documents. In Proceedings of the 20th Conference on Uncertainty in Artiﬁcial Intelligence, pages 487–494. AUAI Press, 2004.<br>
[30] D. Rubin. Bayesianly justiﬁable and relevant frequency calculations for the applied statistician. The Annals of Statistics, 12(4):1151–1172, 1984.<br>
[31] J. Sivic, B. Russell, A. Zisserman, W. Freeman, and A. Efros. Unsupervised discovery of visual object class hierarchies. In Conference on Computer Vision and Pattern Recognition, 2008.<br>
[32] R. Socher, S. Gershman, A. Perotte, P. Sederberg, D. Blei, and K. Norman. A Bayesian analysis of dynamics in free recall. In Neural Information Processing Systems, 2009.<br>
[33] M. Steyvers and T. Griffths. Probabilistic topic models. In T. Landauer, D. McNamara, S. Dennis, and W. Kintsch, editors, Latent Semantic Analysis: A Road to Meaning. Laurence Erlbaum, 2006.<br>
[34] Y. Teh, M. Jordan, M. Beal, and D. Blei. Hierarchical Dirichlet processes. Journal of the American Statistical Association, 101(476):1566–1581, 2006.<br>
[35] M. Wainwright and M. Jordan. Graphical models, exponential families, and variational inference. Foundations and Trends in Machine Learning, 1(1–2):1–305, 2008.<br>
[36] H. Wallach. Topic modeling: Beyond bag of words. In Proceedings of the 23rd International Conference on Machine Learning, 2006.<br>
[37] C. Wang and D. Blei. Decoupling sparsity and smoothness in the discrete hierarchical dirichlet process. In Y. Bengio, D. Schuurmans, J. Lafferty, C. K. I. Williams, and A. Culotta, editors, Advances in Neural Information Processing Systems 22, pages 1982–1989. 2009.<br>
[38] C. Wang, B. Thiesson, C. Meek, and D. Blei. Markov topic models. In Artiﬁcial Intelligence and Statistics, 2009.</p>
<h1>Topic Models Practise</h1>
<p><strong>author:Chelsey Hill</strong></p>
<h2 id="introduction-to-topic-models">Introduction to Topic Models</h2>
<p>Topic Models are unsupervised methods of automatic organizing, understanding, searching and summarizing text documents (Blei 2012). Topic models are built based on term co-occurrence.</p>
<p>Topic Models are mixed-membership models</p>
<ul>
<li>
<p>Every document is mixture of topics.</p>
<ul>
<li>Document 1 could be 30% Topic A, 20% Topic B, 40% Topic C and 10% Topic D.</li>
<li>Every topic is a mixture of terms.</li>
<li>Terms have weights associated with topics.</li>
<li>Terms can be shared across topics.</li>
</ul>
</li>
<li>
<p>Each <strong>topic</strong> is a distribution over the topical <em>terms</em>.</p>
</li>
<li>
<p>Each <strong>document</strong> is a mixture of corpus-wide <em>topics</em>.</p>
</li>
<li>
<p>Each <strong>term</strong> is drawn from one of the <em>topics</em>.</p>
</li>
</ul>
<p>In reality, we only observe the documents (not the topics). The other structure is underlying, or <strong>latent</strong>.</p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA24AAAG+CAMAAADcLqdTAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAMAUExURf////f39+/v7+bm5tbW1t7e3sXFxc7Ozr29vbW1tYyMjK2trXuEhJScnGtzc6WcnFJSSmNaY3tzc0JCQpSUlFJaUmtrYxkZEBAICAAAACEhITExMSkpKTo6OkJCSgAICFpz5kK13iG1pZS13sWErWu13hlzhDpzUmvmpZTm3tbmc0Lm3iHmpWNCIRBzUmvm3s7epZw6Upw6GZwQUpwQGc5Szs5ShJRSzpRShM4Zzs4ZhJQZzpQZhJxjUpxjGUpzhBAQSmNzEBkQzhkQhLXe5ilztQhztb2EezoQUs46Us46GaW1Os4QUs4QGaW1EM5jUs5jGVq1QhC1Qlq1EBC1EFoQzloQhFq1c6W1YxC1zhC1czqEGRCEGTpaGRBaGRlCzhlChM5S785SpZRS75RSpc4Z784ZpZQZ75QZpZyEUpyEGVqEtVpjtSlz5hk6UmNzMRkQ7xkQpfdaGfcZGfecGQhz5qXmOqXmEFrmQhDmQlrmEBDmEFrmc6XmYxDmzhDmc2MQENa1Ota1ELWE5lpCzlpChFq1pda1Y86EUvdazta15vdaWs6EGXu1QjG1QvcZWvcZzvecWvecznu1EDG1EFoQ71oQpXu1c6W1hBC17zG1c/feGfdalPcZlPeclLWt3pzWpRlC7xlCpdbmOoyE5mM6WoyEtdbmEGMQWvfezvfeWvfelHvmQjEQCDHmQnvmEDHmEHvmc6XmhBDm7zHmc2MQMdaE5lpC71pCpXu1pda1hPc69/et92N7Uhk6ENbvzjoQKdatxcWcpUI6GbXmvdb3786tpff/Ovf/vWuEhBAIIVp7YxA6MWtjhHOEY4SElGtSWtbe79bW797OxdbexbWlvZR7lAghIZScrXNaYxAhCIx7ezopKZytpWtaUnuMcxkICHuMhHtzhFJaY/fv9+be97XFvbWtpYyMe2tjc6Wcrc7OvUIxQv/391JSY+///+/3/97W1u/v987e3u/37629va2tnMW9vebe3vf3787Wzube5s7W1sXFvbWttQAAABJ9uOYAAAEAdFJOU////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wBT9wclAAAACXBIWXMAAA7DAAAOwwHHb6hkAAD6UElEQVR4Xux9W1PjONd1SilFwm530za2weZw+f3y/icvN0zVMKmQaqaBmSraBUPTBRUOnYTk4ltrywkBEkiA9Dwzw4IkPsiSbO+lvSVtSZU3vOENb3jDG97whje84Q1veMMb3vCGN7zhDW94wxve8IY3vOENb3jDG97whje84Q1veMMb3vCGN7zhDW94wxv+6VDl5z5UsqbLzZdBh9FLIgoW/XLrDW/4J6OepBsr6Qo+mVceuoU+S15Ot6Xcr1wm8Tg6Twm1F9ly8w1v+GdDFTr+rivqotx/ZTjFVpR7z4IO37+Okn3DG/5+6DxyuueBBuqWvy+ASV5kRxL6ffhGtzf8W2DT0P2kK7nBbxTCwMSW2o7sRcVE6UoWOPVkkjhfWclQk7JxmOReRSfpylaoKsqL4nQlxVZF+flKSuvPxsnSSpavbMQ22MclJobFGoA9ydlCmkqaNkeSw3qZn24sp2cK2izxs5X0BJEx/rUwCl5gir7hDf9L6O5mwTkIk9sLneS22E2z68Lkub4KI1Pxo6Xe5u8lJ+xqGigdZ7YS7G+k6a6JT/SVHyVaxytJH1GEjGehuDzJbeXbappm237kVToeyOvn3oUKUg/8XYm1DlebOOQrfYJEBH4eKBXse0hgJdJ1by2omMVPfXWQIb03vOHfARWCG2AJGWUzT/+6f11wv63jpA5VpypFEPm0K3FwqeCep7wtKDATf4SVp8LI2nVu2fhMSzxdP/+r4m0giFoC08zXWDVBRWi4T7HyM2xdIJyOYyhNcI65QGQJdJifv0MmEl3pLuX+zkl8U6m04vU3W/IN/xboONcVHUnbYW31T/31E01CKDuzFjZ+pXlZ6apzhlTeOvUMFNZlsm8rBRVQpbIZRr6FDqtU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" alt="img"></p>
<p>The goal is to infer the hidden variables (<em>topics</em>), given what we observe (<em>documents</em>).</p>
<p>In topic modeling, the full TDM or DTM is broken down into two major components:</p>
<ol>
<li>the topic distribution over terms</li>
<li>the document distribution over topics</li>
</ol>
<p>The first component tells us the importance of the terms in topics, and using that importance information, the second component tells us the importance of topics in the documents.</p>
<hr>
<h2 id="latent-dirichlet-allocation-lda">Latent Dirichlet Allocation (LDA)</h2>
<p>The <strong>Latent Dirichlet Allocation (LDA)</strong> model is a generative probabilistic model applied to text introduced by <a href="http://papers.nips.cc/paper/2070-latent-dirichlet-allocation.pdf">Blei et al. (2002)</a> and <a href="http://www.cse.cuhk.edu.hk/irwin.king/_media/presentations/latent_dirichlet_allocation.pdf">Blei et al. (2003)</a>. The LDA model extends the <strong>probabilistic Latent Semantic Indexing (pLSI)</strong> model proposed by Hofmann (1999). LDA is a mixture model and documents are a mixture of the different topics in the model (Blei et al. 2003). LDA forms clusters of co-occurring terms, or <strong>topics</strong>, where each topic is a distribution over words.</p>
<p>LDA modeling assumptions include:</p>
<ul>
<li>bag of words (BOW): ordering of terms in documents is unimportant</li>
<li>documents are exchangeable: document sequencing is unimportant</li>
<li>topics are independent (uncorrelated)</li>
</ul>
<p>The text corpus is a set of D documents and there are V terms in the corpus. There are k topic distributions containing V terms and βi is the multinomial for the ith topic.</p>
<p>The generative LDA process consists of a few steps. First, for each document, draw a topic distribution, θd∽Dir(α)∽(), where Dir(α)() is drawn from a uniform Dirichlet distribution and α is the scaling parameter. The Dirichlet distribution is a continuous multivariate generalization of the β distribution with parameter vector α, which controls the average shape and sparsity of the topic proportions. Then, for each word in the document, draw a topic z(d,n)∽multi(θd)(,)∽(), where multi(\theta_{d}) is a multinomial and draw a word w(d,n)∽β(zd,n)(,)∽(,). The LDA modeling approach determines the posterior distribution of the topics given the document.</p>
<p>The probabilistic generative model estimation is intractable, so one of the following approximate posterior inference algorithms is used in modeling:</p>
<ul>
<li>Collapsed Gibbs Sampling</li>
<li>Mean Field Variational Methods</li>
<li>Expectation Propagation</li>
<li>Collapsed Variational Inference (Variational Expectation Maximization)</li>
</ul>
<p><img src="data:image/png;base64,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" alt="img"></p>
<p>The <a href="https://cran.r-project.org/web/packages/topicmodels/vignettes/topicmodels.pdf">topicmodels package</a> will be used to create the LDA model and the <a href="https://cran.r-project.org/web/packages/ldatuning/vignettes/topics.html">ldatuning package</a> will be used to choose the k value. Other packages that can be used for LDA modeling and visualization include <code>lda</code> and <code>LDAvis</code>, respectively. <code>LDAvis</code> creates and interactive topic model visualization and is also available in Python. Note: <code>LDAvis</code> is not directly compatible with LDA models created using the <code>topicmodels</code> package.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(topicmodels) # LDA, CTM</span><br><span class="line">library(ldatuning) # Choosing k</span><br></pre></td></tr></table></figure>
<p>Prior to topic model analysis, any empty documents that exist following preprocessing should be removed.</p>
<p>We use a lemmatized DTM that is reduced using document frequency thresholding named DTM_red. The top 15% of terms based on the document frequency are retained.</p>
<p>The number of topics, k, can be chosen using many metrics. The <code>findTopicsNumber()</code> function in the <code>ldatuning</code> package can be used to evaluate 4 measures.</p>
<ul>
<li>Minimize:
<ul>
<li>Density (<a href="https://www.sciencedirect.com/science/article/abs/pii/S092523120800372X">Cao Juan et al. 2009</a>)</li>
<li>Within-Topic Divergence (<a href="https://link.springer.com/chapter/10.1007/978-3-642-13657-3_43">Arun et al. 2010</a>)</li>
</ul>
</li>
<li>Maximize:
<ul>
<li>Across-Topic Divergence (<a href="https://www.cairn.info/revue-document-numerique-2014-1-page-61.htm">Deveaud et al. 2014</a>)</li>
<li>log-likelihood (<a href="https://www.pnas.org/content/pnas/101/suppl_1/5228.full.pdf?__=">Griffiths and Steyvers 2004</a>) (Collapsed Gibb Sampler only)</li>
</ul>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">result &lt;- FindTopicsNumber(</span><br><span class="line">  DTM_red,</span><br><span class="line">  topics = seq(from = 5, to = 25, by = 1),</span><br><span class="line">  metrics = c(&quot;CaoJuan2009&quot;, &quot;Arun2010&quot;, &quot;Deveaud2014&quot;),</span><br><span class="line">  method = &quot;VEM&quot;,</span><br><span class="line">  control = list(seed = 831),</span><br><span class="line">  mc.cores = 2L,</span><br><span class="line">  verbose = TRUE)</span><br><span class="line">FindTopicsNumber_plot(result)</span><br></pre></td></tr></table></figure>
<p><img src="data:image/png;base64,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" alt="img"></p>
<p>Based on one or more of the metrics, either the best k or a k that is a good trade-off between the metrics can be chosen. In the plot above, Across-Topic Divergence is maximized and Divergence is minimized at 5. Either 9 or 10 may be a good compromise of the 3 metrics.</p>
<p>The <code>LDA()</code> function in the <code>topicmodels</code> package can be used to create an LDA model with k topics from a <code>DocumentTermMatrix</code> object.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">lda_mod &lt;- LDA(DTM_red, </span><br><span class="line">               k = 5, </span><br><span class="line">               control = list(seed=831))</span><br></pre></td></tr></table></figure>
<p>The distribution of terms in topics is β. We can use a custom function <code>beta_plot()</code> to plot the top n terms per topic.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">beta_plot(topic_object = lda_mod, </span><br><span class="line">          n = 6)</span><br></pre></td></tr></table></figure>
<p><img src="data:image/png;base64,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" alt="img"></p>
<p>The distribution of topics in documents is γ. The γ values are the estimated proportion of words from each document that are generated from that topic.</p>
<p>We can view the topic assignments for documents using the <code>topics()</code> function. This will display the most probable topic overall for each document, based on the terms in that document.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">head(topics(lda_mod))</span><br><span class="line">## 14099  7585  5974  2502  9802 19960 </span><br><span class="line">##     4     3     2     5     3     2</span><br></pre></td></tr></table></figure>
<p>We can use a custom function, <code>topic_group_plot()</code> to compare the topical distribution across known factor variable levels.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">topic_group_plot(lda_mod, cr, &quot;Rating&quot;, plot_by=&quot;category&quot;)</span><br></pre></td></tr></table></figure>
<p><img src="data:image/png;base64,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" alt="img"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">##       var</span><br><span class="line">## Topics   1   2   3   4   5</span><br><span class="line">##      1  42  81 127 210 425</span><br><span class="line">##      2  36  78 151 219 485</span><br><span class="line">##      3  27  45  93 189 565</span><br><span class="line">##      4  33  61 101 212 507</span><br><span class="line">##      5  23  43  77 146 532</span><br></pre></td></tr></table></figure>
<p>We can use a custom function, <code>doc_dist_plot()</code> to obtain the fitted distribution of topics over documents.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">doc_dist_plot(lda_mod)</span><br></pre></td></tr></table></figure>
<p><img src="data:image/png;base64,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B5VT438v/OXLdo6T5u/urX5leOQSx35Ahz/6XL+3LXbnoslGZ6W938QfOQDbBHR0wfbwdT7UuEz+MHo++VBsPnaTWx19NEaPxDYBHRvv5CFJDuzE40mQgO6b0Wft5f8q/4qI7waz9f66jJv+lR7NU+mTdJbuWi7/VKzk4SevklEV23346avNAe3+1RSlX15/nG8zW2Ea0GSl/Quphgdgq4COLVhof0ekVf49HCftbm4Z0O6xm9nq2KMxdiS2CujIeKcPSXtg1xOPJzECeqA2ftEI+NUJ6IESULh7AnqgBBTunoAeKAGFuyegB0pA4e4J6IESULh7AnqgBBTunoAeKAGFuyegAEECChAkoABBAgoQJKAAQQIKECSgAEECChAkoABBAgoQJKAAQQIKECSgAEECChAkoABBAgoQJKAAQQIKECSgAEECChAkoABBAgoQJKAAQQIKECSgAEECChAkoABBAgoQJKAAQQIKECSgAEECChAkoABBAgoQJKAAQQIKECSgAEECChAkoABBAgoQJKAAQQIKECSgAEECChAkoABBAgoQJKAAQQIKECSgAEECChAkoABBAgoQJKAAQQIKECSgAEH7HdAFwM7sPlE7X+MO3fXRBu6XnTdq1yvcpV/hDwzgaAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKECQgAIECShAkIACBAkoQJCAAgQJKEdsteg4n5/76uzkm6n7Ll+eLhYPn7/fbrtzaxr17tlicfJv1VKXb6bm6K70w+n4Vm68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" alt="img"></p>
<p>The LDA model has some notable shortcomings, as shown in the above plots. There tends to be very little difference in the topical distribution across documents, with each topic being represented approximately equally across the dataset. Additionally, topics tend to lack exclusivity–meaning that the top terms tend to be the same in more than one topic.</p>
<hr>
<h2 id="correlated-topic-models-ctm">Correlated Topic Models (CTM)</h2>
<p>The <strong>Correlated Topic Model (CTM)</strong> is a hierarchical model that explicitly models the correlation of latent topics, allowing for a deeper understanding of relationships among topics (<a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.958.2484&amp;rep=rep1&amp;type=pdf">Blei and Lafferty 2007</a>). It was created as an extension of LDA, which allows topic proportions to be correlated via the logistic normal distribution (Blei and Lafferty 2007). The CTM extends the LDA model by relaxing the independence assumption of LDA. As in the LDA model, CTM is a mixture model and documents belong to a mixture of topics. CTM uses the same methodological approach as LDA, but it creates a more flexible modeling approach than LDA by replacing the Dirichlet distribution with a logistic normal distribution and explicitly incorporating a covariance structure among topics (Blei and Lafferty 2007). While this method creates a more computationally expensive topic modeling approach, it allows for more realistic modeling by allowing topics to be correlated. Additionally, Blei and Lafferty (2007) show that the CTM model outperforms LDA.</p>
<p>In R, the <code>CTM()</code> function from the <code>topicmodels</code> package can be used.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ctm_mod &lt;- CTM(DTM_red, k = 5, control=list(seed=831))</span><br></pre></td></tr></table></figure>
<p>We can again look at the top terms per topic. As shown below, CTM does not always overcome the problem of exclusivity.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">beta_plot(ctm_mod, n = 5)</span><br></pre></td></tr></table></figure>
<p><img src="data:image/png;base64,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" alt="img"></p>
<p>As shown, CTM can overcome the problem regarding the distribution of topics over documents. The plot below shows that topical prevalence differs.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">doc_dist_plot(ctm_mod)</span><br></pre></td></tr></table></figure>
<p><img src="data:image/png;base64,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" alt="img"></p>
<hr>
<h2 id="structural-topic-models-stm">Structural Topic Models (STM)</h2>
<p>The <strong>Structural Topic Model (STM)</strong> combines 3 common topic models to create a semi-automated approach to modeling topics, which can also incorporate covariates and metadata in the analysis of text (<a href="http://www.luigicurini.com/uploads/6/7/9/8/67985527/stm_paper_ajps12103.pdf">Roberts et al. 2014</a>). Additionally, unlike the LDA model, topics in STM can be correlated. This model is particularly salient in the topical analysis of open-ended textual data, such as survey data. In STM models that do not include covariates, the modeling approach is akin to the Correlated Topic Model (CTM), as proposed by Blei and Lafferty (2007).</p>
<p>STM is a mixture model, where each document can belong to a mixture of the designated k topics. Topic proportions, θd, can be correlated and the topical prevalence can be impacted by covariates, X, through a regression model θd∽LogisticNormal(XY,Σ)∽(,Σ). This allows each document to have its own prior distribution over topics, rather than sharing a global mean. For each word, w, the topic, z(d,n)(,), is drawn from a response-specific distribution. Conditioned on the topic, a word is chosen from a multinomial distribution over words with parameters, β(zd,n)(,). The topical content covariate, U, allows word use within a topic to vary by content.</p>
<p>In choosing the STM model or assessing the goodness of fit, two measures can be used: <strong>semantic cohesion</strong> and <strong>exclusivity</strong> (Roberts et al. 2014). A topic is <strong>cohesive</strong> when high-probability terms for a topic occur together in documents. A topic is <strong>exclusive</strong> if the top words of the topic are not likely to also be top words in other topics.</p>
<p><img src="data:image/png;base64,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" alt="img"></p>
<p>The <a href="https://cran.r-project.org/web/packages/stm/vignettes/stmVignette.pdf">stm</a> package is used to create structural topic models.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">library(stm) # STM</span><br></pre></td></tr></table></figure>
<p>STM will remove infrequent terms automatically, so we can use the unreduced, lemmatized DTM. Since we will use covariates, we will save the variables as <code>metad_vars</code>. The <code>readCorpus()</code> function will preliminarily format a <code>DocumentTermMatrix</code> object for use in the <code>stm</code> package.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">corp &lt;- readCorpus(cr_DTM_lem, type=&quot;slam&quot;)</span><br><span class="line"></span><br><span class="line">metad_vars &lt;- cr[,c(&quot;Age&quot;, &quot;Rating&quot;, &quot;Recommended.IND&quot;, &quot;Positive.Feedback.Count&quot;, &quot;Division.Name&quot;, &quot;Department.Name&quot;, &quot;Class.Name&quot;)]</span><br></pre></td></tr></table></figure>
<p>We use the <code>prepDocuments()</code> function to identify the documents, terms, and metadata and to remove documents based on a lower threshold of 50.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">out &lt;- prepDocuments(documents = corp$documents, </span><br><span class="line">                     vocab = corp$vocab, </span><br><span class="line">                     meta = metad_vars,</span><br><span class="line">                     lower.thresh = 50)</span><br><span class="line">## Removing 4895 of 5305 terms (26074 of 118956 tokens) due to frequency </span><br><span class="line">## Your corpus now has 4508 documents, 410 terms and 92882 tokens.</span><br></pre></td></tr></table></figure>
<p>A number of diagnostic measures can be obtained to help inform the choice of k, the number of topics, using the <code>searchK()</code> function in the <code>stm</code> package. We can seek to maximize held-out likelihood and semantic coherence and minimize residual dispersion.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set.seed(831)</span><br><span class="line">stm.search &lt;- searchK(documents = out$documents,</span><br><span class="line">                      vocab = out$vocab,</span><br><span class="line">                      K = 10:30,</span><br><span class="line">                      init.type = &quot;Spectral&quot;,</span><br><span class="line">                      prevalence = ~ Rating + Age + Positive.Feedback.Count + Recommended.IND,</span><br><span class="line">                      data = out$meta)</span><br><span class="line">plot(stm.search)</span><br></pre></td></tr></table></figure>
<p><img src="data:image/png;base64,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" alt="img"></p>
<p>Two measures that offer a good tradeoff measure when choosing a k value are <strong>Semantic Coherence</strong> and <strong>Exclusivity</strong>. Semantic Coherence is maximized when the most probable terms in a topic co-occur frequently (which will happen naturally when k is low and top words are common). To balance this, we can consider Exclusivity, which is high when top terms are unique to a particular topic. We can look for a compromise point that balances the two measures, with the average values for each k value considered in the search plotted. Based on the plot below, a choice of 15 or 16 may provide a good tradeoff.</p>
<p><img src="data:image/png;base64,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" alt="img"></p>
<p>Using k=15=15, we can build an STM model using Spectral initialization (uses spectral decomposition, or non-negative matrix factorization of the co-occurrence matrix, leading to consistent results).</p>
<p>Prevalence covariates are chosen as those variables that may impact the frequency (or prevalence) of a topic in the document collection. Numeric or factor variables can be included as prevalence covariates. Prevalence covariates in the model include: <code>Rating</code>, <code>Age</code>, <code>Positive.Feedback.Count</code>, <code>Recommended.IND</code>. If a time/date variable is included in the dataset, including it as a ‘time since origin’ prevalence covariate can allow you to map (expected) topical prevalence over time.</p>
<p>Content covariates are chosen as those variables that may impact how a topic occurs in the document collection. <code>Rating</code> is included in the model as a content covariate. Note: including many content covariates can lead to slow convergence.</p>
<p>Interaction terms for covariates can be included.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">stm_mod &lt;- stm(documents = out$documents,</span><br><span class="line">                      vocab = out$vocab,</span><br><span class="line">                      K = 15,</span><br><span class="line">                      init.type = &quot;Spectral&quot;,</span><br><span class="line">                      prevalence = ~ Rating + Age + Positive.Feedback.Count + Recommended.IND,</span><br><span class="line">               content = ~ Rating,</span><br><span class="line">               data = out$meta,</span><br><span class="line">               seed = 831)</span><br></pre></td></tr></table></figure>
<p>The <code>plot()</code> function can be used on an <code>stm</code> object to provide the topical frequency and top <code>n</code> (default = 3) words (<code>type = &quot;summary&quot;</code>, default).</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">plot(stm_mod, </span><br><span class="line">     n = 5, </span><br><span class="line">     text.cex = .8)</span><br></pre></td></tr></table></figure>
<p><img src="data:image/png;base64,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" alt="img"></p>
<p>We can use <code>plot()</code> and <code>type = perspectives</code> to compare two topics or a single topic across two covariate levels to see how the terms differ. We use <code>set.seed()</code> to make the output reproducible. Comparing the content in Topics 3 and Topic 12:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set.seed(831)</span><br><span class="line">plot(stm_mod, </span><br><span class="line">     type=&quot;perspectives&quot;, </span><br><span class="line">     topics=c(3,12), </span><br><span class="line">     plabels = c(&quot;Topic 3&quot;,&quot;Topic 12&quot;))</span><br></pre></td></tr></table></figure>
<p><img src="data:image/png;base64,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AAAiIMADAABABAR4AAAAiIAADwAAABEQ4AEAACACAjwAAABEQIAHAACACAjwAAAAEAEBHgAAACIgwAMAAEAEBHgAAACIgAAPAAAAERDgAQAAIAICPAAAAERAgAcAAIAICPAAAAAQAQEeAAAAIiDAAwAAQAQEeAAAAIiAAA8AAAAREOABAAAgAgI8AAAARECABwAAgAgI8AAAABABAR4AAAAiIMADAABABAR4AAAAiIAADwAAABEQ4AEAACACAjwAAABEQIAHAACACAjwAAAAEAEBHgAAACIgwAMAAEAEBHgAAACIgAAPAAAAERDgAQAAIAICPAAAAERAgAcAAIAICPAAAAAQAQEeAAAAIiDAAwAAQAQEeAAAAIiAAA8AAAAREOABAAAgAgI8AAAARECABwAAgAgI8AAAABABAR4AAAAiIMADAABABAR4AAAAiIAADwAAABEQ4AEAACACAjwAAABEQIAHAACACAjwAAAAEAEBHgAAACIgwAMAAEAEBHgAAACIgAAPAAAAERDgAQAAIAICPAAAAERAgAcAAIAICPAAAAAQAQEeAAAAIiDAAwAAQAQEeAAAAIiAAA8AAAAREOABAAAgAgI8AAAARECABwAAgAgI8AAAABABAR4AAAAiIMADAABABAR4AAAAiIAADwAAABEQ4AEAACACAjwAAABEQIAHAACACAjwAAAAEAEBHgAAACIgwAMAAEAEBHgAAACIgAAPAAAAERDgAQAAIAICPAAAAERAgAcAAIAICPAAAAAQAQEeAAAAIiDAAwAAQAQEeAAAAIiAAA8AAAAREOABAAAgAgI8AAAARECABwAAgAgI8AAAABABAR4AAAAiIMADAABABAR4AAAAiIAADwAAABEQ4AEAACACAjwAAABEQIAHAACACAjwAAAAEAEBHgAAACIgwAMAAEAEBHgAAACIgAAPAAAAERDgAQAAIAICPAAAAERAgAcAAIAICPAAAAAQAQEeAAAAIiDAAwAAQAQEeAAAAIiAAA8AAAAREOABAAAgAgI8AAAARECABwAAgAgI8AAAABABAR4AAAAiIMADAABABAR4AAAAiIAADwAAABEQ4AEAACACAjwAAABEQIAHAACACAjwAAAAEAEBHgAAACIgwAMAAEAEBHgAAACIgAAPAAAAERDgAQAAIAICPAAAAERAgAcAAIAICPAAAAAQAQEeAAAAIiDAAwAAQAQEeAAAAIjA/wY50FJM1EplpgAAAABJRU5ErkJggg==" alt="img"></p>
<p>Comparing the content (terms based on probability) in Topic 9 across two <code>Rating</code> levels, 1 and 5,</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set.seed(832)</span><br><span class="line">plot(stm_mod, </span><br><span class="line">     type=&quot;perspectives&quot;, </span><br><span class="line">     topics=9, </span><br><span class="line">     covarlevels = c(1,5), </span><br><span class="line">     plabels=c(&quot;Rating = 1&quot;, &quot;Rating = 5&quot;),</span><br><span class="line">     main = &quot;Topic 9&quot;)</span><br></pre></td></tr></table></figure>
<p><img src="data:image/png;base64,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AAMgwAMAAAAAYAAEeAAAAAAADIAADwAAAACAARDgAQAAAAAwAAI8AAAAAAAGQIAHAAAAAMAACPAAAAAAABgAAR4AAAAAAAMgwAMAAAAAYAAEeAAAAAAADIAADwAAAACAARDgAQAAAAAwAAI8AAAAAAAGQIAHAAAAAMAACPAAAAAAABgAAR4AAAAAAAMgwAMAAAAAYAAEeAAAAAAADIAADwAAAACAARDgAQAAAAAwAAI8AAAAAAAGQIAHAAAAAMAACPAAAAAAABgAAR4AAAAAAAMgwAMAAAAAYAAEeAAAAAAADIAADwAAAACAARDgAQAAAAAwAAI8AAAAAAAGQIAHAAAAAMAACPAAAAAAABgAAR4AAAAAAAMgwAMAAAAAYAAEeAAAAAAADIAADwAAAACAAfz/7dcBCQAAAICg/6/bEegLBR4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGBB4AAAAGApOmOA85JT+ZAAAAAElFTkSuQmCC" alt="img"></p>
<p>Word Clouds can be created using the <code>cloud()</code> function for the global model (<code>type = &quot;model&quot;</code>, the default) and for specific documents (<code>type = &quot;documents&quot;</code> and identifying the documents in the <code>documents</code> argument. The default for the <code>max.words</code> argument is 100.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set.seed(831)</span><br><span class="line">cloud(stm_mod, topic = 1)</span><br></pre></td></tr></table></figure>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABUAAAAPACAMAAADDuCPrAAABI1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6Zjo6ZmY6ZpA6ZrY6kJA6kLY6kNtmAABmADpmOgBmOjpmOmZmOpBmZgBmZjpmZmZmZpBmkGZmkJBmkLZmkNtmtpBmtrZmtttmtv+QOgCQOjqQOmaQZgCQZjqQZmaQkDqQkGaQkJCQkLaQtpCQtraQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2kDq2kGa2kJC2tma2tpC2tra2ttu2tv+225C227a229u22/+2/7a2/9u2///bkDrbkGbbkJDbtmbbtpDbtrbbttvb25Db27bb29vb2//b/7bb/9vb////tmb/tpD/25D/27b/29v//7b//9v////Zdod7AAAACXBIWXMAAB2HAAAdhwGP5fFlAAAgAElEQVR4nOy9C3fbVpa2uanLMplYqrbclkqubjufnYrFntiVSUXTZdhO2/5q7MTISJlYqYijC/n/f8Xg7HMHDi4kAR5Cep+1yqFAANxkLb7c5+wbzQAAACwExTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6CsU2AAAA+grFNgAAAPoKxTYAAAD6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ACAquQMAQFRyBwCAqOQOAABRyR0AAKKSOwAARCV3AACISu4AABCV3AEAICq5AwBAVHIHAICo5A4AAFHJHQAAopI7AABEJXcAAIhK7gAAEJXcAQAgKrkDAEBUcgcAgKjkDgAAUckdAACikjsAAEQldwAAiEruAAAQldwBACAquQMAQFRyBwCAqOQOAABRyR0AAKKSOwAARCV3AACISu4AABCV3AEAICq5AwBAVHIHAICo5A4AAFHJHQAAopI7AABEJXcAAIhK7gAAEJXcAQAgKrkDAEBUcgcAgKjkDgAAUckdAACikjsAAEQldwAAiEruAAAQldwBACAquQMAQFRyBwCAqOQOAABRyR0AAKKSOwAARCV3AACISu4AABCV3AEAICq5AwBAVHIHAICo5A4AAFHJHQAAopI7AABEJXcAAIhK7gAAEJXcAQAgKrkDAEBUcgcAgKjkDgAAUckdAACikjsAAEQldwAAiEruAAAQldwBACAquQMAQFRyBwCAqOQOAABRyR0AAKKSOwAARCV3AACISu4AABCV3AEAICq5AwBAVHIHAICo5A4AAFHJHQAAopI7AABEJXcAAIhK7gAAEJXcAQAgKrkDAEBUcgcAgKjkDgAAUckdAACikjsAAEQldwAAiEruAAAQldwBACAquQMAQFRyBwCAqOQOAABRyR0AAKKSOwAARCV3AACISu4AABCV3AEAICq5AwBAVHIHAICo5A4AAFHJHQAAopI7AABEJXcAAIhK7gAAEJXcAQAgKrkDAEBUcgcAgKjkDgAAUckdAACikjsAAEQldwAAiEruAAAQldwBACAquQMAQFRyBwCAqOQOAABRyR0AAKKSOwAARCV3AACISu4AABCV3AEAICq5AwBAVHIHAICo5A4AAFHJHQAAopI7AABEJXcAAIhK7gAAEJXcAQAgKrkDAEBUcgcAgKjkDgAAUckdAACikjsAAEQldwAAiEruAAAQldwBACAquQMAQFRyBwCAqOQOAABRyR0AAKKSOwAARCV3AACISu4AABCV3AEAICq5AwBAVHIHAICo5A4AAFHJHQAAopI7AABEJXcAAIhK7gAAEJXcAQAgKrkDAEBU/wM+ecOhh3CtXgAAAABJRU5ErkJggg==" alt="img"></p>
<p>The <code>estimateEffect()</code> function can be used to estimate a regression for each topic specified as the dependent variable in the formula argument, using the documents as observations, covariates as independent variables and the topical proportions for the documents as the dependent variable. Confidence intervals are estimated by default.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">set.seed(831)</span><br><span class="line">stm_ee &lt;- estimateEffect(1:15~Rating + Age + Recommended.IND,</span><br><span class="line">                         stmobj = stm_mod, </span><br><span class="line">                         metadata = out$meta, </span><br><span class="line">                         uncertainty=&quot;Global&quot;)</span><br></pre></td></tr></table></figure>
<p>We can use the <code>summary()</code> function to view the full output, along with the statistical significance flags. We will use use indexing to view the summary information for Topic 15 (which removes the significance flags).</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">summary(stm_ee)[[&quot;tables&quot;]][[15]]</span><br><span class="line">##                      Estimate   Std. Error    t value     Pr(&gt;|t|)</span><br><span class="line">## (Intercept)       0.117683602 1.013351e-02 11.6133129 9.637647e-31</span><br><span class="line">## Rating2          -0.008112754 1.060374e-02 -0.7650843 4.442615e-01</span><br><span class="line">## Rating3          -0.012280054 1.065081e-02 -1.1529688 2.489844e-01</span><br><span class="line">## Rating4          -0.042307498 1.236368e-02 -3.4219190 6.273478e-04</span><br><span class="line">## Rating5          -0.050604880 1.224795e-02 -4.1317011 3.666291e-05</span><br><span class="line">## Age               0.000141237 9.403535e-05  1.5019560 1.331786e-01</span><br><span class="line">## Recommended.IND1 -0.021289230 7.278934e-03 -2.9247729 3.464291e-03</span><br></pre></td></tr></table></figure>
<p>We can use <code>plot()</code> on an <code>estimateEffect</code> object to get point estimate information (mean topic proportions for each value of the covariate), compare differences (mean difference in topic proportions across two covariate levels) and plot expected topic proportions across a continuous variable. Moderator variables can be included if interactions are incorporated.</p>
<p>First, we can use the <code>labelTopics()</code> function to view the top terms for a topic overall, for the covariate, and for the topic-covariate interaction. If no content covariate is provided, the <code>labelTopics()</code> output includes the top terms based on probability, FREX (frequency and exclusivity), lift and score.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">labelTopics(stm_mod,</span><br><span class="line">            topics = c(7))</span><br><span class="line">## Topic Words:</span><br><span class="line">##  Topic 7: dress, girl, slip, zipper, belt, area, curvy </span><br><span class="line">##  </span><br><span class="line">##  Covariate Words:</span><br><span class="line">##  Group 1: bad, completely, due, put, disappoint, something, ever </span><br><span class="line">##  Group 2: sadly, bad, close, return, disappoint, seam, fine </span><br><span class="line">##  Group 3: plus, sadly, however, okay, seem, completely, bad </span><br><span class="line">##  Group 4: rather, reason, still, other, keep, issue, agree </span><br><span class="line">##  Group 5: please, happy, must, purchase, slightly, prefer, texture </span><br><span class="line">##  </span><br><span class="line">##  Topic-Covariate Interactions:</span><br><span class="line">##  Topic 7, Group 1: ivory, exactly, flowy, embroidery, beautiful, gorgeous, fabric </span><br><span class="line">##  Topic 7, Group 2: kind, return, navy, want, picture, pink, green </span><br><span class="line">##  Topic 7, Group 3: buy, use, yet, day, cold, quality </span><br><span class="line">##  Topic 7, Group 4: lovely, high, leg, waisted, hip, regular, problem </span><br><span class="line">##  Topic 7, Group 5: vest, gray, pocket, true, summer, perfect, light </span><br><span class="line">## </span><br></pre></td></tr></table></figure>
<p>We can view the expected topic proportions and CI for the <code>Age</code> variable for the model predicting Topic 7.</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">plot(x = stm_ee, </span><br><span class="line">     covariate = &quot;Age&quot;, </span><br><span class="line">     topic = c(7), </span><br><span class="line">     model = stm_mod, </span><br><span class="line">     method = &quot;continuous&quot;)</span><br></pre></td></tr></table></figure>
<p><img src="data:image/png;base64,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" alt="img"></p>
<p>We can use <code>type = &quot;pointestimate&quot;</code> to plot the mean topic proportions and CI for the levels of the <code>Rating</code> variable (1-5).</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">labelTopics(stm_mod,</span><br><span class="line">            topics = c(3))</span><br><span class="line">## Topic Words:</span><br><span class="line">##  Topic 3: spin-dry, price, wash, quality, worth, hold, sale </span><br><span class="line">##  </span><br><span class="line">##  Covariate Words:</span><br><span class="line">##  Group 1: bad, completely, due, put, disappoint, something, ever </span><br><span class="line">##  Group 2: sadly, bad, close, return, disappoint, seam, fine </span><br><span class="line">##  Group 3: plus, sadly, however, okay, seem, completely, bad </span><br><span class="line">##  Group 4: rather, reason, still, other, keep, issue, agree </span><br><span class="line">##  Group 5: please, happy, must, purchase, slightly, prefer, texture </span><br><span class="line">##  </span><br><span class="line">##  Topic-Covariate Interactions:</span><br><span class="line">##  Topic 3, Group 1: already, shoulder, jacket, really </span><br><span class="line">##  Topic 3, Group 2: wash, first, exactly </span><br><span class="line">##  Topic 3, Group 3: first </span><br><span class="line">##  Topic 3, Group 4: white </span><br><span class="line">##  Topic 3, Group 5: thin, expect </span><br><span class="line">## </span><br><span class="line">plot(x = stm_ee, </span><br><span class="line">     covariate = &quot;Rating&quot;, </span><br><span class="line">     topic = c(3), </span><br><span class="line">     model = stm_mod, </span><br><span class="line">     method = &quot;pointestimate&quot;,</span><br><span class="line">     labeltype = &quot;custom&quot;,</span><br><span class="line">     custom.labels = c(1:5),</span><br><span class="line">     main = &quot;Topic 3 by Rating&quot;)</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>-Topic Modeling</tag>
      </tags>
  </entry>
</search>
